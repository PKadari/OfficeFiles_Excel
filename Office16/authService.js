!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=199)}({1:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return d}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function s(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function u(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))}function c(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function l(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i}function d(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}Object.create},16:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var i=n(4),r=null;function o(t){return void 0===t&&(t=!0),r&&t||(typeof globalThis!==i.l&&globalThis&&(r=globalThis),typeof self!==i.l&&self&&(r=self),typeof window!==i.l&&window&&(r=window),typeof e!==i.l&&e&&(r=e)),r}function a(e){throw new TypeError(e)}function s(e){var t=i.c;if(t)return t(e);if(null==e)return{};var n=typeof e;function r(){}return n!==i.j&&n!==i.h&&a("Object prototype may only be an Object:"+e),r[i.k]=e,new r}}).call(this,n(39))},197:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u}));var i=n(4),r=n(16),o=((Object(r.a)()||{}).Symbol,(Object(r.a)()||{}).Reflect,i.a||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])i.f[i.i].call(t,o)&&(e[o]=t[o]);return e}),a=function(e,t){return(a=i.b.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[i.i](n)&&(e[n]=t[n])})(e,t)};function s(e,t){function n(){this.constructor=e}typeof t!==i.h&&null!==t&&Object(r.c)("Class extends value "+String(t)+" is not a constructor or null"),a(e,t),e[i.k]=null===t?Object(r.b)(t):(n[i.k]=t[i.k],new n)}function u(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e}},198:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var i=function(){try{return void 0!==e.env.JEST_WORKER_ID}catch(e){return!!window.Cypress}}}).call(this,n(46))},199:function(e,t,n){"use strict";n.r(t);var i,r,o=n(40),a=n(8),s=n(36);!function(e){e.Success="success",e.Failure="failure"}(i||(i={})),function(e){e.AuthConfig="AuthConfig"}(r||(r={}));const u=Object(s.a)();function c(e,t,n){u&&u.postMessage({eventType:e,status:t,data:n})}u&&u.addEventListener("message",e=>{e.data&&e.data.type===r.AuthConfig&&function(e){let t=[];e.validDomains&&(t=e.validDomains.split(",")||[]),new o.b(window,{url:e.targetUrl,width:e.width,height:e.height,left:e.left,top:e.top},{appId:e.appId||"",validDomains:t,showLoadingIndicator:e.showLoadingIndicator,version:e.appVersion||""},{getUser:()=>Promise.resolve({profile:{oid:e.userObjectId||"",tid:e.tenantId||"",upn:e.userPrincipalName||""}}),notifySuccess:t=>(c(e.type,i.Success,t),Promise.resolve()),notifyFailure:t=>(c(e.type,i.Failure,t),Promise.resolve()),acquireToken:(t,n,r)=>(c(e.type,i.Failure,"acquireToken in MetaOSAuthExtension is not implemented"),Promise.resolve({token:""}))},{app:{locale:e.locale||"en-US",theme:e.isDarkTheme?a.d.dark:a.d.default,host:{name:a.c.outlook,clientType:a.b.desktop,version:e.clientVersion,sessionId:e.hostSessionId},sessionId:e.sessionId},page:{id:"defaultId",frameContext:a.a.authentication}})||c(e.type,i.Failure,"MetaOSAuthExtension is null")}(e.data)})},2:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return u}));var i,r,o="0.2.6",a={appInitialization:{appLoaded:"appInitialization.appLoaded",expectedFailure:"appInitialization.expectedFailure",failure:"appInitialization.failure",success:"appInitialization.success"},appInstallDialog:{openAppInstallDialog:"appInstallDialog.openAppInstallDialog"},authentication:{getAuthToken:"authentication.getAuthToken",getUser:"authentication.getUser",authenticate:"authentication.authenticate",notifySuccess:"authentication.authenticate.success",notifyFailure:"authentication.authenticate.failure"},appEntity:{selectAppEntity:"appEntity.selectAppEntity"},bot:{authenticate:"bot.authenticate",getSupportedCommands:"bot.getSupportedCommands",sendQuery:"bot.executeQuery"},calendar:{composeMeeting:"calendar.composeMeeting",openCalendarItem:"calendar.openCalendarItem"},call:{startCall:"call.startCall"},chat:{openConversation:"conversations.openConversation",closeConversation:"conversations.closeConversation",getChatMembers:"getChatMembers"},dialogs:{open:"tasks.startTask",resize:"tasks.updateTask",submit:"tasks.completeTask"},files:{openFilePreview:"openFilePreview",getCloudStorageFolders:"files.getCloudStorageFolders",addCloudStorageFolder:"files.addCloudStorageFolder",deleteCloudStorageFolder:"files.deleteCloudStorageFolder"},getContext:"getContext",initialize:"initialize",location:{getLocation:"location.getLocation",showLocation:"location.showLocation"},links:{openLink:"executeDeepLink"},log:{handleAppLog:"log.receive"},mail:{composeMail:"mail.composeMail",openMailItem:"mail.openMailItem"},media:{captureImage:"captureImage",getMedia:"getMedia",scanBarCode:"media.scanBarCode",selectMedia:"selectMedia",viewImages:"viewImages"},meeting:{getAppContentStageSharingCapabilities:"meeting.getAppContentStageSharingCapabilities",getAppContentStageSharingState:"meeting.getAppContentStageSharingState",getAuthenticationTokenForAnonymousUser:"meeting.getAuthenticationTokenForAnonymousUser",getIncomingClientAudioState:"getIncomingClientAudioState",getLiveStreamState:"meeting.getLiveStreamState",getMeetingDetails:"meeting.getMeetingDetails",requestStartLiveStreaming:"meeting.requestStartLiveStreaming",requestStopLiveStreaming:"meeting.requestStopLiveStreaming",shareAppContentToStage:"meeting.shareAppContentToStage",stopSharingAppContentToStage:"meeting.stopSharingAppContentToStage",toggleIncomingClientAudio:"toggleIncomingClientAudio"},meetingRoom:{getPairedMeetingRoomInfo:"meetingRoom.getPairedMeetingRoomInfo",sendCommandToPairedMeetingRoom:"meetingRoom.sendCommandToPairedMeetingRoom"},monetization:{openPurchaseExperience:"monetization.openPurchaseExperience"},notifications:{showNotification:"notifications.showNotification"},pages:{getConfig:"settings.getSettings",navigateCrossDomain:"navigateCrossDomain",navigateToApp:"pages.navigateToApp",returnFocus:"returnFocus",setCurrentFrame:"setFrameContext",shareDeepLink:"shareDeepLink",backStack:{navigateBack:"navigateBack"},tabs:{getTabInstances:"getTabInstances",getMruTabInstances:"getMruTabInstances",navigateToTab:"navigateToTab"},config:{setConfig:"settings.setSettings",setValidityState:"settings.setValidityState",save:{success:"settings.save.success",failure:"settings.save.failure"},remove:{success:"settings.remove.success",failure:"settings.remove.failure"}},fullTrust:{enterFullscreen:"enterFullscreen",exitFullscreen:"exitFullscreen"}},people:{selectPeople:"people.selectPeople"},remoteCamera:{getCapableParticipants:"remoteCamera.getCapableParticipants",requestControl:"remoteCamera.requestControl",sendControlCommand:"remoteCamera.sendControlCommand",terminateSession:"remoteCamera.terminateSession"},readyToUnload:"readyToUnload",registerHandler:"registerHandler",sharing:{shareWebContent:"sharing.shareWebContent"},teams:{fullTrust:{getUserJoinedTeams:"getUserJoinedTeams",getConfigSetting:"getConfigSetting"}}};!function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(i||(i={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(r||(r={}));var s={resourceDomainParameter:"{resourceDomain}",validResourcePattern:"^((https|api)://{resourceDomain}([:/].*)?)$"},u=["com.example.microsoftteamstabs.test","com.example.metaostestapp.test"]},24:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(1),r=n(2),o=n(37),a=n(5),s=n(3),u=function(e){function t(t,n,i){var r=e.call(this,t,i)||this;return r.appSdkHost=t,r.authenticationService=n,r.telemetryService=i,r}return Object(i.d)(t,e),t.prototype.initHandlers=function(){this.registerHandler(r.c.authentication.getUser,this.handleGetUser,{errorCallback:this.onGetUserError,isPrivate:!0}),this.registerHandler(r.c.authentication.getAuthToken,this.handleGetAuthToken,{errorCallback:this.onGetAuthTokenError})},t.prototype.validateDependencies=function(){if(!this.authenticationService)throw"No authentication service is available"},t.prototype.handleGetUser=function(){return Object(i.b)(this,void 0,void 0,(function(){var e;return Object(i.e)(this,(function(t){switch(t.label){case 0:return[4,this.authenticationService.getUser()];case 1:return(e=t.sent())?[2,Object(s.d)([!0,e.profile])]:[2,Promise.reject("Failed to fetch the user profile")]}}))}))},t.prototype.onGetUserError=function(e,t){return null==t||t.fail("GetUser failed ".concat(e)),Object(s.d)([!1,e])},t.prototype.handleGetAuthToken=function(e,t,n,r){return Object(i.b)(this,void 0,void 0,(function(){var a,u,c;return Object(i.e)(this,(function(i){switch(i.label){case 0:return console.log("getAuthToken called"),[4,this.appSdkHost.getAppContext()];case 1:return a=i.sent(),[4,Object(o.b)(e.origin,t,this.appSdkHost.getHubInfo(),this.appDefinition,a)];case 2:return u=i.sent(),[4,this.authenticationService.acquireToken(u[0],n,r)];case 3:return c=i.sent(),[2,Object(s.d)([!0,c.token])]}}))}))},t.prototype.onGetAuthTokenError=function(e,t){return null==t||t.fail("GetAuthToken failed ".concat(e)),Object(s.d)([!1,e])},t}(a.a)},25:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(1),r=n(2),o=n(7),a=n(37),s=n(5),u=n(3),c=function(e){function t(t,n,i){var a,s,u,c=e.call(this,t,i)||this;return c.appSdkHost=t,c.hubServices=n,c.telemetryService=i,c.initializationStatusReported=!1,c.setupAppLoadTimer=function(){return c.registerAppInitMessageHandlers?window.setTimeout((function(){c.appSdkHost.setAppInitInfo({state:o.a.Failed,reason:r.a.Timeout}),c.failAppInitializationScenario("App Load timed out")}),3e4):window.setTimeout((function(){c.failAppInitializationScenario("SDK initialization timed out")}),15e3)},c.stopAppInitializationScenario=function(){var e;c.clearTimeoutTimer(),null===(e=c.appInitializationScenario)||void 0===e||e.stop()},c.failAppInitializationScenario=function(e){var t;c.clearTimeoutTimer(),null===(t=c.appInitializationScenario)||void 0===t||t.fail(e)},c.clearTimeoutTimer=function(){window.clearTimeout(c.appLoadTimerId)},c.appInitializationScenario=null===(a=c.telemetryService)||void 0===a?void 0:a.createScenario("appInitialization",void 0,c.appSdkHost.getUserClickTime()),null===(s=c.appInitializationScenario)||void 0===s||s.markPhase("ClickToBeginLoad"),c.registerAppInitMessageHandlers=(null===(u=t.getAppDefinition())||void 0===u?void 0:u.showLoadingIndicator)||!1,c.appLoadTimerId=c.setupAppLoadTimer(),c}return Object(i.d)(t,e),t.prototype.initHandlers=function(){this.registerHandler(r.c.initialize,this.initialize),this.registerHandler(r.c.getContext,this.getContext,{errorCallback:this.onGetContextError}),this.registerHandler(r.c.readyToUnload,this.readyToUnload),this.registerAppInitMessageHandlers&&(this.registerHandler(r.c.appInitialization.appLoaded,this.handleAppLoaded),this.registerHandler(r.c.appInitialization.success,this.handleSuccess),this.registerHandler(r.c.appInitialization.failure,this.handleFailure),this.registerHandler(r.c.appInitialization.expectedFailure,this.handleExpectedFailure))},t.prototype.initialize=function(e,t){var n,i,r;null===(n=this.appInitializationScenario)||void 0===n||n.markPhase("BeginLoadToInitialized"),null===(i=this.telemetryService)||void 0===i||i.setAppSdkVersion(t),this.registerAppInitMessageHandlers||this.stopAppInitializationScenario(),this.appSdkHost.setInitialized(!0);var o={apiVersion:1,supports:{app:{},appInstallDialog:this.hubServices.appInstallDialogService?{}:void 0,appEntity:this.hubServices.appEntityService?{}:void 0,bot:this.hubServices.botService?{}:void 0,calendar:this.hubServices.calendarService?{}:void 0,call:this.hubServices.callService?{}:void 0,chat:this.hubServices.chatService?{}:void 0,dialog:this.hubServices.dialogService?{}:void 0,files:this.hubServices.filesService?{}:void 0,mail:this.hubServices.mailService?{}:void 0,media:this.hubServices.mediaService?{}:void 0,meeting:this.hubServices.meetingService?{}:void 0,meetingRoom:this.hubServices.meetingRoomService?{}:void 0,notifications:this.hubServices.notificationService?{}:void 0,location:this.hubServices.locationService?{}:void 0,log:this.hubServices.logService?{}:void 0,pages:this.hubServices.pageService?{appButton:this.hubServices.pageService.appButtonService?{}:void 0,tabs:this.hubServices.pageService.tabsService?{}:void 0,config:this.hubServices.pageService.configService?{}:void 0,backStack:this.hubServices.pageService.backStackService?{}:void 0,fullTrust:this.hubServices.pageService.fullTrustService?{}:void 0}:void 0,people:this.hubServices.peopleService?{}:void 0,remoteCamera:this.hubServices.remoteCameraService?{}:void 0,monetization:this.hubServices.monetizationService?{}:void 0,sharing:this.hubServices.sharingService?{}:void 0,teams:this.hubServices.teamsService?{fullTrust:(null===(r=this.hubServices.teamsService)||void 0===r?void 0:r.fullTrustService)?{}:void 0}:void 0}},a=[this.appSdkHost.getFrameContext(),this.appSdkHost.getHubInfo().clientType,"2.0.0",JSON.stringify(o)];return Object(u.d)(a)},t.prototype.getContext=function(){return Object(i.b)(this,void 0,void 0,(function(){var e,t;return Object(i.e)(this,(function(n){switch(n.label){case 0:return t=a.e,[4,this.appSdkHost.getAppContext()];case 1:return e=t.apply(void 0,[n.sent()]),[2,Object(u.d)(e)]}}))}))},t.prototype.onGetContextError=function(e,t){null==t||t.fail(e);return Object(u.d)({})},t.prototype.handleAppLoaded=function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.e)(this,(function(e){return this.appSdkHost.setAppInitInfo({state:o.a.Loaded}),[2,u.g]}))}))},t.prototype.handleSuccess=function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.e)(this,(function(e){return this.markInitializationStatusAsReported()?(this.appSdkHost.setAppInitInfo({state:o.a.Loaded}),this.stopAppInitializationScenario(),[2,u.g]):[2,u.g]}))}))},t.prototype.handleFailure=function(e,t){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.e)(this,(function(e){return this.markInitializationStatusAsReported()?(this.appSdkHost.setAppInitInfo({state:o.a.Failed,reason:t}),this.failAppInitializationScenario(t),[2,u.g]):[2,u.g]}))}))},t.prototype.handleExpectedFailure=function(e,t){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.e)(this,(function(e){return this.markInitializationStatusAsReported()?(this.appSdkHost.setAppInitInfo({state:o.a.Loaded}),this.failAppInitializationScenario("Expected."+t),[2,u.g]):[2,u.g]}))}))},t.prototype.markInitializationStatusAsReported=function(){return!this.initializationStatusReported&&(this.initializationStatusReported=!0,!0)},t.prototype.readyToUnload=function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.e)(this,(function(e){return this.appSdkHost.setAppInitInfo({state:o.a.Unloaded}),[2,u.g]}))}))},t.prototype.cleanup=function(){this.clearTimeoutTimer()},t}(s.a)},26:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(e){this.listeners={},this.element=e}return e.prototype.addListener=function(e,t){this.element&&(this.removeListener(e),this.element.addEventListener(e,t),this.listeners[e]=t)},e.prototype.removeListener=function(e){this.element&&this.listeners[e]&&(this.element.removeEventListener(e,this.listeners[e]),delete this.listeners[e])},e.prototype.removeAllListeners=function(){for(var e=0,t=Object.keys(this.listeners);e<t.length;e++){var n=t[e];this.removeListener(n)}},e}()},27:function(e,t,n){"use strict";n.d(t,"a",(function(){return Wi}));var i=n(1);var r,o=(r=[],{fireEvent:function(e){r.forEach((function(t){return t(e)}))},addListener:function(e){e&&r.push(e)}});function a(e,t,n){o.fireEvent({level:e,category:t,message:n})}function s(e,t,n){a(0,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}var u,c={};!function(e){var t=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,n=/^[a-zA-Z0-9_\.]{1,95}$/;function i(e){return n.test(e)}function r(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!i(e.name))throw new Error("Invalid dataField name");2===e.dataType&&o(e.value)}))}function o(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;return t.test(e)}(e.eventName))throw new Error("Invalid eventName");var n=e.eventContract;if(n){if(n.name&&!i(n.name))throw new Error("Invalid eventContract");r(n.dataFields)}r(e.dataFields)},e.validateInt=o}(u||(u={}));function l(e,t){return{name:e,dataType:1,value:t,classification:4}}function d(e,t){return{name:e,dataType:2,value:t,classification:4}}function f(e,t){return{name:e,dataType:0,value:t,classification:4}}function p(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?Object(i.a)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var v,h,g,m,y,S,b,C,T=function(){function e(e,t,n){var r,o,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=Object(i.a)(Object(i.a)({},e.getConfig()),this.config),(o=this.partAFields).push.apply(o,e.partAFields)),t&&(a=this.persistentDataFields).push.apply(a,t)}return e.prototype.sendTelemetryEvent=function(e){var t=p(e),n=t.telemetryProperties;if(n.customerContentVersion||n.customerContentType)a(0,0,(function(){return"Customer content"}));else{if(!n.ariaTenantToken||!n.nexusTenantToken){var i=function(e){for(var t=e.length;t>0;){var n=e.substr(0,t);if(c[n])return c[n];t=e.lastIndexOf(".",t-1)}}(t.eventName);if(!i)return void a(0,0,(function(){return"No tenant token: "+e.eventName}));n.ariaTenantToken=i.ariaTenantToken,n.nexusTenantToken=i.nexusTenantToken}this.sendTelemetryEventInternal(t)}},e.prototype.sendCustomerContent=function(e){var t=p(e),n=t.telemetryProperties;return(!n.customerContentVersion||n.customerContentVersion>1)&&(n.customerContentVersion=1),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,t.dataFields.push(d("EventContent.Type",2)),this.sendTelemetryEventInternal(t)},e.prototype.sendTelemetryEventInternal=function(e){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push(e):a(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e)}catch(e){return void s(0,"SendTelemetryEvent",e)}try{this.telemetrySinks.forEach((function(t){var n=e.telemetryProperties;n.customerContentVersion&&n.customerContentType?t.sendCustomerContent&&t.sendCustomerContent(e):t.sendTelemetryEvent(e)}))}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t,n,i;if(e.dataFields&&(null===(i=e.dataFields)||void 0===i||i.unshift(f("OTelJS.Version","4.8.3")),this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields)),this.partAFields.length>0){var r=e.eventContract||{name:"",dataFields:[]};(n=r.dataFields).push.apply(n,this.partAFields),e.eventContract=r}this.config.disableValidation||u.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e)},e.prototype.flushQueue=function(){var e=this,t=this.eventQueue;this.eventQueue=[],this.telemetrySinks.length>0&&t.forEach((function(t){e.sendTelemetryEventInternal(t)}))},e.prototype.setTenantToken=function(e,t,n){!function(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?c[e]=t:a(0,0,(function(){return"Namespace: "+e}))}(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.cloneEvent=function(e){return p(e)},e.prototype.getConfig=function(){return this.config},e}();(v||(v={})).getFields=function(e,t){var n=[];return n.push(d(e+".Code",t.code)),void 0!==t.type&&n.push(f(e+".Type",t.type)),void 0!==t.tag&&n.push(d(e+".Tag",t.tag)),void 0!==t.isExpected&&n.push(l(e+".IsExpected",t.isExpected)),n.push(f("zC.Activity.Result","Office.System.Result")),n},(g=h||(h={})).contractName="Office.System.Activity",g.getFields=function(e){var t=[];return void 0!==e.cV&&t.push(f("Activity.CV",e.cV)),t.push(d("Activity.Duration",e.duration)),t.push(d("Activity.Count",e.count)),t.push(d("Activity.AggMode",e.aggMode)),void 0!==e.success&&t.push(l("Activity.Success",e.success)),void 0!==e.result&&t.push.apply(t,v.getFields("Activity.Result",e.result)),t.push(f("zC.Activity",g.contractName)),t},(m||(m={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(f(e+".Id",t.id)),void 0!==t.version&&n.push(f(e+".Version",t.version)),void 0!==t.sessionId&&n.push(f(e+".SessionId",t.sessionId)),n},(y||(y={})).getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(f(e+".Alias",t.alias)),void 0!==t.primaryIdentityHash&&n.push(f(e+".PrimaryIdentityHash",t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(f(e+".PrimaryIdentitySpace",t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(f(e+".TenantId",t.tenantId)),void 0!==t.tenantGroup&&n.push(f(e+".TenantGroup",t.tenantGroup)),void 0!==t.isAnonymous&&n.push(l(e+".IsAnonymous",t.isAnonymous)),n},(S||(S={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(f(e+".Name",t.name)),void 0!==t.state&&n.push(f(e+".State",t.state)),n},(b||(b={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(d(e+".Id",t.id)),void 0!==t.name&&n.push(f(e+".Name",t.name)),void 0!==t.commandSurface&&n.push(f(e+".CommandSurface",t.commandSurface)),void 0!==t.parentName&&n.push(f(e+".ParentName",t.parentName)),void 0!==t.triggerMethod&&n.push(f(e+".TriggerMethod",t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(d(e+".TimeOffsetMs",t.timeOffsetMs)),n},function(e){e.getFields=function(e,t){var n=[];return n.push(f(e+".ErrorGroup",t.errorGroup)),n.push(d(e+".Tag",t.tag)),void 0!==t.code&&n.push(d(e+".Code",t.code)),void 0!==t.id&&n.push(d(e+".Id",t.id)),void 0!==t.count&&n.push(d(e+".Count",t.count)),n}}(C||(C={}));var I,w=h,A=v,x=C,O=S,k=m,P=b,E=y;function F(e,t){return e?e+"."+t:t}function M(e,t,n,i){n&&i.push(f(""+F(e,t),n))}function R(e,t,n,i){"boolean"==typeof n&&i.push(l(""+F(e,t),n))}function D(e,t,n,i){"number"==typeof n&&i.push(d(""+F(e,t),n))}!function(e){!function(e){!function(e){e.Activity=w,e.Result=A,e.Error=x,e.Funnel=O,e.Host=k,e.User=E,e.UserAction=P}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(I||(I={}));var L,N=function(e){var t=[];return D("Activity.Result","Code",e.code,t),M("Activity.Result","Type",e.type,t),D("Activity.Result","Tag",e.tag,t),R("Activity.Result","IsExpected",e.isExpected,t),t.push(f("zC.Activity.Result","Office.System.Result")),t},_={contractName:"Office.System.Activity",getFields:function(e){var t=[];return M("Activity","CV",e.cV,t),D("Activity","Duration",e.duration,t),D("Activity","Count",e.count,t),D("Activity","AggMode",e.aggMode,t),R("Activity","Success",e.success,t),e.result&&t.push.apply(t,N(e.result)),t.push(f("zC.Activity",this.contractName)),t}};!function(e){var t,n=0;e.getNext=function(){return void 0===t&&(t=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new i(t,++n)},e.getNextChild=function(e){return new i(e.getString(),++e.nextChild)};var i=function(){function e(e,t){this.base=e,this.id=t,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=i}(L||(L={}));var j=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(j=function(){return 1e3*Math.floor(window.performance.now())});var U,H=function(e){var t,n=j(),i=p(e.telemetryEvent);return{cv:e.parentCv?L.getNextChild(e.parentCv):L.getNext(),eventName:e.telemetryEvent.eventName,dataFields:i.dataFields,eventFlags:i.eventFlags,telemetryProperties:i.telemetryProperties,createChildActivity:function(t){return H({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){if(!t){void 0===this.success&&void 0===this.result&&a(1,0,(function(){return"Activity does not have success or result set"}));var i=j();t=!0;var r={duration:i-n,count:1,aggMode:0,cV:this.cv.getString(),success:this.success,result:this.result},o=this.eventContract&&this.eventContract.dataFields?this.eventContract.dataFields:[];return o.push.apply(o,_.getFields(r)),this.eventContract={name:_.contractName,dataFields:o},e.sendTelemetryEvent(this)}a(0,0,(function(){return"Already ended"}))}}},z=function(e){var t=[];return t.push(f("Error.ErrorGroup",e.errorGroup)),t.push(d("Error.Tag",e.tag)),void 0!==e.code&&t.push(d("Error.Code",e.code)),void 0!==e.id&&t.push(d("Error.Id",e.id)),void 0!==e.count&&t.push(d("Error.Count",e.count)),t},B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.d)(t,e),t.prototype.createActivity=function(e){return function(e,t){return H({telemetryEvent:t,sendTelemetryEvent:function(t){e.sendTelemetryEvent(t)}})}(this,e)},t.prototype.sendActivity=function(e,t,n,i){return this.sendTelemetryEvent({eventName:e,eventContract:{name:_.contractName,dataFields:_.getFields(t)},dataFields:n,eventFlags:i})},t.prototype.sendError=function(e){var t=z(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return function(e,t){return H({telemetryEvent:t,sendTelemetryEvent:function(t){e.sendCustomerContent(t)}})}(this,e)},t}(T),W=n(197);!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(U||(U={}));var K={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103,FailedAddingCustomDefinedRequestContext:104,InMemoryStorageBufferFull:105},q=n(4),V=n(16),G=q.d,J=(q.b.freeze,q.b.seal,q.b.keys),Q=String[q.k],X=Q.trim,Z=Q.endsWith,$=Q.startsWith,Y=Date[q.k].toISOString,ee=Array.isArray,te=q.f.toString,ne=q.e.toString;ne.call(q.b),Object.getPrototypeOf;function ie(e,t){return typeof e===t}function re(e){return void 0===e||typeof e===q.l}function oe(e){return null===e||re(e)}function ae(e){return!oe(e)}function se(e,t){return!(!e||!q.e.call(e,t))}function ue(e){return!(!e||typeof e!==q.j)}function ce(e){return!(!e||typeof e!==q.h)}function le(e,t,n,i){void 0===i&&(i=!1);var r=!1;if(!oe(e))try{oe(e.addEventListener)?oe(e.attachEvent)||(e.attachEvent("on"+t,n),r=!0):(e.addEventListener(t,n,i),r=!0)}catch(e){}return r}function de(e,t){if(e)for(var n in e)q.e.call(e,n)&&t.call(e,n,e[n])}function fe(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=Z?e.endsWith(t):function(e,t){var n=!1,i=t?t.length:0,r=e?e.length:0;if(i&&r&&r>=i&&!(n=e===t)){for(var o=r-1,a=i-1;a>=0;a--){if(e[o]!=t[a])return!1;o--}n=!0}return n}(e,t)),n}function pe(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=$?e.startsWith(t):function(e,t){var n=!1,i=t?t.length:0;if(e&&i&&e.length>=i&&!(n=e===t)){for(var r=0;r<i;r++)if(e[r]!==t[r])return!1;n=!0}return n}(e,t)),n}function ve(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}function he(e){return!(!e||"[object Date]"!==te.call(e))}var ge=ee||function(e){return!(!e||"[object Array]"!==te.call(e))};function me(e){return!(!e||"[object Error]"!==te.call(e))}function ye(e){return"string"==typeof e}function Se(e){return"number"==typeof e}function be(e){return"boolean"==typeof e}function Ce(e){if(e)return Y?e.toISOString():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function Te(e,t,n){var i=e.length;try{for(var r=0;r<i&&(!(r in e)||-1!==t.call(n||e,e[r],r,e));r++);}catch(e){}}function Ie(e,t,n){if(e){if(e.indexOf)return e.indexOf(t,n);var i=e.length,r=n||0;try{for(var o=Math.max(r>=0?r:i-Math.abs(r),0);o<i;o++)if(o in e&&e[o]===t)return o}catch(e){}}return-1}function we(e,t,n){var i;if(e){if(e.map)return e.map(t,n);var r=e.length,o=n||e;i=new Array(r);try{for(var a=0;a<r;a++)a in e&&(i[a]=t.call(o,e[a],e))}catch(e){}}return i}function Ae(e,t,n){var i;if(e){if(e.reduce)return e.reduce(t,n);var r=e.length,o=0;if(arguments.length>=3)i=arguments[2];else{for(;o<r&&!(o in e);)o++;i=e[o++]}for(;o<r;)o in e&&(i=t(i,e[o],o,e)),o++}return i}function xe(e){return e&&(e=X&&e.trim?e.trim():e.replace?e.replace(/^\s+|\s+$/g,""):e),e}var Oe=!{toString:null}.propertyIsEnumerable("toString"),ke=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function Pe(e){var t=typeof e;if(t===q.h||t===q.j&&null!==e||Object(V.c)("objKeys called on non-object"),!Oe&&J)return J(e);var n=[];for(var i in e)e&&q.e.call(e,i)&&n.push(i);if(Oe)for(var r=ke.length,o=0;o<r;o++)e&&q.e.call(e,ke[o])&&n.push(ke[o]);return n}function Ee(e,t,n,i){if(G)try{var r={enumerable:!0,configurable:!0};return n&&(r.get=n),i&&(r.set=i),G(e,t,r),!0}catch(e){}return!1}function Fe(){var e=Date;return e.now?e.now():(new e).getTime()}function Me(e,t,n,i,r){var o=n;return e&&((o=e[t])===n||r&&!r(o)||i&&!i(n)||(o=n,e[t]=o)),o}function Re(e){return!e}function De(e){return!!e}function Le(e){throw new Error(e)}function Ne(e){return e&&q.a&&(e=Object(q.b)(Object(q.a)({},e))),e}var _e=null,je=null,Ue=!1,He=null,ze=null;function Be(e,t){var n=!1;if(e){try{if(!(n=t in e)){var i=e[q.k];i&&(n=t in i)}}catch(e){}if(!n)try{n=!re((new e)[t])}catch(e){}}return n}function We(e){var t=Object(V.a)();return t&&t[e]?t[e]:"window"===e&&Ke()?window:null}function Ke(){return Boolean(typeof window===q.j&&window)}function qe(){return Ke()?window:We("window")}function Ve(){return Boolean(typeof document===q.j&&document)?document:We("document")}function Ge(){return Boolean(typeof navigator===q.j&&navigator)}function Je(){return Ge()?navigator:We("navigator")}function Qe(e){if(e&&Ue){var t=We("__mockLocation");if(t)return t}return typeof location===q.j&&location?location:We("location")}function Xe(){return Boolean(typeof JSON===q.j&&JSON||null!==We("JSON"))}function Ze(){return Xe()?JSON||We("JSON"):null}function $e(){var e=Je();return!(!e||!e.product)&&"ReactNative"===e.product}function Ye(){var e=Je();if(e&&(e.userAgent!==je||null===_e)){var t=((je=e.userAgent)||"").toLowerCase();_e=ve(t,"msie")||ve(t,"trident/")}return _e}function et(e){var t=Object[q.k].toString.call(e),n="";return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":Xe()&&(n=Ze().stringify(e)),t+n}function tt(){return null===ze&&(ze=Ge()&&Boolean(Je().sendBeacon)),ze}function nt(e){var t=!1;try{t=!!We("fetch");var n=We("Request");t&&e&&n&&(t=Be(n,"keepalive"))}catch(e){}return t}function it(){return null===He&&(He="undefined"!=typeof XDomainRequest)&&rt()&&(He=He&&!Be(We("XMLHttpRequest"),"withCredentials")),He}function rt(){var e=!1;try{e=!!We("XMLHttpRequest")}catch(e){}return e}
/*!
 * Microsoft Dynamic Proto Utility, 1.1.4
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */var ot=Object,at=ot.getPrototypeOf,st=0;function ut(e,t){return e&&ot.prototype.hasOwnProperty.call(e,t)}function ct(e){return e&&(e===ot.prototype||e===Array.prototype)}function lt(e){return ct(e)||e===Function.prototype}function dt(e){if(e){if(at)return at(e);var t=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);if(t)return t}return null}function ft(e,t){var n=[],i=ot.getOwnPropertyNames;if(i)n=i(e);else for(var r in e)"string"==typeof r&&ut(e,r)&&n.push(r);if(n&&n.length>0)for(var o=0;o<n.length;o++)t(n[o])}function pt(e,t,n){return"constructor"!==t&&"function"==typeof e[t]&&(n||ut(e,t))}function vt(e){throw new TypeError("DynamicProto: "+e)}function ht(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function gt(e,t,n,i){var r=null;if(e&&ut(n,"_dynClass")){var o=e._dynInstFuncs||{};if((r=(o[n._dynClass]||{})[t])||vt("Missing ["+t+"] function"),!r._dynInstChk&&!1!==o._dynInstChk){for(var a=!ut(e,t),s=dt(e),u=[];a&&s&&!lt(s)&&!ht(u,s);){var c=s[t];if(c){a=c===i;break}u.push(s),s=dt(s)}try{a&&(e[t]=r),r._dynInstChk=1}catch(e){o._dynInstChk=!1}}}return r}function mt(e,t,n){var i=t[e];return i===n&&(i=dt(t)[e]),"function"!=typeof i&&vt("["+e+"] is not a function"),i}function yt(e,t,n,i,r){if(!ct(e)){var o=n._dynInstFuncs=n._dynInstFuncs||{},a=o[t]=o[t]||{};!1!==o._dynInstChk&&(o._dynInstChk=!!r),ft(n,(function(t){pt(n,t,!1)&&n[t]!==i[t]&&(a[t]=n[t],delete n[t],(!ut(e,t)||e[t]&&!e[t]._isDynProxy)&&(e[t]=function(e,t){var n=function(){var i=gt(this,t,e,n)||mt(t,e,n);return i.apply(this,arguments)};return n._isDynProxy=1,n}(e,t)))}))}}function St(e,t){return ut(e,"prototype")?e.name||t||"_unknown_":((e||{}).constructor||{}).name||t||"_unknown_"}function bt(e,t,n,i){ut(e,"prototype")||vt("theClass is an invalid class definition.");var r=e.prototype;(function(e,t){if(at)for(var n=[],i=dt(t);i&&!lt(i)&&!ht(n,i);){if(i===e)return!0;n.push(i),i=dt(i)}return!1})(r,t)||vt("["+St(e)+"] is not in class hierarchy of ["+St(t)+"]");var o=null;ut(r,"_dynClass")?o=r._dynClass:(o="_dynCls$"+St(e,"_")+"$"+st,st++,r._dynClass=o);var a=bt._dfOpts,s=!!a.useBaseInst;s&&i&&void 0!==i.useBaseInst&&(s=!!i.useBaseInst);var u=function(e){var t={};return ft(e,(function(n){!t[n]&&pt(e,n,!1)&&(t[n]=e[n])})),t}(t);n(t,function(e,t,n,i){function r(e,t,n){var r=t[n];if(r._isDynProxy&&i){var o=e._dynInstFuncs||{};!1!==o._dynInstChk&&(r=(o[t._dynClass]||{})[n]||r)}return function(){return r.apply(e,arguments)}}var o={};ft(n,(function(e){o[e]=r(t,n,e)}));for(var a=dt(e),s=[];a&&!lt(a)&&!ht(s,a);)ft(a,(function(e){!o[e]&&pt(a,e,!at)&&(o[e]=r(t,a,e))})),s.push(a),a=dt(a);return o}(r,t,u,s));var c=!!at&&!!a.setInstFuncs;c&&i&&(c=!!i.setInstFuncs),yt(r,o,t,u,!1!==c)}bt._dfOpts={setInstFuncs:!0,useBaseInst:!0};var Ct,Tt=bt,It=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],wt=null;function At(e,t){return function(){var n=arguments,i=xt(t);if(i){var r=i.listener;r&&r[e]&&r[e].apply(r,n)}}}function xt(e){var t,n=wt;return n||!0===e.disableDbgExt||(n=wt||((t=We("Microsoft"))&&(wt=t.ApplicationInsights),wt)),n?n.ChromeDbgExt:null}function Ot(e){return e?'"'+e.replace(/\"/g,"")+'"':""}function kt(e,t){var n=typeof console!==q.l?console:We("console");if(n){var i="log";n[e]&&(i=e),ce(n[i])&&n[i](t)}}var Pt=function(){function e(e,t,n,i){void 0===n&&(n=!1);this.messageId=e,this.message=(n?"AI: ":"AI (Internal): ")+e;var r="";Xe()&&(r=Ze().stringify(i));var o=(t?" message:"+Ot(t):"")+(i?" props:"+Ot(r):"");this.message+=o}return e.dataType="MessageData",e}();var Et=function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,i={};Tt(e,this,(function(e){function r(e,n){var i=t[e];return oe(i)?n:i}function o(e,n){var i=xt(t);i&&i.diagLog&&i.diagLog(e,n)}oe(t)&&(t={}),e.consoleLoggingLevel=function(){return r("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return r("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return r("maxMessageLimit",25)},e.enableDebugExceptions=function(){return r("enableDebugExceptions",!1)},e.throwInternal=function(t,n,r,a,s){void 0===s&&(s=!1);var u=new Pt(n,r,s,a);if(e.enableDebugExceptions())throw u;var c=t===U.CRITICAL?"errorToConsole":"warnToConsole";if(re(u.message))o("throw"+(t===U.CRITICAL?"Critical":"Warning"),u);else{var l=e.consoleLoggingLevel();if(s){var d=+u.messageId;!i[d]&&l>=t&&(e[c](u.message),i[d]=!0)}else l>=t&&e[c](u.message);e.logInternalMessage(t,u)}},e.warnToConsole=function(e){kt("warn",e),o("warning",e)},e.errorToConsole=function(e){kt("error",e),o("error",e)},e.resetInternalMessageCount=function(){n=0,i={}},e.logInternalMessage=function(t,r){if(!(n>=e.maxInternalMessageLimit())){var a=!0,s="AITR_"+r.messageId;if(i[s]?a=!1:i[s]=!0,a&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(r),n++,o(t===U.CRITICAL?"error":"warn",r)),n===e.maxInternalMessageLimit())){var u="Internal events throttle limit per PageView reached for this app.",c=new Pt(K.MessageLimitPerPVExceeded,u,!1);e.queue.push(c),t===U.CRITICAL?e.errorToConsole(u):e.warnToConsole(u)}}}}))},Ft=null,Mt=function(){function e(t,n,i){var r,o=this,a=!1;(o.start=Fe(),o.name=t,o.isAsync=i,o.isChildEvt=function(){return!1},ce(n))&&(a=Ee(o,"payload",(function(){return!r&&ce(n)&&(r=n(),n=null),r})));o.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?o[t]:(o.ctx||{})[t]:null},o.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)o[t]||(o.isChildEvt=function(){return!0}),o[t]=n;else if(t===e.ChildrenContextKey)o[t]=n;else{(o.ctx=o.ctx||{})[t]=n}},o.complete=function(){var t=0,i=o.getCtx(e.ChildrenContextKey);if(ge(i))for(var r=0;r<i.length;r++){var s=i[r];s&&(t+=s.time)}o.time=Fe()-o.start,o.exTime=o.time-t,o.complete=function(){},!a&&ce(n)&&(o.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Rt=function e(t){this.ctx={},Tt(e,this,(function(e){e.create=function(e,t,n){return new Mt(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&ce(t.perfEvent)&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}}))};function Dt(e,t,n,i,r){if(e){var o=e;if(ce(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx("CoreUtils.doPerf");try{if(a=o.create(t(),i,r)){if(s&&a.setCtx&&(a.setCtx(Mt.ParentContextKey,s),s.getCtx&&s.setCtx)){var u=s.getCtx(Mt.ChildrenContextKey);u||(u=[],s.setCtx(Mt.ChildrenContextKey,u)),u.push(a)}return o.setCtx("CoreUtils.doPerf",a),n(a)}}catch(e){a&&a.setCtx&&a.setCtx("exception",e)}finally{a&&o.fire(a),o.setCtx("CoreUtils.doPerf",s)}}}return n()}var Lt=function(e,t){var n=this,i=null,r=ce(e.processTelemetry),o=ce(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return i},n.setNext=function(e){i=e},n.processTelemetry=function(a,s){s||(s=t);var u=e?e.identifier:"TelemetryPluginChain";Dt(s?s.core():null,(function(){return u+":processTelemetry"}),(function(){if(e&&r){n._hasRun=!0;try{s.setNext(i),o&&e.setNextPlugin(i),i&&(i._hasRun=!1),e.processTelemetry(a,s)}catch(n){var t=i&&i._hasRun;i&&t||s.diagLog().throwInternal(U.CRITICAL,K.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+et(n)),i&&!t&&i.processTelemetry(a,s)}}else i&&(n._hasRun=!0,i.processTelemetry(a,s))}),(function(){return{item:a}}),!a.sync)}};function Nt(e,t){var n=[];if(e&&e.length>0)for(var i=null,r=0;r<e.length;r++){var o=e[r];if(o&&ce(o.processTelemetry)){var a=new Lt(o,t);n.push(a),i&&i.setNext(a),i=a}}return n.length>0?n[0]:null}var _t=function e(t,n,i,r){var o=this,a=null;null!==r&&(t&&ce(t.getPlugin)?a=function(e,t,n){var i=[],r=!n;if(e)for(;e;){var o=e.getPlugin();(r||o===n)&&(r=!0,i.push(o)),e=e.getNext()}return r||i.push(n),Nt(i,t)}(t,o,r||t.getPlugin()):r?a=function(e,t,n){var i=e,r=!1;return n&&e&&(i=[],Te(e,(function(e){(r||e===n)&&(r=!0,i.push(e))}))),n&&!r&&(i||(i=[]),i.push(n)),Nt(i,t)}(t,o,r):re(r)&&(a=Nt(t,o))),o.core=function(){return i},o.diagLog=function(){return function(e,t){return(e||{}).logger||new Et(t)}(i,n)},o.getCfg=function(){return n},o.getExtCfg=function(e,t){var i;if(void 0===t&&(t={}),n){var r=n.extensionConfig;r&&e&&(i=r[e])}return i||t},o.getConfig=function(e,t,i){var r;void 0===i&&(i=!1);var a=o.getExtCfg(e,null);return a&&!oe(a[t])?r=a[t]:n&&!oe(n[t])&&(r=n[t]),oe(r)?i:r},o.hasNext=function(){return null!=a},o.getNext=function(){return a},o.setNext=function(e){a=e},o.processNext=function(e){var t=a;t&&(a=t.getNext(),t.processTelemetry(e,o))},o.createNew=function(t,r){return void 0===t&&(t=null),new e(t||a,n,i,r)}},jt=function(){function e(){var e=this,t=!1,n=null,i=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){i=e},e.processNext=function(e,t){t?t.processNext(e):i&&ce(i.processTelemetry)&&i.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var r=t;if(!r){var o=n||new _t(null,{},e.core);r=i&&i.getPlugin?o.createNew(null,i.getPlugin):o.createNew(null,i)}return r},e._baseTelInit=function(r,o,a,s){r&&Me(r,"extensionConfig",[],null,oe),!s&&o&&(s=o.getProcessTelContext().getNext());var u=i;i&&i.getPlugin&&(u=i.getPlugin()),e.core=o,n=new _t(s,r,o,u),t=!0}}return e.prototype.initialize=function(e,t,n,i){this._baseTelInit(e,t,n,i)},e}();function Ut(e,t){for(var n=[],i=null,r=e.getNext();r;){var o=r.getPlugin();o&&(i&&ce(i.setNextPlugin)&&ce(o.processTelemetry)&&i.setNextPlugin(o),ce(o.isInitialized)&&o.isInitialized()||n.push(o),i=o,r=r.getNext())}Te(n,(function(n){n.initialize(e.getCfg(),e.core(),t,e.getNext())}))}function Ht(e){return e.sort((function(e,t){var n=0,i=ce(t.processTelemetry);return ce(e.processTelemetry)?n=i?e.priority-t.priority:1:i&&(n=-1),n}))}var zt=function(e){function t(){var n,i=e.call(this)||this;function r(e){e&&e.length>0&&(function(e){Te(e,(function(e){e.priority<500&&Le("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,t){return e.priority-t.priority}))),n.push(e))}return i.identifier="ChannelControllerPlugin",i.priority=500,Tt(t,i,(function(e,t){e.setNextPlugin=function(e){},e.processTelemetry=function(e,t){n&&Te(n,(function(n){n.length>0&&i._getTelCtx(t).createNew(n).processNext(e)}))},e.getChannelControls=function(){return n},e.initialize=function(i,o,a){e.isInitialized()||(t.initialize(i,o,a),function(e,t){n=[],e&&Te(e,(function(e){return r(e)}));if(t){var i=[];Te(t,(function(e){e.priority>500&&i.push(e)})),r(i)}}((i||{}).channels,a),Te(n,(function(e){return Ut(new _t(e,i,o),a)})))}})),i}var n;return Object(W.b)(t,e),t._staticInit=(Ee(n=t.prototype,"ChannelControls",n.getChannelControls),void Ee(n,"channelQueue",n.getChannelControls)),t}(jt),Bt=null,Wt=null,Kt=null,qt=Ve(),Vt={},Gt={};function Jt(e,t){var n=Xt._ckMgr||Gt._ckMgr;return n||(n=Xt._ckMgr=Xt(e,t),Gt._ckMgr=n),n}function Qt(e){return!e||e.isEnabled()}function Xt(e,t){var n=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(Me(t,"domain",e.cookieDomain,ae,oe),Me(t,"path",e.cookiePath||"/",null,oe),oe(t.enabled)){var n=void 0;re(e.isCookieUseDisabled)||(n=!e.isCookieUseDisabled),re(e.disableCookiesUsage)||(n=!e.disableCookiesUsage),t.enabled=n}return t}(e||Gt),i=n.path||"/",r=n.domain,o=!1!==n.enabled,a={isEnabled:function(){var e=o&&Zt(t),n=Gt._ckMgr;return e&&n&&a!==n&&(e=Qt(n)),e},setEnabled:function(e){o=!1!==e},set:function(e,t,o,s,u){var c=!1;if(Qt(a)){var l={},d=xe(t||""),f=d.indexOf(";");if(-1!==f&&(d=xe(t.substring(0,f)),l=$t(t.substring(f+1))),Me(l,"domain",s||r,De,re),!oe(o)){var p=Ye();if(re(l.expires)){var v=Fe()+1e3*o;if(v>0){var h=new Date;h.setTime(v),Me(l,"expires",Yt(h,p?"toGMTString":"toUTCString")||Yt(h,p?"toGMTString":"toUTCString")||"",De)}}p||Me(l,"max-age",""+o,null,re)}var g=Qe();g&&"https:"===g.protocol&&(Me(l,"secure",null,null,re),null===Wt&&(Wt=!rn((Je()||{}).userAgent)),Wt&&Me(l,"SameSite","None",null,re)),Me(l,"path",u||i,null,re),(n.setCookie||nn)(e,en(d,l)),c=!0}return c},get:function(e){var t="";return Qt(a)&&(t=(n.getCookie||tn)(e)),t},del:function(e,t){var n=!1;return Qt(a)&&(n=a.purge(e,t)),n},purge:function(e,i){var r,o=!1;if(Zt(t)){var a=((r={}).path=i||"/",r.expires="Thu, 01 Jan 1970 00:00:01 GMT",r);Ye()||(a["max-age"]="0"),(n.delCookie||nn)(e,en("",a)),o=!0}return o}};return a._ckMgr=a,a}function Zt(e){if(null===Bt){Bt=!1;try{Bt=void 0!==(qt||{}).cookie}catch(n){e&&e.throwInternal(U.WARNING,K.CannotAccessCookie,"Cannot access document.cookie - "+(me(t=n)?t.name:""),{exception:et(n)})}}var t;return Bt}function $t(e){var t={};e&&e.length&&Te(xe(e).split(";"),(function(e){if(e=xe(e||"")){var n=e.indexOf("=");-1===n?t[e]=null:t[xe(e.substring(0,n))]=xe(e.substring(n+1))}}));return t}function Yt(e,t){return ce(e[t])?e[t]():null}function en(e,t){var n=e||"";return de(t,(function(e,t){n+="; "+e+(oe(t)?"":"="+t)})),n}function tn(e){var t="";if(qt){var n=qt.cookie||"";Kt!==n&&(Vt=$t(n),Kt=n),t=xe(Vt[e]||"")}return t}function nn(e,t){qt&&(qt.cookie=e+"="+t)}function rn(e){return!!ye(e)&&(!(!ve(e,"CPU iPhone OS 12")&&!ve(e,"iPad; CPU OS 12"))||(!!(ve(e,"Macintosh; Intel Mac OS X 10_14")&&ve(e,"Version/")&&ve(e,"Safari"))||(!(!ve(e,"Macintosh; Intel Mac OS X 10_14")||!fe(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!ve(e,"Chrome/5")&&!ve(e,"Chrome/6"))||(!(!ve(e,"UnrealEngine")||ve(e,"Chrome"))||!(!ve(e,"UCBrowser/12")&&!ve(e,"UCBrowser/11")))))))}function on(e,t){return new Rt(t)}var an=0,sn=1,un=2,cn=4,ln=5,dn=function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;Tt(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=Ie(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=Ie(e.listeners,t)},e.eventsSent=function(t){Te(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(t)}),0)}))},e.eventsDiscarded=function(t,n){Te(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(t,n)}),0)}))},e.eventsSendRequest=function(t,n){Te(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(n)setTimeout((function(){return e.eventsSendRequest(t,n)}),0);else try{e.eventsSendRequest(t,n)}catch(e){}}))},e.perfEvent=function(t){t&&(!n&&t.isChildEvt()||Te(e.listeners,(function(e){if(e&&e.perfEvent)if(t.isAsync)setTimeout((function(){return e.perfEvent(t)}),0);else try{e.perfEvent(t)}catch(e){}})))}}))},fn=function(e){function t(){var n=e.call(this)||this,i=0;return Tt(t,n,(function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],un)}e.initialize=function(e,n,i,r){t.initialize(e,n,i||new Et(e),r||new dn(e))},e.track=function(i){Dt(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===i&&(n(i),Le("Invalid telemetry item")),function(e){if(oe(e.name))throw n(e),Error("telemetry name required")}(i),t.track(i)}),(function(){return{item:i}}),!i.sync)},e.addNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.addNotificationListener(t)},e.removeNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.removeNotificationListener(t)},e.pollInternalLogs=function(t){var n=e.config.diagnosticLogInterval;return n&&n>0||(n=1e4),i&&e.stopPollingInternalLogs(),i=setInterval((function(){var n=e.logger?e.logger.queue:[];Te(n,(function(n){var i={name:t||"InternalMessageId: "+n.messageId,iKey:e.config.instrumentationKey,time:Ce(new Date),baseType:Pt.dataType,baseData:{message:n.message}};e.track(i)})),n.length=0}),n)},e.stopPollingInternalLogs=function(){i&&(clearInterval(i),i=0)}})),n}return Object(W.b)(t,e),t}((function e(){var t,n,i,r,o,a=!1;Tt(e,this,(function(e){e._extensions=new Array,n=new zt,e.logger=new Et({loggingLevelConsole:U.CRITICAL}),t=[],e.isInitialized=function(){return a},e.initialize=function(t,r,o,s){var u,c,l,d;e.isInitialized()&&Le("Core should not be initialized more than once"),t&&!oe(t.instrumentationKey)||Le("Please provide instrumentation key"),i=s,e._notificationManager=s,e.config=t||{},s&&!0!==e.config.disableDbgExt&&s.addNotificationListener(function(e){if(!Ct){Ct={};for(var t=0;t<It.length;t++)Ct[It[t]]=At(It[t],e)}return Ct}(t)),e.config.enablePerfMgr&&Me(e.config,"createPerfMgr",on),t.extensions=oe(t.extensions)?[]:t.extensions,(c="extensionConfig",(u=t)?!(d=u[c])&&oe(d)&&(d=re(l)?{}:l,u[c]=d):d=re(l)?{}:l,d).NotificationManager=s,o&&(e.logger=o);var f=[];f.push.apply(f,Object(W.c)(Object(W.c)([],r,!1),t.extensions,!1)),f=Ht(f);var p=[],v=[],h={};Te(f,(function(e){(oe(e)||oe(e.initialize))&&Le("Extensions must provide callback to initialize");var t=e.priority,i=e.identifier;e&&t&&(oe(h[t])?h[t]=i:o.warnToConsole("Two extensions have same priority #"+t+" - "+h[t]+", "+i)),!t||t<n.priority?p.push(e):v.push(e)})),f.push(n),p.push(n),f=Ht(f),e._extensions=f,Ut(new _t([n],t,e),f),Ut(new _t(p,t,e),f),e._extensions=p,0===e.getTransmissionControls().length&&Le("No channels available"),a=!0,e.releaseQueue()},e.getTransmissionControls=function(){return n.getChannelControls()},e.track=function(n){Me(n,"iKey",e.config.instrumentationKey,null,Re),Me(n,"time",Ce(new Date),null,Re),Me(n,"ver","4.0",null,oe),e.isInitialized()?e.getProcessTelContext().processNext(n):t.push(n)},e.getProcessTelContext=function(){var t=e._extensions,i=t;return t&&0!==t.length||(i=[n]),new _t(i,e.config,e)},e.getNotifyMgr=function(){return i||(i=Object(V.b)({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),e._notificationManager=i),i},e.getCookieMgr=function(){return o||(o=Xt(e.config,e.logger)),o},e.setCookieMgr=function(e){o=e},e.getPerfMgr=function(){return r||e.config&&e.config.enablePerfMgr&&ce(e.config.createPerfMgr)&&(r=e.config.createPerfMgr(e,e.getNotifyMgr())),r||Ft},e.setPerfMgr=function(e){r=e},e.eventCnt=function(){return t.length},e.releaseQueue=function(){t.length>0&&(Te(t,(function(t){e.getProcessTelContext().processNext(t)})),t=[])}}))})),pn=0,vn=13,hn=32,gn=1,mn=2,yn=3,Sn=4,bn=0,Cn=1,Tn=6,In=7,wn=Object(W.a)(Object(W.a)({},K),{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520}),An=!1,xn=123456789,On=987654321;function kn(e){e<0&&(e>>>=0),xn=123456789+e&4294967295,On=987654321-e&4294967295,An=!0}function Pn(){try{var e=2147483647&Fe();kn((4294967296*Math.random()^e)+e)}catch(e){}}function En(e){return e>0?Math.floor(Fn()/4294967295*(e+1))>>>0:0}function Fn(e){var t,n=We("crypto")||We("msCrypto");return n&&n.getRandomValues?t=4294967295&n.getRandomValues(new Uint32Array(1))[0]:Ye()?(An||Pn(),t=4294967295&Rn()):t=Math.floor(4294967296*Math.random()|0),e||(t>>>=0),t}function Mn(e){e?kn(e):Pn()}function Rn(e){var t=((On=36969*(65535&On)+(On>>16)&4294967295)<<16)+(65535&(xn=18e3*(65535&xn)+(xn>>16)&4294967295))>>>0&4294967295|0;return e||(t>>>=0),t}var Dn,Ln=null;q.l;function Nn(e,t){var n=!1,i=qe();i&&(n=le(i,e,t),n=le(i.body,e,t)||n);var r=Ve();return r&&(n=le(r,e,t)||n),n}function _n(e,t){return function e(t,n,i){var r=!1;if(n&&t&&ge(t)){var o=[];Te(t,(function(e){ye(e)&&(i&&-1!==Ie(i,e)?o.push(e):r=Nn(e,n)||r)})),!r&&o.length>0&&(r=e(o,n))}return r}(["beforeunload","unload","pagehide"],e,t)}function jn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(Kn,(function(e){var t=0|En(15);return("x"===e?t:3&t|8).toString(16)}))}function Un(){var e=We("performance");return e&&e.now?e.now():Fe()}function Hn(e){void 0===e&&(e=22);for(var t=Fn()>>>0,n=0,i="";i.length<e;)n++,i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Fn()<<2&4294967295|3&t)>>>0,n=0);return i}function zn(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",i=0;i<4;i++)n+=t[15&(e=Fn())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var r=t[8+(3&Fn())|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+r+n.substr(16,3)+n.substr(19,12)}var Bn,Wn={_canUseCookies:void 0,isTypeof:ie,isUndefined:re,isNullOrUndefined:oe,hasOwnProperty:se,isFunction:ce,isObject:ue,isDate:he,isArray:ge,isError:me,isString:ye,isNumber:Se,isBoolean:be,toISOString:Ce,arrForEach:Te,arrIndexOf:Ie,arrMap:we,arrReduce:Ae,strTrim:xe,objCreate:V.b,objKeys:Pe,objDefineAccessors:Ee,addEventHandler:Nn,dateNow:Fe,isIE:Ye,disableCookies:function(){qn().setEnabled(!1)},newGuid:jn,perfNow:Un,newId:Hn,randomValue:En,random32:Fn,mwcRandomSeed:Mn,mwcRandom32:Rn,generateW3CId:zn},Kn=/[xy]/g;function qn(e,t){var n=Jt(e,t),i=Wn._canUseCookies;return null===Ln&&(Ln=[],Dn=i,Ee(Wn,"_canUseCookies",(function(){return Dn}),(function(e){Dn=e,Te(Ln,(function(t){t.setEnabled(e)}))}))),-1===Ie(Ln,n)&&Ln.push(n),be(i)&&n.setEnabled(i),be(Dn)&&n.setEnabled(Dn),n}var Vn=((Bn={})[0]=bn,Bn[2]=Tn,Bn[1]=Cn,Bn[3]=In,Bn[4098]=Tn,Bn[4097]=Cn,Bn[4099]=In,Bn),Gn=(Boolean(Ve()),Boolean(qe()));function Jn(e){return!(""===e||oe(e))}function Qn(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}function Xn(e){return!!(e&&Se(e)&&e>=gn&&e<=Sn)}function Zn(e,t,n){if(!t&&!Jn(t)||"string"!=typeof e)return null;var i=typeof t;if("string"===i||"number"===i||"boolean"===i||ge(t))t={value:t};else if("object"!==i||t.hasOwnProperty("value")){if(oe(t.value)||""===t.value||!ye(t.value)&&!Se(t.value)&&!be(t.value)&&!ge(t.value))return null}else t={value:n?JSON.stringify(t):t};if(ge(t.value)&&!ii(t.value))return null;if(!oe(t.kind)){if(ge(t.value)||!ni(t.kind))return null;t.value=t.value.toString()}return t}function $n(e,t,n){var i=-1;if(!re(e))if(t>0&&(32===t?i=8192:t<=13&&(i=t<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(n))-1===i&&(i=0),i|=n;else{var r=Vn[oi(e)]||-1;-1!==i&&-1!==r?i|=r:r===Tn&&(i=r)}return i}function Yn(e){void 0===e&&(e="D");var t=jn();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,"")),t}function ei(e,t,n,i,r){var o={},a=!1,s=0,u=arguments.length,c=Object[q.k],l=arguments;for("[object Boolean]"===c.toString.call(l[0])&&(a=l[0],s++);s<u;s++){de(e=l[s],(function(e,t){a&&t&&ue(t)?ge(t)?(o[e]=o[e]||[],Te(t,(function(t,n){t&&ue(t)?o[e][n]=ei(!0,o[e][n],t):o[e][n]=t}))):o[e]=ei(!0,o[e],t):o[e]=t}))}return o}var ti=Un;function ni(e){return e===pn||e>pn&&e<=vn||e===hn}function ii(e){return e.length>0}function ri(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=ti()}function oi(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===q.j&&(t=4,ge(e)?(t=4096,e.length>0&&(t|=oi(e[0]))):se(e,"value")&&(t=8192|oi(e.value)))}return t}q.l,q.j,q.l,V.b;var ai=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],n.pluginVersionString="",Tt(t,n,(function(e,t){e.logger&&e.logger.queue||(e.logger=new Et({loggingLevelConsole:U.CRITICAL})),e.initialize=function(n,i,r,o){Dt(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var a=n.propertyStorageOverride;if(a&&(!a.getProperty||!a.setProperty))throw new Error("Invalid property storage override passed.");n.channels&&Te(n.channels,(function(t){t&&Te(t,(function(t){if(t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},i&&Te(i,(function(t){if(t&&t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{t.initialize(n,i,r,o),e.pollInternalLogs("InternalLog")}catch(t){var s=e.logger,u=et(t);-1!==u.indexOf("channels")&&(u+="\n - Channels must be provided through config.channels only!"),s.throwInternal(U.CRITICAL,wn.FailedToInitializeSDK,"SDK Initialization Failed - no telemetry will be sent: "+u)}}),(function(){return{config:n,extensions:i,logger:r,notificationManager:o}}))},e.track=function(n){Dt(e,(function(){return"AppInsightsCore.track"}),(function(){var i=n;if(i){i.timings=i.timings||{},i.timings.trackStart=ti(),Xn(i.latency)||(i.latency=gn);var r=i.ext=i.ext||{};r.sdk=r.sdk||{},r.sdk.ver="1DS-Web-JS-3.1.11";var o=i.baseData=i.baseData||{};o.properties||(o.properties={});var a=o.properties;a.version||(a.version=""),""!==e.pluginVersionString&&(a.version=e.pluginVersionString)}t.track(i)}),(function(){return{item:n}}),!n.sync)}})),n}return Object(W.b)(t,e),t}(fn);function si(e){var t=(e.ext||{}).intweb;return t&&Jn(t.msfpc)?t.msfpc:null}function ui(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=si(e[n]);return t}var ci=function(){function e(t,n){var i=n?[].concat(n):[],r=ui(i);this.iKey=function(){return t},this.Msfpc=function(){return r||""},this.count=function(){return i.length},this.events=function(){return i},this.addEvent=function(e){return!!e&&(i.push(e),r||(r=si(e)),!0)},this.split=function(n,o){var a;if(n<i.length){var s=i.length-n;oe(o)||(s=o<s?o:s),a=i.splice(n,s),r=ui(i)}return new e(t,a)}}return e.create=function(t,n){return new e(t,n)},e}(),li=Math.min(2e6,65e3),di=/\./,fi=function e(t,n,i,r){var o=!!r,a=n,s={};Tt(e,this,(function(e){function n(e,t,r,u,c,l,d){de(e,(function(e,f){var p=null;if(f||Jn(f)){var v=r,h=e,g=c,m=t;if(o&&!u&&di.test(e)){var y=e.split("."),S=y.length;if(S>1){g&&(g=g.slice());for(var b=0;b<S-1;b++){var C=y[b];m=m[C]=m[C]||{},v+="."+C,g&&g.push(C)}h=y[S-1]}}if(p=u&&function(e,t){var n=s[e];return void 0===n&&(e.length>=7&&(n=pe(e,"ext.metadata")||pe(e,"ext.web")),s[e]=n),n}(v)||!a||!a.handleField(v,h)?Zn(h,f,i):a.value(v,h,f,i)){var T=p.value;if(m[h]=T,l&&l(g,h,p),d&&"object"==typeof T&&!ge(T)){var I=g;I&&(I=I.slice()).push(h),n(f,T,v+"."+h,u,I,l,d)}}}}))}e.createPayload=function(e,t,n,i,r,o){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:i,sendType:o,sendReason:r}},e.appendPayload=function(n,i,r){var o=n&&i&&!n.overflow;return o&&Dt(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=i.events(),o=n.payloadBlob,a=n.numEvents,s=!1,u=[],c=[],l=n.isBeacon,d=l?65e3:3984588,f=l?li:2e6,p=0,v=0;p<t.length;){var h=t[p];if(h){if(a>=r){n.overflow=i.split(p);break}var g=e.getEventBlob(h);if(g&&g.length<=f){var m=g.length;if(o.length+m>d){n.overflow=i.split(p);break}o&&(o+="\n"),o+=g,++v>20&&(o.substr(0,1),v=0),s=!0,a++}else g?u.push(h):c.push(h),t.splice(p,1),p--}p++}if(u&&u.length>0&&n.sizeExceed.push(ci.create(i.iKey(),u)),c&&c.length>0&&n.failedEvts.push(ci.create(i.iKey(),c)),s){n.batches.push(i),n.payloadBlob=o,n.numEvents=a;var y=i.iKey();-1===Ie(n.apiKeys,y)&&n.apiKeys.push(y)}}),(function(){return{payload:n,theBatch:{iKey:i.iKey(),evts:i.events()},max:r}})),o},e.getEventBlob=function(e){try{return Dt(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+Qn(e.iKey);var i={},r=e.ext;r&&(t.ext=i,de(r,(function(e,t){n(t,i[e]={},"ext."+e,!0,null,null,!0)})));var o=t.data={};o.baseType=e.baseType;var a=o.baseData={};return n(e.baseData,a,"baseData",!1,["baseData"],(function(e,t,n){pi(i,e,t,n)}),!0),n(e.data,o,"data",!1,[],(function(e,t,n){pi(i,e,t,n)}),!0),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))};function pi(e,t,n,i){if(i&&e){var r=$n(i.value,i.kind,i.propertyType);if(r>-1){var o=e.metadata;o||(o=e.metadata={f:{}});var a=o.f;if(a||(a=o.f={}),t)for(var s=0;s<t.length;s++){var u=t[s];a[u]||(a[u]={f:{}});var c=a[u].f;c||(c=a[u].f={}),a=c}a=a[n]={},ge(i.value)?a.a={t:r}:a.t=r}}}var vi,hi,gi,mi=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!=e&&429!=e||501==e||505==e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)},e}(),yi=function e(){var t={};Tt(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var i=(a=e.split(","),s=[],a&&Te(a,(function(e){s.push(xe(e))})),s);if("this-request-only"===n)return i;for(var r=1e3*parseInt(n,10),o=0;o<i.length;++o)t[i[o]]=Fe()+r}catch(e){return[]}var a,s;return[]},e.isTenantKilled=function(e){var n=t,i=xe(e);return void 0!==n[i]&&n[i]>Fe()||(delete n[i],!1)}}))},Si=function e(){var t=!0,n=!0,i=!0,r="use-collector-delta",o=!1;Tt(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){i&&(i=!1,o||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return r},e.setClockSkew=function(e){o||(e?(r=e,n=!0,o=!0):n=!1,t=!0)}}))},bi=((vi={})[1]="requeue",vi[100]="requeue",vi[200]="sent",vi[8004]="drop",vi[8003]="drop",vi),Ci={},Ti={};function Ii(e){try{return e.responseText}catch(e){}return""}function wi(e,t){var n=!1;if(e&&t){var i=Pe(e);if(i&&i.length>0)for(var r=t.toLowerCase(),o=0;o<i.length;o++){var a=i[o];if(a&&se(t,a)&&a.toLowerCase()===r){n=!0;break}}}return n}function Ai(e,t,n,i){t&&n&&n.length>0&&(i&&Ci[t]?(e.hdrs[Ci[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}gi="AuthMsaDeviceTicket",Ci[hi="AuthMsaDeviceTicket"]=gi,Ti[gi]=hi;var xi=function e(t,n,i,r){this._responseHandlers=[];var o,a,s,u,c,l,d="?cors=true&"+"content-type".toLowerCase()+"=application/x-json-stream",f=new yi,p=!1,v=new Si,h=!1,g=0,m=!0,y=[],S={},b=[],C=null,T=!1,I=!1,w=!1;Tt(e,this,(function(e){var A=!0;function x(e,t){for(var n=0,i=null,r=0;null==i&&r<e.length;)1===(n=e[r])?it()?i=O:rt()&&(i=P):2===n&&nt(t)?i=k:h&&3===n&&tt()&&(i=F),r++;return i?{_transport:n,_isSync:t,sendPOST:i}:null}function O(e,t,n){var i=new XDomainRequest;i.open("POST",e.urlString),e.timeout&&(i.timeout=e.timeout),i.onload=function(){var e=Ii(i);E(t,200,{},e),K(e)},i.onerror=function(){E(t,400,{})},i.ontimeout=function(){E(t,500,{})},i.onprogress=function(){},n?i.send(e.data):o._setTimeoutOverride((function(){i.send(e.data)}),0)}function k(e,t,n){var i,r=e.urlString,a=!1,s=!1,u=((i={body:e.data,method:"POST"}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,i);n&&(u.keepalive=!0,2===e._sendReason&&(a=!0,r+="&NoResponseBody=true")),A&&(u.credentials="include"),e.headers&&Pe(e.headers).length>0&&(u.headers=e.headers),fetch(r,u).then((function(e){var n={},i="";e.headers&&e.headers.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){i=e})),s||(s=!0,E(t,e.status,n,i),K(i))})).catch((function(e){s||(s=!0,E(t,0,{}))})),a&&!s&&(s=!0,E(t,200,{})),!s&&e.timeout>0&&o._setTimeoutOverride((function(){s||(s=!0,E(t,500,{}))}),e.timeout)}function P(e,t,n){var i=e.urlString;function r(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var i=t.getResponseHeader(n);i&&(e[n]=xe(i))}return e}function o(e){var t,n,i={};return e.getAllResponseHeaders?(t=e.getAllResponseHeaders(),n={},ye(t)&&Te(xe(t).split(/[\r\n]+/),(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var i=xe(e.substring(0,t)).toLowerCase(),r=xe(e.substring(t+1));n[i]=r}else n[xe(e)]=1}})),i=n):(i=r(i,e,"time-delta-millis"),i=r(i,e,"kill-duration"),i=r(i,e,"kill-duration-seconds")),i}function a(e,n){E(t,e.status,o(e),n)}n&&e.disableXhrSync&&(n=!1);var s=function(e,t,n,i,r,o){function a(e,t,n){try{e[t]=n}catch(e){}}void 0===i&&(i=!1),void 0===r&&(r=!1);var s=new XMLHttpRequest;return i&&a(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",i),n&&a(s,"withCredentials",n),s.open(e,t,!r),n&&a(s,"withCredentials",n),!r&&o&&a(s,"timeout",o),s}("POST",i,A,!0,n,e.timeout);de(e.headers,(function(e,t){s.setRequestHeader(e,t)})),s.onload=function(){var e=Ii(s);a(s,e),K(e)},s.onerror=function(){a(s)},s.ontimeout=function(){a(s)},s.send(e.data)}function E(e,t,n,i){try{e(t,n,i)}catch(e){o.diagLog().throwInternal(U.WARNING,wn.SendPostOnCompleteFailure,et(e))}}function F(e,t,n){var i=200,r=e._thePayload,a=e.urlString+"&NoResponseBody=true";try{var s=Je();if(!s.sendBeacon(a,e.data))if(r){var u=[];Te(r.batches,(function(e){if(u&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!s.sendBeacon(a,C.getEventBlob(t[n]))){u.push(e.split(n));break}}else u.push(e.split(0))})),V(u,8003,r.sendType,!0)}else i=0}catch(e){o.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+e),i=0}finally{E(t,i,{},"")}}function M(e){return 2===e||3===e}function R(e){return I&&M(e)&&(e=2),e}function D(){return!p&&g<n}function L(){var e=b;return b=[],e}function N(e,t,n){var i=!1;return e&&e.length>0&&!p&&a[t]&&C&&(i=0!==t||D()&&(n>0||v.allowRequestSending())),i}function _(e){var t={};return e&&Te(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function j(e,n,i,r,u){if(e&&0!==e.length)if(p)V(e,1,r);else{r=R(r);try{var c=e,l=0!==r;Dt(s,(function(){return"HttpManager:_sendBatches"}),(function(o){o&&(e=e.slice(0));for(var s=[],c=null,d=ti(),p=a[r]||(l?a[1]:a[0]),v=(I||M(r)||p&&3===p._transport)&&!m&&h&&tt();N(e,r,n);){var g=e.shift();g&&g.count()>0&&(f.isTenantKilled(g.iKey())?s.push(g):(c=c||C.createPayload(n,i,l,v,u,r),C.appendPayload(c,g,t)?null!==c.overflow&&(e=[c.overflow].concat(e),c.overflow=null,B(c,d,ti(),u),d=ti(),c=null):(B(c,d,ti(),u),d=ti(),e=[g].concat(e),c=null)))}c&&B(c,d,ti(),u),e.length>0&&(b=e.concat(b)),V(s,8004,r)}),(function(){return{batches:_(c),retryCount:n,isTeardown:i,isSynchronous:l,sendReason:u,useSendBeacon:M(r),sendType:r}}),!l)}catch(e){o.diagLog().throwInternal(U.WARNING,wn.CannotSerializeObject,"Unexpected Exception sending batch: "+et(e))}}}function H(e,t){var n={url:d,hdrs:{},useHdrs:!1};n.hdrs=ei(n.hdrs,S),n.useHdrs=Pe(n.hdrs).length>0,Ai(n,"client-id","NO_AUTH",t),Ai(n,"client-version","1DS-Web-JS-3.1.11",t);var i="";Te(e.apiKeys,(function(e){i.length>0&&(i+=","),i+=e})),Ai(n,"apikey",i,t),Ai(n,"upload-time",Fe().toString(),t);var r=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return""}(e);if(Jn(r)&&(n.url+="&ext.intweb.msfpc="+r),v.shouldAddClockSkewHeaders()&&Ai(n,"time-delta-to-apply-millis",v.getClockSkewHeaderValue(),t),s.getWParam){var o=s.getWParam();o>=0&&(n.url+="&w="+o)}for(var a=0;a<y.length;a++)n.url+="&"+y[a].name+"="+y[a].value;return n}function z(e,t,n){e[t]=e[t]||{},e[t][o.identifier]=n}function B(t,n,r,u){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var d=!!e.sendHook,p=a[t.sendType];!M(t.sendType)&&t.isBeacon&&2===t.sendReason&&(p=a[2]||a[3]||p);var h=w;(t.isBeacon||3===p._transport)&&(h=!1);var y=H(t,h);h=h||y.useHdrs;var S=ti();Dt(s,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var a=0;a<t.batches.length;a++)for(var b=t.batches[a].events(),C=0;C<b.length;C++){var w=b[C];if(T){var A=w.timings=w.timings||{};z(A,"sendEventStart",S),z(A,"serializationStart",n),z(A,"serializationCompleted",r)}w.sendAttempt>0?w.sendAttempt++:w.sendAttempt=1}V(t.batches,1e3+(u||0),t.sendType,!0);var x={data:t.payloadBlob,urlString:y.url,headers:y.hdrs,_thePayload:t,_sendReason:u,timeout:c};re(l)||(x.disableXhrSync=!!l),h&&(wi(x.headers,"cache-control")||(x.headers["cache-control"]="no-cache, no-store"),wi(x.headers,"content-type")||(x.headers["content-type"]="application/x-json-stream"));var O=null;p&&(O=function(n){v.firstRequestSent();var r=function(n,r){!function(t,n,r,a){var s=9e3,u=null,c=!1,l=!1;try{var d=!0;if(typeof t!==q.l){if(n){v.setClockSkew(n["time-delta-millis"]);var p=n["kill-duration"]||n["kill-duration-seconds"];Te(f.setKillSwitchTenants(n["kill-tokens"],p),(function(e){Te(r.batches,(function(t){if(t.iKey()===e){u=u||[];var n=t.split(0);r.numEvents-=n.count(),u.push(n)}}))}))}if(200==t||204==t)return void(s=200);(!mi.shouldRetryForStatus(t)||r.numEvents<=0)&&(d=!1),s=9e3+t%1e3}if(d){s=100;var h=r.retryCnt;0===r.sendType&&(h<i?(c=!0,W((function(){0===r.sendType&&g--,j(r.batches,h+1,r.isTeardown,I?2:r.sendType,5)}),I,mi.getMillisToBackoffForRetry(h))):(l=!0,I&&(s=8001)))}}finally{c||(v.setClockSkew(),function(t,n,i,r){try{r&&o._backOffTransmission(),200===n&&(r||t.isSync||o._clearBackOff(),function(e){if(T){var t=ti();Te(e,(function(e){var n,i;e&&e.count()>0&&(n=e.events(),i=t,T&&Te(n,(function(e){z(e.timings=e.timings||{},"sendEventCompleted",i)})))}))}}(t.batches)),V(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(g--,5!==i&&e.sendQueuedRequests(t.sendType,i))}}(r,s,a,l)),V(u,8004,r.sendType)}}(n,r,t,u)},a=t.isTeardown||t.isSync;try{p.sendPOST(n,r,a),e.sendListener&&e.sendListener(x,n,a,t.isBeacon)}catch(e){o.diagLog().warnToConsole("Unexpected exception sending payload. Ex:"+et(e)),E(r,0,{})}}),Dt(s,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(O)if(0===t.sendType&&g++,d&&!t.isBeacon&&3!==p._transport){var n={data:x.data,urlString:x.urlString,headers:ei({},x.headers),timeout:x.timeout,disableXhrSync:x.disableXhrSync},i=!1;Dt(s,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){i=!0,m||e._thePayload||(e._thePayload=e._thePayload||x._thePayload,e._sendReason=e._sendReason||x._sendReason),O(e)}),t.isSync||t.isTeardown)}catch(e){i||O(x)}}))}else O(x)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:r,sendReason:u}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&V(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&V(t.failedEvts,8002,t.sendType)}function W(e,t,n){t?e():o._setTimeoutOverride(e,n)}function K(t){var n=e._responseHandlers;try{for(var i=0;i<n.length;i++)try{n[i](t)}catch(e){o.diagLog().throwInternal(U.CRITICAL,wn.PostResponseHandler,"Response handler failed: "+e)}if(t){var r=JSON.parse(t);Jn(r.webResult)&&Jn(r.webResult.msfpc)&&u.set("MSFPC",r.webResult.msfpc,31536e3)}}catch(e){}}function V(e,t,n,i){if(e&&e.length>0&&r){var a=r[(c=t,l=bi[c],Jn(l)||(l="oth",c>=9e3&&c<=9999?l="rspFail":c>=8e3&&c<=8999?l="drop":c>=1e3&&c<=1999&&(l="send")),l)];if(a){var u=0!==n;Dt(s,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){W((function(){try{a.call(r,e,t,u,n)}catch(e){o.diagLog().throwInternal(U.CRITICAL,wn.NotificationException,"send request notification failed: "+e)}}),i||u,0)}),(function(){return{batches:_(e),reason:t,isSync:u,sendSync:i,sendType:n}}),!u)}}var c,l}e.initialize=function(e,t,n,i,r){var f;r||(r={}),d=e+d,w=!re(r.avoidOptions)&&!r.avoidOptions,s=t,u=t.getCookieMgr(),T=!s.config.disableEventTimings;var p=!!s.config.enableCompoundKey;o=n;var v=r.valueSanitizer,g=r.stringifyObjects;re(r.enableCompoundKey)||(p=!!r.enableCompoundKey),c=r.xhrTimeout,l=r.disableXhrSync,h=!$e(),C=new fi(s,v,g,p);var y=i,S=r.alwaysUseXhrOverride?i:null,b=r.alwaysUseXhrOverride?i:null;if(!i){m=!1;var I=Qe();I&&I.protocol&&"file:"===I.protocol.toLowerCase()&&(A=!1);var O=[];O=$e()?[2,1]:[1,2,3];var k=r.transports;k&&(Se(k)?O=[k].concat(O):ge(k)&&(O=k.concat(O))),i=x(O,!1),y=x(O,!0),i||o.diagLog().warnToConsole("No available transport to send events")}(f={})[0]=i,f[1]=y||x([1,2,3],!0),f[2]=S||x([3,2],!0)||y||x([1],!0),f[3]=b||x([2,3],!0)||y||x([1],!0),a=f},e._getDbgPlgTargets=function(){return[a[0],f,C,a]},e.addQueryStringParameter=function(e,t){for(var n=0;n<y.length;n++)if(y[n].name===e)return void(y[n].value=t);y.push({name:e,value:t})},e.addHeader=function(e,t){S[e]=t},e.canSendRequest=function(){return D()&&v.allowRequestSending()},e.sendQueuedRequests=function(e,t){re(e)&&(e=0),I&&(e=R(e),t=2),N(b,e,0)&&j(L(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!p&&0===g&&0===b.length},e.setUnloading=function(e){I=e},e.addBatch=function(e){if(e&&e.count()>0){if(f.isTenantKilled(e.iKey()))return!1;b.push(e)}return!0},e.teardown=function(){b.length>0&&j(L(),0,!0,2,2)},e.pause=function(){p=!0},e.resume=function(){p=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(oe(t)&&(t=1),I&&(t=R(t),n=2),j([e],0,!1,t,n||0))}}))},Oi=Gn?window:void 0,ki=function(e){function t(){var n,i=e.call(this)||this;i.identifier="PostChannel",i.priority=1011,i.version="3.1.11";var r,o,a,s,u,c=!1,l=[],d=null,f=!1,p=0,v=500,h=0,g=1e4,m={},y="REAL_TIME",S=null,b=null,C=0,T=0,I={},w=-1,A=!0,x=!1,O=6,k=2;return Tt(t,i,(function(e,t){function i(e){"beforeunload"!==(e||qe().event).type&&(x=!0,o.setUnloading(x)),N(2,2)}function P(e){x=!1,o.setUnloading(x)}function E(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=gn),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,A&&(e.ext=Ne(e.ext),e.baseData&&(e.baseData=Ne(e.baseData)),e.data&&(e.data=Ne(e.data))),e.sync)if(C||f)e.latency=yn,e.sync=!1;else if(o)return A&&(e=Ne(e)),void o.sendSynchronousBatch(ci.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,i=h,r=g;n===Sn&&(i=p,r=v);var a=!1;if(i<r)a=!H(e,t);else{var s=gn,u=20;n===Sn&&(s=Sn,u=1),a=!0,function(e,t,n,i){for(;n<=t;){var r=_(e,t,!0);if(r&&r.count()>0){var o=r.split(0,i),a=o.count();if(a>0)return n===Sn?p-=a:h-=a,V("eventsDiscarded",[o],ln),!0}n++}return z(),!1}(e.iKey,e.latency,s,u)&&(a=!H(e,t))}a&&q("eventsDiscarded",[e],ln)}function F(e,t,n){var i=B(e,t,n);return o.sendQueuedRequests(t,n),i}function M(){return h>0}function R(){if(w>=0&&B(w,0,u)&&o.sendQueuedRequests(0,u),p>0&&!b&&!f){var e=m[y][2];e>=0&&(b=D((function(){b=null,F(Sn,0,1),R()}),e))}var t=m[y][1];!S&&!d&&t>=0&&!f&&(M()?S=D((function(){S=null,F(0===T?yn:gn,0,1),T++,T%=2,R()}),t):T=0)}function D(t,n){0===n&&C&&(n=1);var i=1e3;return C&&(i=mi.getMillisToBackoffForRetry(C-1)),e._setTimeoutOverride(t,n*i)}function L(){null!==S&&(e._clearTimeoutOverride(S),S=null,T=0)}function N(t,n){L(),d&&(e._clearTimeoutOverride(d),d=null),f||F(gn,t,n)}function _(e,t,n){var i=I[t];i||(i=I[t=gn]);var r=i.iKeyMap[e];return!r&&n&&(r=ci.create(e),i.batches.push(r),i.iKeyMap[e]=r),r}function j(t,n){o.canSendRequest()&&!C&&(a>0&&h>a&&(n=!0),n&&null==d&&e.flush(t,null,20))}function H(e,t){A&&(e=Ne(e));var n=e.latency,i=_(e.iKey,n,!0);return!!i.addEvent(e)&&(n!==Sn?(h++,t&&0===e.sendAttempt&&j(!e.sync,s>0&&i.count()>=s)):p++,!0)}function z(){for(var e=0,t=0,n=function(n){var i=I[n];i&&i.batches&&Te(i.batches,(function(i){n===Sn?e+=i.count():t+=i.count()}))},i=gn;i<=Sn;i++)n(i);h=t,p=e}function B(t,n,i){var r=!1,a=0===n;return!a||o.canSendRequest()?Dt(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=Sn;n>=t;){var i=I[n];i&&i.batches&&i.batches.length>0&&(Te(i.batches,(function(t){o.addBatch(t)?r=r||t&&t.count()>0:e=e.concat(t.events()),n===Sn?p-=t.count():h-=t.count()})),i.batches=[],i.iKeyMap={}),n--}e.length>0&&q("eventsDiscarded",e,cn),r&&w>=t&&(w=-1,u=0)}),(function(){return{latency:t,sendType:n,sendReason:i}}),!a):(w=w>=0?Math.min(w,t):t,u=Math.max(u,i)),r}function W(){(m={}).REAL_TIME=[2,1,0],m.NEAR_REAL_TIME=[6,3,0],m.BEST_EFFORT=[18,9,0]}function K(t,n){var i=e._notificationManager||{},r=i[t];if(r)try{r.apply(i,n)}catch(n){e.diagLog().throwInternal(U.CRITICAL,wn.NotificationException,t+" notification failed: "+n)}}function q(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&t.length>0&&K(e,[t].concat(n))}function V(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&t.length>0&&Te(t,(function(t){t&&t.count()>0&&K(e,[t.events()].concat(n))}))}function G(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,g/6)}W(),I[Sn]={batches:[],iKeyMap:{}},I[yn]={batches:[],iKeyMap:{}},I[mn]={batches:[],iKeyMap:{}},I[gn]={batches:[],iKeyMap:{}},G(),o=new xi(500,2,1,{requeue:function(t,n){var i=[],r=O;x&&(r=k);Te(t,(function(t){t&&t.count()>0&&Te(t.events(),(function(t){t&&(t.sync&&(t.latency=Sn,t.sync=!1),t.sendAttempt<r?(ri(t,e.identifier),E(t,!1)):i.push(t))}))})),i.length>0&&q("eventsDiscarded",i,sn);x&&N(2,2)},send:function(e,t,n){e&&e.length>0&&K("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])},sent:function(e,t){V("eventsSent",e,t),R()},drop:function(e,t){V("eventsDiscarded",e,t>=8e3&&t<=8999?t-8e3:an)},rspFail:function(e){V("eventsDiscarded",e,sn),R()},oth:function(e,t){V("eventsDiscarded",e,an),R()}}),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(s,u,c){Dt(u,(function(){return"PostChannel:initialize"}),(function(){var l=u;t.initialize(s,u,c),e.setInitialized(!1);var d=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},n=d.getExtCfg(e.identifier),e._setTimeoutOverride=n.setTimeoutOverride?n.setTimeoutOverride:setTimeout.bind(Oi),e._clearTimeoutOverride=n.clearTimeoutOverride?n.clearTimeoutOverride:clearTimeout.bind(Oi),A=!n.disableOptimizeObj&&!!We("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(l),n.eventsLimitInMem>0&&(g=n.eventsLimitInMem),n.immediateEventLimit>0&&(v=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(a=n.autoFlushEventsLimit),n.disableXhrSync,Se(n.maxEventRetryAttempts)&&(O=n.maxEventRetryAttempts),Se(n.maxUnloadEventRetryAttempts)&&(k=n.maxUnloadEventRetryAttempts),G(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(r=n.httpXHROverride),Jn(s.anonCookieName)&&o.addQueryStringParameter("anoncknm",s.anonCookieName),o.sendHook=n.payloadPreprocessor,o.sendListener=n.payloadListener;var f=n.overrideEndpointUrl?n.overrideEndpointUrl:s.endpointUrl;e._notificationManager=s.extensionConfig.NotificationManager,o.initialize(f,e.core,e,r,n);var p=s.disablePageUnloadEvents||[];_n(i,p),function e(t,n){var i=!1;return n&&-1!==Ie(n,"pagehide")||(i=Nn("pagehide",t)),n&&-1!==Ie(n,"visibilitychange")||(i=Nn("visibilitychange",(function(e){var n=Ve();t&&n&&"hidden"===n.visibilityState&&t(e)}))||i),!i&&n&&(i=e(t)),i}(i,p),function e(t,n){var i=!1;return n&&-1!==Ie(n,"pageshow")||(i=Nn("pageshow",t)),n&&-1!==Ie(n,"visibilitychange")||(i=Nn("visibilitychange",(function(e){var n=Ve();t&&n&&"visible"===n.visibilityState&&t(e)}))||i),!i&&n&&(i=e(t)),i}(P,s.disablePageShowEvents),e.setInitialized(!0)}),(function(){return{coreConfig:s,core:u,extensions:c}}))},e.processTelemetry=function(t,i){ri(t,e.identifier);var r=(i=e._getTelCtx(i)).getExtCfg(e.identifier),o=!!n.disableTelemetry;r&&(o=o||!!r.disableTelemetry);var a=t;o||c||(n.overrideInstrumentationKey&&(a.iKey=n.overrideInstrumentationKey),r&&r.overrideInstrumentationKey&&(a.iKey=r.overrideInstrumentationKey),E(a,!0),x?N(2,2):R()),e.processNext(a,i)},e.setEventQueueLimits=function(e,t){g=e>0?e:1e4,a=t>0?t:0,G();var n=h>e;if(!n&&s>0)for(var i=gn;!n&&i<=yn;i++){var r=I[i];r&&r.batches&&Te(r.batches,(function(e){e&&e.count()>=s&&(n=!0)}))}j(!0,n)},e.teardown=function(){N(2,2),c=!0,o.teardown()},e.pause=function(){L(),f=!0,o.pause()},e.resume=function(){f=!1,o.resume(),R()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){L(),W(),y="REAL_TIME",R(),de(e,(function(e,t){var n=t.length;if(n>=2){var i=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var r=t[0]/t[1];t[0]=Math.ceil(r)*t[1]}i>=0&&t[1]>=0&&i>t[1]&&(i=t[1]),t.push(i),m[e]=t}}))},e.flush=function(e,t,n){void 0===e&&(e=!0),f||(L(),n=n||1,e?(B(gn,0,n),z(),null==d?d=D((function(){!function e(t,n){F(gn,0,n),function e(t){o.isCompletelyIdle()?t():d=D((function(){e(t)}),.25)}((function(){t&&t(),l.length>0?d=D((function(){return e(l.shift(),n)}),0):(d=null,M()&&R())}))}(t,n)}),0):l.push(t)):(F(gn,1,n),null!=t&&t()))},e.setMsaAuthTicket=function(e){o.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=M,e._setTransmitProfile=function(e){y!==e&&void 0!==m[e]&&(L(),y=e,R())},e._backOffTransmission=function(){C<4&&(C++,L(),R())},e._clearBackOff=function(){C&&(C=0,L(),R())}})),i}return Object(W.b)(t,e),t}(jt),Pi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.d)(t,e),t.prototype.initialize=function(t,n){this._postChannel=new ki;var r=[];n&&(r=r.concat(n)),t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=Object(i.a)(Object(i.a)({},t.channelConfiguration),t.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,t,r)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,i={};i.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(i),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(ai);function Ei(e,t,n){t&&t.forEach((function(t){if(!t.classification||4===t.classification||1===t.classification||n.customerContentEnabled&&32===t.classification){var i,r;switch(i=n.prependDataToken?"zC."===t.name.substr(0,3)?"zC.Data."+t.name.substr(3):"Data."+t.name:t.name,t.dataType){case 3:r=6;break;case 2:r=4;break;case 4:r=8;break;case 0:return void(e[i]="string"==typeof t.value?t.value.substr(0,25e3):t.value);case 1:default:return void(e[i]=t.value)}var o={value:t.value,propertyType:r};e[i]=o}}))}function Fi(e,t){try{return e()}catch(e){return s(1,"1DS Sink",e),t}}var Mi,Ri=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="PartAPlugin",t.priority=450,t._properties={},t}return Object(i.d)(t,e),t.prototype.initialize=function(t,n,i){e.prototype.initialize.call(this,t,n,i)},t.prototype.processTelemetry=function(e,t){Object.assign?Object.assign(e.data,this._properties):e.data=ei(e.data,this._properties);var n=this._getTelCtx(t);this.processNext(e,n)},t.prototype.addDataFields=function(e){Ei(this._properties,e,{prependDataToken:!1,customerContentEnabled:!1})},t}(jt),Di=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),Li=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return"HttpManager:_sendBatches"===e||"HttpManager:_sendBatchesNotification"===e?new Di(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case"HttpManager:_sendBatches":this.handleSendBatches(e);break;case"HttpManager:_sendBatchesNotification":this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var t=e.payload();if(t.batches&&t.reason&&t.reason>=1e3&&t.reason<=1999){var n=0;for(var i in t.batches)n+=t.batches[i].evts.length;this._callbacks.requestProcessingStats(0,n)}}},e}();!function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="https://office-c.events.data.microsoft.com/OneCollector/1.0/",e.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/"}(Mi||(Mi={}));var Ni=function(e){function t(t,n){var r,o,s=e.call(this,t,n)||this;s.usePartAPlugin=!0;var u=new Ri,c=function(e){e&&e.addNotificationListener({eventsSent:function(e){a(2,2,(function(){return"Successfully sent "+e.length+" event(s)"})),a(3,2,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),s.eventsSent+=e.length},eventsDiscarded:function(e,t){a(0,2,(function(){return"Discarded "+e.length+" event(s) because "+t})),a(3,2,(function(){return"Discarded event(s) details : "+JSON.stringify(e,null,2)})),s.eventsDiscarded+=e.length}})};function l(e,t,n,r){var o={instrumentationKey:t,endpointUrl:n,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:e.httpXHROverride,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},disableCookiesUsage:!0,extensionConfig:Object(i.a)({},e.extensionConfig)};e.stats&&e.stats.networkStats&&o.channelConfiguration&&(o.channelConfiguration.payloadListener=function(t,n){var i,r=n||t;r.data&&(null===(i=e.stats)||void 0===i||i.networkStats(r.data.length))});var a=new Pi;return a.initialize(o,r),a.setUploadFrequency(e.uploadFrequency),e.notificationListener&&a.addNotificationListener(e.notificationListener),e.stats&&a.setPerfMgr(new Li(e.stats)),a}s.sendTelemetryEvent=function(e){return Fi((function(){var t=s.getOneDSTelemetryEvent(e);t&&r&&r.track(t)}),void 0)},s.sendCustomerContent=function(e){return Fi((function(){var t=s.getOneDSCustomerContent(e);t&&o&&o.track(t)}),void 0)},s.addPersistentDataFields=function(e){u.addDataFields(e)},s.flush=function(e){r&&r.flush(e)},s.shutdown=function(){try{r&&r.shutdown()}catch(e){a(0,2,(function(){return"An error occurred on shutdown"}))}};var d=[u];if(n.plugins&&d.push.apply(d,n.plugins),!n.endpointUrl)throw new Error("Missing Endpoint Url");return r=l(n,"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",n.endpointUrl,d),n.enableCustomerContent&&n.endpointUrl===Mi.PUBLIC&&(o=l(n,"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121",Mi.CUSTOMER_CONTENT,d)),n.disableStatsTracking||(c(r),c(o)),s.addPersistentDataFields(t),s}return Object(i.d)(t,e),t}((function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this.usePartAPlugin=!1;var r=[],o=!1,s={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return o||10===t||110===t||120===t}},u={},c=Yn(),l=(new Date).getTime().toString(),d=function(e,t){if(1===t.eventType)return"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121";if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");return e.telemetryProperties.ariaTenantToken},f=function(e,t){var o,s=p(e);if(function(e){for(var t=function(t){var n=r[t];if(!n.processEvent(e))return a(2,1,(function(){return e.eventName+" suppressed by "+n.name})),{value:!1}},n=0;n<r.length;n++){var i=t(n);if("object"==typeof i)return i.value}return!0}(s)){n.eventsProcessed++;var f=((o=s.timestamp)?new Date(o):new Date).toISOString(),v={"Event.Sequence":{value:n.eventsProcessed,propertyType:4},"Event.Name":s.eventName,"Event.Source":"OTelJS","Event.Time":{value:f,propertyType:9}};Ei(v,s.dataFields,{prependDataToken:!0,customerContentEnabled:1===t.eventType}),v["Event.Id"]=c+"."+n.eventsProcessed;var h="custom";s.eventContract&&(s.eventContract.name&&(v["Event.Contract"]=s.eventContract.name,h+="."+s.eventContract.name.toLowerCase().replace(/\./g,"_")),Ei(v,s.eventContract.dataFields,{prependDataToken:!1,customerContentEnabled:1===t.eventType}));var g={iKey:d(s,t),name:s.eventName,data:v,time:f,baseType:h,ext:{sdk:{seq:n.eventsProcessed,epoch:l}}};return n.usePartAPlugin||(g.data=Object(i.a)(Object(i.a)({},g.data),u)),g}};this.getOneDSTelemetryEvent=function(e){return f(e,{eventType:0})},this.getOneDSCustomerContent=function(e){if(t.enableCustomerContent&&e.telemetryProperties.customerContentVersion&&Math.floor(e.telemetryProperties.customerContentVersion)<=1&&1===e.telemetryProperties.customerContentType)return f(e,{eventType:1})},this.addPreprocessor=function(e){r.push(e)},this.addPersistentDataFields=function(e){Ei(u,e,{prependDataToken:!1,customerContentEnabled:!1})},this.setOptionalEventsEnabled=function(e){o=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(o=!0),this.addPersistentDataFields(e),this.addPreprocessor(s)})),_i=n(2),ji=n(8),Ui=n(198),Hi=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(Hi=function(){return 1e3*Math.floor(window.performance.now())});var zi=function(){function e(e,t,n,r){this.hubInfo=e,this.customTelemetryService=n,this.telemetrySink=r,this.letterRegex=/[a-zA-Z]/,this.consumerTid="9188040d-6c67-4c5b-b112-36a304b66dad",this.telemetrySource="AppHostSdk",this.namespace="Office.AppHostingSdk",this.eventFieldPrefix="AppHost",this.ariaTenantToken="7ada8d16f9234e2093f080920f21dd7d-41cee27e-93c2-4a6b-a7aa-2001e852d387-7123",this.nexusTenantToken=-1,this.anonymousDataFields=Object(i.g)([],I.Office.System.User.getFields("User",{isAnonymous:!0}),!0);var o=[f("".concat(this.eventFieldPrefix,".HostName"),this.hubInfo.name),f("".concat(this.eventFieldPrefix,".HostVersion"),this.hubInfo.version),f("".concat(this.eventFieldPrefix,".HostSdkVersion"),_i.b),f("".concat(this.eventFieldPrefix,".HostSessionId"),this.hubInfo.sessionId),f("".concat(this.eventFieldPrefix,".TelemetrySource"),this.telemetrySource),f("".concat(this.eventFieldPrefix,".Platform"),t.app.host.clientType===ji.b.web?"Web":"Desktop")];this.oneDsSink=new Ni(o,{endpointUrl:Mi.PUBLIC}),this.telemetryLogger=new B,this.telemetryLogger.setTenantToken(this.namespace,this.ariaTenantToken,this.nexusTenantToken),this.telemetryLogger.telemetrySinks=void 0!==this.telemetrySink?[this.telemetrySink]:[this.oneDsSink],this.setAppContext(t),this.isTest=Object(Ui.a)()}return e.prototype.createScenario=function(e,t,n){var i,r;void 0===n&&(n=Date.now()),t=null!=t?t:null===(i=this.appDefinition)||void 0===i?void 0:i.appId;var o=this.isTest?void 0:this.telemetryLogger.createActivity(this.createTelemetryEvent(e,n,t)),a=null===(r=this.customTelemetryService)||void 0===r?void 0:r.createScenario(e,t,n),s=this.shouldLogToAria(e);return new Bi(this,s,n,a,o)},e.prototype.setAppSdkVersion=function(e){this.appSdkVersion=e},e.prototype.setAppContext=function(e){var t,n,r,o,a,s,u,c,l,d,p,v=this.appContext;if(this.appContext=e,void 0===this.telemetryLogger.persistentDataFields&&(this.telemetryLogger.persistentDataFields=[]),(null===(n=e.user)||void 0===n?void 0:n.id)!==(null===(r=null==v?void 0:v.user)||void 0===r?void 0:r.id)){var h=!(null===(o=this.appContext.user)||void 0===o?void 0:o.id),g=void 0;if(h)g=this.anonymousDataFields;else{var m=(null===(s=null===(a=this.appContext.user)||void 0===a?void 0:a.tenant)||void 0===s?void 0:s.id)!==this.consumerTid;g=Object(i.g)([],I.Office.System.User.getFields("User",{primaryIdentityHash:null===(u=this.appContext.user)||void 0===u?void 0:u.id,primaryIdentitySpace:m?"UserObjectId":"MSAPuid",tenantId:null===(l=null===(c=this.appContext.user)||void 0===c?void 0:c.tenant)||void 0===l?void 0:l.id,tenantGroup:m?"Commercial":"Consumer",isAnonymous:h}),!0)}(t=this.telemetryLogger.persistentDataFields).push.apply(t,g)}if(this.appContext.app.sessionId!==(null==v?void 0:v.app.sessionId)){var y=f("Session.Id",null!==(d=this.appContext.app.sessionId)&&void 0!==d?d:"");this.telemetryLogger.persistentDataFields.push(y)}if(this.appContext.app.locale!==(null==v?void 0:v.app.locale)){var S=f("Culture.UiLanguage",null!==(p=this.appContext.app.locale)&&void 0!==p?p:"");this.telemetryLogger.persistentDataFields.push(S)}},e.prototype.setAppDefinition=function(e){this.appDefinition=e},e.prototype.isSessionIdSet=function(){var e;return!!(null===(e=this.appContext)||void 0===e?void 0:e.app.sessionId)},e.prototype.createTelemetryEvent=function(e,t,n){var i,r,o,a,s,u,c;return{eventName:"".concat(this.namespace,".").concat(this.sanitizeScenarioName(e)),eventFlags:{dataCategories:2,diagnosticLevel:110},dataFields:[f("HostedAppId",null!=n?n:""),f("HostedAppEntityId",null!==(r=null===(i=this.appContext)||void 0===i?void 0:i.page.id)&&void 0!==r?r:""),f("HostedAppSdkVersion",null!==(o=this.appSdkVersion)&&void 0!==o?o:""),f("HostedAppFrameContext",null!==(s=null===(a=this.appContext)||void 0===a?void 0:a.page.frameContext)&&void 0!==s?s:""),f("HostedAppSessionId",null!==(c=null===(u=this.appContext)||void 0===u?void 0:u.app.sessionId)&&void 0!==c?c:"")],timestamp:t}},e.prototype.sanitizeScenarioName=function(e){for(var t="",n=!0,i=0;i<e.length;i++){var r=e.charAt(i);"."===r&&0!==i&&"."!==t.charAt(t.length-1)?(t+=r,n=!0):this.letterRegex.test(r)?n?(n=!1,t+=r.toUpperCase()):t+=r:n=!0}return t},e.prototype.shouldLogToAria=function(e){return!e.startsWith("eventDispatch")},e}(),Bi=function(){function e(e,t,n,i,r){this.logger=e,this.shouldLogToAria=t,this.clientTimestamp=n,this.customScenario=i,this.activity=r,this.lastMark=function(e){var t=Date.now();return Hi()-1e3*(t-e)}(n)}return e.prototype.markPhase=function(e){var t,n,i,r=Hi(),o=r-this.lastMark;this.lastMark=r,null===(n=null===(t=this.activity)||void 0===t?void 0:t.dataFields)||void 0===n||n.push(d("Activity.Phase.".concat(e),o)),null===(i=this.customScenario)||void 0===i||i.markPhase(e)},e.prototype.stop=function(){var e;this.endActivity(!0),null===(e=this.customScenario)||void 0===e||e.stop()},e.prototype.fail=function(e){var t,n,i;null===(n=null===(t=this.activity)||void 0===t?void 0:t.dataFields)||void 0===n||n.push(f("ErrorMessage",null!=e?e:"")),this.endActivity(!1),null===(i=this.customScenario)||void 0===i||i.fail(e)},e.prototype.endActivity=function(e){this.shouldLogToAria&&this.activity&&this.logger.isSessionIdSet()&&(this.activity.success=e,this.activity.endNow())},e}(),Wi=function(){function e(e,t,n,r,o,a){var s=this;this.hostWindow=e,this.context=t,this.authenticationService=n,this.customTelemetryService=r,this.onAppInitStateChanged=o,this.telemetrySink=a,this.initialized=!1,this.initializeAuthenticationContext=function(e){var t;s.context=e,s.contextPromise=null===(t=s.authenticationService)||void 0===t?void 0:t.getUser().then((function(e){var t,n,r,o,a,u,c,l,d,f=Object(i.a)(Object(i.a)({},null===(t=s.context)||void 0===t?void 0:t.user),{id:(null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.oid)||"",displayName:(null===(r=null==e?void 0:e.profile)||void 0===r?void 0:r.displayName)||"",loginHint:(null===(o=null==e?void 0:e.profile)||void 0===o?void 0:o.upn)||"",userPrincipalName:(null===(a=null==e?void 0:e.profile)||void 0===a?void 0:a.upn)||"",tenant:{id:(null===(u=null==e?void 0:e.profile)||void 0===u?void 0:u.tid)||"",sku:null===(d=null===(l=null===(c=s.context)||void 0===c?void 0:c.user)||void 0===l?void 0:l.tenant)||void 0===d?void 0:d.sku}}),p=Object(i.a)(Object(i.a)({},s.context.app),{userClickTime:s.getUserClickTime()}),v=Object(i.a)(Object(i.a)({},s.context),{app:p,user:f});return s.telemetryService.setAppContext(v),v}))},this.getContext=function(){return s.context},this.getAppContext=function(){return s.contextPromise?s.contextPromise.then((function(e){return e})).catch((function(){return s.context})):Promise.resolve(s.context)},this.getAppDefinition=function(){return s.appDefinition},this.setAppInitInfo=function(e){s.onAppInitStateChanged&&s.onAppInitStateChanged(e)},this.telemetryService=new zi(this.getHubInfo(),t,this.customTelemetryService,this.telemetrySink)}return e.prototype.isInitialized=function(){return this.initialized},e.prototype.setInitialized=function(e){this.initialized=e},e.prototype.getHubInfo=function(){return{name:this.context.app.host.name,version:this.context.app.host.version,clientType:this.context.app.host.clientType,sessionId:this.context.app.host.sessionId}},e.prototype.unloadApp=function(e){this.telemetryService.createScenario("appTermination",e.appId).stop()},e.prototype.getHostWindow=function(){return this.hostWindow},e.prototype.getFrameContext=function(){return this.context.page.frameContext},e.prototype.getUserClickTime=function(){return this.userClickTime},e.prototype.setUserClickTime=function(e){this.userClickTime=e},e}()},28:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(1),r=function(e){if(null==e||null===typeof e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e)return e;if(Array.isArray(e))return e.map((function(e){return r(e)}));if(e instanceof Date)return new Date(e.getTime());if("object"==typeof e){for(var t={},n=0,i=Object.getOwnPropertyNames(e);n<i.length;n++){var o=i[n],a=e[o];t[o]=r(a)}return t}throw Error("Provided type '"+typeof e+"' ("+Object.prototype.toString.call(e)+") can't be cloned using deepCopy.")},o=function(){function e(e){this.appSdkHost=e,this.messageHandlers=[]}return e.prototype.process=function(e){var t;return Object(i.b)(this,void 0,void 0,(function(){var n,o,a,s;return Object(i.e)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),n=e.data,o=n.args,(o=n.args&&Array.isArray(n.args)?n.args.map((function(e){return r(e)})):[]).unshift(e),[4,this.callMessageHandler(n.func,o,n.timestamp)];case 1:return"appResponse"===(a=i.sent()).kind?(this.processHandlerResultHelper(n,a),[2,Promise.resolve(!0)]):[3,3];case 2:return s=i.sent(),console.warn("Error in processing request : ".concat(null===(t=e.data)||void 0===t?void 0:t.func," with error ").concat(s)),[3,3];case 3:return[2,Promise.resolve(!1)]}}))}))},e.prototype.callMessageHandler=function(e,t,n){for(var i=0,r=this.messageHandlers;i<r.length;i++){var o=r[i];if(o.canHandleMessage(e))return o.handleMessage(e,t,n)}return Promise.reject("Unhandled message")},e.prototype.processHandlerResultHelper=function(e,t){var n=e.id,i=[];t.data&&(i=Array.isArray(t.data)?t.data:[t.data]),this.appSdkHost.postResponseToApp(n,i)},e.prototype.cleanup=function(){this.messageHandlers.forEach((function(e){return e.cleanup()}))},e}()},3:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"b",(function(){return f}));var i=n(1),r={errorCode:n(7).b.INTERNAL_ERROR,message:"An internal error occurred"},o=function(e,t,n){return Object(i.b)(void 0,void 0,void 0,(function(){return Object(i.e)(this,(function(i){return null==n||n.fail("".concat(e," Api failed ").concat(t)),u(t)?[2,c(t)]:[2,c(r)]}))}))},a=function(e,t,n){return Object(i.b)(void 0,void 0,void 0,(function(){return Object(i.e)(this,(function(i){return null==n||n.fail("".concat(e," Api failed ").concat(t)),[2,c([!1,t])]}))}))},s=function(e,t,n,r){return void 0===r&&(r=!1),Object(i.b)(void 0,void 0,void 0,(function(){var o,a;return Object(i.e)(this,(function(s){switch(s.label){case 0:return[4,t(e)];case 1:return o=s.sent(),u(o)?[2,Promise.reject(o)]:(a=n?n(o):o,r&&Array.isArray(a)?[2,c(Object(i.g)([null],a,!0))]:[2,c([null,a])])}}))}))},u=function(e){return void 0!==(null==e?void 0:e.errorCode)},c=function(e){return Object(i.b)(void 0,void 0,void 0,(function(){return Object(i.e)(this,(function(t){return null!=e?[2,{kind:"appResponse",data:e}]:[2,{kind:"appResponse"}]}))}))},l=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(i.b)(void 0,void 0,void 0,(function(){var n;return Object(i.e)(this,(function(i){switch(i.label){case 0:return[4,e.apply(void 0,t)];case 1:return n=i.sent(),[2,c(n)]}}))}))},d={kind:"logResponse"},f=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(i.b)(void 0,void 0,void 0,(function(){return Object(i.e)(this,(function(n){switch(n.label){case 0:return[4,e.apply(void 0,t)];case 1:return n.sent(),[2,d]}}))}))}},36:function(e,t,n){"use strict";function i(){return window.chrome.webview}n.d(t,"a",(function(){return i}))},37:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return y})),n.d(t,"e",(function(){return C}));var i=n(1),r=n(2),o=n(7),a=n(8),s=function(){var e=this;this.items=new Map,this.add=function(t){if(t){var n=t.toLowerCase();if(!e.items.has(n))return e.items.set(n,t),!0}return!1},this.values=function(){return Array.from(e.items.values())}},u=function(e){return e&&new URL(e).hostname},c=function(e,t,n){return void 0!==e&&void 0!==t&&g(p(e,n),l(t,n))},l=function(e,t){var n=new s;return e.validDomains&&e.validDomains.forEach(n.add),e.galleryTabs&&e.galleryTabs.forEach((function(e){return n.add(u(p(e.configurationUrl,t)))})),e.staticTabs&&e.staticTabs.forEach((function(e){e.contentUrl&&n.add(u(p(e.contentUrl,t)))})),Array.from(n.values())},d=function(e){return e&&-1!==r.e.indexOf(e.toLowerCase())},f=function(e,t,n,i,r){var o;if(n.name!==a.c.teams||i&&!i.isFullTrustApp&&!d(i.appId)){if(null===(o=null==i?void 0:i.webApplicationInfo)||void 0===o?void 0:o.resource){var s=v(i,r);return s&&h(s,e)?Promise.resolve([s]):Promise.reject("App resource defined in manifest and iframe origin do not match")}return Promise.reject("App webApplicationInfo or resource not defined in manifest")}return Promise.resolve(t)},p=function(e,t){var n,i,r,o,a,s,u,c,l,d,f,p;if(!t)return e;var v={teamSiteDomain:(null===(n=t.sharePointSite)||void 0===n?void 0:n.teamSiteDomain)||"",teamSitePath:(null===(i=t.sharePointSite)||void 0===i?void 0:i.teamSitePath)||"",teamSiteUrl:(null===(r=t.sharePointSite)||void 0===r?void 0:r.teamSiteUrl)||"",mySiteDomain:(null===(o=t.sharePointSite)||void 0===o?void 0:o.mySiteDomain)||"",mySitePath:(null===(a=t.sharePointSite)||void 0===a?void 0:a.mySitePath)||"",channelRelativeUrl:(null===(s=t.channel)||void 0===s?void 0:s.relativeUrl)||"",sharePointSite:{teamSiteDomain:(null===(u=t.sharePointSite)||void 0===u?void 0:u.teamSiteDomain)||"",teamSitePath:(null===(c=t.sharePointSite)||void 0===c?void 0:c.teamSitePath)||"",teamSiteUrl:(null===(l=t.sharePointSite)||void 0===l?void 0:l.teamSiteUrl)||"",mySiteDomain:(null===(d=t.sharePointSite)||void 0===d?void 0:d.mySiteDomain)||"",mySitePath:(null===(f=t.sharePointSite)||void 0===f?void 0:f.mySitePath)||""},channel:{relativeUrl:(null===(p=t.channel)||void 0===p?void 0:p.relativeUrl)||""}};return S(e,v)},v=function(e,t){var n,i;return(null===(n=e.webApplicationInfo)||void 0===n?void 0:n.resource)&&p(null===(i=e.webApplicationInfo)||void 0===i?void 0:i.resource,t)},h=function(e,t){if(e&&t){if(e===t)return!0;var n=u(t),i=r.d.validResourcePattern.replace(r.d.resourceDomainParameter,n);return new RegExp(i,"i").test(e)}return!1},g=function(e,t){for(var n=m(e),i=new s,r=0,o=t;r<o.length;r++){var a=o[r];if(i.add(a)){for(var u="",c=a.split("."),l=0;l<c.length;l++)u+=(l>0?"[.]":"")+c[l].replace("*","[^/^.]+");var d=new RegExp("^https://".concat(u,"((/|\\?).*)?$"),"i");if(e.match(d)||n.match(d))return!0}}return!1},m=function(e){return new URL(e).href},y=function(e,t,n){var i=S(e,b(t));return i=S(i,n)},S=function(e,t,n){if(void 0===n&&(n=[]),void 0!==t)if("object"==typeof t)for(var i in t)e=S(e,t[i],n.concat(i));else{var r=n.join("\\."),o=new RegExp("{".concat(r,"}"),"g");e=e.replace(o,encodeURIComponent(t))}return e},b=function(e){var t,n,r;return{user:Object(i.a)(Object(i.a)({id:"",licenseType:""},e.user),{tenant:Object(i.a)({id:"",sku:""},null===(t=e.user)||void 0===t?void 0:t.tenant)}),app:Object(i.a)({iconPositionVertical:0,parentMessageId:"",userFileOpenPreference:o.c.Inline,userClickTime:0},e.app),page:Object(i.a)({isFullScreen:!1,subPageId:"",isMultiWindow:!1,sourceOrigin:""},e.page),meeting:{id:(null===(n=e.meeting)||void 0===n?void 0:n.id)||""},chat:{id:(null===(r=e.chat)||void 0===r?void 0:r.id)||""},channel:e.channel,sharePointSite:e.sharePointSite,sharepoint:e.sharepoint,team:e.team}};function C(e){var t,n;return{locale:e.app.locale,appSessionId:e.app.sessionId||"",theme:e.app.theme,appIconPosition:e.app.iconPositionVertical||0,osLocaleInfo:e.app.osLocaleInfo,parentMessageId:e.app.parentMessageId||"",userClickTime:e.app.userClickTime||0,userFileOpenPreference:e.app.userFileOpenPreference||o.c.Inline,hostName:e.app.host.name,hostClientType:e.app.host.clientType,sessionId:e.app.host.sessionId||"",ringId:e.app.host.ringId,entityId:e.page.id,frameContext:e.page.frameContext,subEntityId:e.page.subPageId||"",isFullScreen:e.page.isFullScreen||!1,isMultiWindow:e.page.isMultiWindow||!1,sourceOrigin:e.page.sourceOrigin||"",userObjectId:void 0!==e.user?e.user.id:void 0,isCallingAllowed:void 0!==e.user?e.user.isCallingAllowed:void 0,isPSTNCallingAllowed:void 0!==e.user?e.user.isPSTNCallingAllowed:void 0,userLicenseType:void 0!==e.user?e.user.licenseType:"",loginHint:void 0!==e.user?e.user.loginHint:void 0,userPrincipalName:void 0!==e.user?e.user.userPrincipalName:void 0,userDisplayName:void 0!==e.user?e.user.displayName:void 0,tid:void 0!==e.user&&void 0!==e.user.tenant?e.user.tenant.id:void 0,tenantSKU:(null===(n=null===(t=null==e?void 0:e.user)||void 0===t?void 0:t.tenant)||void 0===n?void 0:n.sku)||"",channelId:void 0!==e.channel?e.channel.id:void 0,channelName:void 0!==e.channel?e.channel.displayName:void 0,channelRelativeUrl:void 0!==e.channel?e.channel.relativeUrl:void 0,channelType:void 0!==e.channel?e.channel.membershipType:void 0,defaultOneNoteSectionId:void 0!==e.channel?e.channel.defaultOneNoteSectionId:void 0,hostTeamGroupId:void 0!==e.channel?e.channel.ownerGroupId:void 0,hostTeamTenantId:void 0!==e.channel?e.channel.ownerTenantId:void 0,chatId:void 0!==e.chat?e.chat.id:"",meetingId:void 0!==e.meeting?e.meeting.id:"",sharepoint:e.sharepoint,teamId:void 0!==e.team?e.team.internalId:void 0,teamName:void 0!==e.team?e.team.displayName:void 0,teamType:void 0!==e.team?e.team.type:void 0,groupId:void 0!==e.team?e.team.groupId:void 0,teamTemplateId:void 0!==e.team?e.team.templateId:void 0,isTeamArchived:void 0!==e.team?e.team.isArchived:void 0,userTeamRole:void 0!==e.team?e.team.userRole:void 0,teamSiteUrl:void 0!==e.sharePointSite?e.sharePointSite.teamSiteUrl:void 0,teamSiteDomain:void 0!==e.sharePointSite?e.sharePointSite.teamSiteDomain:void 0,teamSitePath:void 0!==e.sharePointSite?e.sharePointSite.teamSitePath:void 0,mySiteDomain:void 0!==e.sharePointSite?e.sharePointSite.mySiteDomain:void 0,mySitePath:void 0!==e.sharePointSite?e.sharePointSite.mySitePath:void 0}}},39:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},4:function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"j",(function(){return r})),n.d(t,"l",(function(){return o})),n.d(t,"k",(function(){return a})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return v}));var i="function",r="object",o="undefined",a="prototype",s="hasOwnProperty",u="default",c=Object,l=c[a],d=c.assign,f=c.create,p=c.defineProperty,v=l[s]},40:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return h}));var i,r=n(1),o=n(26),a=n(25),s=n(2),u=n(24),c=n(3),l=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.appAuthSdkHost=t,r.authenticationService=n,r.telemetryService=i,r}return Object(r.d)(t,e),t.prototype.initHandlers=function(){e.prototype.initHandlers.call(this),this.registerHandler(s.c.authentication.notifySuccess,this.handleNotifySuccess),this.registerHandler(s.c.authentication.notifyFailure,this.handleNotifyFailure)},t.prototype.handleNotifySuccess=function(e,t){return this.appAuthSdkHost.closeWindow(),this.appAuthSdkHost.stopAuthWindowMonitor(),Object(c.b)(this.authenticationService.notifySuccess,t)},t.prototype.handleNotifyFailure=function(e,t){return this.appAuthSdkHost.closeWindow(),this.appAuthSdkHost.stopAuthWindowMonitor(),Object(c.b)(this.authenticationService.notifyFailure,t,i.Other)},t}(u.a),d=function(e){function t(t,n,i){var r=e.call(this,t)||this;return r.appSdkHost=t,r.authService=n,r.telemetryService=i,r.messageHandlers.push(new l(t,n,i)),r.messageHandlers.push(new a.a(t,{},i)),r.messageHandlers.forEach((function(e){return e.initHandlers()})),r}return Object(r.d)(t,e),t}(n(28).a),f=n(8),p=n(37),v=n(27);!function(e){e.AppDefinitionUnavailable="AppDefinitionUnavailable",e.BlockedByBrowser="BlockedByBrowser",e.CancelledByUser="CancelledByUser",e.InvalidAuthUrl="InvalidAuthUrl",e.InvalidFrameContext="InvalidFrameContext",e.Other="Other"}(i||(i={}));var h=function(e){function t(t,n,a,s,u,c){var l,v=e.call(this,t,u,s,c,void 0)||this;if(v.hostWindow=t,v.openWindowInfo=n,v.appDefinition=a,v.authenticationService=s,v.context=u,v.onAuthMessageReceived=function(e){return Object(r.b)(v,void 0,void 0,(function(){var t;return Object(r.e)(this,(function(n){switch(n.label){case 0:return this.authWindow&&this.authWindow===e.source?((t=e.origin)!==this.origin&&Object(p.c)(t,this.appDefinition)&&(this.origin=e.origin),this.origin===t&&this.messageProcessor?[4,this.messageProcessor.process(e)]:[3,2]):[2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},v.setupAuthMessageHandlers=function(){v.authenticationService&&(v.messageProcessor=new d(v,v.authenticationService,v.telemetryService))},v.context.page.frameContext!==f.a.authentication&&v.HandleError("Invalid frame context for scenario",i.InvalidFrameContext),v.appDefinition||v.HandleError("App definition not available",i.AppDefinitionUnavailable),Object(p.c)(n.url,a)&&v.hostWindow){var h=v.hostWindow,g="";n.width&&n.height&&(g="width=".concat(n.width,",height=").concat(n.height),null!=n.left&&null!=n.top&&(g="".concat(g,",left=").concat(n.left,",top=").concat(n.top))),v.authWindow=h.open(n.url,"appAuthWindow",g),v.authWindow?(v.origin=n.url,v.setUserClickTime(null!==(l=u.app.userClickTime)&&void 0!==l?l:Date.now()),v.setupAuthMessageHandlers(),v.globalWindowEventListener=new o.a(h),v.globalWindowEventListener.addListener("message",v.onAuthMessageReceived),v.startAuthWindowMonitor(),v.initializeAuthenticationContext(u)):v.HandleError("browser is blocking the url to open",i.BlockedByBrowser)}else v.HandleError("Auth url is not valid",i.InvalidAuthUrl);return v}return Object(r.d)(t,e),t.prototype.getHostWindow=function(){return this.authWindow||null},t.prototype.postResponseToApp=function(e,t){this.sendResponseMessage(e,t)},t.prototype.isWindowOpen=function(){return!!this.authWindow&&!this.authWindow.closed},t.prototype.closeWindow=function(){this.unloadApp(this.appDefinition)},t.prototype.sendResponseMessage=function(e,t){if(this.origin){var n={id:e,args:t,origin:this.origin};this.postMessage(n)}},t.prototype.sendRequestMessage=function(e,t){if(this.origin){var n={func:e,args:t};this.postMessage(n)}},t.prototype.startAuthWindowMonitor=function(){var e=this;this.stopAuthWindowMonitor(),this.authWindowMonitor=this.hostWindow.setInterval((function(){e.authWindowInterval()}),100)},t.prototype.authWindowInterval=function(){this.isWindowOpen()?this.sendRequestMessage("ping"):(this.HandleError("CancelledByUser",i.CancelledByUser),this.stopAuthWindowMonitor())},t.prototype.stopAuthWindowMonitor=function(){this.authWindowMonitor&&(this.hostWindow.clearInterval(this.authWindowMonitor),this.authWindowMonitor=void 0)},t.prototype.unloadApp=function(e){var t;this.unloadSDK(),null===(t=this.authWindow)||void 0===t||t.close()},t.prototype.unloadSDK=function(){this.globalWindowEventListener&&this.globalWindowEventListener.removeListener("message")},t.prototype.postMessage=function(e){var t;this.origin&&(null===(t=this.authWindow)||void 0===t||t.postMessage(e,this.origin))},t.prototype.HandleError=function(e,t){this.authenticationService&&this.authenticationService.notifyFailure(e,t)},t}(v.a)},46:function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var u,c=[],l=!1,d=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):d=-1,c.length&&p())}function p(){if(!l){var e=s(f);l=!0;for(var t=c.length;t;){for(u=c,c=[];++d<t;)u&&u[d].run();d=-1,t=c.length}u=null,l=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function h(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new v(e,t)),1!==c.length||l||s(p)},v.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=h,r.addListener=h,r.once=h,r.off=h,r.removeListener=h,r.removeAllListeners=h,r.emit=h,r.prependListener=h,r.prependOnceListener=h,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},5:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i,r=n(1),o=n(2),a=((i={})[o.c.appInstallDialog.openAppInstallDialog]="api.appInstallDialog.openAppInstallDialog",i[o.c.authentication.getAuthToken]="api.getAuthToken",i[o.c.authentication.getUser]="api.getUser",i[o.c.authentication.notifyFailure]="api.authentication.notifyFailure",i[o.c.authentication.notifySuccess]="api.authentication.notifySuccess",i[o.c.appEntity.selectAppEntity]="api.appEntity.selectAppEntity",i[o.c.bot.authenticate]="api.bot.authenticate",i[o.c.bot.getSupportedCommands]="api.bot.getSupportedCommands",i[o.c.bot.sendQuery]="api.bot.sendQuery",i[o.c.calendar.composeMeeting]="api.calendar.composeMeeting",i[o.c.calendar.openCalendarItem]="api.calendar.openCalendarItem",i[o.c.call.startCall]="api.call.startCall",i[o.c.chat.openConversation]="api.chat.openConversation",i[o.c.chat.closeConversation]="api.chat.closeConversation",i[o.c.chat.getChatMembers]="api.chat.getChatMembers",i[o.c.dialogs.open]="api.dialogs.open",i[o.c.dialogs.resize]="api.dialogs.resize",i[o.c.dialogs.submit]="api.dialogs.submit",i[o.c.files.openFilePreview]="api.files.openFilePreview",i[o.c.files.getCloudStorageFolders]="api.files.getCloudStorageFolders",i[o.c.files.addCloudStorageFolder]="api.files.addCloudStorageFolder",i[o.c.files.deleteCloudStorageFolder]="api.files.deleteCloudStorageFolder",i[o.c.getContext]="api.getContext",i[o.c.links.openLink]="api.links.openLink",i[o.c.location.getLocation]="api.location.getLocation",i[o.c.location.showLocation]="api.location.showLocation",i[o.c.mail.openMailItem]="api.mail.openMailItem",i[o.c.mail.composeMail]="api.mail.composeMail",i[o.c.media.captureImage]="api.media.captureImage",i[o.c.media.getMedia]="api.media.getMedia",i[o.c.media.scanBarCode]="api.media.scanBarCode",i[o.c.media.selectMedia]="api.media.selectMedia",i[o.c.media.viewImages]="api.media.viewImages",i[o.c.meeting.getAppContentStageSharingCapabilities]="api.meeting.getAppContentStageSharingCapabilities",i[o.c.meeting.getAppContentStageSharingState]="api.meeting.getAppContentStageSharingState",i[o.c.meeting.getAuthenticationTokenForAnonymousUser]="api.meeting.getAuthenticationTokenForAnonymousUser",i[o.c.meeting.getIncomingClientAudioState]="api.meeting.getIncomingClientAudioState",i[o.c.meeting.getLiveStreamState]="api.meeting.getLiveStreamState",i[o.c.meeting.getMeetingDetails]="api.meeting.getMeetingDetails",i[o.c.meeting.requestStartLiveStreaming]="api.meeting.requestStartLiveStreaming",i[o.c.meeting.requestStopLiveStreaming]="api.meeting.requestStopLiveStreaming",i[o.c.meeting.shareAppContentToStage]="api.meeting.shareAppContentToStage",i[o.c.meeting.stopSharingAppContentToStage]="api.meeting.stopSharingAppContentToStage",i[o.c.meeting.toggleIncomingClientAudio]="api.meeting.toggleIncomingClientAudio",i[o.c.monetization.openPurchaseExperience]="api.monetization.openPurchaseExperience",i[o.c.meetingRoom.getPairedMeetingRoomInfo]="api.meetingRoom.getPairedMeetingRoomInfo",i[o.c.meetingRoom.sendCommandToPairedMeetingRoom]="api.meetingRoom.sendCommandToPairedMeetingRoom",i[o.c.notifications.showNotification]="api.notifications.showNotification",i[o.c.pages.config.setConfig]="api.pages.config.setConfig",i[o.c.pages.config.remove.failure]="api.pages.config.remove.failure",i[o.c.pages.config.remove.success]="api.pages.config.remove.success",i[o.c.pages.config.save.failure]="api.pages.config.save.failure",i[o.c.pages.config.save.success]="api.pages.config.save.success",i[o.c.pages.config.setValidityState]="api.pages.config.setValidityState",i[o.c.pages.backStack.navigateBack]="api.pages.backStack.navigateBack",i[o.c.pages.fullTrust.enterFullscreen]="api.pages.fullTrust.enterFullscreen",i[o.c.pages.fullTrust.exitFullscreen]="api.pages.fullTrust.exitFullscreen",i[o.c.pages.getConfig]="api.pages.getConfig",i[o.c.pages.navigateCrossDomain]="api.pages.navigateCrossDomain",i[o.c.pages.navigateToApp]="api.pages.navigateToApp",i[o.c.pages.returnFocus]="api.pages.returnFocus",i[o.c.pages.shareDeepLink]="api.pages.shareDeepLink",i[o.c.pages.tabs.getMruTabInstances]="api.pages.tabs.getMruTabInstances",i[o.c.pages.tabs.getTabInstances]="api.pages.tabs.getTabInstances",i[o.c.pages.tabs.navigateToTab]="api.pages.tabs.navigateToTab",i[o.c.people.selectPeople]="api.people.selectPeople",i[o.c.remoteCamera.getCapableParticipants]="api.remoteCamera.getCapableParticipants",i[o.c.remoteCamera.requestControl]="api.remoteCamera.requestControl",i[o.c.remoteCamera.sendControlCommand]="api.remoteCamera.sendControlCommand",i[o.c.remoteCamera.terminateSession]="api.remoteCamera.terminateSession",i[o.c.registerHandler]="api.registerHandler",i[o.c.teams.fullTrust.getUserJoinedTeams]="api.teams.fullTrust.getUserJoinedTeams",i[o.c.teams.fullTrust.getConfigSetting]="api.teams.fullTrust.getConfigSetting",i),s=function(){function e(e,t){this.appSdkHost=e,this.telemetryService=t,this.handlers={},this.appDefinition=this.appSdkHost.getAppDefinition()}return e.prototype.registerHandler=function(e,t,n){var i;this.handlers[e]={callback:t,scenarioName:null!==(i=null==n?void 0:n.scenarioName)&&void 0!==i?i:a[e],errorCallback:null==n?void 0:n.errorCallback,isPrivate:null==n?void 0:n.isPrivate}},e.prototype.deleteMessageHandling=function(e){delete this.handlers[e]},e.prototype.canHandleMessage=function(e){return this.validateInitialization(e)&&void 0!==this.handlers[e]},e.prototype.handleMessage=function(e,t,n){var i,o;return Object(r.b)(this,void 0,void 0,(function(){var a,s,u,c;return Object(r.e)(this,(function(r){switch(r.label){case 0:if(!this.validateInitialization(e))return[2,Promise.reject("SDK context is not initialized")];if(!this.canHandleMessage(e))return[2,Promise.reject("Handler cannot handle message: ".concat(e))];if((a=this.handlers[e]).isPrivate&&!(null===(i=this.appSdkHost.getAppDefinition())||void 0===i?void 0:i.isFullTrustApp))return[2,Promise.reject("Private APIs can only be called by Full Trust Apps")];a.scenarioName&&this.telemetryService&&(s=this.telemetryService.createScenario(a.scenarioName,null===(o=this.appDefinition)||void 0===o?void 0:o.appId,n),n&&s.markPhase("MessageDelay")),r.label=1;case 1:return r.trys.push([1,3,,4]),this.validateDependencies(e),[4,a.callback.apply(this,t)];case 2:return u=r.sent(),null==s||s.stop(),[2,u];case 3:return c=r.sent(),a.errorCallback?[2,a.errorCallback(c,s)]:(null==s||s.fail(c),[2,Promise.reject(c)]);case 4:return[2]}}))}))},e.prototype.validateInitialization=function(e){return e===o.c.initialize||this.appSdkHost.isInitialized()},e.prototype.validateDependencies=function(e){},e.prototype.cleanup=function(){},e}()},7:function(e,t,n){"use strict";var i,r,o,a,s,u;n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return u})),function(e){e.Unknown="unknown",e.Loading="loading",e.Loaded="loaded",e.Failed="failed",e.Unloading="unloading",e.Unloaded="unloaded",e.Cached="cached"}(i||(i={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(r||(r={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(o||(o={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(a||(a={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(s||(s={})),function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(u||(u={}))},8:function(e,t,n){"use strict";var i,r,o,a,s,u;n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u})),function(e){e.office="Office",e.orange="Orange",e.outlook="Outlook",e.teams="Teams"}(i||(i={})),function(e){e.windows="windows",e.macOs="macos"}(r||(r={})),function(e){e.default="default",e.dark="dark",e.highContrast="contrast"}(o||(o={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(a||(a={})),function(e){e.web="web",e.desktop="desktop"}(s||(s={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.meetingStage="meetingStage"}(u||(u={}))}});