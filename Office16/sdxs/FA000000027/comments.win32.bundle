/*! For license information please see Comments.win32.bundle.LICENSE.txt */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="http://localhost:8081/",n(n.s=364)}([function(e,t,n){"use strict";var r,o,i,a,s,c,d,l;function u(e,t){return{visit:function(){}}}function p(e,t,n){return{key:e,value:t,dataClassification:n}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return d})),n.d(t,"j",(function(){return u})),n.d(t,"l",(function(){return p})),n.d(t,"e",(function(){return l})),n.d(t,"i",(function(){return y})),n.d(t,"k",(function(){return D})),function(e){e[e.None=0]="None",e[e.Always=1]="Always",e[e.OnSuccess=2]="OnSuccess"}(r||(r={})),function(e){e[e.None=0]="None",e[e.BasicEvent=1]="BasicEvent",e[e.FullEvent=2]="FullEvent",e[e.NecessaryServiceDataEvent=3]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=4]="AlwaysOnNecessaryServiceDataEvent"}(o||(o={})),function(e){e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration"}(i||(i={})),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Required=1]="Required",e[e.Basic=2]="Basic",e[e.All=3]="All"}(s||(s={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Info=3]="Info",e[e.Verbose=4]="Verbose",e[e.Spam=5]="Spam"}(c||(c={})),function(e){e[e.GlobalAPI=1]="GlobalAPI",e[e.ReviewedAsNotNecessary=2]="ReviewedAsNotNecessary",e[e.Test=3]="Test",e[e.Todo=4]="Todo"}(d||(d={})),function(e){e[e.Normal=0]="Normal",e[e.Critical=1]="Critical"}(l||(l={}));var h,f,m=n(8),g=function(){function e(){this.isInitialized=!1,this.deferredInitializationCallbacks=[]}return e.prototype.init=function(e){var t,n=this;this.isInitialized?this.assertConditionTag(!1,"ClientTelemetryAPI init called twice!",595644941):(this.hostAPI=e,this.isInitialized=!0,this.deferredInitializationCallbacks.map((function(e){return e(n)})),this.deferredInitializationCallbacks=[],this.logDiagnosticTrace=null===(t=this.hostAPI.logDiagnosticTrace)||void 0===t?void 0:t.bind(this.hostAPI))},e.prototype.hasBeenInitialized=function(){return this.isInitialized},e.prototype.onInitialized=function(e){this.isInitialized?e(this):this.deferredInitializationCallbacks.push(e)},e.prototype.createActivityObject=function(e,t,n,r,o){return void 0===o&&(o=!1),this.checkIsInitialized(),Object(m.n)(e[0]>="A"&&e[0]<="Z","Activity name should start with a capital letter.",578937436),Object(m.n)(this.hostAPI,"Host API must be defined",578937437),this.hostAPI.createActivityObject(e,t,n,r,o)},e.prototype.assertCondition=function(e,t){this.checkIsInitialized(),this.assertConditionTag(e,t,590899031)},e.prototype.assertConditionTag=function(e,t,n){this.checkIsInitialized(),e||(Object(m.j)("*ASSERT* 0x".concat(n.toString(16)," : ").concat(t)),Object(m.n)(this.hostAPI,"Host API must be defined",578937437),this.hostAPI.logErrorData(n,t))},e.prototype.getMetadata=function(){return Object(m.n)(this.hostAPI,"Host API must be defined",578937437),this.hostAPI.getMetadata()},e.prototype.checkIsInitialized=function(){if(!this.isInitialized||!this.hostAPI)throw new m.d("ClientTelemetryAPI is not initialized",578937438)},e.prototype.logFloodgateActivity=function(e){this.checkIsInitialized(),Object(m.n)(this.hostAPI,"Host API must be defined",578937437),this.hostAPI.logFloodgateActivity&&this.hostAPI.logFloodgateActivity(e)},e}(),b=void 0;function C(e){return!0===e.testOnly}function y(){if(h||(h=Object(m.f)()),!b){var e=new g;return function(e){if(b){if(C(b))return void(C(e)&&(b=e));if(h)throw new m.d(["'getTelemetryAPI' was called before a stub API was injected.","First call to getTelemetryAPI originated from:",h].join("\n"),576717444);throw new m.d("ClientTelemetryAPI cannot be re-initialized.\nFirst intialized from ".concat(f),576717445)}f||(f=Object(m.f)()),b=e}(e),e}return b}var v=n(3),T={appName:"TestHost",appVersion:"1.0",releaseAudience:"Internal",releaseChannel:"Insiders",sessionId:"D9430514-C886-445F-891C-6C0E7F774EF7"};var S=function(){function e(e,t){void 0===t&&(t=T),this.sdxMetadata=e,this.hostTelemetrySupport=t,this.logDiagnosticTrace=void 0}return e.prototype.getMetadata=function(){var e=this.hostTelemetrySupport;return{appName:e.appName,appVersion:e.appVersion,dataCenter:e.dataCenter,releaseAudience:e.releaseAudience,releaseAudienceGroup:e.releaseAudienceGroup,releaseChannel:e.releaseChannel,ring:e.ring,sessionId:e.sessionId,sovereignEnvironmentName:e.sovereignEnvironmentName}},e}(),I=function(){function e(e){this._visitor=e,this._ended=!1}return e.prototype.finalize=function(){return this._ended?(Object(m.h)("ActivityObject has already been ended"),!1):(this._visitor&&this._visitor.visit(this),this._ended=!0,!0)},e.prototype.success=function(){this.successTag(0)},e.prototype.fail=function(e){this.failTag(0,e)},e.prototype.isEnded=function(){return this._ended},e}(),O=n(26);O.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::TelemetryMetadata":{appName:"$string",appVersion:"$string",releaseAudience:"$string",releaseChannel:"$string",releaseAudienceGroup:["opt-field","$string"],sessionId:"$string"}});var E={TelemetryModule:O.RekaServiceRegistry.getNativeService(["Mso::Document::Comments::JS::TelemetryModule",{logActivity:["FireAndForgetMethod",["Mso::Document::Comments::JS::ActivityData","Mso::Document::Comments::JS::ActivityDataFields"]],logErrorData:["FireAndForgetMethod",["$number","$string"]],logDiagnosticTrace:["FireAndForgetMethod",["$number","$number","$number","$string",["$array","Mso::Document::Comments::JS::HostClassifiedDataField"]]],telemetryMetadata:["Constant","Mso::Document::Comments::JS::TelemetryMetadata"]}])};var P=function(e){function t(n,o,i,a,c){var d=e.call(this,o)||this;return d._startTime=0,d._activityData={name:n,timeElapsed:0,result:0,endTag:0,aggregationMode:void 0===i?r.None:i,diagnosticLevel:a,apiContext:void 0,documentMetadata:s.None},d._dataFields={},d._startTime=t.now(),d}return Object(v.c)(t,e),t.prototype.successTag=function(e){this.finalize()&&(this._activityData.result=0,this._activityData.endTag=e,this._activityData.timeElapsed=t.now()-this._startTime,t.logActivity(this._activityData,this._dataFields))},t.prototype.failTag=function(e,n){this.finalize()&&(this._activityData.result=n,this._activityData.endTag=e,this._activityData.timeElapsed=t.now()-this._startTime,t.logActivity(this._activityData,this._dataFields))},t.prototype.addDataField=function(e,t,n,r){this.isEnded()?y().assertConditionTag(!1,"Activity object has already been ended. Field: '".concat(e,"'"),595644948):void 0===this._dataFields[e]?n&&n!==a.SystemMetadata?y().assertConditionTag(!1,"PII data fields are not yet supported. Field: '".concat(e,"'"),595644950):this._dataFields[e]=t:y().assertConditionTag(!1,"ActivityObject already contains data for given field: '".concat(e,"'"),595644949)},t.prototype.addDocumentMetadata=function(e){this._activityData.documentMetadata=e},t.prototype.attachContext=function(e){this._activityData.apiContext=e},t.logActivity=function(e,t){var n={string:[],number:[],boolean:[]};Object.keys(t).forEach((function(e){var r=t[e];"boolean"==typeof r?n.boolean.push({key:e,value:r}):"number"==typeof r?n.number.push({key:e,value:r}):n.string.push({key:e,value:r})})),E.TelemetryModule.logActivity(e,n)},t.now=function(){if("undefined"!=typeof performance&&performance.now){var e=performance.now();return Math.floor(1e3*e)}return 1e3*Date.now()},t}(I);function k(e){switch(typeof e){case"boolean":return{type:"boolean",boolVal:e};case"string":return{type:"string",strVal:e};case"number":return{type:"number",numVal:e};default:Object(m.m)(e)}}function R(e){return{key:e.key,dataClassification:e.dataClassification,value:k(e.value)}}var x=function(e){function t(t,n){void 0===n&&(n=E.TelemetryModule.telemetryMetadata);var r=e.call(this,t,n)||this;return r.sdxMetadata=t,r.logDiagnosticTrace=function(e,t,n,r,o){for(var i=[],a=5;a<arguments.length;a++)i[a-5]=arguments[a];var s=Object(v.g)([],i,!0);o.visit({addDataField:function(e,t,n,r){s.push({key:e,value:t,dataClassification:n})},addDocumentMetadata:function(e){},attachContext:function(e){}}),E.TelemetryModule.logDiagnosticTrace(t,n,r,e,s.map(R))},r}return Object(v.c)(t,e),t.prototype.createActivityObject=function(e,t,n,r){return function(e,t,n,r){return new P(e,t,n,r)}(e,t,n,r)},t.prototype.logErrorData=function(e,t){E.TelemetryModule.logErrorData(e,"".concat(t,"\n\nStack:\n").concat((new Error).stack))},t}(S);function D(e,t){y().init(new x(e,t))}},function(e,t){e.exports=OfficePlatformGlobal.React},function(e,t,n){"use strict";n.d(t,"r",(function(){return l})),n.d(t,"A",(function(){return u})),n.d(t,"x",(function(){return p})),n.d(t,"m",(function(){return h})),n.d(t,"i",(function(){return f})),n.d(t,"R",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"z",(function(){return b})),n.d(t,"y",(function(){return C})),n.d(t,"C",(function(){return y})),n.d(t,"c",(function(){return v})),n.d(t,"p",(function(){return T})),n.d(t,"U",(function(){return S})),n.d(t,"e",(function(){return I})),n.d(t,"n",(function(){return O})),n.d(t,"v",(function(){return E})),n.d(t,"Y",(function(){return P})),n.d(t,"a",(function(){return k})),n.d(t,"t",(function(){return R})),n.d(t,"E",(function(){return x})),n.d(t,"B",(function(){return D})),n.d(t,"k",(function(){return w})),n.d(t,"s",(function(){return A})),n.d(t,"o",(function(){return j})),n.d(t,"D",(function(){return _})),n.d(t,"l",(function(){return F})),n.d(t,"J",(function(){return M})),n.d(t,"W",(function(){return N})),n.d(t,"X",(function(){return L})),n.d(t,"j",(function(){return B})),n.d(t,"g",(function(){return H})),n.d(t,"w",(function(){return U})),n.d(t,"N",(function(){return V})),n.d(t,"S",(function(){return W})),n.d(t,"V",(function(){return z})),n.d(t,"Z",(function(){return K})),n.d(t,"q",(function(){return G})),n.d(t,"f",(function(){return q})),n.d(t,"I",(function(){return $})),n.d(t,"T",(function(){return Y})),n.d(t,"P",(function(){return J})),n.d(t,"M",(function(){return Q})),n.d(t,"G",(function(){return X})),n.d(t,"K",(function(){return Z})),n.d(t,"F",(function(){return ee})),n.d(t,"h",(function(){return te})),n.d(t,"H",(function(){return ne})),n.d(t,"O",(function(){return re})),n.d(t,"u",(function(){return oe})),n.d(t,"L",(function(){return ie})),n.d(t,"Q",(function(){return ae})),n.d(t,"d",(function(){return se}));var r=n(43),o=(n(8),n(21));let i;function a(){if(!i)try{i=Object(r.a)()}catch(e){throw new o.a("FeatureGateAPI not initialized",589103629,-2130957531)}return i}var s=n(0);const c={LivePersonaPicker:{webSettingName:"LivePersonaPicker",dependencies:[]},PersonaFeature:{webSettingName:"PersonaColor",dependencies:[]},NewCommentButton:{webSettingName:"NewCommentButton",dependencies:[]},DiscreteHostedComments:{webSettingName:"DiscreteHostedComments",dependencies:["NewDraftingUI"]},CommentsFluentUI:{webSettingName:"CommentsFluentUI",dependencies:[]},RenderDHCInPane:{dependencies:[]},CommentTasks:{webSettingName:"CommentTasks",dependencies:["CommentsFluentUI"]},NoDiscardOnFocusLoss:{webSettingName:"NoDiscardOnFocusLoss",dependencies:[]},NewDraftingUI:{webSettingName:"DiscreteHostedComments",dependencies:[]},TaskPaneWithNewInfrastructure:{webSettingName:"TaskPaneWithNewInfrastructure",dependencies:[]},CommentTasksFromReply:{webSettingName:"CommentTasksFromReply",dependencies:["CommentTasks"]},HeadlessBoot:{dependencies:[]},HyperlinksInComments:{webSettingName:"HyperlinksInComments",dependencies:[]},HyperlinksWithDisplayText:{webSettingName:"HyperlinksWithDisplayText",dependencies:[]},ContentNavigation:{webSettingName:"ContentNavigation",dependencies:[]},AtMentionFloodgateSurvey:{webSettingName:"AtMentionFloodgateSurvey",dependencies:[]},ExtendedDrafting:{webSettingName:"ExtendedDrafting",dependencies:["NewDraftingUI"]},RichTextFormattingInWeb:{webSettingName:"RichTextFormattingInWeb",dependencies:[]},SmartReplies:{webSettingName:"SmartReplies",dependencies:[]},LogDraftCommentIdPair:{webSettingName:"LogDraftCommentIdPair",dependencies:[]},RichContentEditIntegrationInWeb:{webSettingName:"RichContentEditIntegration",dependencies:[]},NewSelectionInteractions:{webSettingName:"NewSelectionInteractions",dependencies:[]},CommentReactions:{webSettingName:"CommentReactions",dependencies:[]},LinkToComment:{webSettingName:"LinkToComment",dependencies:[]},WebThemeIntegration:{webSettingName:"WebThemeIntegration",dependencies:[]},TruncationUIWithReadMoreText:{webSettingName:"TruncationUIWithReadMoreText",dependencies:[]},QuickEdit:{dependencies:[]},QuillInitializationTelemetry:{webSettingName:"QuillInitializationTelemetry",dependencies:[]},CtrlEnterTip:{webSettingName:"CtrlEnterTip",dependencies:["CommentsFluentUI"]},LPPVerboseLogging:{dependencies:[]},FluentSVRefreshWin32:{dependencies:[]},HighlightsAndFontColorInWebComments:{webSettingName:"HighlightsAndFontColorInWebComments",dependencies:["RichContentEditIntegrationInWeb"]},UnresponsivePaneWorkaround:{dependencies:[]},DiagnosticHeartbeat:{dependencies:[]},EnableExperimentalLists:{dependencies:[]},TaskHistoryRecordIDs:{webSettingName:"TaskHistoryRecordIDs",dependencies:[]},AtMentionHintMessage:{webSettingName:"AtMentionHintMessage",dependencies:[]},MapBasedStore:{webSettingName:"MapBasedStore",dependencies:[]},ContentFiltering:{dependencies:[]},CommentTasksMultiAssignCreation:{webSettingName:"CommentTasksMultiAssignCreation",dependencies:["CommentTasks","CommentTasksFromReply"]}};function d(e,t=new Set){if(!a().isFeatureEnabled(e))return!1;t.add(e);return c[e].dependencies.every(n=>{const r=t.has(n)||d(n,t);return Object(s.i)().assertConditionTag(r,`Gate ${e} enabled without dependency gate ${n}`,544482649),r})}function l(){return d("LivePersonaPicker")}function u(){return d("PersonaFeature")}function p(){return d("NewCommentButton")}function h(){return d("DiscreteHostedComments")}function f(){return d("CommentsFluentUI")}function m(){return d("RenderDHCInPane")}function g(){return d("CommentTasks")}function b(){return d("NoDiscardOnFocusLoss")}function C(){return d("NewDraftingUI")}function y(){return d("TaskPaneWithNewInfrastructure")}function v(){return d("CommentTasksFromReply")}function T(){return d("HeadlessBoot")}function S(){return d("ContentNavigation")}function I(){return d("AtMentionFloodgateSurvey")}function O(){return d("ExtendedDrafting")}function E(){return d("LogDraftCommentIdPair")}function P(){return d("NewSelectionInteractions")}function k(){return d("CommentReactions")}function R(){return d("LinkToComment")}function x(){return d("WebThemeIntegration")}function D(){return d("QuickEdit")}function w(){return d("CtrlEnterTip")}function A(){return d("LPPVerboseLogging")}function j(){return d("FluentSVRefreshWin32")}function _(){return d("UnresponsivePaneWorkaround")}function F(){return d("DiagnosticHeartbeat")}function M(){return d("EnableExperimentalLists")}function N(){return d("TaskHistoryRecordIDs")}function L(){return V()&&ne()&&d("MapBasedStore")}function B(){return d("ContentFiltering")}function H(){return d("CommentTasksMultiAssignCreation")}function U(){return!1}function V(){return a().isChangeGateEnabled("FixSelectRootPostOfSelectedThread",Object(r.c)(5775395))}function W(){return a().isChangeGateEnabled("SimplifyMathInFocusSibling",Object(r.c)(5793713))}function z(){return a().isChangeGateEnabled("LPPMobileAccountID",Object(r.c)(5819744))}function K(){return a().isChangeGateEnabled("RichEditWrapperLocalizationAPI",Object(r.c)(5823384))}function G(){return a().isChangeGateEnabled("HistoryRecordViewStateProcessingRefactor",Object(r.c)(5846229))}function q(){return a().isChangeGateEnabled("CentralizeTaskMetaDataLogic",Object(r.c)(5851800))}function $(){return a().isChangeGateEnabled("DeleteTaskStaleRecords",Object(r.c)(5849117))}function Y(){return a().isChangeGateEnabled("TimeoutSoonerForFocusRetry",Object(r.c)(5863516))}function J(){return a().isChangeGateEnabled("LogNativeInitialization",Object(r.c)(5865528))}function Q(){return a().isChangeGateEnabled("FixLieInsertionWhenOrphanedReplies",Object(r.c)(5866102))}function X(){return a().isChangeGateEnabled("ComputeRenderableItemsAfterReadyToRender",Object(r.c)(5868290))}function Z(){return P()&&a().isChangeGateEnabled("FixFirstThreadLogic",Object(r.c)(5891066))}function ee(){return a().isChangeGateEnabled("AllowDraftSelectionOnContextChange",Object(r.c)(5894454))}function te(){return a().isChangeGateEnabled("CommentTasksRenderMultiAssignData",Object(r.c)(5949645))}function ne(){return a().isChangeGateEnabled("DeferLieCreation",Object(r.c)(5953388))}function re(){return a().isChangeGateEnabled("FixViewStateLogic",Object(r.c)(5935388))}function oe(){return a().isChangeGateEnabled("LinkToCommentIconWorkaround",Object(r.c)(5949274))}function ie(){return a().isChangeGateEnabled("FixFormattedTextFallback",Object(r.c)(5956421))}function ae(){return a().isChangeGateEnabled("RemoveLPPCompliance",Object(r.c)(5955517))}function se(){return a().isChangeGateEnabled("AndroidDraftBoxTabWorkaround",Object(r.c)(5963013))}},function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return u}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function s(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function c(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}Object.create;function d(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function u(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}Object.create},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(32),o=n(12);class i{constructor(e){this.rules=[],this.storedStyles=new Map,this.rules=e}render(e){return this.renderInternal(e,i.DEFAULT_SETTINGS)}renderWithSettings(e,t){return this.renderInternal(e,t)}renderInternal(e,t){const n=this.serializeRulesResults(e);let r=this.storedStyles.get(t);r||(r=new Map,this.storedStyles.set(t,r));let o=r.get(n);if(void 0===o){const i=this.computeStyle(e,t);return o=this.registerStyle(i),r.set(n,o),o}return o}computeStyle(e,t){return this.flattenStyle(this.rules.filter(t=>this.testCondition(t.condition,e)).map(e=>{const n=e.style;if("function"==typeof n){if(t===a.DEFAULT_SETTINGS)throw new Error("Functional rule def encountered with unset settings object");return n(t)}return n}))}testCondition(e,t){return"function"==typeof e?e(t):Object.keys(e).every(n=>e[n]===t[n])}serializeRulesResults(e){return this.rules.map(t=>this.testCondition(t.condition,e)?"1":"0").join("")}flattenStyle(e){return Object.assign({},...e)}}i.DEFAULT_SETTINGS=Symbol();class a extends i{registerStyle(e){return Object(o.e)(e)}static rule(e,t){return{condition:e,style:t}}static always(e){return{condition:{},style:e}}}class s extends i{registerStyle(e){return r.StyleSheet.createViewStyle(e)}static rule(e,t){return{condition:e,style:t}}static always(e){return{condition:{},style:e}}}},function(e,t,n){"use strict";n.d(t,"m",(function(){return d})),n.d(t,"v",(function(){return l})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"l",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"k",(function(){return C})),n.d(t,"q",(function(){return y})),n.d(t,"h",(function(){return v})),n.d(t,"t",(function(){return T})),n.d(t,"r",(function(){return S})),n.d(t,"j",(function(){return I})),n.d(t,"o",(function(){return O})),n.d(t,"s",(function(){return E})),n.d(t,"f",(function(){return P})),n.d(t,"i",(function(){return k})),n.d(t,"g",(function(){return R})),n.d(t,"x",(function(){return x})),n.d(t,"n",(function(){return D})),n.d(t,"w",(function(){return w})),n.d(t,"u",(function(){return A})),n.d(t,"d",(function(){return j}));var r=n(92),o=n(24),i=n(7),a=n(23),s=n(87),c=n(103);const d=e=>e.commentState.contextState.isReadOnly,l=e=>e.commentState.topVisibleThreadId,u=e=>e.commentState.personaIconPropertiesMap,p=e=>e.commentState.cardViewState,h=e=>e.commentState.highlightedCommentId,f=e=>Object(a.e)(e.commentState)?e.commentState.postData:e.commentState.commentData,m=e=>Object(a.e)(e.commentState)?e.commentState.commentThreadIds:e.commentState.commentData,g={},b=e=>Object(a.e)(e.commentState)?e.commentState.cardPostIds:g,C=e=>m(e).length>0,y=e=>e.commentState.postViewState,v=e=>e.commentState.draftState,T=e=>Object(i.K)(v(e)),S=e=>e.commentState.selectedComment,I=e=>e.commentState.expandedComments,O=e=>e.commentState.pendingCommentLoad,E=e=>e.commentState.selectedThreadIdBeforeCommentSession,P=e=>e.commentState.contextState,k=(e,t,n)=>Object(i.G)(v(e),t,n),R=(e,t,n)=>e.commentState.createdCommentLie&&k(e,t,n)?e.commentState.createdCommentLie:void 0,x=()=>Object(r.createSelector)([m,b,f,c.b,s.c],o.m),D=e=>e.commentState.modelCapabilities,w=()=>Object(r.createSelector)(v,e=>{var t;return null===(t=Object(i.K)(e))||void 0===t?void 0:t.renderContextType}),A=e=>e.commentState.suggestionsDetails,j=(e,t)=>t?Object(a.b)(f(e),t):void 0},function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.FullPane=1]="FullPane",e[e.HalfPane=2]="HalfPane",e[e.DiscreteIntegrated=4]="DiscreteIntegrated",e[e.DiscreteIsolated=5]="DiscreteIsolated"}(r||(r={})),t.a=r},function(e,t,n){"use strict";n.d(t,"P",(function(){return A})),n.d(t,"N",(function(){return j})),n.d(t,"z",(function(){return _})),n.d(t,"e",(function(){return F})),n.d(t,"l",(function(){return M})),n.d(t,"y",(function(){return N})),n.d(t,"m",(function(){return L})),n.d(t,"t",(function(){return B})),n.d(t,"o",(function(){return H})),n.d(t,"h",(function(){return U})),n.d(t,"g",(function(){return V})),n.d(t,"U",(function(){return W})),n.d(t,"k",(function(){return z})),n.d(t,"j",(function(){return K})),n.d(t,"M",(function(){return G})),n.d(t,"v",(function(){return q})),n.d(t,"x",(function(){return $})),n.d(t,"w",(function(){return Y})),n.d(t,"T",(function(){return J})),n.d(t,"a",(function(){return Q})),n.d(t,"W",(function(){return X})),n.d(t,"R",(function(){return Z})),n.d(t,"X",(function(){return ee})),n.d(t,"n",(function(){return te})),n.d(t,"A",(function(){return ne})),n.d(t,"C",(function(){return oe})),n.d(t,"E",(function(){return ie})),n.d(t,"D",(function(){return ae})),n.d(t,"fb",(function(){return se})),n.d(t,"O",(function(){return de})),n.d(t,"F",(function(){return le})),n.d(t,"bb",(function(){return ue})),n.d(t,"p",(function(){return pe})),n.d(t,"q",(function(){return he})),n.d(t,"B",(function(){return fe})),n.d(t,"G",(function(){return me})),n.d(t,"b",(function(){return ge})),n.d(t,"L",(function(){return Ce})),n.d(t,"u",(function(){return ye})),n.d(t,"Y",(function(){return Se})),n.d(t,"db",(function(){return Ie})),n.d(t,"eb",(function(){return Oe})),n.d(t,"cb",(function(){return Ee})),n.d(t,"H",(function(){return Pe})),n.d(t,"I",(function(){return Re})),n.d(t,"J",(function(){return xe})),n.d(t,"K",(function(){return De})),n.d(t,"Z",(function(){return we})),n.d(t,"V",(function(){return Ae})),n.d(t,"ab",(function(){return je})),n.d(t,"S",(function(){return _e})),n.d(t,"c",(function(){return Fe})),n.d(t,"f",(function(){return Me})),n.d(t,"Q",(function(){return Ne})),n.d(t,"i",(function(){return Le})),n.d(t,"d",(function(){return Be})),n.d(t,"s",(function(){return He})),n.d(t,"r",(function(){return Ue}));var r=n(8);function o(e,t){var n=e.filter(t);return n.length===e.length?e:n}var i=n(0),a=n(45),s=n(55),c=n(192),d=n(145),l=n(86),u=n(37),p=n(63),h=n(80),f=n(6),m=n(54),g=n(15),b=(n(72),n(60)),C=n(112),y=n(21),v=n(61),T=n(2),S=n(62),I=n(65),O=n(19),E=n(59),P=n(100),k=n(17),R=n(23),x=n(153),D=n(141),w=n(173);function A(e){return""===e||null===e?void 0:e}function j(e){return e.state===E.a.Placeholder||e.state===E.a.Loading}function _(e,t,n){var r,o;return Object(R.c)(e)?null!==(o=null===(r=t[n])||void 0===r?void 0:r.map(t=>e[t]))&&void 0!==o?o:[]:e.filter(e=>Object(u.b)(e)===n)}function F(e){return{commentId:e,commentBody:Object(C.b)(),author:{UserId:"",Provider:"",DisplayName:""},parentId:"",commentFlags:0}}function M(e,t){const n=t?Object(R.e)(t)?{commentThreadIds:[...t.commentThreadIds],cardPostIds:Object.assign({},t.cardPostIds),postData:Object.assign({},t.postData)}:{commentData:[...t.commentData,...e]}:T.X()?{commentThreadIds:[],cardPostIds:{},postData:{}}:{commentData:e};if(!Object(R.d)(n))return n;let r=void 0;return e.forEach(e=>{if(Object(u.a)(e))n.commentThreadIds.push(e.commentId),n.cardPostIds[e.commentId]=[e.commentId],r=e.commentId;else if(r===e.parentId)n.cardPostIds[e.parentId].push(e.commentId);else{if(!n.cardPostIds[e.parentId])return void Object(i.i)().assertConditionTag(!1,"Orphaned post detected on processing comments array. Omitting storing data.",528773920);n.cardPostIds[e.parentId]=[...n.cardPostIds[e.parentId],e.commentId],r=e.parentId}n.postData[e.commentId]=e}),n}function N(e,t,n){const r={};for(let o=0;o<e.length;++o)r[e[o].commentId]=L(!T.X()&&t.includes(Object(u.b)(e[o]))?H(e[o].date,e[o].displayDate,n.dataCulture):e[o].displayDate);return r}function L(e){return{displayDate:e,displayingErrorUI:!1,pending:P.a.None}}function B(e){return{displayDate:e}}function H(e,t,n){return t||(!e||isNaN(e.getDate())?"":m.a(e,n))}function U(e,t,n,r){var o;let a=void 0,s=!1;for(let c=0;c<n.length;c++){if(Object(u.b)(n[c])!==e){if(s)break;continue}s=!0,Object(i.i)().assertConditionTag(!!t[n[c].commentId],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",540112392);const d=null!==(o=t[n[c].commentId])&&void 0!==o?o:L(void 0);d.displayDate||(a||(a=Object.assign({},t)),a[n[c].commentId]=Object.assign(Object.assign({},d),{displayDate:H(n[c].date,n[c].displayDate,r.dataCulture)}))}return a}function V(e,t,n,r){let o=void 0;return e.forEach(e=>{var a;if(n[e]){Object(i.i)().assertConditionTag(!!t[e],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",538035351);const s=null!==(a=t[e])&&void 0!==a?a:L(void 0);s.displayDate||(o||(o=Object.assign({},t)),o[e]=Object.assign(Object.assign({},s),{displayDate:H(n[e].date,n[e].displayDate,r.dataCulture)}))}}),o}function W(e,t){const n=Object.assign({},e);return t.forEach(e=>delete n[e]),n}function z(e,t){const n={};for(let r=0;r<e.length;++r)""===e[r].parentId&&(n[e[r].commentId]=K(void 0,t));return n}function K(e,t){return q(e,t===E.a.Loading||t===E.a.Placeholder?{state:t,initialItemCount:1}:{state:null!=t?t:E.a.Loaded})}function G(e){const t={};for(const n of e)t[n.threadId]=q(void 0,{state:E.a.Placeholder,initialItemCount:n.itemCount});return t}function q(e,t){return{loadState:null!=t?t:{state:E.a.Loaded},pending:I.a.None,alternateId:e}}function $(e){const t={};return t[e]={pending:P.a.Post,displayDate:void 0,displayingErrorUI:!1},t}function Y(e){const t={};return t[e]={pending:I.a.Card,loadState:{state:E.a.Loaded},alternateId:e},t}function J(e,t){const n=Object.assign({},e);return t.forEach(e=>delete n[e]),n}function Q(e,t,n){const r=Z(e,t,n);if(!t||r.includes(t.selectedCardId))return r;const o=De(n);return o&&o.threadId===t.selectedCardId?[o.threadId]:o&&r.includes(o.threadId)?[t.selectedCardId,o.threadId]:[t.selectedCardId]}function X(e,t,n,r){if(!t.includes(e))return t;const o=De(n);return o&&o.threadId===e?t:r&&Object(k.j)(r.selectionDetails)?(Object(i.i)().assertConditionTag(!1,"Trying to collapse a card while it has a selected post",570529298),t):o&&t.includes(o.threadId)?[o.threadId]:[]}function Z(e,t,n){const r=De(n);return o(e,e=>e===(null==t?void 0:t.selectedCardId)||e===(null==r?void 0:r.threadId))}function ee(e,t,n){const r=De(n);return o(e,e=>t[e]||e===(null==r?void 0:r.threadId))}function te(e){return{selectedCardId:e,selectionDetails:{lowFidelityWarningType:void 0}}}function ne(e,t){var n;const r=e.draftState.postIdToDraftIdMap[t];if(!r)return e.selectedComment;const o=e.draftState.drafts[r];if(!o.isInCurrentContext)return(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)===o.threadId?void 0:e.selectedComment;const i=Object(R.b)(Object(R.a)(e),t);if(!i)throw new y.a(v.k,589103587,-2130957563);return te(Object(u.b)(i))}function re(e,t){return{selectedCardId:e,selectionDetails:{selectedPostId:t,lowFidelityWarningType:void 0}}}function oe(e,t){switch(t.sessionConfiguration.sessionType){case"CREATE":return te(t.sessionConfiguration.draftId);case"EDIT":return function(e,t){const n=Object(R.b)(e,t);if(n)return re(Object(u.b)(n),t);throw new y.a(v.f,589103616,-2130957556)}(e,t.sessionConfiguration.commentId);case"REPLY":return function(e,t){const n=Object(R.b)(e,t);if(n&&""===n.parentId)return te(t);throw new y.a(v.f,589103617,-2130957556)}(e,t.sessionConfiguration.threadId);default:throw new y.a(v.e,589103618,-2130957532)}}function ie(e){switch(e.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":return te(e.threadId);case"EDIT":return re(e.threadId,e.commentDraft.sessionConfiguration.commentId);default:throw new y.a(v.e,577610274,-2130957532)}}function ae(e,t,n){return(null==t?void 0:t.selectedCardId)===e&&Object(k.j)(t.selectionDetails)&&!Object(O.l)(n)?te(e):t}function se(e,{payload:t}){return{selectedCardId:t.selectedCard,selectionDetails:ce(e,t)}}function ce(e,t){if(t.selectType===S.a.SelectPost)return e&&Object(k.j)(e.selectionDetails)&&t.selectedPost===e.selectionDetails.selectedPostId?e.selectionDetails:{selectedPostId:t.selectedPost,lowFidelityWarningType:void 0};return{lowFidelityWarningType:e&&!Object(k.j)(e.selectionDetails)&&t.selectedCard===e.selectedCardId?e.selectionDetails.lowFidelityWarningType:void 0}}function de(e){return e===Object(g.t)()}function le(e,t,n){var r;const o=t.payload.params;return Object(l.f)(o)?te(n):Object(l.e)(o)?{selectedCardId:n,selectionDetails:{lowFidelityWarningType:void 0,selectedPostId:o.commentId}}:T.H()||T.x()?te(null!==(r=null==e?void 0:e.selectedCardId)&&void 0!==r?r:n):te(Object(g.t)())}function ue(e,t,n){if("CLEAR_COMMENT_SELECTION"===n.type)return!!t&&!Object(O.l)(e);if(!t)return!0;if(Object(O.l)(e))return n.payload.selectedCard===t.selectedCardId&&!Object(k.j)(t.selectionDetails)&&n.payload.selectType===S.a.ExpandCard;if(n.payload.selectedCard===t.selectedCardId)switch(n.payload.selectType){case S.a.SelectCard:return Object(k.j)(t.selectionDetails);case S.a.Polite:return!1;case S.a.SelectPost:case S.a.ExpandCard:return!0;default:Object(r.m)(n.payload)}return!0}function pe(e){const t={};return e.commentId&&(t[e.commentId]={pending:I.a.None,loadState:{state:E.a.Loaded},alternateId:e.commentId}),t}function he(e){const t={};return e.commentId&&(t[e.commentId]={pending:P.a.None,displayDate:void 0,displayingErrorUI:!1}),t}function fe(e,t){return e&&e.selectedCardId===t.payload.commentId?te(t.payload.commentId):e}function me(e,t,n){if(e.pendingDraft&&"CREATE"===e.pendingDraft.sessionType)return Object(g.t)();if(e.committedLieId)return e.committedLieId;const r=De(e);return!r||"CREATE"!==r.commentDraft.sessionConfiguration.sessionType||t&&!r.isInCurrentContext||n&&r.renderContextType!==n&&r.renderContextType!==f.a.None?void 0:r.commentDraft.sessionConfiguration.draftId}function ge(e,t,n,r){if(!me(r,!0))return e;const o=me(r);if(!e||!o||!n[o]||n[o].pending!==I.a.None)return;if(T.X())return e;const i=Object.assign({},e),a=t.length;if(i.index>=a)i.index=a;else if(i.index>=0&&t[i.index].parentId){const e=new d.b(t,i.index);e.next().done?i.index=a:i.index=e.currentIndex()}return i}function be(e,t,n){if(!t)return-1;const r=n?t.selectedCardId:Object(k.b)(t);return e.findIndex(e=>e.commentId===r)}function Ce(e,t){return Object(R.f)(e)?t?e.findIndex(e=>e===t.selectedCardId):-1:be(e,t,!0)}function ye(e,t,n){if(Object(R.f)(e)){if(!n||!t[n.selectedCardId])return-1;const e=Object(k.b)(n);return t[n.selectedCardId].findIndex(t=>t===e)}return be(e,n,!1)}function ve(e,t){const n=Object.assign({},e);return n[t]&&delete n[t],n}function Te(e,t){if(void 0===t)return Object(i.i)().assertConditionTag(0===Object.keys(e).length,"Invalid number of drafts.",593762516),e;Object(i.i)().assertConditionTag(1===Object.keys(e).length,"Invalid number of drafts.",593762517),Object(i.i)().assertConditionTag(!!e[t.sessionConfiguration.draftId],"Draft is not in map",593762518);const n=Object.assign({},e);return delete n[t.sessionConfiguration.draftId],n}function Se(e){return Object(D.a)(e)===h.a.CanAutoDiscard?Object(O.h)():e}function Ie(e,t,n,r,o,i){let a,s;if(e.pendingDraft)switch(e.pendingDraft.sessionType){case"REPLY":if(a=e.pendingDraft.threadId,!t[a])return e;break;case"EDIT":if(s=e.pendingDraft.commentId,!r[s])return e;break;default:return e}else{const t=De(e);if(!t||!t.isInCurrentContext)return e;switch(t.commentDraft.sessionConfiguration.sessionType){case"REPLY":a=t.threadId;break;case"EDIT":s=t.commentDraft.sessionConfiguration.commentId;break;default:return e}}if(a&&!n[a]){const t=Ae(e,a);return Object(x.b)(e,t,3,i,539297118),t}if(s&&!o[s]){const t=je(e,s);return Object(x.b)(e,t,2,i,539297119),t}return e}function Oe(e,t){const n=Object.assign({},e.drafts);let r=!1;return Object.keys(n).forEach(e=>{const o=t(e);o!==n[e].renderContextType&&(n[e]=Object.assign(Object.assign({},n[e]),{renderContextType:o}),r=!0)}),r?Object.assign(Object.assign({},e),{drafts:n}):e}function Ee(e,t){if(t===p.a.Closed){if(Object(b.c)(e))return f.a.None}else if(e===f.a.DiscreteIntegrated)return f.a.FullPane;return e}function Pe(e){const t=De(e);return t?t.commentDraft:void 0}function ke(e){const t=Object.keys(e);if(t.length>1)throw Object(i.i)().assertConditionTag(!1,"Invalid number of drafts.",593762519),new y.a("Only a single draft is supported at this time.",589103619,-2130957551);if(0!==t.length)return t[0]}function Re(e){return ke(e.cardIdToDraftIdMap)}function xe(e){return ke(e.postIdToDraftIdMap)}function De(e){const t=e.drafts,n=ke(t);return n?t[n]:void 0}function we(e){const t=e.drafts,n=Object.keys(t).filter(e=>{var n;return null===(n=t[e])||void 0===n?void 0:n.isInCurrentContext}).map(e=>t[e]);if(0===n.length)return e;let o=Object.assign({},e);for(const e of n)switch(e.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":case"METADATA":Object(i.i)().assertConditionTag("METADATA"!==e.commentDraft.sessionConfiguration.sessionType,"Metadata session removed on context change, but metadata sessions should not be long lived.",545630307),o=Ae(o,e.threadId);break;case"EDIT":o=je(o,e.commentDraft.sessionConfiguration.commentId);break;default:Object(r.m)(e.commentDraft.sessionConfiguration)}return o}function Ae(e,t){var n;const r=e.pendingDraft&&Object(l.f)(e.pendingDraft)&&e.pendingDraft.threadId===t,o=e.cardIdToDraftIdMap[t];return o?Object.assign(Object.assign({},e),{drafts:Te(e.drafts,null===(n=e.drafts[o])||void 0===n?void 0:n.commentDraft),cardIdToDraftIdMap:ve(e.cardIdToDraftIdMap,t),pendingDraft:r?void 0:e.pendingDraft}):r?Object.assign(Object.assign({},e),{pendingDraft:void 0}):e}function je(e,t){var n;const r=e.pendingDraft&&Object(l.e)(e.pendingDraft)&&e.pendingDraft.commentId===t,o=e.postIdToDraftIdMap[t];return o?Object.assign(Object.assign({},e),{drafts:Te(e.drafts,null===(n=e.drafts[o])||void 0===n?void 0:n.commentDraft),postIdToDraftIdMap:ve(e.postIdToDraftIdMap,t),pendingDraft:r?void 0:e.pendingDraft}):r?Object.assign(Object.assign({},e),{pendingDraft:void 0}):e}function _e(e,t,n){let r=Ae(e,t);const o=xe(r);if(o){const e=r.postIdToDraftIdMap[o],n=r.drafts[e];n&&n.threadId===t&&(r=je(r,o))}if(r.pendingDraft&&Object(l.e)(r.pendingDraft)){const e=r.pendingDraft.commentId,o=n.find(t=>t.commentId===e);o&&Object(u.b)(o)===t&&(r=Object.assign(Object.assign({},r),{pendingDraft:void 0}))}return r}function Fe(e){return(e.tasks===c.a.Unknown||e.tasks===c.a.Enabled)&&T.b()}function Me(e,t){return n=De(e),!(!(r=De(t))||!r.draftWarningState||n&&n.draftWarningState&&r.commentDraft.sessionConfiguration.draftId===n.commentDraft.sessionConfiguration.draftId&&r.draftWarningState.warningCounter===n.draftWarningState.warningCounter);var n,r}function Ne(e,t,n){var o;let i=e.pendingCommentLoad,a=void 0,s=e.expandedComments;if(e.pendingCommentLoad){const o=e.pendingCommentLoad.selectedThreadIndex;if(!Object(R.d)(t)&&void 0!==o&&Object(w.a)({commentData:t.commentData,pendingCommentLoad:i,virtualized:n})){const n=Object(R.d)(t)?t.commentThreadIds:t.commentData.filter(u.a);if(!(o>=0&&o<n.length))throw Object(r.i)("selectedThreadIndex out of bounds"),new y.a(v.l,589103620,-2130957565);a=te(Object(R.f)(n)?n[o]:n[o].commentId),s=Q(s,a,e.draftState)}(Object(R.d)(t)?t.commentThreadIds.length===e.pendingCommentLoad.numberOfThreads:t.commentData.length===e.pendingCommentLoad.numberOfComments)&&(i=void 0)}if(e.selectedComment)if(T.Y()){const t=De(e.draftState);(null!==(o=null==t?void 0:t.threadId)&&void 0!==o?o:me(e.draftState))===e.selectedComment.selectedCardId&&(a=e.selectedComment,s=e.expandedComments)}else Object(O.d)(e.draftState)&&(a=e.selectedComment,s=e.expandedComments);return{pendingCommentLoad:i,selectedComment:a,expandedComments:s}}function Le(e,t){const n=Object(R.b)(e,t);return(null==n?void 0:n.author.DisplayName)&&(null==n?void 0:n.date)?{valid:!0,matchesCurrentUser:!!(null==n?void 0:n.author.IsCurrentUser),timeElapsed:(null==n?void 0:n.date)?Date.now()-n.date.getTime():0}:{valid:!1}}function Be(e,t,n){if(Object(R.c)(t)){if(!Object(R.f)(e))throw new Error("ThreadData and CommentData must align if Map-Based");return n?e.some(e=>!(t[e].commentFlags&s.a.Resolved)):e.length>0}return n?t.filter(e=>""===e.parentId&&!(e.commentFlags&s.a.Resolved)).length>0:t.length>0}function He(){return{atMention:a.b.Unknown,newThread:!1,resolve:!1,richTextCapabilities:0,tasks:c.a.Unknown,virtualized:!1,presentLinkToComment:!1,UIAAnnotationPattern:!1}}function Ue(e,t){const n=e.cardIdToDraftIdMap[t.commentId],r=n?e.drafts[n].commentDraft:void 0;if(void 0===r)return Object(i.i)().assertConditionTag(0===Object.keys(e.drafts).length,"Could not find draft for adding smart replies",590202465),e;const o=t.smartReplies,a=r.sessionConfiguration.sessionType,s=o.length;return"REPLY"===a&&(s<=3&&s>0)?Object.assign(Object.assign({},e),{drafts:Object.assign(Object.assign({},e.drafts),{[n]:Object.assign(Object.assign({},e.drafts[n]),{smartReplies:o})})}):e}},function(e,t,n){"use strict";n.d(t,"i",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"j",(function(){return c})),n.d(t,"c",(function(){return r})),n.d(t,"k",(function(){return d})),n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return f})),n.d(t,"g",(function(){return m})),n.d(t,"l",(function(){return g})),n.d(t,"e",(function(){return h})),n.d(t,"a",(function(){return C})),n.d(t,"m",(function(){return y})),n.d(t,"n",(function(){return v}));n(323);var r,o,i=!1,a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]};!function(e){e[e.None=0]="None",e[e.Redux=1]="Redux",e[e.Comments=2]="Comments"}(r||(r={}));function d(e,t){if(o){var n=null===window||void 0===window?void 0:window.performance;if(n&&"function"==typeof n.measure&&"function"==typeof n.mark)return new o(e,t,n)}}function l(e,t){return void 0===t&&(t=0),e?e.split("\n").slice(1+t,i?void 0:2+t).join("\n"):"<unable to get stack>"}function u(){try{throw new Error}catch(e){return e instanceof Error?l(e.stack,1):""}}var p=Boolean;function h(e,t,n,r){return[f.enableMessageLogging&&n?n:void 0,"Tag: ".concat(e),f.enableStackLogging?t:void 0,r?"----------\nInner exception: ".concat(g(r)):void 0].filter(p).join("\n")}var f=function e(t,n,r){var o=function(e,t,n){return new Error(h(t,(new Error).stack,e,n))}(t,n,r);return o.name="StructuredError",o.innerException=r,o.tag=n,Object.setPrototypeOf(o,Object.getPrototypeOf(this)),Error.captureStackTrace&&Error.captureStackTrace(o,e),o};function m(e,t){return!(!e||!(e instanceof f||void 0!==e.isStructuredError)||t&&e.name!==t)}function g(e){if(m(e))return e.stringify();if(e instanceof Error){var t=f.enableUnknownMessageLogging&&e.message?" - ".concat(e.message):"";return"".concat(e.name).concat(t,":\n").concat(f.enableStackLogging?l(e.stack):"")}return f.enableUnknownMessageLogging&&"string"==typeof e?e:"Unknown error"}f.enableStackLogging=i,f.enableMessageLogging=i,f.enableUnknownMessageLogging=i,f.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0},stringify:{value:function(){return h(this.tag,this.stack,void 0,this.innerException)},enumerable:!1,writable:!0,configurable:!0},isStructuredError:{value:!0,enumerable:!1,writable:!1,configurable:!1}}),Object.setPrototypeOf?Object.setPrototypeOf(f,Error):f.__proto__=Error;var b=n(341),C=Object(b.a)(0);b.a;function y(e){throw new Error("Unreachable throw hit! Passed in value is ".concat(e,"."))}function v(e,t,n){if(!e)throw new f(t,n)}},function(e,t){e.exports=OfficePlatformGlobal.ReactNative.Components},function(e,t,n){"use strict";function r(e,t){return Object.assign(Object.assign({},e),{trackback:t})}function o(e,t,n){return{type:e,payload:t,actionDetail:n}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},function(e,t,n){"use strict";function r(e){return!!e&&void 0!==e.focus&&void 0!==e.blur}n.d(t,"n",(function(){return r})),n.d(t,"f",(function(){return s})),n.d(t,"o",(function(){return c})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u.a})),n.d(t,"c",(function(){return d})),n.d(t,"l",(function(){return p})),n.d(t,"q",(function(){return h})),n.d(t,"d",(function(){return m})),n.d(t,"s",(function(){return g})),n.d(t,"i",(function(){return b})),n.d(t,"j",(function(){return C})),n.d(t,"k",(function(){return y})),n.d(t,"u",(function(){return S})),n.d(t,"m",(function(){return k})),n.d(t,"r",(function(){return R})),n.d(t,"e",(function(){return D})),n.d(t,"p",(function(){return w})),n.d(t,"g",(function(){return A})),n.d(t,"h",(function(){return _})),n.d(t,"t",(function(){return O}));var o,i,a=n(1),s=a.createContext(void 0);function c(e){return!!e&&e.getFocusState&&e.getId&&e.getData&&e.getNextTabTarget&&e.isTabbable&&e.getChildNodes&&e.addChildNode&&e.getDescendantById&&r(e)}!function(e){e[e.Forward=0]="Forward",e[e.Reverse=1]="Reverse"}(o||(o={})),function(e){e[e.None=0]="None",e[e.Capturing=1]="Capturing",e[e.AtTarget=2]="AtTarget",e[e.Bubbling=3]="Bubbling"}(i||(i={}));var d,l,u=n(140);function p(e,t){if(!t)return e;switch(e){case d.ArrowLeft:return d.ArrowRight;case d.ArrowRight:return d.ArrowLeft;default:return e}}function h(e){switch(e){case"Down":return d.ArrowDown;case"Up":return d.ArrowUp;case"Left":return d.ArrowLeft;case"Right":return d.ArrowRight;case"OS":return d.Meta;case"Del":return d.Delete;case"Spacebar":return" ";case"Esc":return d.Escape;case"Ctrl":case"Ctl":return d.Control;case"F6":return d.F6;case"F12":return d.F12;default:return e}}!function(e){e.A="a",e.C="c",e.V="v",e.X="x",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowUp="ArrowUp",e.Backspace="Backspace",e.Control="Control",e.Delete="Delete",e.Enter="Enter",e.Escape="Escape",e.Meta="Meta",e.Tab="Tab",e.Home="Home",e.End="End",e.F6="F6",e.F12="F12",e.Space=" "}(d||(d={})),function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.Delete=46]="Delete",e[e.a=65]="a",e[e.b=66]="b",e[e.c=67]="c",e[e.d=68]="d",e[e.e=69]="e",e[e.f=70]="f",e[e.g=71]="g",e[e.h=72]="h",e[e.i=73]="i",e[e.j=74]="j",e[e.k=75]="k",e[e.l=76]="l",e[e.m=77]="m",e[e.n=78]="n",e[e.o=79]="o",e[e.p=80]="p",e[e.q=81]="q",e[e.r=82]="r",e[e.s=83]="s",e[e.t=84]="t",e[e.u=85]="u",e[e.v=86]="v",e[e.w=87]="w",e[e.x=88]="x",e[e.y=89]="y",e[e.z=90]="z",e[e.F6=117]="F6"}(l||(l={}));var f=n(3),m=[{key:d.Tab,eventPhase:i.AtTarget},{key:d.Tab,eventPhase:i.AtTarget,shiftKey:!0}],g=function(e,t){return e?e.map((function(e){return Object(f.a)(Object(f.a)({},e),{eventPhase:t})})):e},b=function(e,t){var n=e.filter((function(e){return e.eventPhase!==i.None}));return t&&(n=n.concat(m)),g(n,i.AtTarget)};function C(e){return e.useJSTabLoop?e.handleKeysDuringBubbling?[{key:d.Tab,eventPhase:i.Bubbling},{key:d.Tab,shiftKey:!0,eventPhase:i.Bubbling}]:[{key:d.Tab,eventPhase:i.Capturing},{key:d.Tab,shiftKey:!0,eventPhase:i.Capturing}]:[]}function y(e){return e.isFocusOn?u.a.FocusOn:e.isFocusWithin?u.a.FocusWithin:u.a.Unfocused}var v=n(223),T=function(){function e(e,t,n,r,o){this.nodeId=e,this.nodeData=t,this.tabbable=n,this.onFocusStateChange=r,this.focusState=o,this.registrationRef=a.createRef(),this.innerComponentRef=a.createRef()}return e.prototype.onEffect=function(e,t,n,r){this.nodeData=e,this.tabbable=t,this.onFocusStateChange=n;var o=this.focusState;this.focusState=r,y(o)!==y(this.focusState)&&(this.onFocusStateChange&&this.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},e.prototype.getIterator=function(){return Object(f.d)(this,(function(e){switch(e.label){case 0:return[4,this];case 1:return e.sent(),[2]}}))},e.prototype.getId=function(){return this.nodeId||""},e.prototype.getData=function(){return this.nodeData?this.nodeData():this},e.prototype.getFocusState=function(){return y(this.focusState)},e.prototype.getNextTabTarget=function(){return this.getFocusState()===u.a.Unfocused&&this.isTabbable()?this:void 0},e.prototype.isTabbable=function(){return!!this.tabbable},e.prototype.getChildNodes=function(){return[]},e.prototype.addChildNode=function(){throw new Error("Method not implemented.")},e.prototype.getDescendantById=function(){},e.prototype.focus=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.focus()},e.prototype.blur=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.blur()},e}();function S(e,t,n,r,o,i){var s=a.useRef(new T(e,t,n,r,{isFocusOn:o,isFocusWithin:i}));return v.b((function(e,t,n,r,o,i){i.current.onEffect(e,t,n,{isFocusOn:r,isFocusWithin:o})}),t,n,r,o,i,s),s}var I={logFocusDebugInfo:function(){}};function O(e){I=e}function E(){return I}function P(e,t){if(e){var n=e.getNextTabTarget(t,!1);return n||(E().logFocusDebugInfo("No next focus found - restarting loop"),n=e.getNextTabTarget(t,!0)),n?(E().logFocusDebugInfo("Next focus target: ".concat(n.getId())),n.focus()):E().logFocusDebugInfo("No next focus found"),n}}function k(e,t,n){var r=e.getFocusState();if(r!==u.a.FocusOn||n||t!==o.Reverse){if((r===u.a.Unfocused||n)&&t===o.Forward&&e.isTabbable())return e;var i=e.getChildNodes();t===o.Reverse&&i.reverse();for(var a=t===o.Forward&&r===u.a.FocusOn||n?0:i.findIndex((function(e){return e.getFocusState()!==u.a.Unfocused})),s=a>=0?a:0;s<i.length;++s){var c=i[s].getNextTabTarget(t,n);if(c)return c}return t===o.Reverse&&e.isTabbable()?e:void 0}}function R(e,t){if(t.nativeEvent.key!==d.Tab)return{wasHandled:!1};var n=t.nativeEvent.shiftKey?o.Reverse:o.Forward;return{wasHandled:!0,newTabTarget:P(e.getRoot(),n)}}var x=function(){var e=this;this.root=null,this.getRoot=function(){return e.root},this.setRoot=function(t){e.root=t}},D=function(){function e(e){var t=this;this.viewTreeMap=new Map,e&&e.viewTreeMap.forEach((function(e,n){return t.viewTreeMap.set(n,e)}))}return e.prototype.updateIdForViewTree=function(e,t){var n=this.viewTreeMap.get(e);return!!n&&(this.viewTreeMap.set(t,n),this.viewTreeMap.delete(e),!0)},e.prototype.getOrCreateViewTreeById=function(e){var t=this.viewTreeMap.get(e);return t||(t=new x,this.viewTreeMap.set(e,t)),t},e.prototype.getViewTrees=function(){return this.viewTreeMap.values()},e.prototype.getDescendantById=function(e){var t,n,r;try{for(var o=Object(f.h)(this.viewTreeMap.values()),i=o.next();!i.done;i=o.next()){var a=null===(r=i.value.getRoot())||void 0===r?void 0:r.getDescendantById(e);if(a)return a}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},e}();function w(e){return function(){var t,n,r,o,i,a,s,c;return Object(f.d)(this,(function(d){switch(d.label){case 0:return[4,e];case 1:d.sent(),d.label=2;case 2:d.trys.push([2,8,9,10]),t=Object(f.h)(e.getChildNodes()),n=t.next(),d.label=3;case 3:if(n.done)return[3,7];r=n.value,o=r.getIterator(),i=void 0,d.label=4;case 4:return(i=o.next()).done?[3,6]:[4,i.value];case 5:return d.sent(),[3,4];case 6:return n=t.next(),[3,3];case 7:return[3,10];case 8:return a=d.sent(),s={error:a},[3,10];case 9:try{n&&!n.done&&(c=t.return)&&c.call(t)}finally{if(s)throw s.error}return[7];case 10:return[2]}}))}()}var A=function(){function e(){var e=this;this.ref=a.createRef(),this.focus=function(){e.ref&&e.ref.current&&e.ref.current.focus()},this.blur=function(){e.ref&&e.ref.current&&e.ref.current.blur()},this.getFocusState=function(){return e.ref&&e.ref.current?e.ref.current.getFocusState():u.a.Unfocused},this.getNextTabTarget=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.getNextTabTarget(t,n)},this.isTabbable=function(){return!(!e.ref||!e.ref.current)&&e.ref.current.isTabbable()},this.getChildNodes=function(){return e.ref&&e.ref.current?e.ref.current.getChildNodes():[]},this.addChildNode=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.addChildNode(t,n)},this.getId=function(){return e.ref&&e.ref.current?e.ref.current.getId():""},this.getData=function(){if(e.ref&&e.ref.current)return e.ref.current.getData()},this.getDescendantById=function(t){if(e.ref&&e.ref.current)return e.ref.current.getDescendantById(t)},this.getIterator=function(){return e.ref&&e.ref.current?e.ref.current.getIterator():{next:function(){return{done:!0,value:e}}}}}return Object.defineProperty(e.prototype,"disabled",{get:function(){return!(!this.ref.current||!this.ref.current.disabled)},enumerable:!1,configurable:!0}),e}(),j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationToken=void 0,t.onFocusStateChange=function(e){t.registrationToken&&t.registrationToken.onFocusStateChange(e)},t}return Object(f.c)(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.parentNode&&(this.registrationToken=this.props.parentNode.addChildNode(this.props.node,(function(){return e.props.position})))},t.prototype.componentWillUnmount=function(){this.registrationToken&&(this.registrationToken.unregister(),this.registrationToken=void 0)},t.prototype.render=function(){return a.Children.only(this.props.children)},t}(a.PureComponent),_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationHelperRef=a.createRef(),t.onFocusStateChange=function(e){t.registrationHelperRef.current&&t.registrationHelperRef.current.onFocusStateChange(e)},t}return Object(f.c)(t,e),t.prototype.render=function(){var e=this;return a.createElement(s.Consumer,null,(function(t){return a.createElement(j,{parentNode:t,node:e.props.node,ref:e.registrationHelperRef,position:e.props.position},e.props.children)}))},t}(a.PureComponent)},function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return h})),n.d(t,"f",(function(){return f}));var r=n(0),o=n(9),i=n(29);function a(e){return o.StyleSheet.create({style:e}).style}const s=a({flex:1}),c=a({flex:0}),d=a({overflow:"hidden"}),l=1e3;function u(e,t=0,n=0,r=0,i=0){const a=o.StyleSheet.flatten(e),s={padding:a.padding,paddingTop:a.paddingTop,paddingRight:a.paddingRight,paddingBottom:a.paddingBottom,paddingLeft:a.paddingLeft,paddingHorizontal:a.paddingHorizontal,paddingVertical:a.paddingVertical},c={};Object.keys(s).forEach(e=>c[e]="string"==typeof s[e]?0:s[e]);const d=(...e)=>e.find(e=>void 0!==e,e),l={};return t&&(l.paddingTop=(d(c.paddingTop,c.paddingVertical,c.padding)||0)+t),n&&(l.paddingRight=(d(c.paddingRight,c.paddingHorizontal,c.padding)||0)+n),r&&(l.paddingBottom=(d(c.paddingBottom,c.paddingVertical,c.padding)||0)+r),i&&(l.paddingLeft=(d(c.paddingLeft,c.paddingVertical,c.padding)||0)+i),[e,l]}function p(e,t){return 2!==t.length?(Object(r.i)().assertConditionTag(!1,"Invalid alpha value provided",578348938),e):!e.startsWith("#")||7!==e.length&&9!==e.length?(Object(r.i)().assertConditionTag(!1,"setAlpha only supports colors in #RRGGBB or #RRGGBBAA format",578348939),e):7===e.length?e+t:e.substr(0,7)+t}function h(e,t,n){return e.renderWithSettings(Object(i.c)(n),t)}function f(e,t,n){return e.renderWithSettings(Object(i.c)(n),t)}},function(e,t,n){"use strict";n.d(t,"h",(function(){return r.a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"i",(function(){return d.a})),n.d(t,"j",(function(){return l.a})),n.d(t,"k",(function(){return u})),n.d(t,"l",(function(){return p})),n.d(t,"m",(function(){return h})),n.d(t,"n",(function(){return f})),n.d(t,"o",(function(){return m.a})),n.d(t,"p",(function(){return g})),n.d(t,"q",(function(){return b.a})),n.d(t,"r",(function(){return C})),n.d(t,"a",(function(){return y.a})),n.d(t,"s",(function(){return v.a})),n.d(t,"t",(function(){return T})),n.d(t,"u",(function(){return S})),n.d(t,"v",(function(){return I})),n.d(t,"w",(function(){return O})),n.d(t,"x",(function(){return E})),n.d(t,"y",(function(){return P})),n.d(t,"H",(function(){return k})),n.d(t,"z",(function(){return R})),n.d(t,"A",(function(){return x})),n.d(t,"B",(function(){return D.a})),n.d(t,"C",(function(){return w})),n.d(t,"D",(function(){return A})),n.d(t,"E",(function(){return j})),n.d(t,"F",(function(){return _})),n.d(t,"G",(function(){return F})),n.d(t,"I",(function(){return M})),n.d(t,"J",(function(){return N})),n.d(t,"K",(function(){return L})),n.d(t,"L",(function(){return B})),n.d(t,"b",(function(){return H.a})),n.d(t,"R",(function(){return H.c})),n.d(t,"M",(function(){return H.b})),n.d(t,"N",(function(){return U})),n.d(t,"O",(function(){return V})),n.d(t,"P",(function(){return W})),n.d(t,"Q",(function(){return z})),n.d(t,"S",(function(){return K.a})),n.d(t,"T",(function(){return G})),n.d(t,"U",(function(){return q})),n.d(t,"V",(function(){return $})),n.d(t,"W",(function(){return Y})),n.d(t,"X",(function(){return J})),n.d(t,"Y",(function(){return Q})),n.d(t,"Z",(function(){return X})),n.d(t,"ab",(function(){return Z})),n.d(t,"bb",(function(){return ee})),n.d(t,"cb",(function(){return te})),n.d(t,"db",(function(){return ne.a})),n.d(t,"eb",(function(){return re})),n.d(t,"fb",(function(){return oe})),n.d(t,"gb",(function(){return ie}));var r=n(10);n(256);function o(e,t){return Object(r.b)("ADD_TO_CURRENT_MENTIONEES",{mentionee:t},e)}function i(e,t){return Object(r.b)("APPLY_COMMENT_CHANGES",{changes:t},e)}n(257),n(258),n(259),n(260),n(261);function a(e,t){return Object(r.b)("CANCEL_COMMENT_CREATE_THREAD",{closeOnDiscard:t},e)}function s(e,t,n){return Object(r.b)("CANCEL_COMMENT_POST_EDIT",{commentId:t,closeOnDiscard:n},e)}function c(e,t,n){return Object(r.b)("CANCEL_COMMENT_REPLY",{commentId:t,closeOnDiscard:n},e)}n(262);var d=n(263),l=n(264);function u(e){return Object(r.b)("CLEAR_LOW_FIDELITY_WARNING",void 0,e)}function p(e,t){return Object(r.b)("CLEAR_POST_ERROR_STATE",{commentId:t},e)}function h(e,t){return Object(r.b)("COLLAPSE_CARD",{cardId:t},e)}function f(e,t){return Object(r.b)("COMMENT_CONTEXT_CHANGED",t,e)}var m=n(265);n(198);function g(e,t){return Object(r.b)("DISPATCH_LOAD_THREADS",t,e)}var b=n(172);function C(e,t,n){return Object(r.b)("DRAFT_EMPTINESS_CHANGED",{isEmpty:t,draftId:n},e)}var y=n(159),v=(n(235),n(266));n(267);function T(e,t){return Object(r.b)("LOAD_DEFAULT_FILTER",t,e)}function S(e,t){return Object(r.b)("LOAD_FILTER",t,e)}n(236),n(268);function I(e,t){return Object(r.b)("MOVE_FOCUS_TO_CANVAS",{resource:t},e)}function O(e,t){return Object(r.b)("NEXT_POPULATED_CONTEXT_DETAILS_UPDATED",{nextPopulatedContextDetails:t},e)}function E(e,t){return Object(r.b)("ON_INITIAL_RENDER",t,e)}function P(e,t){return Object(r.b)("POPULATE_SMART_REPLY",t,e)}function k(e,t){return Object(r.b)("PRESENT_LINK_TO_COMMENT",{commentId:t},e)}function R(e,t){return Object(r.b)("QUEUE_LOAD_THREADS",t,e)}function x(e){return Object(r.b)("READY_TO_RENDER",{},e)}var D=n(269);function w(e,...t){return Object(r.b)("REMOVE_CONTENT_EXTENSION",{renderModes:t},e)}function A(e){return Object(r.b)("REQUEST_CLOSE_PANE",{},e)}function j(e,t){return Object(r.b)("REQUEST_DELETE_POST",{commentId:t},e)}function _(e,t,n){return Object(r.b)("REQUEST_DELETE_THREAD",{commentId:t,isTask:n},e)}function F(e,t,n,o){return Object(r.b)("REQUEST_MODAL_CONFIRMATION",{onConfirm:t,onCancel:n,displayStrings:o},e)}function M(e,t,n){return Object(r.b)("REQUEST_REOPEN_THREAD",{commentId:t,isTask:n},e)}function N(e){return Object(r.b)("REQUEST_SHOW_PANE",{},e)}function L(e,t,n){return Object(r.b)("REQUEST_THREAD_RESOLVE",{commentId:t,isTask:n},e)}n(237);function B(e,t){return Object(r.b)("SAVE_DRAFT",t,e)}var H=n(62);function U(e,t,n,o,i,a,s){return Object(r.b)("SELECT_CONTENT",{selectDirection:t,from:a,reason:s,iterableContentTypes:n,restrictToCurrentContext:o,preventLooping:i},e)}function V(e){return Object(r.b)("SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT",{},e)}function W(e){return Object(r.b)("SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT",{},e)}n(270);function z(e,t){return Object(r.b)("SET_FILTERING_CAPABILITIES",t,e)}var K=n(271);function G(e,t){return Object(r.b)("SHOW_POST_ERROR_STATE",{commentId:t},e)}function q(e){return Object(r.b)("TOGGLE_TASK_ASSIGNER_TYPE",{},e)}n(272),n(273);function $(e,t,n){return Object(r.b)("UPDATE_DRAFT_RENDER_CONTEXT",{isClaimingLock:t,draftId:n},e)}function Y(e,t){return Object(r.b)("UPDATE_DRAFT_THREAD",t,e)}function J(e,t){return Object(r.b)("UPDATE_EXTENSION_PRIORITY",{updates:t},e)}function Q(e,t){return Object(r.b)("UPDATE_FILTER_RANGE",t,e)}function X(e,t){return Object(r.b)("UPDATE_MENTIONEES_STILL_IN_DRAFT",{emailsStillInDraft:t},e)}function Z(e,t,n){return Object(r.b)("UPDATE_MODEL_STATE",{modelCapabilityFlags:t,richTextCapabilityFlags:n},e)}function ee(e,t){return Object(r.b)("UPDATE_SELECTED_TASK_ASSIGNEE",{selectedAssignee:t},e)}function te(e,t){return Object(r.b)("UPDATE_SELECTED_TASK_ASSIGNEES",{selectedAssignee:t},e)}var ne=n(274);function re(e,t){return Object(r.b)("VIEW_CONTAINER_CHANGED",{viewContainer:t},e)}function oe(e,t){return Object(r.b)("VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED",{foldableLayoutState:t},e)}function ie(e,t){return Object(r.b)("VIEW_CONTAINER_VISIBILITY_CHANGED",{visibilityState:t},e)}},function(e,t,n){"use strict";n.d(t,"e",(function(){return j})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return p}));var r,o=n(8),i=n(26);!function(e){e[e.Modify=1]="Modify",e[e.Remove=2]="Remove",e[e.Add=3]="Add",e[e.ReQuery=4]="ReQuery"}(r||(r={}));var a,s,c,d,l=n(3),u=n(424);function p(e){return e===a.Enabled_Default||e===a.Enabled_ForcePrimary}!function(e){e[e.Invalid=0]="Invalid",e[e.Disabled=1]="Disabled",e[e.Enabled_Default=2]="Enabled_Default",e[e.Enabled_ForcePrimary=3]="Enabled_ForcePrimary"}(a||(a={})),function(e){e[e.Empty=0]="Empty",e[e.CommentThread=1]="CommentThread",e[e.TrackedChange=2]="TrackedChange"}(s||(s={})),function(e){e[e.Disabled=0]="Disabled",e[e.Primary=1]="Primary",e[e.Secondary=2]="Secondary"}(c||(c={})),function(e){e[e.Integrated=0]="Integrated",e[e.Isolated=1]="Isolated",e[e.TaskPane=2]="TaskPane",e[e.TaskPaneItem=3]="TaskPaneItem"}(d||(d={}));var h=function(){function e(){this.store=new Map}return e.prototype.getInstanceIdForExtensionKey=function(e){var t;return this.store.forEach((function(n,r){if(n.has(e)){if(t)throw new o.d("Double registration across instances for an extension key.",589103766);t=r}})),t},e.prototype.insertExtension=function(e,t){var n=t.instanceId;this.store.has(n)||this.store.set(n,new Map);var r=this.store.get(n);if(r.has(e.extensionKey))throw new o.d("Duplicate Registration in same instance.",589103767);this.store.forEach((function(t,r){if(r!==n&&t.has(e.extensionKey))throw new o.d("Duplicate Registration in different instance.",589103768)})),r.set(e.extensionKey,t)},e.prototype.updateExtension=function(e,t){var n=this.getInstanceIdForExtensionKey(e);if(n){var r=this.store.get(n);if(r){var o=r.get(e);if(o)return o=Object(l.a)(Object(l.a)({},o),t),r.set(e,o),o}}},e.prototype.removeExtension=function(e){var t=this.getInstanceIdForExtensionKey(e);if(t){var n=this.store.get(t);if(n){var r=n.get(e);return n.delete(e),r}}},e.prototype.getExtension=function(e){var t=this.getInstanceIdForExtensionKey(e);if(t){var n=this.store.get(t);if(n)return n.get(e)}},e.prototype.getExtensionsByInstance=function(e){return this.store.get(e)},e}(),f=function(){function e(){this.onExtensionUpdated=new i.EventImpl((function(){})),this.extensionStore=new h}return e.prototype.triggerExtensionUpdated=function(e,t){this.onExtensionUpdated.trigger({extension:e,updateType:t})},e.prototype.registerExtension=function(e,t,n){var o,i=Object(u.b)(),a=null!==(o=n.priority)&&void 0!==o?o:c.Primary,s={extensionKey:i},l=n.renderMode===d.Isolated?{componentKey:t,contentType:e,priority:a,isContentAvailable:n.isContentAvailable,renderMode:n.renderMode,instanceId:n.instanceId,componentDimensions:n.componentDimensions}:{componentKey:t,contentType:e,priority:a,renderMode:n.renderMode,instanceId:n.instanceId,componentDimensions:n.componentDimensions};this.extensionStore.insertExtension(s,l);var p={id:i,state:l};return this.triggerExtensionUpdated(p,r.Add),p},e.prototype.unregisterExtension=function(e){var t=this.extensionStore.removeExtension(e);t&&this.triggerExtensionUpdated({id:e,state:t},r.Remove)},e.prototype.updateExtension=function(e,t){var n=this,o=function(t,r){t&&n.triggerExtensionUpdated({id:e,state:t},r)};t?o(this.extensionStore.updateExtension(e,t),r.Modify):o(this.extensionStore.getExtension(e),r.ReQuery)},e.prototype.getExtensions=function(e,t){var n=this.extensionStore.getExtensionsByInstance(t);if(!n)return[];var r=[];return n.forEach((function(t,n){t.contentType===e&&r.push({state:t,id:n})})),r},e.prototype.getExtension=function(e){var t=this.extensionStore.getExtension(e);if(void 0!==t)return{id:e,state:t}},e}(),m=["SDX::ContentExtension::ContentExtensionHostModule",{initializeExtensionModule:["FireAndForgetMethod",[]],onExtensionUpdate:["FireAndForgetMethod",[["$union",["SDX::ContentExtension::ExtensionRemovedEventArgs","SDX::ContentExtension::ExtensionModifiedEventArgs","SDX::ContentExtension::ExtensionAddedEventArgs"]]]]}],g={ContentExtensionHostModule:i.RekaServiceRegistry.getNativeService(m)},b=function(){function e(){if(!g.ContentExtensionHostModule)throw new Error("NativeService not available for ContentExtensionHostModule")}return e.prototype.initializeExtensionModule=function(){g.ContentExtensionHostModule.initializeExtensionModule()},e.prototype.onExtensionUpdate=function(e){g.ContentExtensionHostModule.onExtensionUpdate(e)},e}(),C=n(0);function y(e,t){var n=e.isContentAvailable(t),r=function(e,t){switch(e){case c.Primary:case c.Secondary:switch(t){case a.Invalid:case a.Disabled:return c.Disabled;case a.Enabled_Default:return e;case a.Enabled_ForcePrimary:return c.Primary}case c.Disabled:return e}}(e.priority,n),o=n!==a.Invalid;return{contentType:e.contentType,renderMode:e.renderMode,instanceId:e.instanceId,componentKey:e.componentKey,componentDimensions:e.componentDimensions,priority:r,contentId:t,isContentIdValid:o,type:"Isolated"}}var v,T=["SDX::ContentExtension::ContentExtensionHostService",{getExtensions:["ReturnsPromiseMethod",["$array","SDX::ContentExtension::ExtensionDescriptor"],["$number","$string"]],getExtensionState:["ReturnsPromiseMethod",["$optional",["$union",["SDX::ContentExtension::IntegratedExtensionSimple","SDX::ContentExtension::IsolatedExtensionSimple","SDX::ContentExtension::TaskPaneExtensionSimple","SDX::ContentExtension::TaskPaneItemExtensionSimple"]]],["SDX::ContentExtension::ExtensionDescriptor","$string"]],unregisterExtensionEventsForContentId:["FireAndForgetMethod",["$string","$string"]]}],S=function(){function e(e){var t=this;this.contentExtensionHostNativeModule=new b,this.trackedIsolatedExtensions=new Map,this.triggerIsolatedContentEnablementUpdate=function(e,n){var r=t.trackedIsolatedExtensions.get(e);r&&r.forEach((function(o,i){var a=y(n,i);(a.priority!==o.priority||a.isContentIdValid!==o.isContentIdValid)&&(t.contentExtensionHostNativeModule.onExtensionUpdate({type:"ExtensionModified",extensionKey:e,extension:a}),a.isContentIdValid||r.delete(i))}))},this.onExtensionUpdate=this.onExtensionUpdate.bind(this),e.onExtensionUpdated.subscribe(this.onExtensionUpdate)}return e.getInstance=function(){return this.instance},e.register=function(t){var n=this;this.instance||(this.instance=new e(t),i.RekaServiceRegistry.registerService({serviceInfo:this.ServiceInfo,factory:function(){return n.instance}}))},e.prototype.onExtensionUpdate=function(e){switch(e.updateType){case r.Add:var t={contentType:e.extension.state.contentType,extensionKey:e.extension.id,instanceId:e.extension.state.instanceId,renderMode:e.extension.state.renderMode};this.contentExtensionHostNativeModule.onExtensionUpdate({type:"ExtensionAdded",descriptor:t});break;case r.Modify:switch(e.extension.state.renderMode){case d.Integrated:var n={contentType:e.extension.state.contentType,renderMode:e.extension.state.renderMode,instanceId:e.extension.state.instanceId,componentKey:e.extension.state.componentKey,priority:e.extension.state.priority,componentDimensions:e.extension.state.componentDimensions,type:"Integrated"};this.contentExtensionHostNativeModule.onExtensionUpdate({type:"ExtensionModified",extensionKey:e.extension.id,extension:n});break;case d.Isolated:this.triggerIsolatedContentEnablementUpdate(e.extension.id,e.extension.state);break;case d.TaskPane:throw new o.d("Taskpane extension is not supported on this platform",573384474)}break;case r.ReQuery:e.extension.state.renderMode===d.Isolated&&this.triggerIsolatedContentEnablementUpdate(e.extension.id,e.extension.state);break;case r.Remove:this.contentExtensionHostNativeModule.onExtensionUpdate({type:"ExtensionRemoved",extensionKey:e.extension.id,instanceId:e.extension.state.instanceId});break;default:Object(o.m)(e.updateType)}},e.prototype.getExtensions=function(e,t){var n=O().getExtensions(e,t);return Promise.resolve(n.map((function(e){return{instanceId:t,contentType:e.state.contentType,extensionKey:e.id,renderMode:e.state.renderMode}})))},e.prototype.getExtensionState=function(e,t){var n,r,o=O().getExtension(e.extensionKey);if(void 0===o)return Promise.resolve(void 0);switch(o.state.renderMode){case d.Integrated:r={type:"Integrated",componentKey:o.state.componentKey,priority:o.state.priority,contentType:o.state.contentType,renderMode:o.state.renderMode,instanceId:o.state.instanceId,componentDimensions:o.state.componentDimensions};break;case d.Isolated:if(void 0===t)return Object(C.i)().assertConditionTag(!1,"No content ID provided for isolated extension state.",593081312),Promise.resolve(void 0);var i=y(o.state,t);this.trackedIsolatedExtensions.has(o.id)||this.trackedIsolatedExtensions.set(o.id,new Map),null===(n=this.trackedIsolatedExtensions.get(o.id))||void 0===n||n.set(t,i),r=i;break;case d.TaskPane:return Promise.reject(new Error("Taskpane RenderMode is not supported on this platform, for descriptor with extensionKey ".concat(e.extensionKey)));default:return Promise.reject(new Error("Unexpected RenderMode on ExtensionData for descriptor with extensionKey ".concat(e.extensionKey)))}return Promise.resolve(r)},e.prototype.unregisterExtensionEventsForContentId=function(e,t){var n,r;Object(C.i)().assertConditionTag(!!(null===(n=this.trackedIsolatedExtensions.get(e))||void 0===n?void 0:n.get(t)),"Unregistering for events for a content ID that is not cached.",593081313),null===(r=this.trackedIsolatedExtensions.get(e))||void 0===r||r.delete(t)},e.ServiceInfo=T,e}(),I=function(e){function t(){var t=e.call(this)||this;return t.contentExtensionHostModule=new b,t.contentExtensionHostModule.initializeExtensionModule(),t}return Object(l.c)(t,e),t.prototype.initialize=function(){S.register(this)},t}(f);function O(){if(void 0===v){var e=new I;e.initialize(),v=e}return v}!function(){function e(){}e.prototype.initializeExtensionModule=function(){},e.prototype.onExtensionUpdate=function(e){},e.ServiceInfo=m}();var E,P=function(){function e(e,t){this.extensionKey=e,this.scope=t}return e.prototype.getExtension=function(){var e=O().getExtension(this.extensionKey);if(!e||e.state.renderMode!==d.Integrated)throw Object(C.i)().assertConditionTag(!!e,"No extension data in provider. Querying a removed extension.",592316051),Object(C.i)().assertConditionTag((null==e?void 0:e.state.renderMode)===d.Integrated,"Extension data is not for the Integrated Render Mode.",592316052),new Error("Unable to query extension data within provider.");return{contentType:e.state.contentType,renderMode:e.state.renderMode,instanceId:e.state.instanceId,componentKey:e.state.componentKey,priority:e.state.priority,componentDimensions:e.state.componentDimensions,type:"Integrated"}},e}(),k=function(){function e(e,t){var n=this;this.extensionKey=e,this.scope=t,this.cachedExtensions={},this.onExtensionUpdate=function(e){e.updateType!==r.Remove?e.extension.id===n.extensionKey&&n.updateCachedExtensions():n.teardown()},this.teardown=function(){n.cachedExtensions={},n.subscription.unsubscribe()},this.subscription=O().onExtensionUpdated.subscribe(this.onExtensionUpdate)}return e.prototype.getExtension=function(e){var t=this,n=this.cachedExtensions[e];if(n)return n.extension;var r=O().getExtension(this.extensionKey);if(!r||r.state.renderMode!==d.Isolated)throw Object(C.i)().assertConditionTag(!!r,"No extension data in provider. Querying a removed extension.",592316053),Object(C.i)().assertConditionTag((null==r?void 0:r.state.renderMode)===d.Isolated,"Extension data is not for the Isolated Render Mode.",592316054),new Error("Unable to query extension data within provider.");var o=y(r.state,e),a=Object(l.a)(Object(l.a)({},o),{onUpdated:new i.EventImpl((function(n){var r=t.cachedExtensions[e];r&&(n?r.hasListener=!0:delete t.cachedExtensions[e])}))});return this.cachedExtensions[e]={extension:a,hasListener:!1},a},e.prototype.updateCachedExtensions=function(){var e=this,t=O().getExtension(this.extensionKey);if(!t||t.state.renderMode!==d.Isolated)return Object(C.i)().assertConditionTag(!!t,"No extension data in provider. Querying a removed extension.",592314635),void Object(C.i)().assertConditionTag((null==t?void 0:t.state.renderMode)===d.Isolated,"Extension data is not for the Isolated Render Mode.",592314636);var n=t.state;Object.keys(this.cachedExtensions).forEach((function(t){var r=e.cachedExtensions[t],o=null==r?void 0:r.extension;if(o&&r){var i=y(n,t);(o.priority!==i.priority||o.isContentIdValid!==i.isContentIdValid)&&(o.priority=i.priority,o.isContentIdValid=i.isContentIdValid,o.onUpdated.trigger({})),r.hasListener||i.isContentIdValid||delete e.cachedExtensions[t]}else Object(C.i)().assertConditionTag(!1,"Trying to access extension before it has been cached.",591152983)}))},e}(),R=function(){function e(e,t){this.extensionKey=e,this.scope=t}return e.prototype.getExtension=function(){var e=O().getExtension(this.extensionKey);if(!e||e.state.renderMode!==d.TaskPane)throw Object(C.i)().assertConditionTag(!!e,"No extension data in provider. Querying a removed extension.",573384475),Object(C.i)().assertConditionTag(!e||e.state.renderMode===d.TaskPane,"Extension data is not for the TaskPane Render Mode.",573384476),new o.d("Unable to query extension data within provider.",573384477);return Object(l.a)(Object(l.a)({},e.state),{type:"TaskPane"})},e}(),x=function(){function e(e,t){this.extensionKey=e,this.scope=t}return e.prototype.getExtension=function(){var e=O().getExtension(this.extensionKey);if(!e||e.state.renderMode!==d.TaskPaneItem)throw Object(C.i)().assertConditionTag(!!e,"No extension data in provider. Querying a removed extension.",546174347),Object(C.i)().assertConditionTag(!e||e.state.renderMode===d.TaskPaneItem,"Extension data is not for the TaskPaneItem Render Mode.",546174348),new o.d("Unable to query extension data within provider.",546174349);return Object(l.a)(Object(l.a)({},e.state),{type:"TaskPaneItem"})},e}(),D=function(){function e(e){this._detached=!1,this._id=e.id;var t={contentType:e.state.contentType,renderMode:e.state.renderMode,instanceId:e.state.instanceId};switch(e.state.renderMode){case d.TaskPane:this._extensionProvider=new R(this._id,t);break;case d.TaskPaneItem:this._extensionProvider=new x(this._id,t);break;case d.Isolated:this._extensionProvider=new k(this._id,t);break;case d.Integrated:this._extensionProvider=new P(this._id,t)}}return e.prototype.triggerUpdate=function(){O().updateExtension(this._id,void 0)},e.prototype.unregisterExtension=function(){this._detached=!0,O().unregisterExtension(this._id)},e.prototype.updateState=function(e){var t=O().getExtension(this._id);if(void 0===t)throw Object(C.i)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",591005410),new Error("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"));1===Object.keys(e).length&&void 0!==e.priority&&t.state.priority===e.priority?this.triggerUpdate():O().updateExtension(this._id,e)},Object.defineProperty(e.prototype,"priority",{get:function(){var e=O().getExtension(this._id);if(void 0===e)throw Object(C.i)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",595620259),new o.d("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"),589103770);return e.state.priority},set:function(e){this._detached||this.updateState({priority:e})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"componentDimensions",{get:function(){var e=O().getExtension(this._id);if(void 0===e)throw Object(C.i)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",591005411),new Error("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"));return e.state.componentDimensions},set:function(e){this._detached||this.updateState({componentDimensions:e})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"detached",{get:function(){return this._detached},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"provider",{get:function(){return this._extensionProvider},enumerable:!1,configurable:!0}),e}(),w=function(){function e(e,t){var n=this;this.contentTypes=e,this.host=t,this.onUpdated=new i.EventImpl((function(){})),O().onExtensionUpdated.subscribe((function(t){e.find((function(e){return e===t.extension.state.contentType}))&&t.updateType!==r.ReQuery&&n.onUpdated.trigger({})}))}return Object.defineProperty(e.prototype,"providers",{get:function(){var e=[],t=function(t){var r=n.host.extensions[t];r.priority!==c.Disabled&&n.contentTypes.find((function(e){return e===r.provider.scope.contentType}))&&e.push(r.provider)},n=this;for(var r in this.host.extensions)t(r);return e},enumerable:!1,configurable:!0}),e}(),A=function(){function e(){var e=this;this.contentTypeRegistrationInfo={},this.extensions={},this.onExtensionFirstRequested=new i.EventImpl((function(){})),O().onExtensionUpdated.subscribe((function(t){switch(t.updateType){case r.ReQuery:break;case r.Remove:delete e.extensions[t.extension.id];break;case r.Add:case r.Modify:e.ensureExtensionCached(t.extension.id,t.extension.state);break;default:Object(o.m)(t.updateType)}}))}return e.prototype.registerExtension=function(e,t,n){var r=O().registerExtension(e,t,n);return this.ensureExtensionCached(r.id,r.state),Promise.resolve(this.extensions[r.id])},e.prototype.getExtensions=function(e,t){var n=this,r=new w(e,this);return e.forEach((function(e){var r;O().getExtensions(e,t).forEach((function(e){n.ensureExtensionCached(e.id,e.state)}));var o=n.contentTypeRegistrationInfo[e];if(void 0!==o){if(o[t])return;o[t]=!0}else n.contentTypeRegistrationInfo[e]=((r={})[t]=!0,r);n.onExtensionFirstRequested.trigger({contentType:e,instanceId:t})})),r},e.prototype.ensureExtensionCached=function(e,t){void 0===this.extensions[e]&&(this.extensions[e]=new D({id:e,state:t}))},e}();function j(){return void 0===E&&(E=new A),E}},function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"C",(function(){return c})),n.d(t,"F",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"v",(function(){return u})),n.d(t,"M",(function(){return p})),n.d(t,"L",(function(){return h})),n.d(t,"d",(function(){return f})),n.d(t,"i",(function(){return m})),n.d(t,"D",(function(){return g})),n.d(t,"E",(function(){return b})),n.d(t,"J",(function(){return C})),n.d(t,"a",(function(){return y})),n.d(t,"s",(function(){return v})),n.d(t,"q",(function(){return T})),n.d(t,"u",(function(){return S})),n.d(t,"k",(function(){return I})),n.d(t,"P",(function(){return O})),n.d(t,"G",(function(){return E})),n.d(t,"c",(function(){return P})),n.d(t,"m",(function(){return k})),n.d(t,"n",(function(){return R})),n.d(t,"g",(function(){return x})),n.d(t,"f",(function(){return D})),n.d(t,"t",(function(){return w})),n.d(t,"z",(function(){return A})),n.d(t,"r",(function(){return j})),n.d(t,"H",(function(){return _})),n.d(t,"y",(function(){return F})),n.d(t,"x",(function(){return M})),n.d(t,"A",(function(){return N})),n.d(t,"I",(function(){return L})),n.d(t,"h",(function(){return B})),n.d(t,"B",(function(){return H})),n.d(t,"p",(function(){return U})),n.d(t,"o",(function(){return V})),n.d(t,"O",(function(){return W})),n.d(t,"b",(function(){return z})),n.d(t,"K",(function(){return K})),n.d(t,"N",(function(){return G})),n.d(t,"w",(function(){return q})),n.d(t,"l",(function(){return $}));var r=n(8),o=n(0);var i=n(6);function a(e){return`_${e.renderContextType}_${e.id}`}function s(e){return"cardEditor"+a(e)}function c(e){return"postEditor"+a(e)}function d(e){return"postRoot"+a(e)}function l(e,t){return t?"draftCardRoot"+a(e):"cardRoot"+a(e)}function u(){return"GhostCard"}function p(e){return"sendReplyButton"+a(e)}function h(e){return"cancelReplyButton"+a(e)}function f(e){return"cardContextMenu"+a(e)}function m(e){return"cardRootEditButton"+a(e)}function g(e){return"postContextMenu"+a(e)}function b(e){return"postEditButton"+a(e)}function C(e){return"renderableItemList"+a(e)}function y(e,t){return`actionBarButton_${t}${a(e)}`}function v(e){return"editorFocusContainer_"+e}function T(e){return"draftCancelButton"+a(e)}function S(){return"firstPaneElement5F6E8B9B-F2EF-4238-B749-89D6F5F132DD"}function I(){return"closePaneButton2F313A40-4603-41E4-90DD-12E000896375"}function O(e){return"viewMoreReply"+a(e)}function E(e){return"postTimeStamp"+a(e)}function P(e,t){return`${t.replace(/\s/g,"")}${a(e)}`}function k(){return"CommentsListScrollView"}function R(){return"CommentsList"}function x(){return"CardListWrapper"}function D(){return"CardList"}function w(){return"EmptyCreatedCommentLie"}function A(){return"NewCommentButton"}function j(e){return"draftWarning"+a(e)}function _(e){return`postingTip${a(e)};`}function F(){return"confirm-low-fidelity"}function M(){return"cancel-low-fidelity"}function N(){return"next-thread-button"}function L(){return"previous-thread-button"}function B(e){return"loadingPlaceholder"+a(e)}function H(e){return"persona"+a(e)}function U(e){return"DiscreteHostedCommentRoot"+a(e)}function V(){return"CommentPaneE026E6C3-C737-4F07-86EA-711651051DBC"}function W(e,t,n,a){let s;switch(e){case i.a.DiscreteIntegrated:s=a?"SharedComments_DHCIntegrated_DraftThreadAnnotation_Id:(.*)_Context:(.*)":"SharedComments_DHCIntegrated_ThreadAnnotation_Id:(.*)_Context:(.*)";break;case i.a.DiscreteIsolated:s=a?"SharedComments_DHCIsolated_DraftThreadAnnotation_Id:(.*)_Context:(.*)":"SharedComments_DHCIsolated_ThreadAnnotation_Id:(.*)_Context:(.*)";break;case i.a.FullPane:case i.a.HalfPane:s=a?"SharedComments_Pane_DraftThreadAnnotation_Id:(.*)_Context:(.*)":"SharedComments_Pane_ThreadAnnotation_Id:(.*)_Context:(.*)";break;case i.a.None:return Object(o.i)().assertConditionTag(!1,"Unexpected render context type: "+e,590995920),"";default:Object(r.m)(e)}return s.replace("(.*)",n).replace("(.*)",t)}function z(e){return"unk://SharedCommentsCanvas/(.*)".replace("(.*)",e)}function K(){return"ReopenThread"}function G(){return"8342575e-c7c7-4a18-825e-c7ab2c78a0c3"}function q(){return"lppSuggestionListId"}function $(e){return"commentReactionButton"+a(e)}},function(e,t,n){"use strict";n.d(t,"K",(function(){return B})),n.d(t,"D",(function(){return U})),n.d(t,"G",(function(){return V})),n.d(t,"A",(function(){return W})),n.d(t,"E",(function(){return z})),n.d(t,"C",(function(){return K})),n.d(t,"J",(function(){return G})),n.d(t,"z",(function(){return q})),n.d(t,"k",(function(){return $})),n.d(t,"h",(function(){return Y})),n.d(t,"I",(function(){return J})),n.d(t,"F",(function(){return Q})),n.d(t,"a",(function(){return X})),n.d(t,"b",(function(){return Z})),n.d(t,"i",(function(){return ee})),n.d(t,"n",(function(){return te})),n.d(t,"j",(function(){return ne})),n.d(t,"f",(function(){return re})),n.d(t,"g",(function(){return oe})),n.d(t,"e",(function(){return ie})),n.d(t,"c",(function(){return ae})),n.d(t,"l",(function(){return se})),n.d(t,"m",(function(){return ce})),n.d(t,"d",(function(){return de})),n.d(t,"o",(function(){return le})),n.d(t,"t",(function(){return ue})),n.d(t,"q",(function(){return pe})),n.d(t,"x",(function(){return he})),n.d(t,"u",(function(){return fe})),n.d(t,"y",(function(){return me})),n.d(t,"r",(function(){return ge})),n.d(t,"s",(function(){return be})),n.d(t,"p",(function(){return Ce})),n.d(t,"B",(function(){return ye})),n.d(t,"H",(function(){return ve})),n.d(t,"w",(function(){return Te})),n.d(t,"v",(function(){return Se}));var r=n(8),o=n(0),i=n(129),a=n(70),s=n(55),c=n(46),d=n(37),l=n(30),u=n(84),p=n(82),h=n(25),f=n(21),m=n(2);function g(e,t,n,r,i){if(m.Y())return;const a=Object(o.i)().createActivityObject("SelectionAttemptWhileDrafting",n,o.a.None,o.b.NecessaryServiceDataEvent);a.addDataField("Trackback",r,o.d.SystemMetadata),a.addDataField("RenderContextType",i,o.d.SystemMetadata),a.addDataField("SelectionAttemptType",e,o.d.SystemMetadata),a.addDataField("IsDraftInCurrentContext",t.isInCurrentContext,o.d.SystemMetadata),a.addDataField("DraftId",t.commentDraft.sessionConfiguration.draftId,o.d.SystemMetadata),a.successTag(590206682)}var b,C=n(13),y=n(22),v=n(165),T=n(119),S=n(7),I=n(19),O=n(17),E=n(58),P=n(76);!function(e){e[e.NoDialog=0]="NoDialog",e[e.AbandonDraft=1]="AbandonDraft",e[e.ResumeDrafting=2]="ResumeDrafting"}(b||(b={}));var k=b,R=n(80),x=n(71),D=n(6),w=n(39),A=n(104),j=n(287),_=n(128),F=n(9);function M(){F.Keyboard.dismiss()}n(72);var N=n(60),L=n(24);function B({comment:e,threads:t,selectedComment:n,warningType:r}){const o=!e.parentId,i=!!(e.commentFlags&s.a.LowFidelity);if(!n)return!(!o||r!==O.a.DeleteThread||!i&&!L.k(t,e.commentId))||m.i()&&i&&o;const a=i||o&&(r===O.a.DeleteReply||r===O.a.DeleteThread)&&L.k(t,e.commentId),c=Object(O.j)(n.selectionDetails)?n.selectionDetails.selectedPostId:n.selectedCardId;return!(!a||c===e.commentId&&n.selectionDetails.lowFidelityWarningType===r)}function H({result:e,localizationAPI:t}){e===T.a.Success&&Object(i.a)(t.getString(67))}function U({trackback:e,id:t,data:n,selectedComment:r,renderContextType:a,actionDispatchers:s,telemetryVisitor:c,localizationAPI:d}){const l=L.b(n,t);l?B({comment:l,threads:n,selectedComment:r,warningType:O.a.DeleteReply})?s.showLowFidelityWarning({renderContextType:a,telemetryVisitor:c,trackback:593826118},t,O.a.DeleteReply):(Object(i.a)(d.getString(65)),s.requestDeleteComment({renderContextType:a,telemetryVisitor:c,trackback:e},t)):Object(o.i)().assertConditionTag(!1,"Comment not found",593826117)}function V({trackback:e,id:t,data:n,renderContextType:r,actionDispatchers:i,telemetryVisitor:a}){const s=L.b(n,t);s?i.showPostErrorUI({renderContextType:r,telemetryVisitor:a,trackback:e},s.commentId):Object(o.i)().assertConditionTag(!1,"Comment not found",593875075)}function W({trackback:e,id:t,data:n,renderContextType:r,actionDispatchers:i,telemetryVisitor:a}){const s=L.b(n,t);s?i.clearPostErrorUI({renderContextType:r,telemetryVisitor:a,trackback:e},s.commentId):Object(o.i)().assertConditionTag(!1,"Comment not found",593875076)}function z({trackback:e,id:t,data:n,selectedComment:r,renderContextType:i,actionDispatchers:a,telemetryVisitor:s}){const c=L.b(n,t);c?B({comment:c,threads:n,selectedComment:r,warningType:O.a.Edit})?a.showLowFidelityWarning({renderContextType:i,telemetryVisitor:s,trackback:593826120},t,O.a.Edit):a.requestEditCommentSession({renderContextType:i,telemetryVisitor:s,trackback:e},t):Object(o.i)().assertConditionTag(!1,"Comment not found",593826119)}function K({trackback:e,id:t,data:n,draftState:r,contentPromise:i,atMentionsEnabled:a,componentTree:s,actionDispatchers:c,telemetryVisitor:l,localizationAPI:u,commitSource:p}){if(Object(I.i)(r))return Promise.resolve();if(!r.postIdToDraftIdMap[t])return Object(o.i)().assertConditionTag(!1,"Post draft to commit not found",588853381),Promise.reject(new f.a("Post draft to commit not found",587850403,-2130957492));const m=L.b(n,t);return m?c.commitCommentAndFocus({renderContextType:s.componentTreeId.renderContextType,telemetryVisitor:l,trackback:e},()=>i,{commentId:t,type:"EDIT",previousCommentBody:m.commentBody},a,s,Object(d.b)(m),p).then(e=>{H({result:e,localizationAPI:u})}).catch(Object(h.a)(593826122)):(Object(o.i)().assertConditionTag(!1,"Comment not found in model",593826121),Promise.reject(new f.a("Comment not found in model",587850432,2130957505)))}function G({trackback:e,renderableItem:t,selectedComment:n,cardCollapsedState:r,dispatchProps:o,telemetryVisitor:i,componentTree:a,draftState_deprecated:s,shouldFocusAfter:c}){const d=L.j(t),l=L.f(t);return o.discardDraftIfEmpty({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:i,trackback:593237586},y.a.SharedComments,void 0).then(t=>{if(m.Y()||t.draftDiscardBehavior!==R.a.CannotAutoDiscard||n&&Object(O.j)(n.selectionDetails)&&n.selectionDetails.selectedPostId===l){const t=r===E.a.Collapsed;o.selectComment(a,{renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:i,trackback:e},Object(v.a)(d,y.a.SharedComments,t?{selectType:C.b.ExpandCard}:{selectType:C.b.SelectPost,selectedPost:l}),c||t).catch(Object(h.a)(590104649))}else{const e=Object(S.K)(s);e&&g(2,e,i,590206683,a.componentTreeId.renderContextType)}},Object(h.a)(593032901))}function q({trackback:e,commentId:t,setContents:n,data:r,draftState:a,shouldClosePaneAfterDiscardDraft:s,onWillDiscardCallback:d,renderContextType:l,dispatchProps:u,telemetryVisitor:p,localizationAPI:f}){M();const m=L.b(r,t);a.postIdToDraftIdMap[t]&&m?(Object(i.a)(f.getString(66)),u.discardDraftAsync({renderContextType:l,telemetryVisitor:p,trackback:e},y.a.SharedComments,s,d).then(e=>{e===c.a.Handled&&m&&n&&n(m.commentBody)}).catch(Object(h.a)(593826127))):Object(o.i)().assertConditionTag(!1,`Cannot find comment post to cancel '${t}'`,593826126)}function $({cardProps:e,componentTree:t,focusManager:n}){setTimeout(()=>n.commentCardMounted(t,e))}function Y({cardId:e,componentTree:t,focusManager:n}){setTimeout(()=>n.commentCardEditorMounted(t,e))}function J({postId:e,componentTree:t,focusManager:n}){setTimeout(()=>n.commentPostMounted(t,e))}function Q({postId:e,componentTree:t,focusManager:n}){setTimeout(()=>n.commentPostEditorMounted(t,e))}function X({trackback:e,threadId:t,renderContextType:n,dispatchProps:r,telemetryVisitor:o}){r.requestReplyCommentSession({renderContextType:n,telemetryVisitor:o,trackback:e},t)}function Z({trackback:e,commentCardRef:t,renderContextType:n,dispatchProps:r,telemetryVisitor:o}){r.collapseCard({renderContextType:n,telemetryVisitor:o,trackback:e},t.getId())}function ee({trackback:e,commentCardRef:t,dispatchProps:n,telemetryVisitor:o,componentTree:i,options:a,focusManager:s,isDraftThread:c}){const d={componentType:Object(w.b)(c),id:t.getId(),renderContextType:i.componentTreeId.renderContextType};s.postOnComponentFocusedRequest(d,()=>{p.a&&Object(r.i)("Handling card focus with polite selection on "+t.getId()),i.isFocusOnOrWithin(d)&&te({trackback:e,commentCardRef:t,dispatchProps:n,telemetryVisitor:o,componentTree:i,options:a})})}function te({trackback:e,commentCardRef:t,dispatchProps:n,telemetryVisitor:o,componentTree:i,options:a}){let s,c=!1;const d=a.selectActionType;switch(d){case C.b.ExpandCard:const e=a,n=e.selectRootPost&&(m.Y()||!e.relativeDraftingState);c=e.shouldFocusAfter,s=n?{selectType:C.b.SelectPost,selectedPost:t.getId()}:{selectType:C.b.ExpandCard};break;case C.b.SelectCard:case C.b.Polite:s={selectType:d};break;default:Object(r.m)(d)}const l=Object(v.a)(t.getId(),y.a.SharedComments,s);a.selectActionType===C.b.ExpandCard&&n.discardDraftIfEmpty({renderContextType:i.componentTreeId.renderContextType,telemetryVisitor:o,trackback:571281760},y.a.SharedComments,void 0).then(e=>{if(!m.Y()&&e.draftDiscardBehavior===R.a.CannotAutoDiscard&&a.relativeDraftingState===P.a.InOtherCard){const e=Object(S.K)(a.draftState);e&&g(1,e,o,571281761,i.componentTreeId.renderContextType)}}).catch(Object(h.a)(571281762)),n.selectComment(i,{renderContextType:i.componentTreeId.renderContextType,telemetryVisitor:o,trackback:e},l,c).catch(Object(h.a)(571340118))}function ne({trackback:e,commentCardRef:t,renderContextType:n,dispatchProps:r,telemetryVisitor:o,shouldHighlightCard:i}){i?r.highlightComment({renderContextType:n,telemetryVisitor:o,trackback:e},t.getId()):r.clearCommentHighlight({renderContextType:n,telemetryVisitor:o,trackback:e},t.getId())}function re({trackback:e,focusManager:t,componentTree:n,cardId:r,isCardLie:i,newHeight:a,renderContextType:s,selectedComment:c,dispatchProps:d,telemetryVisitor:l}){if(s===D.a.HalfPane){if(void 0===a)return Object(o.i)().assertConditionTag(!1,"Height should not be undefined in half-pane mode",593826129);i&&c&&c.selectedCardId===r&&(m.H()||Object(S.O)(r))&&d.requestDisplayConfiguration({renderContextType:s,telemetryVisitor:l,trackback:e},{displayMode:u.a.Variable,desiredHeight:a}).then(()=>{t.focusCommentPaneCommand(n)}).catch(Object(h.a)(593826130))}}function oe({trackback:e,id:t,draftState:n,renderContextType:r,dispatchProps:o,telemetryVisitor:i}){if(m.z())return;const s=n.drafts[n.cardIdToDraftIdMap[t]];s&&s.isDraftEmpty&&s.commentDraft.sessionConfiguration.sessionType===a.g&&o.discardDraftAsync({renderContextType:r,telemetryVisitor:i,trackback:e},y.a.SharedComments,!1)}function ie({trackback:e,showDiscardDialog:t,invokeModalDialog:n,componentTree:r,dispatchProps:s,closeOnDiscard:d,cardId:l,draftState:u,telemetryVisitor:p,localizationAPI:f,focusManager:m,lieIndex:g}){var b;const C=u.cardIdToDraftIdMap[l];if(!C)return void Object(o.i)().assertConditionTag(!1,"Card draft to cancel not found",588853382);M();let v=void 0;t&&(v=Object(_.a)(u,r,n));const T=(null===(b=u.drafts[C])||void 0===b?void 0:b.commentDraft.sessionConfiguration.sessionType)===a.g,S=function({componentTree:e,focusManager:t,lieIndex:n,cardId:r,isReplyDraft:o,discardCallback:i}){return(a,s)=>{if(i){return i(()=>(t.onUserAction(e,{userAction:A.a.CancelNewThreadDraft,threadIndex:n}),a?a():c.a.Unhandled),s)}return a?(o?t.onUserAction(e,{userAction:A.a.CancelReplyDraft,cardId:r}):t.onUserAction(e,{userAction:A.a.CancelNewThreadDraft,threadIndex:n}),Promise.resolve(a())):Promise.resolve(c.a.Unhandled)}}({componentTree:r,focusManager:m,lieIndex:g,cardId:l,isReplyDraft:T,discardCallback:v});Object(i.a)(f.getString(T?64:103)),s.discardDraftAsync({renderContextType:r.componentTreeId.renderContextType,telemetryVisitor:p,trackback:e},y.a.SharedComments,d,S).then(e=>{e===c.a.Handled&&(T?m.onUserAction(r,{userAction:A.a.CancelReplyDraft,cardId:l}):m.onUserAction(r,{userAction:A.a.CancelNewThreadDraft,threadIndex:g}))},Object(h.a)(592840735))}function ae({trackback:e,commentCardRef:t,draftState:n,areMentionsEnabled:r,session:i,componentTree:a,dispatchProps:s,telemetryVisitor:c,localizationAPI:d,commitSource:l,selectedTaskAssignee_deprecated:u}){if(Object(I.i)(n))return Promise.resolve();const p=t.getId();if(!n.cardIdToDraftIdMap[p])return Object(o.i)().assertConditionTag(!1,"Card draft to commit not found, card ID "+p,588853383),Promise.reject(new f.a("Card draft to commit not found",587850433,-2130957492));let g=void 0;return!m.g()&&!m.f()&&m.b()&&u&&(g={Task:{type:"Task",assignee:u}}),s.commitCommentAndFocus({trackback:e,telemetryVisitor:c,renderContextType:a.componentTreeId.renderContextType},t.getContentsAsync,i,r,a,p,l,g).then(e=>{H({result:e,localizationAPI:d})}).catch(Object(h.a)(593826134))}function se({trackback:e,id:t,renderContextType:n,dispatchProps:r,telemetryVisitor:o,localizationAPI:a,isTask:s}){Object(i.a)(a.getString(125)),r.requestReopenThread({renderContextType:n,telemetryVisitor:o,trackback:e},t,s)}function ce({componentTree:e,focusManager:t,trackback:n,id:r,renderContextType:o,dispatchProps:a,telemetryVisitor:s,localizationAPI:c,isTask:d}){Object(i.a)(c.getString(124)),t.onUserAction(e,{userAction:A.a.ResolveThread,cardId:r}),a.requestResolveThread({renderContextType:o,telemetryVisitor:s,trackback:n},r,d)}function de({trackback:e,id:t,data:n,selectedComment:r,componentTree:a,invokeModalDialog:s,dispatchProps:d,telemetryVisitor:l,localizationAPI:u,focusManager:p,isTask:f,threadIndex:m,shouldCheckForLowFidelity:g}){if(g){const e=L.b(n,t);if(!e)return void Object(o.i)().assertConditionTag(!1,"Comment not found",593605342);if(B({comment:e,threads:n,selectedComment:r,warningType:O.a.DeleteThread}))return void d.selectCommentCardAndShowLowFidelityWarning({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:l,trackback:593605343},e.commentId,O.a.DeleteThread)}if(a.componentTreeId.renderContextType===D.a.HalfPane&&s){const e=()=>function({dispatchProps:e,componentTree:t,selectedComment:n,telemetryVisitor:r}){if(n)return e.requestDeleteThread({renderContextType:t.componentTreeId.renderContextType,telemetryVisitor:r,trackback:592840775},n.selectedCardId),c.a.Handled;return Object(o.i)().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",592840776),c.a.Unhandled}({dispatchProps:d,componentTree:a,selectedComment:r,telemetryVisitor:l});s(x.a.DeleteThread,e,()=>c.a.Canceled).then(e=>{e===c.a.Handled&&p.onUserAction(a,{userAction:A.a.DeleteThread,threadIndex:m})}).catch(Object(h.a)(595632546))}else Object(i.a)(u.getString(63)),p.onUserAction(a,{userAction:A.a.DeleteThread,threadIndex:m}),Object(N.b)(a.componentTreeId.renderContextType)?setTimeout(()=>{d.requestDeleteThread({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:l,trackback:e},t,f)},100):d.requestDeleteThread({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:l,trackback:e},t,f)}function le({componentTree:e,focusManager:t,trackback:n,id:r,renderContextType:o,dispatchProps:i,telemetryVisitor:a,localizationAPI:s}){ce({componentTree:e,focusManager:t,trackback:n,id:r,renderContextType:o,dispatchProps:i,telemetryVisitor:a,localizationAPI:s,isTask:!0})}function ue({failTag:e,successTag:t,person:n,dispatchProps:r,telemetryVisitor:i,renderContextType:a,trackback:s}){const c=Object(o.i)().createActivityObject("CheckUserAccess",i,o.a.None,o.b.NecessaryServiceDataEvent),d={UserId:Object(l.h)(n),Provider:j.a,DisplayName:Object(l.g)(n),Email:Object(l.h)(n)};r.checkUserAccess(d).then(e=>{var n;c.addDataField("UserCanWrite",e.UserCanWrite,o.d.SystemMetadata),c.addDataField("UserCanReview",null!==(n=null==e?void 0:e.UserCanReview)&&void 0!==n&&n,o.d.SystemMetadata),c.successTag(t)},t=>{c.failTag(e,-2130957562)}),r.addToCurrentMentionees({telemetryVisitor:i,trackback:s,renderContextType:a},n)}function pe({trackback:e,contentId:t,isEmpty:n,renderContextType:r,draftIdMap:o,actionDispatchers:i,telemetryVisitor:a}){const s=o[t];s&&i.draftEmptinessChanged({renderContextType:r,telemetryVisitor:a,trackback:e},s,n)}function he({trackback:e,id:t,editor:n,renderContextType:o,draftIdMap:i,draftMap:a,actionDispatchers:s,telemetryVisitor:c}){const d=i[t];if(!d)return;const l=a[d];Object(r.n)(l,"Draft should be defined if draftId exists!",587850434),l.pendingState===I.a.None&&s.saveDraft({renderContextType:o,telemetryVisitor:c,trackback:e},d,{editorContent:n.getContentsAsync(),editorCursorPosition:n.getCursorPositionAsync()})}function fe({trackback:e,emailsStillInDraft:t,renderContextType:n,dispatchProps:r,telemetryVisitor:o}){r.updateMentioneesStillInDraft({renderContextType:n,telemetryVisitor:o,trackback:e},t)}function me({trackback:e,renderContextType:t,dispatchProps:n,telemetryVisitor:r,selectedAssignee:o}){n.updateSelectedTaskAssignee({renderContextType:t,telemetryVisitor:r,trackback:e},o)}function ge({selectedState:e,renderContextType:t,dispatchProps:n,telemetryVisitor:r}){e&&Object(O.h)(e)?n.clearLowFidelityWarning({renderContextType:t,telemetryVisitor:r,trackback:573612046}):Object(o.i)().assertConditionTag(!1,"onLowFidelityWarningCancel called unexpectedly",593846658)}function be({selectedState:e,onCardDelete:t,onPostDelete:n,onPostEdit:r}){if(e)if(!Object(O.j)(e.selectionDetails)||Object(O.d)(e)){if(Object(O.e)(e)){return void t(e.selectedCardId)}if(Object(O.f)(e))return void Object(o.i)().assertConditionTag(!1,"Unexpected LowFidelityWarningOnEdit with card selection",593846662)}else{const t=e.selectionDetails.selectedPostId;if(Object(O.c)(e))return void n(t);if(Object(O.f)(e))return void r(t)}else Object(o.i)().assertConditionTag(!1,"onLowFidelityWarningConfirm called unexpectedly",593846661)}function Ce({ownProps:e,dispatchProps:t,componentTree:n,draftState:r,invokeModalDialog:i}){if(n.componentTreeId.renderContextType!==D.a.HalfPane&&Object(I.b)(r)&&!m.m()){const a=e=>{e===c.a.Canceled||e===c.a.Unhandled&&Object(o.i)().assertConditionTag(e!==c.a.Unhandled,"Unhandled request to discard on close pane",592840769)};t.discardDraftAsync({renderContextType:n.componentTreeId.renderContextType,telemetryVisitor:e.telemetryVisitor,trackback:592840770},y.a.SharedComments,!0,Object(_.a)(r,n,i,x.a.ClosePaneDraft)).then(a).catch(Object(h.a)(592840771))}else!function({dispatchProps:e,componentTree:t,telemetryVisitor:n}){const r=Object(o.i)().createActivityObject("ClosePane",n,o.a.None,o.b.NecessaryServiceDataEvent);r.addDataField("PaneCloseResult",k.NoDialog,o.d.SystemMetadata),r.successTag(592840773),e.requestClosePane({renderContextType:t.componentTreeId.renderContextType,telemetryVisitor:n,trackback:592840774})}({dispatchProps:t,componentTree:n,telemetryVisitor:e.telemetryVisitor})}function ye(e,t,n,r,o){n.collapseCard({renderContextType:o.componentTreeId.renderContextType,telemetryVisitor:r,trackback:e},L.j(t))}function ve(e,t,n,r){Object(I.d)(r)&&m.Y();const o=L.j(e);n.focusCommentCardCommand(t,o)}function Te(e,t,n,r,o,i,a){o.requestUpdateCommentReactions({renderContextType:r,telemetryVisitor:i,trackback:e},t,a,n)}function Se(e,t,n,r,o){r.requestPresentLinkToComment({renderContextType:n,telemetryVisitor:o,trackback:e},t)}},function(e,t,n){"use strict";var r;function o(e){return e.selectionDetails.lowFidelityWarningType===r.Edit}function i(e){return e.selectionDetails.lowFidelityWarningType===r.DeleteReply}function a(e){return e.selectionDetails.lowFidelityWarningType===r.DeleteThread}function s(e){return i(e)||a(e)}function c(e){return!!e&&(o(e)||i(e))}function d(e){return!!e&&(s(e)||o(e))}function l(e){return void 0!==e.selectedPostId}function u(e){return l(e.selectionDetails)?e.selectionDetails.selectedPostId:e.selectedCardId}function p(e,t){return!!t&&l(t.selectionDetails)&&t.selectionDetails.selectedPostId===e.commentId&&d(t)}n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"i",(function(){return p})),function(e){e[e.Edit=1]="Edit",e[e.DeleteReply=2]="DeleteReply",e[e.DeleteThread=3]="DeleteThread"}(r||(r={}))},function(e,t,n){"use strict";var r;function o(e){return e===r.ClosePaneButton||e===r.NextCommentButton||e===r.PreviousCommentButton||e===r.GhostCard||e===r.NewCommentButton||e===r.PaneRoot||e===r.CommentsList}function i(e){return(t=e.componentType)===r.CardEditor||t===r.PostEditor||t===r.Card||t===r.Post||t===r.DraftCard||t===r.DiscreteHostedCommentRoot||t===r.ReopenThreadButton;var t}function a(e){switch(e){case r.CardEditor:case r.Card:case r.DraftCard:case r.DiscreteHostedCommentRoot:case r.ReopenThreadButton:return!0;case r.PostEditor:case r.Post:return!1}}function s(e,t){return i(e)&&i(t)?e.componentType===t.componentType&&e.id===t.id&&e.renderContextType===t.renderContextType:e.componentType===t.componentType}n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return s})),function(e){e[e.ClosePaneButton=1]="ClosePaneButton",e[e.CardEditor=2]="CardEditor",e[e.PostEditor=3]="PostEditor",e[e.Card=4]="Card",e[e.Post=5]="Post",e[e.NextCommentButton=6]="NextCommentButton",e[e.PreviousCommentButton=7]="PreviousCommentButton",e[e.GhostCard=8]="GhostCard",e[e.NewCommentButton=9]="NewCommentButton",e[e.PaneRoot=10]="PaneRoot",e[e.DraftCard=11]="DraftCard",e[e.DiscreteHostedCommentRoot=12]="DiscreteHostedCommentRoot",e[e.ReopenThreadButton=13]="ReopenThreadButton",e[e.CommentsList=14]="CommentsList"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"l",(function(){return u})),n.d(t,"k",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"i",(function(){return m})),n.d(t,"j",(function(){return g})),n.d(t,"m",(function(){return b}));var r,o=n(2);function i(e){return{isDraftEmpty:e.isDraftEmpty,savedDraftContent:e.savedDraftContent,draftWarningState:e.draftWarningState,currentMentionees:e.currentMentionees,selectedTaskAssignee:e.selectedTaskAssignee,selectedTaskAssignees:e.selectedTaskAssignees,smartReplies:e.smartReplies}}function a(e){return Object.keys(e.drafts)}function s(e){let t=0;for(const n in e.drafts)e.drafts.hasOwnProperty(n)&&++t;return t}function c(){return{drafts:{},cardIdToDraftIdMap:{},postIdToDraftIdMap:{},pendingDraft:void 0,committedLieId:void 0}}function d(e){return s(e)>0}function l(e){return d(e)||p(e)}function u(e){return!o.Y()&&l(e)}function p(e){return void 0!==e.pendingDraft}function h(e,t){for(const n of a(e))if(e.drafts[n].pendingState===t)return!0;return!1}function f(e){return h(e,r.None)}function m(e){return h(e,r.Commit)}function g(e){return h(e,r.Discard)}function b(e,t){return g(e)&&f(t)}!function(e){e[e.None=0]="None",e[e.Discard=1]="Discard",e[e.Commit=2]="Commit"}(r||(r={}))},function(e,t,n){"use strict";var r=n(105);n.d(t,"a",(function(){return r.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(8);class o extends r.d{constructor(e,t,n){super(e,t),this.tag=t,this.errorCode=n,this.name="CommentError"}stringify(){return Object(r.e)(this.tag,this.stack,"Error "+(e=>{if(e>4294967295||e<-4294967296)return`dword_out_of_range(${e})`;return"0x"+(e<0?4294967295+e+1:e).toString(16)})(this.errorCode),this.innerException)}}function i(e){return Object(r.g)(e,"CommentError")}},function(e,t,n){"use strict";var r;!function(e){e[e.SharedComments=0]="SharedComments",e[e.Canvas=1]="Canvas"}(r||(r={})),t.a=r},function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var r=n(2);function o(e){return r.X()}function i(e){return r.X()}function a(e){return r.X()}function s(e){return r.X()}function c(e){return s()?e.postData:e.commentData}function d(e,t){return i()?e[t]:e.find(e=>e.commentId===t)}},function(e,t,n){"use strict";n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return v})),n.d(t,"d",(function(){return T})),n.d(t,"b",(function(){return S})),n.d(t,"i",(function(){return I})),n.d(t,"h",(function(){return O})),n.d(t,"a",(function(){return E})),n.d(t,"f",(function(){return P})),n.d(t,"j",(function(){return k})),n.d(t,"e",(function(){return x})),n.d(t,"g",(function(){return D})),n.d(t,"k",(function(){return w})),n.d(t,"c",(function(){return A}));n(8);var r=n(0),o=n(14),i=n(81),a=n(37),s=n(88),c=n(30),d=n(21),l=n(61),u=n(2),p=n(7),h=n(65),f=n(23),m=n(64),g=n(54);function b(e,t,n){for(let r=t;r<e.length;++r)if(e[r].commentId===n.commentId)return r;return-1}function C(e,t,n,o,i,a){const s=[];let c=t,d=i;for(;c<=n&&d<=a;){const t=e[c].date;Object(r.i)().assertConditionTag(!!t,"commentDate should not be undefined",595719177),!t||t<=o.history[d].records[0].time?(Object(r.i)().assertConditionTag(e[c].parentId===o.commentId,"comments must belong to the same thread",595719173),s.push({commentModel:e[c]}),++c):(Object(r.i)().assertConditionTag(!o.history[d].commentId,"Unachored history item should not have commentId",595719178),s.push({historyItem:o.history[d],parentThreadId:o.commentId}),++d)}for(;c<=n;++c)s.push({commentModel:e[c]});for(;d<=a;++d)Object(r.i)().assertConditionTag(!o.history[d].commentId,"Unachored history item should not have commentId",595719179),s.push({historyItem:o.history[d],parentThreadId:o.commentId});return s}function y(e,t){if(!u.b()||!t||0===t.history.length)return e.map(e=>({commentModel:e}));let n=!0;if(u.c()||t.commentId===t.history[0].commentId||(Object(r.i)().assertConditionTag(!1,"taskItem.commentId must match the first history item",595719174),n=!1),e[0].commentId!==t.commentId&&(Object(r.i)().assertConditionTag(!1,"TaskItem must be paired with the root comment",595719303),n=!1),!n)return e.map(e=>({commentModel:e}));const o=[];u.c()||o.push({commentModel:e[0],historyItem:t.history[0]});let i=u.c()?0:1,a=u.c()?0:1,s=u.c()?0:1;for(;i<e.length&&s<t.history.length;){const n=b(e,i,t.history[s]);n>=0&&(o.push(...C(e,i,n-1,t,a,s-1)),Object(r.i)().assertConditionTag(0===n||e[n].parentId===t.commentId,"comments must belong to the same thread",595719175),o.push({commentModel:e[n],historyItem:t.history[s]}),i=n+1,a=s+1),++s}return o.push(...C(e,i,e.length-1,t,a,t.history.length-1)),o}function v(e,t,n,i,s){let c=n;if(u.j()&&s){const e=new Set;s.forEach(t=>t.contentType===o.b.CommentThread&&e.add(t.contentId)),Object(f.c)(n)||(c=n.filter(t=>e.has(t.parentId||t.commentId)))}const d=[];if(Object(f.c)(c))Object(f.f)(e)?e.forEach(e=>{d.push(...y(Object(p.z)(c,t,e),i[e]))}):Object(r.i)().assertConditionTag(!1,"Map-Based Data w/o Map-Based Thread Data is unsupported",537515151);else{let e=0;for(let t=1;t<=c.length;t++)(t===c.length||Object(a.a)(c[t]))&&(d.push(...y(c.slice(e,t),i[c[e].commentId])),e=t)}return d}function T(e){return e.filter(m.a).map(e=>e.commentModel)}function S(e,t){const n=e.find(e=>Object(m.a)(e)&&e.commentModel.commentId===t);if(Object(m.a)(n))return n.commentModel}function I(e){const t=e[0];if(Object(m.a)(t))return t.commentModel;throw new d.a(l.a,589103627,2130957505)}function O(e){return Object(m.a)(e)?e.commentModel.parentId:e.parentThreadId}function E(e,t){return u.W()?`${e}__${t}`:t}function P(e){return Object(m.a)(e)?e.commentModel.commentId:E(e.historyItem.taskId,e.historyItem.records[0].recordId)}function k(e){return Object(m.a)(e)?Object(a.b)(e.commentModel):e.parentThreadId}function R(e,t){const n=e.records[0];switch(n.type){case s.a.Create:{const n=e.records[1];if(!n||n.type!==s.a.Assign)return Object(r.i)().assertConditionTag(!1,"HistoryRecordType Create encountered without Assign ",595723398),{icon:0,description:t.getString(119)};const o=Object(c.k)(n.assignee);return{icon:13,description:t.formatString(114,o)}}case s.a.UnassignAll:case s.a.Unassign:{const n=e.records[1];if(!n||n.type!==s.a.Assign)return Object(r.i)().assertConditionTag(!1,"HistoryRecordType Unassign encountered without Assign ",595723399),{icon:14,description:t.getString(204)};const o=Object(c.k)(n.assignee);return{icon:14,description:t.formatString(115,o)}}case s.a.Progress:return 100===n.completion?{icon:15,description:t.getString(116)}:{icon:21,description:t.getString(117)};case s.a.Schedule:return{icon:17,description:t.getString(118)};default:return Object(r.i)().assertConditionTag(!1,"Unexpected HistoryRecordType",595723400),{icon:0,description:t.getString(119)}}}function x(e,t){if(!u.h())return[R(e,t)];const n=[],o=e.records[0];switch(o.type){case s.a.Create:case s.a.UnassignAll:{const r=[];for(let t=1;t<e.records.length;t++){const n=e.records[t];n.type===s.a.Assign&&r.push(Object(c.k)(n.assignee))}n.push({icon:13,description:Object(g.k)(t,!0,r)});break}case s.a.Assign:case s.a.Unassign:{const o=[],i=[];for(let n=0;n<e.records.length;n++){const a=e.records[n];if(a.type!==s.a.Assign&&a.type!==s.a.Unassign)return Object(r.i)().assertConditionTag(!1,"Unexpected HistoryRecordType.",528064847),[{icon:0,description:t.getString(119)}];a.type===s.a.Assign?o.push(Object(c.k)(a.assignee)):i.push(Object(c.k)(a.assignee))}o.length>0&&n.push({icon:13,description:Object(g.k)(t,!0,o)}),i.length>0&&n.push({icon:13,description:Object(g.k)(t,!1,i)});break}case s.a.Progress:return 100===o.completion?[{icon:15,description:t.getString(116)}]:[{icon:21,description:t.getString(117)}];case s.a.Schedule:return[{icon:17,description:t.getString(118)}];default:return Object(r.i)().assertConditionTag(!1,"Unexpected HistoryRecordType",527759317),[{icon:0,description:t.getString(119)}]}return 0===n.length&&n.push({icon:0,description:t.getString(119)}),n}function D(e,t){return e.findIndex(e=>e.length>0&&k(e[0])===t)}function w(e,t){return e.some(e=>Object(m.a)(e)&&!!(e.commentModel.commentFlags&i.f.LowFidelity)&&(void 0===t||t===Object(a.b)(e.commentModel)))}function A(e,t,n,o,i){const a=[],s=!i&&void 0!==n&&(u.H()||n.index>=0);let c=-1;if(!u.M()){const t=T(e).length;n&&n.index===t&&(c=t)}let d=-1;for(let i=0;i<e.length;i+=1){let l=e[i];const p=Object(m.a)(l)?l:void 0;if(p&&void 0!==t[p.commentModel.commentId])if(t[p.commentModel.commentId].pending===h.a.Delete&&o)for(u.M()&&Object(m.a)(l)&&++d;!(i+1>=e.length||""===O(e[i+1]));)++i,u.M()&&Object(m.a)(e[i])&&++d;else{++d,a.push([p]),s&&(u.M()||-1===c)&&d===(null==n?void 0:n.index)&&(c=a.length-1);for(let t=i+1;t<e.length;t+=1){if(l=e[t],Object(m.a)(l)){const e=O(l);if(e!==p.commentModel.commentId){Object(r.i)().assertConditionTag(!e,`Orphaned reply with id ${P(l)}, expected parent ${p.commentModel.commentId} but was ${e}`,593085889);break}a[a.length-1].push(l),++d}else a[a.length-1].push(l);++i}}else{const n=p?p.commentModel.commentId:"",o=p?p.commentModel.parentId:"";for(Object(r.i)().assertConditionTag(!1,`CommentData corruption detected with orphaned reply. Skipping to allow render. commentDataLength: ${e.length} | cardViewStateLength: ${Object.keys(t).length} | isLieThread: ${s} | CommentId: ${n} | ParentId: ${o}`,593085888),u.M()&&Object(m.a)(l)&&++d;!(i+1>=e.length||""===O(e[i+1]));)++i,u.M()&&Object(m.a)(e[i])&&++d}}return s&&n&&(-1!==c?a.splice(c,0,[{commentModel:n.newComment}]):u.M()&&(Object(r.i)().assertConditionTag(n.index>d,"Failed to find insertion point for lie in getAllRenderableItemThreads",529094429),n.index===d+1&&a.push([{commentModel:n.newComment}]))),a}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(8),o=n(0),i=n(21);const a=e=>t=>{Object(i.b)(t)?Object(o.i)().assertConditionTag(!1,t.message,e):Object(o.i)().assertConditionTag(!1,"Unknown error "+Object(r.l)(t),e)}},function(e,t){e.exports=OfficePlatformGlobal.Reka},function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"n",(function(){return f})),n.d(t,"l",(function(){return m})),n.d(t,"m",(function(){return g})),n.d(t,"k",(function(){return b})),n.d(t,"i",(function(){return C})),n.d(t,"o",(function(){return y})),n.d(t,"j",(function(){return v}));var r=n(6),o=n(29),i=n(4);const a=8,s=12,c=36,d=32,l=19,u=2,p=8,h=1,f=[i.b.rule({isFluentEnabled:!0},{paddingLeft:4,paddingBottom:4-h,borderColor:"transparent",borderWidth:1,marginLeft:5,marginRight:5,marginBottom:h,borderRadius:2}),i.b.rule({platform:"win32",renderContextType:r.a.DiscreteIsolated},{paddingLeft:4+s+p})],m=[i.b.rule({isFluentEnabled:!1},e=>({backgroundColor:e.palette.CardReplyBackground})),i.b.rule({renderContextType:r.a.HalfPane,isFluentEnabled:!1},e=>({backgroundColor:e.palette.CardReplyBackground_HalfPane}))],g=new i.b([i.b.always({flex:1,flexDirection:"row",alignItems:"center",paddingBottom:2})]),b=new i.a([i.a.always(e=>({opacity:7!==e.themeId?.65:1}))]),C=new i.b([i.b.always(e=>({borderWidth:1,paddingLeft:10,paddingRight:10,paddingTop:4,paddingBottom:4,borderColor:e.palette.CardDraftBoxBorder,borderRadius:2,backgroundColor:e.palette.CardDraftBoxBackground}))]),y=new i.b([i.b.rule({platform:"win32"},{flexShrink:0}),i.b.rule(o.d,{marginLeft:2,marginRight:-10,width:40,height:40})]),v=new i.a([i.a.always({flex:0,borderWidth:0,height:24,width:28})])},function(e,t,n){"use strict";var r;!function(e){e[e.Draft=0]="Draft",e[e.Normal=1]="Normal",e[e.Reply=2]="Reply",e[e.ReplyPostCommitPending=4]="ReplyPostCommitPending",e[e.ReplySessionRequestPending=5]="ReplySessionRequestPending",e[e.CardPostCommitPending=6]="CardPostCommitPending",e[e.DraftPreCommitPending=7]="DraftPreCommitPending",e[e.ReplyPreCommitPending=8]="ReplyPreCommitPending",e[e.Resolved=9]="Resolved",e[e.Loading=10]="Loading",e[e.LowFidelityWarningOnDeleteThread=11]="LowFidelityWarningOnDeleteThread"}(r||(r={})),t.a=r},function(e,t,n){"use strict";n.d(t,"g",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"i",(function(){return b}));var r=n(2),o=n(53),i=n(6),a=(n(72),n(60)),s=n(31);let c=o.a.None;function d(e){c=e}function l(){return c}function u(){return c===o.a.LargeDisplay}const p=e=>"ios"===e||"android"===e,h=e=>p(e.platform);function f(e){return{renderContextType:e,displayClass:l(),platform:"win32",isFluentEnabled:r.i()}}function m(e){return e===i.a.FullPane||Object(a.b)(e)}function g(e,t){return!e||t?s.a.WHITE:s.a.REST_RESOLVED_BODY}function b(e,t,n){return e&&(!n||t)}},function(e,t,n){"use strict";n.d(t,"l",(function(){return c})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"j",(function(){return p})),n.d(t,"k",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return m})),n.d(t,"m",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return C})),n.d(t,"n",(function(){return y})),n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return T}));n(8);var r=n(77),o=n(0),i=(n(72),n(29)),a=n(21),s=n(2);function c(e,t){return!(!e||!t)&&(e.UserId===t.UserId&&e.Provider===t.Provider)}function d(e){return e?Object(r.e)(e)?e.Name:e.DisplayName:""}function l(e){if(!e)return"";if(!Object(r.e)(e))return Object(o.i)().assertConditionTag(!s.r()||Object(i.e)("win32"),"LPP feature gate should not be enabled",594392914),e.Email;if(e.UserPrincipalName.length>0)return e.UserPrincipalName;if(e.EmailAddresses.length>0&&e.EmailAddresses[0].length>0)return Object(o.i)().assertConditionTag(!0,"UserPrincipalName is not available, fallback to EmailAddresses",594401410),e.EmailAddresses[0];throw new a.a("UserPrincipalName and EmailAddresses, both not available",589103706,-2130957499)}function u(e){if(!e)return"";if(Object(r.d)(e)){const t=e.Email||e.UserId;return Object(o.i)().assertConditionTag(!!t,"Email and UserId are both not available on IUser object",529024399),t}return l(e)}function p(e){return e.UserId?e.UserId:h(e)}function h(e){return void 0!==e.DisplayName?e.DisplayName:(Object(o.i)().assertConditionTag(!1,"user.DisplayName is undefined",595133131),e.Email?e.Email:"")}function f(e){return e.author?e.author:{UserId:e.authorIdentity,Provider:"",DisplayName:e.authorName,Email:e.authorEmail,IsCurrentUser:!0,appAuthorId:e.appAuthorId,authorContextId:e.authorContextId}}function m(e){return 0===Object.keys(e).length&&Object(o.i)().assertConditionTag(!1,"MentioneeMap should not be empty",594641282),e[Object.keys(e)[0]].mentionee}function g(e,t){t.forEach(t=>{t.UserId&&e[t.UserId]?delete e[t.UserId]:t.Email&&e[t.Email]&&delete e[t.Email]})}function b(e,t){return t.forEach(t=>{e[u(t)]={assignee:t}}),e}function C(e,t){Object.keys(t).forEach(n=>{e[n]={assignee:t[n].mentionee}})}function y(e,t){const n=u(t);e[n]?delete e[n]:e[n]={assignee:t}}function v(e){const t={};for(const n in e)e[n].stillInDraft&&(t[n]=e[n]);return t}function T(e){return e.some(e=>e.IsCurrentUser)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r={WHITE:"#FFFFFF",BLACK:"#000000",GRAY_A:"#F3F3F3",GRAY_B:"#E6E6E6",GRAY_C:"#D2D2D2",GRAY_C2:"#C6C6C6",GRAY_C3:"#B1B1B1",GRAY_D:"#969696",GRAY_E:"#666666",GRAY_F:"#505050",GRAY_H:"#363636",GRAY_H2:"#333333",GRAY_I:"#262626",GRAY_J:"#0A0A0A",Gray26:"#424242",Gray90:"#E5E5E5",GRAY_20:"#F3F2F1",GRAY_30:"#EDEBE9",GRAY_40:"#E1DFDD",GRAY_50:"#D2D0CE",GRAY_60:"#C8C6C4",GRAY_70:"#BEBBB8",GRAY_100:"#979593",GRAY_110:"#8A8886",GRAY_130:"#605E5C",GRAY_140:"#484644",GRAY_150:"#3B3A39",GRAY_160:"#323130",GRAY_180:"#252423",GRAY_200:"#1B1A19"},o={FIRST_RUN_GRAY:"#f7f7f7",COMMENTS_PURPLE:"#9C44A6",COMMENTS_GRAY:"#EAEAEA",FLUENT_RESOLVED:"#B3B0AD",FOCUS_BOX:"#797775",DOT_BLUE:"#006BFF",WARNING_RED:"#A80000",REST_RESOLVED_BODY:r.GRAY_20,RESOLVED_CARD_TEXT:r.GRAY_130,ACTIVE_COMMENT_TEXT:r.GRAY_H2,SUGGESTED_PICKER_ITEM:"#DEECF9",SUGGESTED_PICKER_ITEM_HOVER:"#C7E0F4"},i=Object.assign(Object.assign({},r),o)},function(e,t){e.exports=OfficePlatformGlobal.Polyester.Components},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c}));var r=n(63);const o=e=>e.paneState.visibilityState===r.a.Visible,i=e=>e.paneState.visibilityState!==r.a.Closed,a=e=>e.paneState.visibilityState,s=e=>e.paneState.componentTree,c=e=>e.paneState.viewContainer},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),o=n(306),i=n(1);const a=e=>{const{textStylePolyester:t,variantFluent:n,colorFluent:a}=e,s=Object(r.f)(e,["textStylePolyester","variantFluent","colorFluent"]);return i.createElement(o.a,Object.assign({variant:n,color:a},s))};a.displayName="TextWrapper"},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.CommentContextChanged=0]="CommentContextChanged",e[e.LoadComments=1]="LoadComments",e[e.CommentContextReload=2]="CommentContextReload",e[e.CommentsInserted=3]="CommentsInserted",e[e.CommentsDeleted=4]="CommentsDeleted",e[e.CommentsUpdated=5]="CommentsUpdated",e[e.CommentSelected=6]="CommentSelected",e[e.CommentHighlighted=7]="CommentHighlighted",e[e.NextPopulatedContextDetailsUpdated=8]="NextPopulatedContextDetailsUpdated",e[e.CommentError=9]="CommentError",e[e.CommentsChanged=10]="CommentsChanged",e[e.CommentHostCapabilitiesChanged=11]="CommentHostCapabilitiesChanged",e[e.ModelCapabilitiesChanged=12]="ModelCapabilitiesChanged",e[e.UpdateDraftThread=13]="UpdateDraftThread",e[e.ReturnToDraftRequested=14]="ReturnToDraftRequested",e[e.SmartReplyPopulated=15]="SmartReplyPopulated",e[e.NativeHeartbeat=50]="NativeHeartbeat"}(r||(r={}))},function(e,t,n){"use strict";var r;!function(e){e[e.New_nonFluent=0]="New_nonFluent",e[e.Normal=1]="Normal",e[e.Editing=2]="Editing",e[e.PendingDraft=3]="PendingDraft",e[e.PendingEdit=4]="PendingEdit",e[e.EditPreCommitPending=5]="EditPreCommitPending",e[e.Resolved=6]="Resolved",e[e.LowFidelityWarningEdit=7]="LowFidelityWarningEdit",e[e.LowFidelityWarningDelete=8]="LowFidelityWarningDelete",e[e.Error=9]="Error"}(r||(r={})),t.a=r},function(e,t,n){"use strict";function r(e){return""===e.parentId?e:void 0}function o(e){return e.parentId||e.commentId}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(1);const o=r.createContext(new Proxy({},{get:()=>{throw new Error("Theme undefined. Did you forget to render a theme context provider?")}}));function i(){return r.useContext(o)}},function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return p}));var r=n(11),o=n(7),i=n(15),a=n(18);function s(e){let t="";return Object(a.e)(e.componentType)?t=c(e.componentType):Object(a.c)(e)&&(t=d(e)),t}function c(e){switch(e){case a.a.ClosePaneButton:return i.k();case a.a.NextCommentButton:return i.A();case a.a.PreviousCommentButton:return i.I();case a.a.GhostCard:return i.v();case a.a.NewCommentButton:return i.z();case a.a.PaneRoot:return i.u();case a.a.CommentsList:return i.n()}}function d(e){switch(e.componentType){case a.a.Card:return i.j(e,!1);case a.a.DraftCard:return i.j(e,!0);case a.a.PostEditor:return i.s(i.C(e));case a.a.CardEditor:return i.s(i.e(e));case a.a.Post:return i.F(e);case a.a.DiscreteHostedCommentRoot:return i.p(e);case a.a.ReopenThreadButton:return i.c(e,i.K())}}function l(e){return e?a.a.DraftCard:a.a.Card}function u(e,t){return l(Object(o.G)(t)===e)}function p(e){var t,n;if(Object(r.o)(e)&&e.getId())return e.getId();const o=e.props?null!==(n=null!==(t=e.props.testId)&&void 0!==t?t:e.props.nodeId)&&void 0!==n?n:e.props.accessibilityLabel:void 0;return e.constructor.name+(o?"#"+o:"")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return g})),n.d(t,"z",(function(){return b})),n.d(t,"s",(function(){return C})),n.d(t,"i",(function(){return y})),n.d(t,"r",(function(){return v})),n.d(t,"t",(function(){return T})),n.d(t,"o",(function(){return S})),n.d(t,"q",(function(){return I})),n.d(t,"p",(function(){return O})),n.d(t,"n",(function(){return E})),n.d(t,"l",(function(){return P})),n.d(t,"k",(function(){return k})),n.d(t,"j",(function(){return R})),n.d(t,"m",(function(){return x})),n.d(t,"h",(function(){return D})),n.d(t,"g",(function(){return w})),n.d(t,"B",(function(){return A})),n.d(t,"A",(function(){return j})),n.d(t,"w",(function(){return _})),n.d(t,"x",(function(){return F})),n.d(t,"y",(function(){return M})),n.d(t,"v",(function(){return N})),n.d(t,"u",(function(){return L}));var r=n(11),o=n(2),i=n(6),a=n(50),s=n(27),c=n(29),d=n(4),l=n(12);const u=1,p=12,h=22,f=10,m=300,g=40,b=[d.b.rule({isFluentEnabled:!1},e=>({backgroundColor:e.palette.CardHeroBarBackground})),d.b.rule({renderContextType:i.a.HalfPane,isFluentEnabled:!1},e=>({backgroundColor:e.palette.CardHeroBarBackground_HalfPane}))],C=new d.b([d.b.always({flex:1,overflow:"hidden"}),d.b.rule({platform:"win32",isFluentEnabled:!0},{flexDirection:"column",alignItems:"stretch",justifyContent:"flex-start"})]),y=new d.b([d.b.always({flex:1,flexDirection:"column"}),d.b.rule(({renderContextType:e,platform:t,isFluentEnabled:n})=>Object(c.h)(e)&&"ios"!==t&&!n,e=>({borderWidth:u,borderColor:e.palette.CardAccent})),d.b.rule({isFluentEnabled:!0},{paddingLeft:p}),d.b.rule({platform:"win32",renderContextType:i.a.DiscreteIsolated},{paddingLeft:0}),d.b.rule({renderContextType:i.a.FullPane,platform:"ios"},e=>({borderWidth:a.b,borderColor:e.palette.CardAccent,borderRadius:a.a,overflow:"hidden"})),d.b.rule({renderContextType:i.a.HalfPane},{alignItems:"stretch"}),d.b.rule({renderContextType:i.a.HalfPane},e=>({backgroundColor:e.palette.CardBackground}))]),v=new d.b([d.b.rule({platform:"ios",renderContextType:i.a.HalfPane},e=>({backgroundColor:e.palette.CardReplyBackground}))]),T=Object(l.e)({flex:1,flexDirection:"column"}),S=Object(l.e)({justifyContent:"flex-end"}),I=new d.b([d.b.always({position:"absolute",backgroundColor:"transparent",flex:1,flexDirection:"column",justifyContent:"center",width:"100%",height:"100%",left:p,paddingBottom:u,paddingRight:u,paddingLeft:u}),d.b.rule({platform:"win32",renderContextType:i.a.DiscreteIsolated},{left:0})]),O=new d.b([d.b.always({position:"relative",borderRadius:2,flex:1,flexDirection:"column",justifyContent:"center",width:"100%",height:"100%"}),d.b.rule({isFluentEnabled:!0},{borderRadius:4,borderWidth:3,borderColor:"transparent"})]),E=new d.b([d.b.always(e=>({backgroundColor:e.palette.CardBackground,borderRadius:4,flex:1,borderWidth:u,borderColor:e.palette.CardBorder,borderStyle:7===e.themeId?"dashed":void 0,position:"absolute",left:s.g,justifyContent:"center",right:0,height:"100%"})),d.b.rule(({renderContextType:e})=>e===i.a.DiscreteIsolated,{left:0})]),P=new d.b([d.b.always(e=>({backgroundColor:e.palette.ResolvedCardBackground}))]),k=new d.b([d.b.always(e=>({borderColor:e.palette.CardBorderEmphasis,borderStyle:7===e.themeId?"solid":void 0})),d.b.rule(()=>!o.o(),e=>({backgroundColor:e.palette.CardHoveredBackground}))]),R=new d.b([d.b.always({borderWidth:3})]),x=new d.b([d.b.always(e=>({borderColor:e.palette.CardBorderEmphasis,borderWidth:2,borderStyle:7===e.themeId?"solid":void 0}))]),D=new d.b([d.b.always({position:"absolute",height:"100%",width:2}),d.b.rule({isFluentEnabled:!0},{marginLeft:p})]),w=new d.b([d.b.always(e=>({backgroundColor:e.palette.CardSelectionColor}))]),A=Object(l.e)({flex:1,justifyContent:"center"}),j=Object(l.e)({paddingBottom:s.e});function _(e,t){return e===r.b.FocusOn?3:t?2:u}function F(e){return{marginRight:e,marginLeft:e,marginBottom:e}}function M(e){return new d.b([d.b.always(t=>({flex:0,flexDirection:"row",padding:12-e,paddingTop:11,borderTopWidth:1,borderColor:t.palette.CardBorder}))])}const N=Object(l.e)({height:16,width:16,marginTop:1,marginRight:8}),L=Object(l.e)({flexDirection:"column",flex:1})},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return d}));var r=n(344),o=n(345),i=n(346),a=n(9),s=function(e){for(var t in e)for(var n in e[t]){var r=e[t][n];if("string"==typeof r&&r.includes("PlatformColor")){var o=r.substring(14,r.length-1);e[t][n]=Object(a.PlatformColor)(o)}}return e}(n(280));var c=n(281);function d(e){return"light"===e?o:"dark"===e?i:"highContrast"===e?s:(Object(c.assertNever)(e),o)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),o=n(1);function i(e,...t){const n=[];if(!t.length)return e();const i=t.reduceRight((t,r,i)=>()=>o.createElement(r.Consumer,null,r=>(n[i]=r,null===t?e(...n):t())),null);return i?i():(Object(r.i)().assertConditionTag(!1,"Contexts failed to wrap, default to raw render.",575479898),e())}},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l}));var r=n(247),o=n(26);o.CustomTypeRegistry.registerTypeInfos({"SDX::Docs::FeatureGate::JS::GateValue":{gate:"$string",value:"$boolean"}});var i=o.RekaServiceRegistry.getNativeService(["SDX::Docs::FeatureGate::JS::FeatureGateModule",{Values:["Constant",["$array","SDX::Docs::FeatureGate::JS::GateValue"]]}]),a=function(){function e(){this.gateValues=new Map((i.Values||[]).map((function(e){return[e.gate,e.value]})))}return e.prototype.isGateEnabled=function(e,t){var n=this.gateValues.get(e);return null!=n?n:t},e.prototype.isFeatureEnabled=function(e){return this.isGateEnabled(e,!1)},e.prototype.isChangeGateEnabled=function(e,t){return this.isGateEnabled(e,!0)},e}(),s=new r.a("FeatureGate",a);function c(e){return e}function d(e){return s.getAndInitialize(e)}function l(){return s.getInstanceOrThrow()}},,function(e,t,n){"use strict";n.d(t,"j",(function(){return r.a})),n.d(t,"k",(function(){return r.c})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b})),n.d(t,"d",(function(){return o.d})),n.d(t,"e",(function(){return o.f})),n.d(t,"c",(function(){return o.c})),n.d(t,"h",(function(){return o.j})),n.d(t,"f",(function(){return o.g})),n.d(t,"g",(function(){return o.h})),n.d(t,"i",(function(){return o.k}));var r=n(239),o=n(81)},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unhandled=0]="Unhandled",e[e.Handled=1]="Handled",e[e.Canceled=2]="Canceled",e[e.Failed=3]="Failed"}(r||(r={}))},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o,i,a,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[n,r,o,i,a,s],l=0;(c=new Error(t.replace(/%s/g,(function(){return d[l++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},function(e,t,n){"use strict";var r;function o(e){switch(e){case"ins":return r.Insert;case"mod":return r.Modify;case"del":return r.Delete;case"load":return r.Load;default:return r.Unknown}}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),function(e){e.Unknown="unk",e.Insert="ins",e.Modify="mod",e.Delete="del",e.Load="load"}(r||(r={})),t.b=r},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return r}));var r,o=n(148);function i(e){return e===o.a.CheckEnabled}function a(e){return e===o.a.CheckToggled}function s(e){return e===o.a.Execute}!function(e){e[e.Success=0]="Success",e[e.Fail=1]="Fail",e[e.NotHandled=2]="NotHandled"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return f})),n.d(t,"l",(function(){return m})),n.d(t,"w",(function(){return g})),n.d(t,"x",(function(){return b})),n.d(t,"i",(function(){return C})),n.d(t,"m",(function(){return y})),n.d(t,"g",(function(){return v})),n.d(t,"f",(function(){return T})),n.d(t,"h",(function(){return S})),n.d(t,"k",(function(){return I})),n.d(t,"v",(function(){return O})),n.d(t,"u",(function(){return E})),n.d(t,"q",(function(){return P})),n.d(t,"j",(function(){return k})),n.d(t,"r",(function(){return R})),n.d(t,"s",(function(){return x})),n.d(t,"t",(function(){return D})),n.d(t,"n",(function(){return w})),n.d(t,"o",(function(){return A})),n.d(t,"p",(function(){return j}));var r=n(9),o=n(53),i=n(6),a=n(29),s=n(4),c=n(12);const d=16,l=16,u=12,p=r.StyleSheet.hairlineWidth,h=4,f=r.StyleSheet.hairlineWidth,m=e=>({shadowColor:e.palette.CardShadowColor,shadowOffset:{height:1,width:0},shadowRadius:2,shadowOpacity:.1}),g=new s.b([s.b.always({minWidth:64}),s.b.rule({displayClass:o.a.LargeDisplay},{width:100})]),b=new s.a([s.a.always({minWidth:96,textAlign:"center"}),s.a.rule({displayClass:o.a.LargeDisplay},{width:120})]),C=new s.b([s.b.always(e=>({flex:1,flexDirection:"column",justifyContent:"flex-start",alignItems:"stretch",backgroundColor:e.palette.PaneBackground})),s.b.rule({renderContextType:i.a.HalfPane},e=>({backgroundColor:e.palette.PaneBackground_HalfPane})),s.b.rule({platform:"ios",renderContextType:i.a.FullPane},{borderTopColor:"transparent",borderTopWidth:1})]),y=new s.b([s.b.always({position:"absolute",bottom:0,left:0,right:0}),s.b.rule(a.d,{zIndex:100})]),v=Object(c.e)({marginBottom:u}),T=new s.b([s.b.always(e=>Object.assign({marginBottom:u},m(e))),s.b.rule(a.d,{marginLeft:d,marginRight:l}),s.b.rule({platform:"android"},e=>({elevation:2,backgroundColor:e.palette.CardBackground})),s.b.rule({platform:"ios"},{borderRadius:h})]),S=new s.b([s.b.always(e=>({flex:1,flexDirection:"column",borderRightWidth:p,borderRightColor:e.palette.CardAccent,borderLeftWidth:p,borderLeftColor:e.palette.CardAccent}))]),I=new s.b([s.b.always(e=>({flex:1,alignSelf:"stretch",borderRightWidth:p,borderRightColor:e.palette.CardAccent,borderLeftWidth:p,borderLeftColor:e.palette.CardAccent}))]),O=Object(c.e)({flexDirection:"row",alignItems:"center"}),E=Object(c.e)({flex:1,justifyContent:"center"}),P=new s.b([s.b.rule({platform:"ios",displayClass:o.a.SmallPhone},{width:55,paddingLeft:0,paddingRight:0,marginLeft:0,marginRight:0}),s.b.rule({platform:"ios",displayClass:o.a.LargeDisplay},{paddingLeft:12,paddingRight:12,marginLeft:0,marginRight:0})]),k=new s.b([s.b.rule({platform:"ios",renderContextType:i.a.FullPane},e=>({borderTopColor:e.palette.ApplePaneTopBorder}))]),R=new s.b([s.b.always(e=>({backgroundColor:e.palette.CardBackground,borderWidth:1,borderColor:e.palette.CardAccent,borderRadius:2,minHeight:24,minWidth:67,marginBottom:12,alignSelf:"flex-end"}))]),x=new s.b([s.b.rule({platform:"win32"},{marginRight:28})]),D=new s.b([s.b.rule({platform:"win32"},{paddingRight:12})]),w=Object(c.e)({borderWidth:0}),A=new s.b([s.b.rule({platform:"win32"},{borderColor:"transparent",borderWidth:2})]),j=new s.b([s.b.rule({platform:"win32"},e=>({borderColor:e.palette.FocusBorderColor}))])},function(e,t,n){"use strict";function r(e){return void 0!==e.numberOfComments&&void 0!==e.numberOfThreads}function o(e){return void 0!==e.comments||void 0!==e.threads}function i(e){return void 0!==e.threads&&void 0===e.comments}var a;function s(e){return void 0!==e.comments||void 0!==e.commentIds}function c(e){return void 0!==e.commentIds}function d(e){return void 0!==e.changes}function l(e){return void 0!==e.commentId}function u(e){return void 0!==e.commentId}function p(e){return void 0!==e.contextDetails}function h(e){return void 0!==e.modelCapabilityFlags}function f(e){return void 0!==e.errorType}function m(e){return void 0!==e.draftId}function g(e){return void 0!==e.draftId}function b(e){return void 0!==e.commentId&&void 0!==e.smartReplies}n.d(t,"b",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"o",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"k",(function(){return p})),n.d(t,"j",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"l",(function(){return m})),n.d(t,"n",(function(){return g})),n.d(t,"m",(function(){return b})),function(e){e[e.Thread=0]="Thread",e[e.Reply=1]="Reply"}(a||(a={}))},function(e,t,n){"use strict";var r,o,i;n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return h})),n.d(t,"e",(function(){return f})),function(e){e[e.None=0]="None",e[e.Canvas=1]="Canvas"}(r||(r={})),function(e){e[e.Keyboarding=1]="Keyboarding",e[e.HostAction=2]="HostAction"}(o||(o={})),function(e){e[e.None=0]="None",e[e.Next=1]="Next",e[e.Previous=2]="Previous"}(i||(i={}));var a={ContentNavigationModule:n(26).RekaServiceRegistry.getNativeService(["SDX::ContentExtension::Navigation::ContentNavigationModule",{selectNextOrPreviousContent:["FireAndForgetMethod",["$string","SDX::ContentExtension::Navigation::SelectNextOrPreviousContentArgs"]],moveFocus:["FireAndForgetMethod",["$string","SDX::ContentExtension::Navigation::MoveFocusArgs"]],bringContentIntoView:["FireAndForgetMethod",["$string","SDX::ContentExtension::Navigation::BringContentIntoViewArgs"]]}])},s=function(){function e(e){this.apiContext=e}return e.prototype.selectNextOrPreviousContent=function(e){this.getModule().selectNextOrPreviousContent(this.apiContext,e)},e.prototype.moveFocus=function(e){this.getModule().moveFocus(this.apiContext,e)},e.prototype.bringContentIntoView=function(e){this.getModule().bringContentIntoView(this.apiContext,e)},e.prototype.getModule=function(){return a.ContentNavigationModule},e}(),c=n(8),d=n(0),l=new Map;function u(e,t){Object(d.i)().assertConditionTag(!l.has(t),"ContentNavigation API previously set and is being overwritten for this API Context.",591726556),l.set(t,e)}function p(e){var t=l.get(e);if(!t)throw new c.d("ContentNavigationAPI not set for this APIContext",589103765);return t}function h(e){return l.has(e)}function f(e){l.delete(e)}!function(){function e(){}e.prototype.selectNextOrPreviousContent=function(e){},e.prototype.moveFocus=function(e){},e.prototype.bringContentIntoView=function(e){}}()},function(e,t,n){"use strict";var r;function o(e){return function(e){return Object.values(r).includes(e)}(e)?e:r.None}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e.None="NONE",e.SmallPhone="SMALL_PHONE",e.Phablet="PHABLET",e.LargeDisplay="LARGE_DISPLAY",e.Infinite="INFINITE"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"t",(function(){return b})),n.d(t,"h",(function(){return C})),n.d(t,"g",(function(){return y})),n.d(t,"f",(function(){return v})),n.d(t,"e",(function(){return T})),n.d(t,"n",(function(){return S})),n.d(t,"j",(function(){return I})),n.d(t,"a",(function(){return E})),n.d(t,"d",(function(){return P})),n.d(t,"i",(function(){return k})),n.d(t,"l",(function(){return R})),n.d(t,"o",(function(){return x})),n.d(t,"p",(function(){return D})),n.d(t,"s",(function(){return w})),n.d(t,"r",(function(){return A})),n.d(t,"c",(function(){return j})),n.d(t,"k",(function(){return _})),n.d(t,"b",(function(){return F})),n.d(t,"m",(function(){return M})),n.d(t,"q",(function(){return N}));n(114);var r=n(8),o=n(413),i=n(0),a=n(69),s=n(30),c=n(21),d=n(61),l=n(2),u=n(91),p=n(17),h=n(28),f=n(76),m=n(71),g=n(6);function b(e,t,n){const r=n&&l.i()?t-1:t-2;if(r<1)throw new c.a(d.g,589103692,-2130957559);const o=l.i();return 1===r?o?e.getString(106):e.getString(9):o?e.formatString(107,String(r)):e.formatString(10,String(r))}function C(e,t){switch(t){case a.a.AtFinishNextCommentIsFirst:return e.getString(8);case a.a.AtStartNextCommentIsFirst:return e.getString(6);case a.a.MoreCommentsUpcoming:case a.a.DocumentHasComments:return e.getString(7);case a.a.OnlyCommentsInCurrent:case a.a.NoComments:case a.a.Unknown:return"";default:Object(r.m)(t)}}function y(e,t,n){return t===a.a.NoComments?e.getString(13):n===g.a.HalfPane?e.getString(228):void 0}function v(e,t,n,r){return n?t?e.getString(16):e.getString(17):l.y()&&void 0!==r&&r!==f.a.InCard?e.getString(108):t?e.getString(11):e.getString(12)}function T(e,t){switch(t){case u.a.ReturnToDraft:return e.getString(110);case u.a.GrantAccessFailedSilently:return e.getString(134);case u.a.GrantAccessCanceled:return e.getString(234);case u.a.CommitFailed:return e.getString(135);case u.a.None:return Object(i.i)().assertConditionTag(!1,"Invalid DraftWarningType: "+t,595686755),""}}function S(e,t=!0){return t?e.getStringWithStandardPlaceholders(112):e.getStringWithStandardPlaceholders(113)}function I(e,t){return t?Object(p.f)(t)?e.getString(35):Object(p.c)(t)?e.getString(36):"":""}const O=Object(o.a)(()=>{try{(new Date).toLocaleDateString("i")}catch(e){return e instanceof Error&&"RangeError"===e.name}return!1});function E(e,t){const n=!!t&&O();try{if(n){const n={hour:"numeric",minute:"2-digit",day:"numeric",month:"long",year:"numeric",timeZone:void 0};return e.toLocaleDateString(t,n)}return Object(i.i)().assertConditionTag(!1,`The locale and/or options arguments are not supported, doesToLocaleDateStringSupportsLocales: ${O()}, locale Exists: ${!!t}`,595882385),e.toLocaleDateString()}catch(n){return Object(i.i)().assertConditionTag(!1,`LocaleDateString conversion failed: ${n instanceof Error?n.name:""}, locale Exists: ${!!t}, doesToLocaleDateStringSupportsLocales: ${O()}, Date: ${e.toString()}`,595953050),""}}function P(e,t){switch(t){case m.a.DeleteThread:return function(e){return{title:e.getString(75),confirmButton:e.getString(77),cancelButton:e.getString(78)}}(e);case m.a.CancelNewDraft:case m.a.CancelReplyDraft:case m.a.CancelPostEdit:case m.a.ClosePaneDraft:return function(e){return{body:e.getString(69),title:e.getString(68),confirmButton:e.getString(70),cancelButton:e.getString(71)}}(e)}}function k(e,t){return{loading:t.loading||e.getString(94),error:t.error||e.getString(95),limitedResults:t.limitedResults||e.getString(96),emptyResults:t.emptyResults||e.getString(93),allResults:t.allResults||"",atMentionsModePlaceholderText:t.atMentionsModePlaceholderText||"",pickerModePlaceholderText:t.pickerModePlaceholderText||"",suggestionsAnnouncement:t.suggestionsAnnouncement||e.getString(97),useThisAddress:t.useThisAddress||"",selectedSuggestionAccessibilityLabel:t.selectedSuggestionAccessibilityLabel||e.getStringOrUndefined(198)||"",selectedSuggestionNumberAccessibilityLabel:t.selectedSuggestionNumberAccessibilityLabel||e.getStringOrUndefined(199)||"",suggestionsAvailableAnnouncement:t.suggestionsAvailableAnnouncement||""}}function R(e){return e.getString(122)}function x(e,t){return 0===e.length?(Object(i.i)().assertConditionTag(l.h(),"Unexpected state: task is unassigned",528064848),w(t)):l.h()&&1!==e.length?Object(s.c)(e)?t.getString(250):t.getString(251):function(e,t){return e.IsCurrentUser?t.getString(127):t.formatString(111,Object(s.k)(e))}(e[0],t)}function D(e,t,n){if(0===e.length)return A(t,n);if(!l.h())return function(e,t,n){return e.IsCurrentUser?t?n.getString(132):n.getString(131):t?n.formatString(130,Object(s.k)(e)):n.formatString(129,Object(s.k)(e))}(e[0],t,n);const r=e.map(e=>Object(s.k)(e)).join(", ");return t?n.formatString(130,r):n.formatString(129,r)}function w(e){return e.formatString(111,e.getString(133))}function A(e,t){return e?t.formatString(130,t.getString(133)):t.formatString(129,t.getString(133))}function j(e,t,n,r){var o;const i=t===h.a.Draft||t===h.a.DraftPreCommitPending;return null!==(o=F(e,n,r))&&void 0!==o?o:i?e.getString(173):e.getString(174)}function _(e,t,n){let r="";switch(n.length){case 0:r=e.getString(133);break;case 1:r=n[0];break;case 2:r=e.formatString(242,n[0],n[1]);break;case 3:r=e.formatString(243,n[0],n[1],n[2]);break;default:r=e.formatString(244,n[0],(n.length-1).toString())}const o=t?114:252;return e.formatString(o,r)}function F(e,t,n){const r=Object(s.g)(n);if(r)return e.formatString(t?179:178,r)}function M(e,t){return e?t.getString(176):t.getString(126)}function N(e,t,n){return l.h()?0===t.length?n.getString(181):n.formatString(114,t.map(e=>Object(s.k)(e)).join(", ")):function(e,t,n){return e?n.getString(180):(null==t?void 0:t.DisplayName)?n.formatString(114,t.DisplayName):n.getString(181)}(e,t[0],n)}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReadOnly=1]="ReadOnly",e[e.LowFidelity=2]="LowFidelity",e[e.Locked=4]="Locked",e[e.Resolved=8]="Resolved",e[e.EditRestricted=16]="EditRestricted",e[e.IsNew=32]="IsNew",e[e.DeleteRestricted=64]="DeleteRestricted"}(r||(r={}))},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,n.apply(this,arguments)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"s",(function(){return l})),n.d(t,"o",(function(){return u})),n.d(t,"n",(function(){return p})),n.d(t,"i",(function(){return h})),n.d(t,"j",(function(){return f})),n.d(t,"f",(function(){return m})),n.d(t,"h",(function(){return g})),n.d(t,"g",(function(){return b})),n.d(t,"k",(function(){return C})),n.d(t,"r",(function(){return y})),n.d(t,"p",(function(){return v})),n.d(t,"q",(function(){return T})),n.d(t,"c",(function(){return S})),n.d(t,"b",(function(){return I})),n.d(t,"e",(function(){return O})),n.d(t,"u",(function(){return E})),n.d(t,"v",(function(){return P})),n.d(t,"d",(function(){return k})),n.d(t,"t",(function(){return R})),n.d(t,"l",(function(){return x})),n.d(t,"m",(function(){return D})),n.d(t,"w",(function(){return w})),n.d(t,"x",(function(){return A}));var r=n(53),o=n(6),i=n(27),a=n(29),s=n(4),c=n(12);const d=64,l=new s.b([s.b.always({alignItems:"flex-start",flex:-1,flexDirection:"row"}),s.b.rule({isFluentEnabled:!1},e=>({paddingLeft:i.g,paddingTop:i.g,paddingBottom:i.g,backgroundColor:e.palette.CardBackground})),s.b.rule({displayClass:r.a.LargeDisplay,renderContextType:o.a.HalfPane},{paddingLeft:i.f,paddingTop:i.h,paddingBottom:i.h}),...i.n]),u=new s.b([s.b.always({flexDirection:"row",alignItems:"flex-start",alignSelf:"stretch",paddingRight:i.g-6,paddingBottom:1})]),p=new s.b([s.b.always(e=>({borderColor:e.palette.FocusBorderColor,borderStyle:"dashed"}))]),h=new s.b([s.b.rule({isFluentEnabled:!1},{marginRight:i.g,minHeight:i.b,marginTop:i.c}),s.b.rule({displayClass:r.a.LargeDisplay,renderContextType:o.a.HalfPane},{marginRight:i.f}),s.b.rule({isFluentEnabled:!0},{marginRight:i.g})]),f=new s.b([s.b.always({marginRight:3,marginBottom:3})]),m=new s.b([s.b.always(e=>({backgroundColor:e.palette.CardBackground}))]),g=new s.b([s.b.always(e=>({backgroundColor:e.palette.ResolvedCardBackground}))]),b=new s.b([s.b.always(e=>({backgroundColor:e.palette.CardHoveredBackground}))]),C=Object(c.e)({overflow:"hidden"}),y=new s.b([s.b.always(e=>({position:"absolute",width:"100%",backgroundColor:e.palette.CardBackground,bottom:0,borderBottomWidth:6,borderColor:e.palette.CardBackground,height:7===e.themeId?11.5:17})),s.b.rule({platform:"win32"},e=>7===e.themeId?{}:{backgroundColor:{gradientDirection:"ToTop",colorStops:[{color:Object(c.h)(e.palette.CardBackground,"CC"),offset:0},{color:Object(c.h)(e.palette.CardBackground,"00"),offset:1}]}})]),v=new s.b([s.b.always(e=>({position:"absolute",width:"100%",backgroundColor:e.palette.CardHoveredBackground,bottom:0,borderBottomWidth:6,borderColor:e.palette.CardHoveredBackground,height:7===e.themeId?11.5:17})),s.b.rule({platform:"win32"},e=>7===e.themeId?{}:{backgroundColor:{gradientDirection:"ToTop",colorStops:[{color:Object(c.h)(e.palette.CardHoveredBackground,"CC"),offset:0},{color:Object(c.h)(e.palette.CardHoveredBackground,"00"),offset:1}]}})]),T=new s.b([s.b.always(e=>({position:"absolute",width:"100%",backgroundColor:e.palette.ResolvedCardBackground,bottom:0,borderBottomWidth:6,borderColor:e.palette.ResolvedCardBackground,height:7===e.themeId?11.5:17})),s.b.rule({platform:"win32"},e=>7===e.themeId?{}:{backgroundColor:{gradientDirection:"ToTop",colorStops:[{color:Object(c.h)(e.palette.ResolvedCardBackground,"CC"),offset:0},{color:Object(c.h)(e.palette.ResolvedCardBackground,"00"),offset:1}]}})]),S=new s.b([s.b.rule({displayClass:r.a.LargeDisplay,renderContextType:o.a.HalfPane},{marginTop:32,marginBottom:32}),s.b.rule({platform:"win32"},{minHeight:36,alignItems:"flex-end"}),s.b.rule(a.d,{flexWrap:"wrap"})]),I=new s.b([s.b.rule({displayClass:r.a.LargeDisplay,renderContextType:o.a.HalfPane},{paddingLeft:32,paddingRight:32})]),O=new s.a([s.a.rule({isFluentEnabled:!0},{flex:1,marginTop:3,marginRight:4}),s.a.rule({isFluentEnabled:!1},{marginRight:i.g+56,alignSelf:"flex-start"})]),E=new s.b([s.b.rule({isFluentEnabled:!1},e=>({borderTopWidth:1,borderColor:e.palette.CardReplyTopBorder})),...i.l,s.b.rule({isFluentEnabled:!0},{marginTop:i.d,marginBottom:i.d+3,paddingTop:1})]),P=new s.b([s.b.rule({platform:"ios",renderContextType:o.a.HalfPane,isFluentEnabled:!1},e=>({borderTopWidth:0,backgroundColor:e.palette.CardReplyBackground_HalfPane}))]),k=new s.b([s.b.always({flexDirection:"column",alignItems:"stretch",flex:1})]),R=Object(c.e)({paddingBottom:0}),x=new s.b([s.b.always({flex:1,flexDirection:"column",alignItems:"stretch"}),s.b.rule({isFluentEnabled:!1},{marginLeft:i.e}),s.b.rule({isFluentEnabled:!0},{paddingLeft:9})]),D=Object(c.e)({paddingRight:10}),w=Object(c.e)({paddingLeft:13}),A=new s.b([s.b.always({flex:1,alignItems:"center",justifyContent:"center",position:"absolute",backgroundColor:"rgba(0,0,0,0.1)",width:"100%",height:"100%"}),s.b.rule(a.d,{zIndex:100})])},function(e,t,n){"use strict";var r;!function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"}(r||(r={})),t.a=r},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Placeholder=0]="Placeholder",e[e.Loaded=1]="Loaded",e[e.Loading=2]="Loading",e[e.Reloading=3]="Reloading",e[e.NeedsReload=4]="NeedsReload"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(6);function o(e){return e===r.a.FullPane||e===r.a.HalfPane}function i(e){return e===r.a.DiscreteIntegrated||e===r.a.DiscreteIsolated}function a(e,t){return e!==t&&(o(e)&&o(t))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"k",(function(){return o})),n.d(t,"l",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"j",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"m",(function(){return u})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return h})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return m}));const r="Duplicate instance registration",o="Selected comment not found",i="Selected thread index out of bounds",a="Invalid number of posts for display more replies string",s="Method not implemented",c="Not enough replacement strings given",d="LocalizationModule NativeModule not valid",l="Maximum of 100 replacements",u="Store state unexpected",p="Invalid arguments",h="Comment ID value is invalid in the current operation",f="Attempting to perform an operation on an inactive draft",m="CommentModel not found in a thread of RenderableItems"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a}));var r,o=n(10);function i(e){switch(e){case r.SelectCard:case r.Polite:return!1;case r.ExpandCard:case r.SelectPost:return!0}}function a(e,t,n,r,i){return Object(o.b)("SELECT_COMMENT",{selectedCard:t,selectedPost:n,selectType:r,source:i},e)}!function(e){e[e.ExpandCard=0]="ExpandCard",e[e.SelectCard=1]="SelectCard",e[e.SelectPost=2]="SelectPost",e[e.Polite=3]="Polite"}(r||(r={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Closed=1]="Closed",e[e.Hidden=2]="Hidden",e[e.Visible=3]="Visible"}(r||(r={}))},function(e,t,n){"use strict";function r(e){return!!e&&!!e.commentModel}function o(e){return!!e&&!!e.historyItem}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Editor=1]="Editor",e[e.Card=2]="Card",e[e.Delete=3]="Delete"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(1);const o=r.createContext(new Proxy({},{get:()=>{throw new Error("ComponentTreeIdContext undefined. Did you forget to render a ComponentTreeIdContext context provider?")}}));function i(){return r.useContext(o)}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.HalfPane="half-pane",e.FullPane="full-pane"}(r||(r={})),t.b=r},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a}));const r="CREATE",o="EDIT",i="REPLY",a="METADATA"},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.NoComments=1]="NoComments",e[e.AtStartNextCommentIsFirst=2]="AtStartNextCommentIsFirst",e[e.MoreCommentsUpcoming=3]="MoreCommentsUpcoming",e[e.AtFinishNextCommentIsFirst=4]="AtFinishNextCommentIsFirst",e[e.OnlyCommentsInCurrent=5]="OnlyCommentsInCurrent",e[e.DocumentHasComments=6]="DocumentHasComments"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"i",(function(){return r.j})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.e})),n.d(t,"g",(function(){return r.h})),n.d(t,"d",(function(){return r.f})),n.d(t,"f",(function(){return r.g})),n.d(t,"h",(function(){return r.i})),n.d(t,"e",(function(){return o.a}));var r=n(45);var o=n(255);n(171),n(84),n(136),n(67)},function(e,t,n){"use strict";var r;!function(e){e[e.CancelNewDraft=0]="CancelNewDraft",e[e.CancelReplyDraft=1]="CancelReplyDraft",e[e.CancelPostEdit=2]="CancelPostEdit",e[e.DeleteThread=3]="DeleteThread",e[e.ClosePaneDraft=4]="ClosePaneDraft"}(r||(r={})),t.a=r},function(e,t,n){"use strict";n(9)},function(e,t){e.exports=OfficePlatformGlobal.Telemetry.OTel},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var r=n(0),o=n(9),i=n(31),a=n(2);function s(e){var t,n,r,o,i,a,s,c,d,l,u,p;return{buttonBackground:"transparent",buttonHoveredBackground:"transparent",expandButtonTextColor:null!==(n=null===(t=e.host.palette)||void 0===t?void 0:t.TextEmphasis)&&void 0!==n?n:"bodyText",selectedText:null!==(o=null===(r=e.host.palette)||void 0===r?void 0:r.Text)&&void 0!==o?o:"bodyText",subTextColor:null!==(a=null===(i=e.host.palette)||void 0===i?void 0:i.TextSecondary)&&void 0!==a?a:"subText",text:null!==(c=null===(s=e.host.palette)||void 0===s?void 0:s.Text)&&void 0!==c?c:"bodyText",warningTextColor:null!==(l=null===(d=e.host.palette)||void 0===d?void 0:d.TextError)&&void 0!==l?l:"bodyText",warningDraftboxColor:null!==(p=null===(u=e.host.palette)||void 0===u?void 0:u.TextError)&&void 0!==p?p:"bodyText"}}function c(e){var t,n,r,o,c,d,l;return Object.assign(Object.assign({},s(e)),{assignedToYouBackground:null!==(n=null===(t=e.host.colors)||void 0===t?void 0:t.App1)&&void 0!==n?n:"background",assignedToYouText:null!==(o=null===(r=e.host.colors)||void 0===r?void 0:r.App6)&&void 0!==o?o:"bodyText",completedCheckColor:i.a.WHITE,completedSquareCheckboxColor:i.a.GRAY_140,expandButtonTextHoverColor:null!==(l=a.o()?null===(c=e.host.colors)||void 0===c?void 0:c.AppShade10:null===(d=e.host.colors)||void 0===d?void 0:d.App8)&&void 0!==l?l:"bodyText",roundCheckboxBorderColor:i.a.BLACK,squareCheckboxBorderColor:i.a.BLACK})}function d(e){var t,n,r,o,c,d,l;return Object.assign(Object.assign({},s(e)),{assignedToYouBackground:null!==(n=null===(t=e.host.colors)||void 0===t?void 0:t.App2)&&void 0!==n?n:"background",assignedToYouText:null!==(o=null===(r=e.host.colors)||void 0===r?void 0:r.App7)&&void 0!==o?o:"bodyText",checkHoverColor:i.a.GRAY_70,completedCheckColor:i.a.GRAY_180,completedSquareCheckboxColor:i.a.GRAY_30,expandButtonTextHoverColor:null!==(l=a.o()?null===(c=e.host.colors)||void 0===c?void 0:c.AppTint40:null===(d=e.host.colors)||void 0===d?void 0:d.App1)&&void 0!==l?l:"bodyText",menuFocus:i.a.GRAY_130,roundCheckboxBorderColor:i.a.WHITE,squareCheckboxBorderColor:i.a.GRAY_100})}function l(e){const t=e.colors;return function(e){return void 0!==e.assignedToYouBackground&&void 0!==e.assignedToYouText&&void 0!==e.buttonBackground&&void 0!==e.buttonHoveredBackground&&void 0!==e.checkHoverColor&&void 0!==e.completedCheckColor&&void 0!==e.completedSquareCheckboxColor&&void 0!==e.expandButtonTextColor&&void 0!==e.expandButtonTextHoverColor&&void 0!==e.menuFocus&&void 0!==e.roundCheckboxBorderColor&&void 0!==e.selectedText&&void 0!==e.squareCheckboxBorderColor&&void 0!==e.subTextColor&&void 0!==e.text&&void 0!==e.warningDraftboxColor&&void 0!==e.warningTextColor}(t)?t:(Object(r.i)().assertConditionTag(!1,"Comments fluent theme is not being provided",588910614),p(e).colors)}const u=e=>{switch(e.name){case"Colorful":return p(e);case"White":return function(e){return{colors:Object.assign(Object.assign({},c(e)),{checkHoverColor:i.a.GRAY_140,menuFocus:i.a.GRAY_50})}}(e);case"Black":case"DarkGray":return function(e){return{colors:d(e)}}(e);case"HighContrast":return{colors:{assignedToYouBackground:Object(o.PlatformColor)("Highlight"),assignedToYouText:Object(o.PlatformColor)("HighlightText"),buttonBackground:Object(o.PlatformColor)("ButtonFace"),buttonHoveredBackground:Object(o.PlatformColor)("Highlight"),checkHoverColor:Object(o.PlatformColor)("Highlight"),completedCheckColor:Object(o.PlatformColor)("ButtonText"),completedSquareCheckboxColor:Object(o.PlatformColor)("ButtonFace"),expandButtonTextColor:Object(o.PlatformColor)("ButtonText"),expandButtonTextHoverColor:Object(o.PlatformColor)("HighlightText"),menuFocus:Object(o.PlatformColor)("Highlight"),roundCheckboxBorderColor:Object(o.PlatformColor)("ButtonText"),selectedText:Object(o.PlatformColor)("HighlightText"),squareCheckboxBorderColor:Object(o.PlatformColor)("ButtonText"),subTextColor:Object(o.PlatformColor)("WindowText"),text:Object(o.PlatformColor)("WindowText"),warningDraftboxColor:Object(o.PlatformColor)("ButtonText"),warningTextColor:Object(o.PlatformColor)("WindowText")}};default:return{}}};function p(e){return{colors:Object.assign(Object.assign({},c(e)),{checkHoverColor:i.a.GRAY_130,menuFocus:i.a.GRAY_40})}}},function(e,t,n){"use strict";var r=Array.isArray;t.a=r},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InCard=1]="InCard",e[e.InChildPost=2]="InChildPost",e[e.InOtherCard=3]="InOtherCard",e[e.InOtherContextOfThisCard=4]="InOtherContextOfThisCard"}(r||(r={}))},function(e,t,n){"use strict";var r,o,i;function a(e){return!!e&&void 0!==e.Id&&void 0!==e.Name&&void 0!==e.UserPrincipalName&&void 0!==e.EmailAddresses&&void 0!==e.SuggestionType&&void 0!==e.SuggestionSubtype&&void 0!==e.HostAppSuggestion&&void 0!==e.Source&&void 0!==e.SuggestionOrigin}function s(e){return!!e&&void 0!==e.UserId&&void 0!==e.Provider}n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.MSGraph=1]="MSGraph",e[e.Loki=2]="Loki"}(r||(r={})),function(e){e[e.None=0]="None",e[e.GetContactsForMentions=2]="GetContactsForMentions",e[e.GetAuthToken=4]="GetAuthToken",e[e.GetSuggestionsDetails=8]="GetSuggestionsDetails"}(o||(o={})),function(e){e[e.Success=0]="Success",e[e.UnknownError=1]="UnknownError",e[e.FailedSilently=2]="FailedSilently",e[e.DialogCanceled=3]="DialogCanceled"}(i||(i={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.AddComment=0]="AddComment",e[e.NextThread=1]="NextThread",e[e.PreviousThread=2]="PreviousThread",e[e.DeleteThread=3]="DeleteThread",e[e.BackKeyPressed=4]="BackKeyPressed",e[e.ShowHideCommentPane=6]="ShowHideCommentPane"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return k})),n.d(t,"b",(function(){return _})),n.d(t,"a",(function(){return r.a}));var r=n(110),o=n(162);var i=n(3),a=(n(300),n(9)),s={Bkg:"#FFFFFF",BkgHover:"#D2D2D2",BkgPressed:"#B1B1B1",BkgSelected:"#C6C6C6",BkgSubtle:"#F3F3F3",BkgSelectionHighlight:"#737373",Text:"#262626",TextRest:"#262626",TextHover:"#262626",TextPressed:"#262626",TextSelected:"#262626",TextDisabled:"#B1B1B1",TextSelectionHighlight:"#FFFFFF",TextSecondary:"#666666",TextSecondaryRest:"#666666",TextSecondaryHover:"#505050",TextSecondaryPressed:"#666666",TextSecondarySelected:"#666666",TextEmphasis:"#D83B01",TextEmphasisRest:"#D83B01",TextEmphasisHover:"#EA6115",TextEmphasisPressed:"#A22C01",TextEmphasisSelected:"#D83B01",StrokeSelectedHover:"#969696",StrokeKeyboard:"#969696",StrokeOverRest:"#00000000",StrokeOverHover:"#00000000",StrokeOverPressed:"#00000000",StrokeOverSelectedRest:"#00000000",StrokeOverSelectedHover:"#969696",StrokeOverSelectedPressed:"#00000000",BkgCtl:"#E6E6E6",BkgCtlHover:"#FFF7F0",BkgCtlPressed:"#FBDFD0",BkgCtlSelected:"#E6E6E6",BkgCtlDisabled:"#E6E6E6",TextCtl:"#262626",TextCtlHover:"#262626",TextCtlPressed:"#262626",TextCtlSelected:"#262626",TextCtlDisabled:"#B1B1B1",StrokeCtl:"#969696",StrokeCtlHover:"#FBDFD0",StrokeCtlPressed:"#EA6115",StrokeCtlSelected:"#969696",StrokeCtlDisabled:"#D2D2D2",StrokeCtlKeyboard:"#FBDFD0",BkgCtlEmphasis:"#D83B01",BkgCtlEmphasisHover:"#F29F71",BkgCtlEmphasisPressed:"#A22C01",BkgCtlEmphasisDisabled:"#E6E6E6",TextCtlEmphasis:"#FFFFFF",TextCtlEmphasisHover:"#FFFFFF",TextCtlEmphasisPressed:"#FFFFFF",TextCtlEmphasisDisabled:"#B1B1B1",StrokeCtlEmphasis:"#A22C01",StrokeCtlEmphasisHover:"#D83B01",StrokeCtlEmphasisPressed:"#A22C01",StrokeCtlEmphasisDisabled:"#D2D2D2",StrokeCtlEmphasisKeyboard:"#A22C01",BkgCtlSubtle:"#FFFFFF",BkgCtlSubtleHover:"#FFFFFF",BkgCtlSubtlePressed:"#FFFFFF",BkgCtlSubtleDisabled:"#F3F3F3",BkgCtlSubtleSelectionHighlight:"#7DA3C6",TextCtlSubtle:"#262626",TextCtlSubtlePlaceholder:"#666666",TextCtlSubtleHover:"#262626",TextCtlSubtlePressed:"#262626",TextCtlSubtleDisabled:"#B1B1B1",TextCtlSubtleSelectionHighlight:"#262626",StrokeCtlSubtle:"#C6C6C6",StrokeCtlSubtleHover:"#969696",StrokeCtlSubtlePressed:"#969696",StrokeCtlSubtleDisabled:"#C6C6C6",StrokeCtlSubtleKeyboard:"#969696",TextHyperlink:"#D83B01",TextHyperlinkHover:"#A22C01",TextHyperlinkPressed:"#6C1E01",TextActive:"#262626",TextActiveHover:"#EA6115",TextActivePressed:"#A22C01",TextActiveSelected:"#D83B01",StrokeOnlyHover:"#B1B1B1",StrokeOnlyPressed:"#737373",StrokeOnlySelected:"#969696",TextError:"#A50000",TextErrorHover:"#A50000",TextErrorPressed:"#A50000",TextErrorSelected:"#A50000",ThumbToggleSwitchOff:"#505050",ThumbToggleSwitchOffHover:"#505050",ThumbToggleSwitchOffPressed:"#505050",ThumbToggleSwitchOffDisabled:"#D2D2D2",ThumbToggleSwitchOn:"#FFFFFF",ThumbToggleSwitchOnHover:"#FFFFFF",ThumbToggleSwitchOnPressed:"#FFFFFF",ThumbToggleSwitchOnDisabled:"#FFFFFF",BkgToggleSwitchOff:"#FFFFFF",BkgToggleSwitchOffHover:"#D2D2D2",BkgToggleSwitchOffPressed:"#B1B1B1",BkgToggleSwitchOffDisabled:"#FFFFFF",BkgToggleSwitchOn:"#D83B01",BkgToggleSwitchOnHover:"#EA6115",BkgToggleSwitchOnPressed:"#A22C01",BkgToggleSwitchOnDisabled:"#D2D2D2",StrokeToggleSwitchOff:"#505050",StrokeToggleSwitchOffHover:"#505050",StrokeToggleSwitchOffPressed:"#505050",StrokeToggleSwitchOffDisabled:"#D2D2D2",StrokeToggleSwitchOn:"#D83B01",StrokeToggleSwitchOnHover:"#EA6115",StrokeToggleSwitchOnPressed:"#A22C01",StrokeToggleSwitchOnDisabled:"#D2D2D2",SliderPrimary:"#444444",SliderPrimaryHover:"#D2D2D2",SliderPrimaryPressed:"#262626",SliderPrimaryDisabled:"#969696",SliderSecondary:"#D2D2D2",SliderBuffer:"#262626",SliderKeyboard:"#444444",SliderToolTipBorder:"#C6C6C6",SliderToolTipLabel:"#262626",SliderToolTipBkg:"#FFFFFF",AccentDark:"#C6C6C6",AccentLight:"#E6E6E6",AccentEmphasis:"#D83B01",AccentOutline:"#000000",TextEmphasis2:"#D83B01",BkgCtlSubtleSelected:"#F3F3F3",TextCtlSubtleSelected:"#262626",BkgCtlEmphasisFocus:"#F3F3F3",BkgCtlSubtleFocus:"#F3F3F3",BkgCtlSubtleHoverDisabled:"#F3F3F3",BkgCtlSubtleSelectedDisabled:"#F3F3F3",BkgHeader:"#E6E6E6",TextHeader:"#262626"};function c(e){return"TaskPane"===e?Object(i.a)(Object(i.a)({},s),{Bkg:"antiquewhite"}):s}var d={ramps:{App:["#F8F8F8","#EFF6FC","#BBDAF3","#55A4E2","#359EDD","#0078d7","#283E4A","#030C13"],FluentGrays:["#FAF9F8","#797775","#11100F"],ClassicGrays:["#FFFFFF","#737373","#000000"],Sepias:["#ECE6DE"]},getPalette:c,typography:{},fluentTypography:{},rampNames:{App:["FakeApp1","App2","App3","App4","App5","App6","App7","App8"],FluentGrays:["FakeGray1","Gray2","Gray3"],ClassicGrays:["FakeGray4","Gray5","Gray6"],Sepias:["FakeSepia"]}};function l(){var e=a.TurboModuleRegistry.get("Theming");return e?[e,new a.NativeEventEmitter(e)]:[d,void 0]}var u=function(e){return Object.keys(e.ramps).reduce((function(t,n){return Object.assign.apply(Object,Object(i.g)([t],e.rampNames[n].map((function(t,r){var o;return(o={})[t]=e.ramps[n][r],o})),!1))}),{})};function p(e,t,n){return Object(i.a)({colors:Object(i.a)({},n&&(r=n,{background:r.Bkg,bodyStandoutBackground:r.Bkg,bodyFrameBackground:r.Bkg,bodyFrameDivider:r.AccentLight,bodyText:r.Text,bodyTextChecked:r.TextSelected,subText:r.TextSecondary,bodyDivider:r.AccentLight,disabledBackground:r.BkgCtlSubtleDisabled,disabledText:r.TextCtlSubtleDisabled,disabledBodyText:r.TextDisabled,disabledSubtext:r.TextCtlSubtleDisabled,disabledBodySubtext:r.TextDisabled,focusBorder:r.StrokeKeyboard,variantBorder:r.AccentOutline,variantBorderHovered:r.AccentOutline,defaultStateBackground:r.Bkg,errorText:r.TextError,warningText:r.Text,errorBackground:r.Bkg,blockingBackground:r.Bkg,warningBackground:r.Bkg,warningHighlight:r.TextError,successBackground:r.TextEmphasis,inputBorder:r.StrokeCtlSubtle,inputBorderHovered:r.StrokeCtlSubtleHover,inputBackground:r.BkgCtlSubtle,inputBackgroundChecked:r.BkgCtlSubtle,inputBackgroundCheckedHovered:r.BkgCtlSubtleHover,inputForegroundChecked:r.TextCtlSubtle,inputFocusBorderAlt:r.StrokeCtlSubtleKeyboard,smallInputBorder:r.StrokeCtlSubtle,inputText:r.TextCtlSubtle,inputTextHovered:r.TextCtlSubtleHover,inputPlaceholderText:r.TextCtlSubtlePlaceholder,buttonBackground:r.BkgCtl,buttonBackgroundChecked:r.BkgCtlSelected,buttonBackgroundHovered:r.BkgCtlHover,buttonBackgroundCheckedHovered:r.BkgCtlSelected,buttonBackgroundPressed:r.BkgCtlPressed,buttonBackgroundDisabled:r.BkgCtlDisabled,buttonBorder:r.StrokeCtl,buttonText:r.TextCtl,buttonTextHovered:r.TextCtlHover,buttonTextChecked:r.TextCtlSelected,buttonTextCheckedHovered:r.TextCtlSelected,buttonTextPressed:r.TextCtlPressed,buttonTextDisabled:r.TextCtlDisabled,buttonBorderDisabled:r.StrokeCtlDisabled,buttonBorderFocused:r.StrokeCtlKeyboard,primaryButtonBackground:r.BkgCtlEmphasis,primaryButtonBackgroundHovered:r.BkgCtlEmphasisHover,primaryButtonBackgroundPressed:r.BkgCtlEmphasisPressed,primaryButtonBackgroundDisabled:r.BkgCtlEmphasisDisabled,primaryButtonBorder:r.StrokeCtlEmphasis,primaryButtonBorderFocused:r.StrokeCtlEmphasisKeyboard,primaryButtonText:r.TextCtlEmphasis,primaryButtonTextHovered:r.TextCtlEmphasisHover,primaryButtonTextPressed:r.TextCtlEmphasisPressed,primaryButtonTextDisabled:r.TextCtlEmphasisDisabled,accentButtonBackground:r.BkgCtlEmphasis,accentButtonText:r.TextCtlEmphasis,menuBackground:r.Bkg,menuDivider:r.AccentLight,menuIcon:r.Text,menuHeader:r.Text,menuItemBackgroundHovered:r.BkgHover,menuItemBackgroundPressed:r.BkgPressed,menuItemText:r.Text,menuItemTextHovered:r.TextHover,listBackground:r.Bkg,listText:r.Text,listItemBackgroundHovered:r.BkgHover,listItemBackgroundChecked:r.BkgSelected,listItemBackgroundCheckedHovered:r.BkgSelected,listHeaderBackgroundHovered:r.BkgHover,listHeaderBackgroundPressed:r.BkgPressed,actionLink:r.TextActive,actionLinkHovered:r.TextActiveHover,link:r.TextHyperlink,linkHovered:r.TextHyperlinkHover,linkPressed:r.TextHyperlinkPressed,defaultBackground:r.BkgCtl,defaultBorder:r.StrokeCtl,defaultContent:r.TextCtl,defaultIcon:r.TextCtl,defaultHoveredBackground:r.BkgCtlHover,defaultHoveredBorder:r.StrokeCtlHover,defaultHoveredContent:r.TextCtlHover,defaultHoveredIcon:r.TextCtlHover,defaultFocusedBackground:r.BkgCtlHover,defaultFocusedBorder:r.StrokeCtlKeyboard,defaultFocusedContent:r.TextCtlHover,defaultFocusedIcon:r.TextCtlHover,defaultPressedBackground:r.BkgCtlPressed,defaultPressedBorder:r.StrokeCtlPressed,defaultPressedContent:r.TextCtlPressed,defaultPressedIcon:r.TextCtlPressed,defaultDisabledBackground:r.BkgCtlDisabled,defaultDisabledBorder:r.StrokeCtlDisabled,defaultDisabledContent:r.TextCtlDisabled,defaultDisabledIcon:r.TextCtlDisabled,ghostBackground:r.Bkg,ghostBorder:r.Bkg,ghostContent:r.Text,ghostIcon:r.Text,ghostHoveredBackground:r.BkgHover,ghostHoveredBorder:r.BkgHover,ghostHoveredContent:r.TextHover,ghostHoveredIcon:r.TextHover,ghostFocusedBackground:r.BkgHover,ghostFocusedBorder:r.StrokeKeyboard,ghostFocusedContent:r.TextHover,ghostFocusedIcon:r.TextHover,ghostPressedBackground:r.BkgPressed,ghostPressedBorder:r.BkgPressed,ghostPressedContent:r.TextPressed,ghostPressedIcon:r.TextPressed,ghostDisabledBackground:r.Bkg,ghostDisabledBorder:r.Bkg,ghostDisabledContent:r.TextDisabled,ghostDisabledIcon:r.TextDisabled,brandedBackground:r.BkgCtlEmphasis,brandedBorder:r.StrokeCtlEmphasis,brandedContent:r.TextCtlEmphasis,brandedIcon:r.TextCtlEmphasis,brandedHoveredBackground:r.BkgCtlEmphasisHover,brandedHoveredBorder:r.StrokeCtlEmphasisHover,brandedHoveredContent:r.TextCtlEmphasisHover,brandedHoveredIcon:r.TextCtlEmphasisHover,brandedFocusedBackground:r.BkgCtlEmphasisHover,brandedFocusedBorder:r.StrokeCtlEmphasisKeyboard,brandedFocusedContent:r.TextCtlEmphasisHover,brandedFocusedIcon:r.TextCtlEmphasisHover,brandedPressedBackground:r.BkgCtlEmphasisPressed,brandedPressedBorder:r.StrokeCtlEmphasisPressed,brandedPressedContent:r.TextCtlEmphasisPressed,brandedPressedIcon:r.TextCtlEmphasisPressed,brandedDisabledBackground:r.BkgCtlEmphasisDisabled,brandedDisabledBorder:r.StrokeCtlEmphasisDisabled,brandedDisabledContent:r.TextCtlEmphasisDisabled,brandedDisabledIcon:r.TextCtlEmphasisDisabled,defaultCheckedBackground:r.BkgCtlSelected,defaultCheckedContent:r.TextCtlSelected,defaultCheckedHoveredBackground:r.BkgCtlHover,defaultCheckedHoveredContent:r.TextCtlHover,ghostCheckedBackground:r.BkgSelected,ghostCheckedContent:r.TextSelected,ghostCheckedHoveredBackground:r.BkgHover,ghostCheckedHoveredContent:r.TextHover,ghostCheckedHoveredBorder:r.StrokeSelectedHover,ghostSecondaryContent:r.TextSecondary,ghostFocusedSecondaryContent:r.TextSecondaryHover,ghostHoveredSecondaryContent:r.TextSecondaryHover,ghostPressedSecondaryContent:r.TextSecondaryPressed})),typography:e.fluentTypography,host:{palette:n||{},colors:u(e)}},t?{name:t}:void 0);var r}var h=n(318),f=n(347),m=n(348),g=function(e){for(var t in e)for(var n in e[t]){var r=e[t][n];if("string"==typeof r&&r.includes("PlatformColor")){var o=r.substring(14,r.length-1);e[t][n]=Object(a.PlatformColor)(o)}}return e}(n(280));var b=n(135),C=n(190);Object(b.b)((function(e){var t=function(e){return"White"===e||"Colorful"===e?h:"DarkGray"===e?f:"Black"===e?m:"HighContrast"===e?g:h}(e);return Object(C.c)(t)})),n(41);function y(e,t,n){var r=e.getPalette(n);(function(e){return void 0!==e.message})(r)||(t[n]=r)}function v(e,t,n,r){return p(e,r,function(e,t,n){var r=function(e){return e||"WhiteColors"}(n);return t[r]||y(e,t,r),t[r]||{}}(e,t,n))}var T=function(e,t){e||console.error("No NativeModule for Theming found");var n={},i=e.initialHostThemeSetting||"";return t&&t.addListener("onPlatformDefaultsChanged",(function(e){i=e&&e.hostThemeSetting||i,Object.keys(n).forEach((function(e){return delete n[e]}))})),{getPlatformDefaults:function(t){return Object(r.c)(o.c,v(e,n,t,i))},getPlatformThemeDefinition:function(t){return function(r){return y(e,n,t),v(e,n,t)}},addListener:function(e){t&&t.addListener("onPlatformDefaultsChanged",e)}}}.apply(void 0,l());var S;function I(e){if("__platform"===e)throw new Error("The platform theme may not be accessed directly");return e&&""!==e?e:"__default"}function O(e,t,n,r){var o=[];"__platform"!==e&&n[e].resolved&&o.push(e),n[e]=t,function e(t,n,r){for(var o=0,i=Object.getOwnPropertyNames(r);o<i.length;o++){var a=i[o],s=r[a];s.parentEntryName===t&&s.resolved&&(n.push(a),s.resolved=void 0,e(a,n,r))}}(e,o,n),o.map((function(e){for(var t="__default"===e?"":e,n=0,o=r;n<o.length;n++){o[n].onInvalidate(t)}}))}function E(e,t){if(!t.hasOwnProperty(e))throw Error('"'+e+'" does not exist in the theme registry');return t[e]}function P(e,t){var n,r=((n={}).__platform={resolved:e},n.__default={parentEntryName:"__platform"},n),o=[],i=t;return{getTheme:function(e){return function e(t,n,r){var o=E(t,n);if(!o.resolved){var i=e(o.parentEntryName,n,r),a=function(e,t){return t?"function"==typeof t?t(e):t:{}}(i,o.definition);o.resolved=r(i,a)}return o.resolved}(I(e),r,i)},setTheme:function(e,t,n){!function(e,t,n,r,o){var i=I(r),a="__default"===i?"__platform":I(o);if(!t.hasOwnProperty(a))throw new Error("Attempting to parent to an unknown theme");if(function(e,t,n){for(;t;){if(t===e)return!0;var r=n[t];t=r?r.parentEntryName:""}return!1}(i,a,t))throw new Error("Attempt to register a dependent theme that would cause a cycle");var s={parentEntryName:a,definition:e};t.hasOwnProperty(i)?O(i,s,t,n):t[i]=s}(e,r,o,t,n)},addEventListener:function(e){o.push(e)},removeEventListener:function(e){var t=o.indexOf(e);t>-1&&o.splice(t,1)},updatePlatformDefaults:function(e){var t=E("__platform",r);O("__platform",{resolved:t&&t.resolved?i(t.resolved,e):e},r,o)}}}function k(e,t){void 0===t&&(t=T);var n=P(t.getPlatformDefaults(e),r.c);return t.addListener((function(){n.updatePlatformDefaults(t.getPlatformDefaults(e))})),n}function R(){return S||(S=k()),S}function x(e){return R().addEventListener(e)}var D,w=n(1),A=(D=function(e,t){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}D(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),j=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onInvalidate=function(e){e===t._registeredTheme&&t.forceUpdate()},t._ensureCallbackRegistration=function(e){void 0===t._registeredTheme&&x(t),t._registeredTheme=e},t}A(t,e),t.prototype.componentWillUnmount=function(){var e;void 0!==this._registeredTheme&&(e=this,R().removeEventListener(e),this._registeredTheme=void 0)},t.prototype.render=function(){var e=this,t=this.props.themeName;return w.createElement(r.a.Consumer,null,(function(n){return void 0!==t||void 0===n?(t=t||"",e._ensureCallbackRegistration(t),o=t,n=R().getTheme(o),w.createElement(r.a.Provider,{value:n},e.props.children(n))):e.props.children(n);var o}))}}(w.Component),w.createContext(void 0)),_=function(e){var t=e.registry,n=e.theme,o=void 0===n?"":n,i=e.children,a=t||w.useContext(j)||R(),s=w.useState(a.getTheme(o)),c=s[0],d=s[1];w.useEffect((function(){var e={onInvalidate:function(e){e===o&&d(a.getTheme(o))}};return a.addEventListener(e),function(){a.removeEventListener(e)}}),[a,o,d]);var l=w.createElement(r.a.Provider,{value:c},i);return t?w.createElement(j.Provider,{value:t},l):l}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoDraft=1]="NoDraft",e[e.CanAutoDiscard=2]="CanAutoDiscard",e[e.CannotAutoDiscard=3]="CannotAutoDiscard"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return i.a})),n.d(t,"d",(function(){return a.a})),n.d(t,"e",(function(){return s.a})),n.d(t,"f",(function(){return c.a})),n.d(t,"c",(function(){return d.a})),n.d(t,"j",(function(){return d.d})),n.d(t,"i",(function(){return d.c})),n.d(t,"g",(function(){return l.a})),n.d(t,"h",(function(){return u.a})),n.d(t,"k",(function(){return p.a}));var r,o=n(148),i=n(253),a=n(48);!function(e){e[e.FailedToCommit=1]="FailedToCommit"}(r||(r={}));var s=n(35),c=n(55),d=n(68),l=n(78),u=n(46),p=(n(69),n(207))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));n(72);Object({NODE_ENV:"production"}).TEST_PAGE;const r=!1,o=()=>{console.ignoredYellowBox=["Warning: Can only update a mounted or mounting component. This usually means you called setState, replaceState, or forceUpdate on an unmounted component. This is a no-op."],console.disableYellowBox=!0,console.disableYellowBox=!0}},function(e,t,n){"use strict";var r;!function(e){e[e.Editing=0]="Editing",e[e.Disabled=1]="Disabled",e[e.ReadOnly=2]="ReadOnly"}(r||(r={})),t.a=r},function(e,t,n){"use strict";var r;function o(e){if(!e)return!1;const t=e;return void 0!==t.displayMode&&"string"==typeof t.displayMode}function i(e,t){return e.displayMode===t.displayMode&&(e.displayMode!==r.Variable||e.desiredHeight===t.desiredHeight)}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),function(e){e.Normal="Normal",e.FullScreen="FullScreen",e.Variable="Variable"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(21),o=n(217);function i(e,t){return Object(r.b)(e)?e.errorCode:Object(o.a)(e)?e.SDXHostAPIErrorCode:void 0===t?-2147467259:t}},function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u}));var r=n(113),o=n(48),i=n(68);function a(e){return e.sessionType===i.a}function s(e){return e.sessionType===i.d&&void 0!==e.threadId}function c(e){return e.sessionType===i.b&&void 0!==e.commentId}const d={CREATE:0,REPLY:1,EDIT:2,METADATA:3},l={CREATE:o.a.Insert,REPLY:o.a.Insert,EDIT:o.a.Modify,METADATA:o.a.Modify};function u(e){return a(e)?r.a.InitCreateCommentSession:s(e)?r.a.InitReplyCommentSession:c(e)?r.a.InitEditCommentSession:r.a.Unknown}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return d}));const r=e=>e.filterState.activeFilterId,o=e=>e.filterState.defaultFilterId,i=e=>{var t;const n=e.filterState.activeFilterId;if(n)return null===(t=e.filterState.filteredRanges[n])||void 0===t?void 0:t.filter},a=(e,t)=>e.filterState.filteredRanges[t],s=[],c=e=>{var t,n;const r=e.filterState.activeFilterId;return r&&null!==(n=null===(t=e.filterState.filteredRanges[r])||void 0===t?void 0:t.order)&&void 0!==n?n:s},d=e=>e.filterState.filteringCapabilities},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Undo=-1]="Undo",e[e.Unknown=0]="Unknown",e[e.Create=1]="Create",e[e.Assign=2]="Assign",e[e.Unassign=3]="Unassign",e[e.UnassignAll=4]="UnassignAll",e[e.Schedule=5]="Schedule",e[e.Progress=6]="Progress",e[e.Delete=7]="Delete",e[e.Restore=8]="Restore",e[e.SetTitle=9]="SetTitle",e[e.Priority=10]="Priority"}(r||(r={}))},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r={batch:!0};Object.defineProperty(t,"batch",{enumerable:!0,get:function(){return i.unstable_batchedUpdates}});var o=n(369);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(r,e)||e in t&&t[e]===o[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}}))}));var i=n(385);(0,n(324).setBatch)(i.unstable_batchedUpdates)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(9),o=n(20),i=n(98);const a=Object(i.c)(o.a);Object(i.c)(r.TouchableOpacity)},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReturnToDraft=1]="ReturnToDraft",e[e.GrantAccessFailedSilently=2]="GrantAccessFailedSilently",e[e.CommitFailed=3]="CommitFailed",e[e.GrantAccessCanceled=4]="GrantAccessCanceled"}(r||(r={}))},function(e,t,n){"use strict";function r(e,t){return e===t}function o(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,o=0;o<r;o++)if(!e(t[o],n[o]))return!1;return!0}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,n=null,i=null;return function(){return o(t,n,arguments)||(i=e.apply(null,arguments)),n=arguments,i}}function a(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var n=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}function s(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];var s=0,c=r.pop(),d=a(r),l=e.apply(void 0,[function(){return s++,c.apply(null,arguments)}].concat(n)),u=i((function(){for(var e=[],t=d.length,n=0;n<t;n++)e.push(d[n].apply(null,arguments));return l.apply(null,e)}));return u.resultFunc=c,u.recomputations=function(){return s},u.resetRecomputations=function(){return s=0},u}}t.__esModule=!0,t.defaultMemoize=i,t.createSelectorCreator=s,t.createStructuredSelector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var n=Object.keys(e);return t(n.map((function(t){return e[t]})),(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((function(e,t,r){return e[n[r]]=t,e}),{})}))};var c=t.createSelector=s(i)},function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"i",(function(){return C})),n.d(t,"k",(function(){return y})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return T})),n.d(t,"e",(function(){return S})),n.d(t,"n",(function(){return I})),n.d(t,"m",(function(){return O})),n.d(t,"f",(function(){return E})),n.d(t,"h",(function(){return k})),n.d(t,"d",(function(){return R})),n.d(t,"o",(function(){return x})),n.d(t,"l",(function(){return D})),n.d(t,"j",(function(){return w})),n.d(t,"g",(function(){return A}));var r=n(14),o=n(349),i=n(92),a=n(199),s=n(193),c=n(24),d=n(2),l=n(23),u=n(5),p=n(103);function h(){return f||(f=Object(i.createSelectorCreator)(i.defaultMemoize,o.a)),f}let f=void 0;const m=(e,t)=>{var n,r;return null!==(r=null===(n=t.resource)||void 0===n?void 0:n.id)&&void 0!==r?r:""},g=(e,t)=>t.componentTree.componentTreeId.renderContextType,b=()=>Object(i.createSelector)([m,u.b],(e,t)=>t[e]),C=()=>Object(i.createSelector)([m,u.l],(e,t)=>t===e),y=()=>h()([m,u.r],(e,t)=>(null==t?void 0:t.selectedCardId)===e?t:void 0),v=()=>Object(i.createSelector)([m,g,u.h],(e,t,n)=>Object(a.a)(e,t,n)),T=()=>Object(i.createSelector)([m,u.e,u.b],(e,t,n)=>Object(s.c)(e,t,n)),S=()=>Object(i.createSelector)([m,u.h],(e,t)=>t.drafts[e]),I=(e,t,n,r)=>Object(i.createSelector)([m,u.c,u.a,r,e,n,t],(e,t,n,r,o,i,a)=>Object(s.b)(e,t,n,r,o,i,a)),O=e=>h()([e,u.q],(e,t)=>e.thread.reduce((e,n)=>(e[n.commentId]=t[n.commentId],e),{})),E=e=>h()([e,p.a],(e,t)=>{const n={};return e&&e.history.forEach(r=>{r.records.forEach(r=>{const o=c.a(e.id,r.recordId);n[o]=t[o]})}),n}),P=e=>{var t,n;return Object(l.e)(e.commentState)?e.commentState.commentThreadIds[0]:d.K()&&0===(null===(t=e.commentState.createdCommentLie)||void 0===t?void 0:t.index)?e.commentState.createdCommentLie.newComment.commentId:null===(n=e.commentState.commentData[0])||void 0===n?void 0:n.commentId},k=e=>Object(i.createSelector)([m,P,u.k,e],(e,t,n,r)=>n?e===t:!!r.draftThreadState),R=(e,t)=>Object(i.createSelector)([m,e,u.h,g,t],(e,t,n,r,o)=>Object(s.a)(e,t,n,r,o)),x=e=>Object(i.createSelector)([e],e=>Object(r.f)(e)),D=()=>Object(i.createSelector)([m,p.b],(e,t)=>t[e]),w=(e,t)=>h()([e,t],(e,t)=>Object(c.l)(e.thread,t)),A=()=>Object(i.createSelector)([m,u.h],(e,t)=>t.cardIdToDraftIdMap[e]===e)},function(e,t,n){"use strict";var r=n(282),o="object"==typeof self&&self&&self.Object===Object&&self,i=r.a||o||Function("return this")();t.a=i},function(e,t,n){"use strict";var r=n(275);n.d(t,"a",(function(){return r.a}))},function(e,t,n){"use strict";var r,o;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e[e.AllCardsTabbable=0]="AllCardsTabbable",e[e.ExpandedCardTabbable=1]="ExpandedCardTabbable",e[e.ExpandedCardOrFirstCardTabbable=2]="ExpandedCardOrFirstCardTabbable",e[e.SelectedCardTabbable=3]="SelectedCardTabbable"}(r||(r={})),function(e){e[e.AllPostsTabbable=0]="AllPostsTabbable",e[e.ExpandedCardPostsTabbable=1]="ExpandedCardPostsTabbable",e[e.ExpandedCardRootPostTabbable=2]="ExpandedCardRootPostTabbable",e[e.SelectedPostTabbable=3]="SelectedPostTabbable"}(o||(o={}))},function(e,t,n){"use strict";t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return h}));var r=n(3),o=n(8),i=n(11),a=n(1),s=n(82),c=n(20),d=(n(72),n(12)),l=n(177);const u=a.createContext(0),p=(e,t)=>{const n=[];return e&&n.push(...e),t&&n.push(...t),n};function h(e){var t;return(t=class extends a.PureComponent{constructor(e){super(e),this.nodes=[],this.registrationRef=a.createRef(),this.innerRef=a.createRef(),this.onFocusWithinChange=()=>{const e=this.nodes.some(e=>e.node.getFocusState()!==i.b.Unfocused);this.setState({isFocusWithin:e})},this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),this.state={isFocusWithin:!1,isFocusOn:!1}}componentDidUpdate(e,t){const n=Object(i.k)(this.state),r=Object(i.k)(t);n!==r&&(s.a&&Object(o.i)(`${this.getId()}: ${i.b[n]}`),this.props.onFocusStateChange&&this.props.onFocusStateChange(n),r!==i.b.Unfocused&&n!==i.b.Unfocused||this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(n))}getInnerRef(){return this.innerRef}focus(){this.innerRef&&this.innerRef.current&&Object(l.a)(this.innerRef.current)}blur(){}getFocusState(){return Object(i.k)(this.state)}getNextTabTarget(e,t){return Object(i.m)(this,e,t)}isTabbable(){return!!this.props.isTabbable}getChildNodes(){return this.nodes.slice().sort((e,t)=>e.getSortKey()-t.getSortKey()).map(e=>e.node)}getIterator(){return Object(i.p)(this)}addChildNode(e,t){const n={unregister:()=>this.unregister(e),onFocusStateChange:this.onFocusWithinChange};return this.nodes.push({node:e,getSortKey:t}),n}getData(){return this.props.nodeData?this.props.nodeData():this}getId(){return this.props.nodeId||""}getDescendantById(e){const t=this.getIterator();let n;for(;!(n=t.next()).done;)if(n.value.getId()===e)return n.value}unregister(e){const t=this.nodes.findIndex(t=>t.node===e);t>=0&&(this.nodes.splice(t,1),this.state.isFocusWithin&&this.onFocusWithinChange())}onFocus(e){e&&e.target!==e.currentTarget||this.setState({isFocusOn:!0}),this.props.onFocus&&this.props.onFocus(e)}onBlur(e){e&&e.target!==e.currentTarget||this.setState({isFocusOn:!1}),this.props.onBlur&&this.props.onBlur(e)}renderInnerComponent(){const t=this.props,{onFocusStateChange:n,onFocus:o,onBlur:s,keyDownEvents:c,preventDefaultKeyDownBehavior:d}=t,l=Object(r.f)(t,["onFocusStateChange","onFocus","onBlur","keyDownEvents","preventDefaultKeyDownBehavior"]);return a.createElement(u.Consumer,null,t=>a.createElement(i.h,{node:this,ref:this.registrationRef,position:t},a.createElement(e,Object.assign({testID:this.props.nodeId,focusable:!0},l,this.state,{ref:this.innerRef,onFocus:this.onFocus,onBlur:this.onBlur,keyDownEvents:p(c,d)}),a.createElement(i.f.Provider,{value:this},a.Children.map(this.props.children,(e,t)=>a.createElement(u.Provider,{value:t},e))))))}renderInnerComponentDebug(){let e={};return this.state.isFocusOn?e={borderColor:"red",borderWidth:3}:this.state.isFocusWithin&&(e={borderColor:"yellow",borderWidth:3}),a.createElement(c.a,{style:[e,d.d]},this.renderInnerComponent())}render(){return this.renderInnerComponent()}}).displayName="FocusAware"+e.displayName,t}},function(e,t,n){"use strict";var r;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(r||(r={})),t.a=r},function(e,t,n){"use strict";var r;function o(e){return void 0!==e.pending||void 0!==e.displayingErrorUI}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e[e.None=0]="None",e[e.Post=1]="Post",e[e.Delete=2]="Delete"}(r||(r={}))},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(2);const o={},i=e=>Object(r.b)()?e.commentState.tasks:o,a=e=>e.commentState.historyRecordViewState},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.CancelNewThreadDraft=1]="CancelNewThreadDraft",e[e.DeleteThread=2]="DeleteThread",e[e.RequestNewCommentFromHost=3]="RequestNewCommentFromHost",e[e.CancelReplyDraft=4]="CancelReplyDraft",e[e.ResolveThread=5]="ResolveThread"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(212);const o=r.ViewWin32},function(e,t,n){"use strict";var r;!function(e){e[e.KeyboardShortcut=1]="KeyboardShortcut",e[e.CommitButton=2]="CommitButton",e[e.Programmatic=3]="Programmatic"}(r||(r={})),t.a=r},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.MetadataOnly=1]="MetadataOnly",e[e.Any=2]="Any"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return p}));var r=n(3),o=function(e){return e.colors},i=[{source:"color",lookup:o}],a=[{source:"backgroundColor",lookup:o}];Object(r.g)(Object(r.g)([],i,!0),a,!0);function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=function(t){var n={};return e.filter((function(e){return void 0!==t[e]})).forEach((function(e){n[e]=t[e]})),n};return{from:n,keys:e}}var c=[{source:"borderColor",lookup:o},{source:"borderWidth"},{source:"borderRadius"},{source:"borderStyle"}],d=(s("borderColor","borderRadius","borderStyle","borderWidth"),n(245)),l=function(e,t){var n=e.fontFamily,r=e.fontSize,o=e.fontWeight,i=e.variant,a=t.typography,s=a.families,c=a.sizes,d=a.weights,l=a.variants;return n||r||o||i?{fontFamily:s[n]||n||s[l[i].face]||l[i].face,fontSize:c[r]||r||c[l[i].size]||l[i].size,fontWeight:d[o]||o||d[l[i].weight]||l[i].weight}:{}},u=["fontFamily","fontSize","fontWeight","variant"];var p=Object(d.c)((function(e,t){return{style:l(e,t)}}),u);s("minWidth","minHeight","padding","paddingHorizontal"),s("shadowColor","shadowOffset","shadowOpacity","shadowRadius","elevation")},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}n.r(t),n.d(t,"__DO_NOT_USE__ActionTypes",(function(){return d})),n.d(t,"applyMiddleware",(function(){return g})),n.d(t,"bindActionCreators",(function(){return f})),n.d(t,"combineReducers",(function(){return p})),n.d(t,"compose",(function(){return m})),n.d(t,"createStore",(function(){return u}));var s="function"==typeof Symbol&&Symbol.observable||"@@observable",c=function(){return Math.random().toString(36).substring(7).split("").join(".")},d={INIT:"@@redux/INIT"+c(),REPLACE:"@@redux/REPLACE"+c(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+c()}};function l(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function u(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(a(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(a(1));return n(u)(e,t)}if("function"!=typeof e)throw new Error(a(2));var o=e,i=t,c=[],p=c,h=!1;function f(){p===c&&(p=c.slice())}function m(){if(h)throw new Error(a(3));return i}function g(e){if("function"!=typeof e)throw new Error(a(4));if(h)throw new Error(a(5));var t=!0;return f(),p.push(e),function(){if(t){if(h)throw new Error(a(6));t=!1,f();var n=p.indexOf(e);p.splice(n,1),c=null}}}function b(e){if(!l(e))throw new Error(a(7));if(void 0===e.type)throw new Error(a(8));if(h)throw new Error(a(9));try{h=!0,i=o(i,e)}finally{h=!1}for(var t=c=p,n=0;n<t.length;n++){(0,t[n])()}return e}function C(e){if("function"!=typeof e)throw new Error(a(10));o=e,b({type:d.REPLACE})}function y(){var e,t=g;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(a(11));function n(){e.next&&e.next(m())}return n(),{unsubscribe:t(n)}}})[s]=function(){return this},e}return b({type:d.INIT}),(r={dispatch:b,subscribe:g,getState:m,replaceReducer:C})[s]=y,r}function p(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];0,"function"==typeof e[o]&&(n[o]=e[o])}var i,s=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:d.INIT}))throw new Error(a(12));if(void 0===n(void 0,{type:d.PROBE_UNKNOWN_ACTION()}))throw new Error(a(13))}))}(n)}catch(e){i=e}return function(e,t){if(void 0===e&&(e={}),i)throw i;for(var r=!1,o={},c=0;c<s.length;c++){var d=s[c],l=n[d],u=e[d],p=l(u,t);if(void 0===p){t&&t.type;throw new Error(a(14))}o[d]=p,r=r||p!==u}return(r=r||s.length!==Object.keys(e).length)?o:e}}function h(e,t){return function(){return t(e.apply(this,arguments))}}function f(e,t){if("function"==typeof e)return h(e,t);if("object"!=typeof e||null===e)throw new Error(a(16));var n={};for(var r in e){var o=e[r];"function"==typeof o&&(n[r]=h(o,t))}return n}function m(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function g(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(a(15))},o={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},s=t.map((function(e){return e(o)}));return r=m.apply(void 0,s)(n.dispatch),i(i({},n),{},{dispatch:r})}}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return u.a}));var r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};function o(e){if(e){e._overrides,e._precedence;return r(e,["_overrides","_precedence"])}return e}function i(e,t){return e.components&&e.components[t]||void 0}var a=n(124),s=n(125),c=function(){return(c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};var d={object:!0,settings:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.c.apply(void 0,e)}};function l(e,t){var n=Object(s.b)(d,e,t);return n===e&&(n=c({},n)),n}var u=n(158)},function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return f}));var r=n(0),o=n(9),i=n(2),a=n(53),s=n(413);class c{constructor(e){this.compile=Object(s.a)(()=>{const e={};this.color&&(e.color="0xff"+this.color.substr(1)),void 0!==this.isColorEnabled&&(e.isColorEnabled=String(this.isColorEnabled));const t=Object.entries(e).map(e=>e.join("=")).join("&");return{uri:`ms-namex-icon:${this.namex}${t?"?"+t:""}`,width:this.width,height:this.height}}),"string"==typeof e?this.namex=e:(this.namex=e.namex,this.isColorEnabled=e.isColorEnabled,this.color=e.color,this.width=e.width,this.height=e.height)}withSize(e,t){const n=new c(this);return n.width=e,n.height=null!=t?t:e,n}withColorEnabled(e){const t=new c(this);return t.isColorEnabled=e,t}withColor(e){if(!/^#[0-9a-f]{6}$/i.test(e))return Object(r.i)().assertConditionTag(!1,"Invalid icon color provided: "+e,579606091),this;const t=new c(this);return t.color=e,t}}var d=n(31);const l=Object(s.a)(()=>{const e=new c("Send").withSize(16),t=new c("CancelCommentSession").withSize(16),n=new c("MoreCommentThreadActions").withSize(16),r=new c("TrashCan").withSize(16),o=new c("EditGeneric").withSize(16),a=new c("ReopenComment").withSize(16),s=new c("Checkmark").withSize(10),l=s.withColor(d.a.WHITE),u=s.withSize(14),p=s.withSize(16),h=new c("NewComment").withSize(16),f=new c("NewCommentRTL").withSize(16),m=new c("TaskAssign").withSize(16),g=m.withColor(d.a.WHITE),b=new c("TaskReopen").withSize(16),C=b.withColor(d.a.WHITE),y=p.withColor(d.a.WHITE),v=new c("CommentError").withSize(16),T=v.withColor(d.a.WHITE),S=new c("CommentInfo").withSize(16),I=S.withColor(d.a.WHITE),O=new c("TaskEdit").withSize(16),E=O.withColor(d.a.WHITE),P=new c("TaskAssignDropdown").withSize(16),k=P.withColor(d.a.WHITE),R=new c("CopyLinkToClipboard").withSize(16),x=R.withColor(d.a.WHITE),D=new c("CommentLikeSolid").withSize(16),w=D.withColor(d.a.WHITE),A=new c("CommentLikeEmpty").withSize(16),j=A.withColor(d.a.WHITE);return{send:{standard:e.compile(),directional:!0},cancel:{standard:t.compile(),directional:!1},ellipses:{standard:n.compile(),directional:!1},leftChevron:{standard:0,directional:!0},rightChevron:{standard:0,directional:!0},closePaneLargeDisplay:{standard:t.compile(),directional:!1},closePaneSmallDisplay:{standard:t.compile(),directional:!1},deleteCommandBar:{standard:r.compile(),directional:!1},delete:{standard:r.compile(),directional:!1},edit:{standard:o.compile(),directional:!0},unlock:{standard:a.compile(),directional:!0},checkmarkTopper:{standard:s.compile(),dark:l.compile(),directional:!0},checkmark:{standard:s.compile(),directional:!0},cancelFluent:{standard:t.compile(),directional:!1},sendFluentForAppColor:{standard:e.compile(),directional:!0},sendFluentDisabledForAppColor:{standard:e.compile(),directional:!0},newComment:{standard:h.compile(),directional:!1},newCommentRTL:{standard:f.compile(),directional:!1},taskAssign:{standard:m.compile(),dark:g.compile(),directional:!0},reopenThread:{standard:b.compile(),directional:!0},taskReopen:{standard:b.compile(),dark:C.compile(),directional:!0},taskComplete:{standard:p.compile(),dark:y.compile(),directional:!0},error:{standard:v.compile(),dark:T.compile(),directional:!1},taskEdit:{standard:O.compile(),dark:E.compile(),directional:!0},assignerDropdown:{standard:P.compile(),dark:k.compile(),directional:!1},save:{standard:u.compile(),directional:!0},info:{standard:S.compile(),dark:I.compile(),directional:!1},linkToComment:{standard:R.compile(),dark:i.u()?void 0:x.compile(),directional:!1},likeSolid:{standard:D.compile(),dark:w.compile(),directional:!1},likeEmpty:{standard:A.compile(),dark:j.compile(),directional:!1}}});var u=n(29);function p(e,t){const n=l()[e],r=n[t];let o;return o=r||(n.dark&&function(e){return 5===e||4===e}(t)?n.dark:n.standard),{source:o,directional:n.directional}}function h(e){const t=f(e);return t||(Object(r.i)().assertConditionTag(!1,"Missing icon "+e.icon,595646157),p("cancel",e.themeId))}function f(e){if(0===e.icon)return;const t=function(e){const t=(i.i()?g:m)[e.icon];if(void 0===t)return;if("function"==typeof t)return t(e);return t}(e);return void 0!==t?p(t,e.themeId):void 0}const m={1:"cancel",2:"send",7:"ellipses",10:"leftChevron",11:"rightChevron",9:()=>Object(u.a)()===a.a.LargeDisplay?"closePaneLargeDisplay":"closePaneSmallDisplay",12:function(){return o.I18nManager.isRTL?"newCommentRTL":"newComment"},24:"send"},g=Object.assign(Object.assign({},m),{1:"cancelFluent",2:function(e){if(e.disabled)return"sendFluentDisabledForAppColor";return"sendFluentForAppColor"},3:function(e){if("Pane"===e.renderTarget)return"deleteCommandBar";return"delete"},4:"unlock",5:"checkmark",20:"checkmarkTopper",6:"edit",13:"taskAssign",14:"taskAssign",16:"reopenThread",21:"taskReopen",15:"taskComplete",19:"error",17:"taskEdit",8:"assignerDropdown",24:"save",26:"info",25:"linkToComment",23:"likeSolid",22:"likeEmpty"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return u}));var r=n(51),o=n(2),i=n(7),a=n(23),s=n(151);function c(e,t){const n=null==t?void 0:t(),o=[];let i=0,a=void 0;for(;i<e.length;){if(e[i].type===r.a.Thread){const t=e[i].id;a=t,o.push(l(t,void 0,n))}else o.push(l(e[i].id,a,n));i++}return o}function d(e){return e.map(e=>l(e,void 0,void 0))}function l(e,t,n){let r=void 0;return n&&(r=Object(a.b)(Object(a.a)(n),e)),r||Object.assign(Object.assign({},Object(i.e)(e)),{parentId:null!=t?t:""})}function u(){if(o.L())return p;const e=new s.a;return e.insert(""),e.toJSON()}const p=(new s.a).insert("").toJSON()},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.GrantUsersAccessFailure=1]="GrantUsersAccessFailure",e[e.InitCreateCommentSession=2]="InitCreateCommentSession",e[e.InitEditCommentSession=3]="InitEditCommentSession",e[e.InitReplyCommentSession=4]="InitReplyCommentSession",e[e.NextThread=5]="NextThread",e[e.PreviousThread=6]="PreviousThread",e[e.DeleteThread=8]="DeleteThread",e[e.CommitFailure=9]="CommitFailure",e[e.HostRequest=10]="HostRequest",e[e.GhostCard=11]="GhostCard"}(r||(r={}))},function(e,t,n){"use strict";var r,o,i;n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return b})),n.d(t,"d",(function(){return C})),n.d(t,"e",(function(){return y})),function(e){e[e.HostDefaultOrder=0]="HostDefaultOrder",e[e.NewestFirst=1]="NewestFirst"}(r||(r={})),function(e){e[e.All=0]="All",e[e.ResolvedOnly=1]="ResolvedOnly",e[e.ActiveOnly=2]="ActiveOnly"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.UnableToReconcile=1]="UnableToReconcile",e[e.DivergentChange=2]="DivergentChange"}(i||(i={}));var a=n(8),s=n(0),c=n(26),d={ContentFilteredRangeModule:c.RekaServiceRegistry.getNativeService(["SDX::ContentFilteredRange::ContentFilteredRangeModule",{getFilteredRange:["ReturnsPromiseMethod","SDX::ContentFilteredRange::GetFilteredRangeResult",["$string","SDX::ContentFilteredRange::GetFilteredRangeArgs"]],teardownFilteredRange:["FireAndForgetMethod",["$string","$string"]],updateFilterForFilteredRangeId:["ReturnsPromiseMethod","$any",["$string","$string","SDX::ContentFilteredRange::HostFilter"]],getExistingFilteredRange:["ReturnsPromiseMethod",["$optional","SDX::ContentFilteredRange::GetFilteredRangeResult"],["$string","$string"]],setActiveFilteredRange:["ReturnsPromiseMethod","$any",["$string",["$optional","$string"]]],getActiveFilteredRangeId:["ReturnsPromiseMethod",["$optional","$string"],["$string"]],getFilterUsers:["ReturnsPromiseMethod",["$array","Mso::Document::Comments::JS::IUser"],["$string"]],getCapabilities:["ReturnsPromiseMethod",["$optional","SDX::ContentFilteredRange::CapabilitiesResult"],["$string"]],getHostSpecificLabels:["ReturnsPromiseMethod","SDX::ContentFilteredRange::HostLabelsResult",["$string"]],onFilteredRangeUpdated:["Event","SDX::ContentFilteredRange::ModuleFilteredRangeUpdatedArgs"],onUserFilterManagerEvent:["Event","SDX::ContentFilteredRange::ModuleUserFilterManagerEventArgs"],onActiveFilterUpdated:["Event","SDX::ContentFilteredRange::ModuleActiveFilterUpdatedEventArgs"]}])},l=function(){function e(e){var t=this;if(this.apiContext=e,this.onFilteredRangeUpdated=new c.EventImpl((function(){})),this.onActiveFilterUpdated=new c.EventImpl((function(){})),this.onUserFilterManagerEvent=new c.EventImpl((function(){})),this.onModuleFilteredRangeEventReceived=function(e){e.apiContext===t.apiContext&&t.onFilteredRangeUpdated.trigger(e)},this.onModuleUserFilterManagerEventReceived=function(e){e.apiContext===t.apiContext&&t.onUserFilterManagerEvent.trigger(e.payload)},this.onModuleActiveFilterUpdatedReceived=function(e){e.apiContext===t.apiContext&&t.onActiveFilterUpdated.trigger(e.payload)},!d.ContentFilteredRangeModule)throw new Error("NativeService not available for ContentFilteredRangeHostAPI");d.ContentFilteredRangeModule.onFilteredRangeUpdated.subscribe(this.onModuleFilteredRangeEventReceived),d.ContentFilteredRangeModule.onActiveFilterUpdated.subscribe(this.onModuleActiveFilterUpdatedReceived),d.ContentFilteredRangeModule.onUserFilterManagerEvent.subscribe(this.onModuleUserFilterManagerEventReceived)}return e.prototype.getFilteredRange=function(e){return d.ContentFilteredRangeModule.getFilteredRange(this.apiContext,e)},e.prototype.teardownFilteredRange=function(e){d.ContentFilteredRangeModule.teardownFilteredRange(this.apiContext,e)},e.prototype.getExistingFilteredRange=function(e){return d.ContentFilteredRangeModule.getExistingFilteredRange(this.apiContext,e)},e.prototype.updateFilterForFilteredRangeId=function(e,t){d.ContentFilteredRangeModule.updateFilterForFilteredRangeId(this.apiContext,e,t).catch((function(e){return Object(s.i)().assertConditionTag(!1,"Native module call failed with error ".concat(Object(a.l)(e)),537743712)}))},e.prototype.setActiveFilteredRange=function(e){d.ContentFilteredRangeModule.setActiveFilteredRange(this.apiContext,e).catch((function(e){return Object(s.i)().assertConditionTag(!1,"Native module call failed with error ".concat(Object(a.l)(e)),537743713)}))},e.prototype.getActiveFilteredRangeId=function(){return d.ContentFilteredRangeModule.getActiveFilteredRangeId(this.apiContext)},e.prototype.getCapabilities=function(){return d.ContentFilteredRangeModule.getCapabilities(this.apiContext)},e.prototype.getHostSpecificLabels=function(){return d.ContentFilteredRangeModule.getHostSpecificLabels(this.apiContext)},e.prototype.getFilterUsers=function(){return d.ContentFilteredRangeModule.getFilterUsers(this.apiContext)},e}(),u=(n(122),n(247)),p=n(3),h=function(){function e(e,t,n,r,o,i){this.id=e,this.filter=t,this.order=n,this.hostAPI=r,this.supportsUpdates=o,this.onTeardown=i,this.active=!0,this.onRangeUpdated=new c.EventImpl((function(){}))}return e.prototype.getFilter=function(){return this.filter},e.prototype.getOrder=function(){return this.order},e.prototype.isActive=function(){return this.active},e.prototype.teardown=function(){this.active=!1,this.hostAPI.teardownFilteredRange(this.id),this.onTeardown()},e.prototype.canBeUpdated=function(){return this.supportsUpdates},e.prototype.updateFilter=function(e){return!!this.supportsUpdates&&(this.filter=e,this.hostAPI.updateFilterForFilteredRangeId(this.id,Object(p.a)({},e)),!0)},e.prototype.onChangeEventReceived=function(e){if(this.active){for(var t=0,n=e.changes;t<n.length;t++){var r=n[t];if(this.active)switch(r.type){case"FilterUpdate":this.filter=r.updatedFilter;break;case"Insert":this.order=Object(p.g)(Object(p.g)(Object(p.g)([],this.order.slice(0,r.index),!0),[r.content],!1),this.order.slice(r.index),!0);break;case"Remove":this.order=Object(p.g)(Object(p.g)([],this.order.slice(0,r.index),!0),this.order.slice(r.index+1),!0);break;case"Reload":this.order=r.fullContent,Object(s.i)().assertConditionTag(r.reason===i.DivergentChange,"Received a full reload for an error reason.",537743690);break;case"Teardown":this.active=!1}}this.onRangeUpdated.trigger(e)}},e}(),f=function(e){var t=this;this.hostApi=e,this.getFilterUsers=function(){return void 0!==t.cachedUsers?Promise.resolve(t.cachedUsers):t.hostApi.getFilterUsers().then((function(e){return t.cachedUsers=e,e}))},this.onUserFilterManagerEventReceived=function(e){if(t.cachedUsers){var n=e.payload.type;switch(n){case"UserAdded":t.cachedUsers=Object(p.g)(Object(p.g)([],t.cachedUsers,!0),[e.payload.user],!1);break;case"UserRemoved":t.cachedUsers=t.cachedUsers.filter((function(t){return t.Provider===e.payload.user.Provider&&t.UserId===e.payload.user.UserId}));break;default:Object(a.m)(n)}}},this.onUserFilterManagerEvent=this.hostApi.onUserFilterManagerEvent,this.hostApi.onUserFilterManagerEvent.subscribe(this.onUserFilterManagerEventReceived)},m=function(e){var t=this;this.contentFilteredRangeHostAPI=e,this.filteredRanges=new Map,this.createFilteredRange=function(e){return t.contentFilteredRangeHostAPI.getFilteredRange({contentTypes:e.contentTypes,hostFilter:e.filters,supportsFilterUpdates:e.supportsFilterUpdates}).then((function(e){var n=e.filterId,r=new h(n,e.filter,e.content,t.contentFilteredRangeHostAPI,e.supportsFilterUpdates,(function(){return t.onFilterTearDown(n)}));return t.filteredRanges.set(n,r),r}))},this.getFilteredRange=function(e){return t.filteredRanges.has(e)?Promise.resolve(t.filteredRanges.get(e)):t.contentFilteredRangeHostAPI.getExistingFilteredRange(e).then((function(n){if(n){var r=new h(n.filterId,n.filter,n.content,t.contentFilteredRangeHostAPI,n.supportsFilterUpdates,(function(){return t.onFilterTearDown(e)}));return t.filteredRanges.has(e)||t.filteredRanges.set(e,r),r}}))},this.setActiveFilteredRange=function(e){t.contentFilteredRangeHostAPI.setActiveFilteredRange(e)},this.getActiveFilteredRangeId=function(){return t.contentFilteredRangeHostAPI.getActiveFilteredRangeId()},this.onEventReceived=function(e){var n=t.filteredRanges.get(e.filterId);n&&n.onChangeEventReceived(e.payload)},this.onFilterTearDown=function(e){t.filteredRanges.delete(e)},this.getCapabilities=function(){return t.contentFilteredRangeHostAPI.getCapabilities()},this.getHostSpecificLabels=function(){return t.contentFilteredRangeHostAPI.getHostSpecificLabels()},this.getUserFilterManager=function(){return t.userFilterManager},this.onActiveFilterUpdated=this.contentFilteredRangeHostAPI.onActiveFilterUpdated,this.contentFilteredRangeHostAPI.onFilteredRangeUpdated.subscribe(this.onEventReceived),this.userFilterManager=new f(e)};var g=new Map;function b(e,t){Object(s.i)().assertConditionTag(!1,"Received unexpected API Context for Web. This is not fully supported for all APIs.",538035220);var n=g.get(e);n||(n=new u.a("ContentFilteredRange"),g.set(e,n)),n.injectInstance(new m(t))}function C(e){var t=g.get(e);if(!t)throw new a.d("ContentFilteredRangeAPI not initialized for current apiContenxt ".concat(e,"."),538035221);return t.getInstanceOrThrow()}function y(e){var t;return void 0!==(null===(t=g.get(e))||void 0===t?void 0:t.getInstance())}!function(){function e(){this.getCapabilities=function(){return Promise.resolve(void 0)},this.getHostSpecificLabels=function(){throw new a.d("Method not implemented.",537421141)},this.getExistingFilteredRange=function(e){throw new a.d("Method not implemented.",537421142)},this.updateFilterForFilteredRangeId=function(e,t){throw new a.d("Method not implemented.",537421143)},this.setActiveFilteredRange=function(e){throw new a.d("Method not implemented.",537421144)},this.getActiveFilteredRangeId=function(){throw new a.d("Method not implemented.",537421145)},this.onFilteredRangeUpdated=new c.EventImpl((function(){})),this.onUserFilterManagerEvent=new c.EventImpl((function(){})),this.onActiveFilterUpdated=new c.EventImpl((function(){}))}e.prototype.getFilteredRange=function(e){throw new a.d("Method not implemented.",537421138)},e.prototype.teardownFilteredRange=function(e){throw new a.d("Method not implemented.",537421139)},e.prototype.getOrder=function(e){throw new a.d("Method not implemented.",537421140)},e.prototype.getFilterUsers=function(){throw new a.d("Method not implemented.",537421146)}}()},,function(e,t,n){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){"use strict";var r=n(94).a.Symbol;t.a=r},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";var r;!function(e){e[e.Success=0]="Success",e[e.CommitPending=1]="CommitPending",e[e.ShareFailed=2]="ShareFailed",e[e.CommitFailed=3]="CommitFailed"}(r||(r={})),t.a=r},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";var r=n(208),o=n(209);t.a=function(e){return null!=e&&Object(o.a)(e.length)&&!Object(r.a)(e)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}));var r="Default_7210d794-9f0f-4d0a-805c-964303b2676b";function o(e,t){return function(n){(n.apiContext||r)===e&&t(n)}}},function(e,t,n){"use strict";var r,o=n(208),i=n(94).a["__core-js_shared__"],a=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var s=function(e){return!!a&&a in e},c=n(97),d=n(168),l=/^\[object .+?Constructor\]$/,u=Function.prototype,p=Object.prototype,h=u.toString,f=p.hasOwnProperty,m=RegExp("^"+h.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var g=function(e){return!(!Object(c.a)(e)||s(e))&&(Object(o.a)(e)?m:l).test(Object(d.a)(e))};var b=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var n=b(e,t);return g(n)?n:void 0}},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return u}));var r=n(125),o=n(191),i=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},a={tokens:0,object:o.a,get _overrides(){return{object:this}}},s={object:a};function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.b.apply(void 0,i([a],e))}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.b.apply(void 0,i([s],e))}function l(e,t){var n="function"==typeof t?t:function(e){return t[e]};return e&&e._precedence&&e._precedence.filter((function(e){return n(e)}))||[]}function u(e,t){var n=e,r=e._overrides,o=e._precedence;if(t&&r&&o)for(var i=0,a=l(e,t);i<a.length;i++){var s=a[i];n=c(n,n._overrides[s])}return n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l}));var r=n(3),o={appendArray:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return[].concat.apply([],e)}};function i(e){return"boolean"==typeof e?[{object:e},e]:"number"==typeof e?[{object:!(e>=0)||e},0!==e]:[e,!0]}function a(e){return"object"==typeof e?Array.isArray(e)?"array":"object":typeof e}function s(e,t,n){var i=void 0,a=void 0!==e[t]?e[t]:void 0!==e[n]?e[n]:void 0;return void 0!==a&&void 0===(i=function(e){return"function"==typeof e?e:"string"==typeof e?o[e]:void 0}(a))&&"object"===n&&(i=function(e,t){return"boolean"==typeof e?e?Object(r.a)({object:e},t):t:"number"==typeof e?0===e?t:Object(r.a)({object:e-1},t):e}(a,function(e){return e.array?{array:e.array}:{}}(e))),i}function c(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var d=n.filter((function(e){return e&&"object"===a(e)&&Object.getOwnPropertyNames(e).length>0})),l=i(e),u=l[0],p=l[1],h=t&&1===d.length;if(d.length>1||h&&1===d.length){var f=h?void 0:Object.assign.apply(Object,Object(r.g)([{}],d,!1)),m=f||d[0],g=function(e){if(m.hasOwnProperty(e)){if(p){var n=m[e],o=a(n),i=s(u,e,o);if(void 0!==i){var l=d.map((function(t){return t[e]})).filter((function(e){return void 0!==e})),g="function"==typeof i?i.apply(void 0,l):c.apply(void 0,Object(r.g)([i,t],l,!1));g!==n&&((f=f||Object.assign.apply(Object,Object(r.g)([{}],d,!1)))[e]=g)}}h||void 0!==f[e]||delete f[e]}};for(var b in m)g(b);return f||m}return d.length>0?d[0]:void 0}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c.apply(void 0,Object(r.g)([!0,!1],e,!1))}function l(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return c.apply(void 0,Object(r.g)([e,!1],t,!1))}},function(e,t,n){var r=n(386),o=n(387),i=n(333),a=n(388);e.exports=function(e,t){return r(e)||o(e,t)||i(e,t)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(68);function o(e){return e.sessionType===r.a}function i(e){return e.sessionType===r.d&&void 0!==e.threadId}function a(e){return e.sessionType===r.b&&void 0!==e.commentId}},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var r=n(141),o=n(7),i=n(80),a=n(6),s=n(241);const c=(e,t,n,r,i)=>e&&t===a.a.HalfPane&&void 0===i&&(!r||r.selectedCardId===Object(o.G)(n,!0,t)),d=(e,t,n,o)=>{if(!n)return;if(Object(r.a)(e)!==i.a.CannotAutoDiscard)return;const a=null!=o?o:Object(s.a)(e,t.componentTreeId.renderContextType);return(e,t)=>n(a,e,t)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r,o=n(0);function i(e){r=e}function a(e){r?r.announceToScreenReader(e):Object(o.i)().assertConditionTag(!1,"announceToScreenReader not registered",595632534)}var s=function(){function e(){}return e.prototype.setScreenReaderNotifier=function(e){e&&i(e)},e}();new(function(){function e(){this.screenReaderNotifierManagerInstance=void 0}return e.prototype.getScreenReaderNotifierManagerInstance=function(){return this.screenReaderNotifierManagerInstance||(this.screenReaderNotifierManagerInstance=new s),this.screenReaderNotifierManagerInstance},e}())},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Editing=1]="Editing",e[e.Pending=2]="Pending"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(58),o=n(6);function i(e,t,n){return n===o.a.HalfPane||t.includes(e)?r.a.Expanded:r.a.Collapsed}},function(e,t,n){"use strict";var r=n(117),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=r.a?r.a.toStringTag:void 0;var c=function(e){var t=i.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var o=a.call(e);return r&&(t?e[s]=n:delete e[s]),o},d=Object.prototype.toString;var l=function(e){return d.call(e)},u=r.a?r.a.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":u&&u in Object(e)?c(e):l(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r.a}));var r=n(88)},function(e,t,n){"use strict";function r(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))}n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return f}));var o,i=n(1),a=n(2),s=n(20),c=n(64),d=n(42),l=n(12);!function(e){e[e.None=0]="None",e[e.CardExpanding=1]="CardExpanding",e[e.CardCollapsing=2]="CardCollapsing"}(o||(o={}));const u=i.createContext({collapsingCards:[],expandingCards:[]}),p=i.createContext(o.None);class h extends i.PureComponent{constructor(e){super(e),this.timeoutCookie=void 0,this.state={previousExpandedComments:e.expandedComments,collapsingCards:[],expandingCards:[]}}static getDerivedStateFromProps(e,t){if(!a.i())return{};const n=e.expandedComments.filter(e=>!t.previousExpandedComments.includes(e)),r=t.previousExpandedComments.filter(t=>!e.expandedComments.includes(t));return{previousExpandedComments:e.expandedComments,collapsingCards:r,expandingCards:n}}componentDidUpdate(e,t){(!r(this.state.expandingCards,t.expandingCards)||!r(this.state.collapsingCards,t.collapsingCards))&&(void 0!==this.timeoutCookie&&cancelAnimationFrame(this.timeoutCookie),this.timeoutCookie=requestAnimationFrame(()=>this.setState({expandingCards:[],collapsingCards:[]})))}componentWillUnmount(){void 0!==this.timeoutCookie&&(cancelAnimationFrame(this.timeoutCookie),this.timeoutCookie=void 0)}render(){return i.createElement(u.Provider,{value:this.state},i.Children.only(this.props.children))}}const f=function(e){return Object(d.a)(t=>{var n,r;const d=t.collapsingCards||t.expandingCards?"CommentCard_Container":void 0;let u=o.None;if(e.item.length>0){const i=e.item[0],a=Object(c.a)(i)&&i.commentModel.commentId;a&&(null===(n=t.expandingCards)||void 0===n?void 0:n.includes(a))?u=o.CardExpanding:a&&(null===(r=t.collapsingCards)||void 0===r?void 0:r.includes(a))&&(u=o.CardCollapsing)}const h=a.J()?{onFocusCapture:e.onFocusCapture,onLayout:e.onLayout}:{};return i.createElement(s.a,Object.assign({style:l.d,animationClass:d},h),i.createElement(p.Provider,{value:u},e.children))},u)}},function(e,t,n){"use strict";function r(e,t){return e[t]=e[t]||{}}function o(e,t){return t&&t.length>0?t.reduce((function(e,t){return function(e,t){if(null==t)return r(e,"empty");if("object"==typeof t||"function"==typeof t){var n=e.obj=e.obj||new WeakMap;return n.get(t)||n.set(t,{}).get(t)}var o=t+"",i=r(e,"str");return i[o]=i[o]||{}}(e,t)}),e):r(e,"noargs")}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var i={};function a(e){var t=e?o(i,[e]):{};return function(e,n){return function e(t,n,r){var i=o(t,r);return i.hasOwnProperty("value")||(i.value="function"==typeof n?n():n),[i.value,function(t,n){return e(i,t,n)}]}(t,e,n)}}function s(e){var t=a();return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t((function(){return e.apply(void 0,n||[])}),n)[0]}}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ViewContainerChanged=0]="ViewContainerChanged",e[e.FocusTriggered=2]="FocusTriggered",e[e.VisibilityChanged=3]="VisibilityChanged",e[e.FoldableLayoutStateChanged=4]="FoldableLayoutStateChanged"}(r||(r={}))},function(e,t,n){"use strict";var r=n(214);n.d(t,"a",(function(){return r.a}))},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l}));var r=n(0),o=n(70),i=n(13),a=n(22);function s(e){return void 0!==e&&0!=(e.commentFlags&o.c.Resolved)}function c(e){return e!==a.a.Canvas}function d(e){return Object(i.R)(e)}function l(e,t){e.addDataField("IsCommentResolved",t,r.d.SystemMetadata)}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unfocused=0]="Unfocused",e[e.FocusOn=1]="FocusOn",e[e.FocusWithin=2]="FocusWithin"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(45),o=n(80),i=n(19),a=n(7);function s(e){if(!Object(i.c)(e))return o.a.NoDraft;if(!function(e){const t=Object(a.I)(e),n=t?e.drafts[e.cardIdToDraftIdMap[t]]:void 0;return!!(null==n?void 0:n.isDraftEmpty)}(e))return o.a.CannotAutoDiscard;const t=Object(a.K)(e);return t&&Object(r.k)(t.commentDraft.sessionConfiguration)?o.a.CannotAutoDiscard:o.a.CanAutoDiscard}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(8),o=n(67),i=n(6);function a(e){switch(e){case o.b.HalfPane:return i.a.HalfPane;case o.b.FullPane:return i.a.FullPane;default:Object(r.m)(e)}}},function(e,t,n){"use strict";var r;!function(e){e.PaneOpen="Read",e.NewThread="NewThread",e.InitRuntime="InitRuntime"}(r||(r={})),t.a=r},function(e,t,n){"use strict";n.d(t,"b",(function(){return $})),n.d(t,"a",(function(){return Y}));var r=n(8),o=n(25),i=n(13),a=n(22),s=n(164),c=n(0),d=n(85);var l=n(414),u=n(77),p=n(68),h=n(86),f=n(127),m=n(58),g=n(131),b=n(160),C=n(287);class y{constructor(e,t=!0){this.rawDelta=e,this.onlyNewMentions=t,this._deserializedDelta=void 0,this._NumHyperlinks=0,this._hasRichTextFormatting=!1,this._users=[]}get NumHyperlinks(){return void 0===this._deserializedDelta&&this.parseDelta(),this._NumHyperlinks}get Mentions(){return void 0===this._deserializedDelta&&this.parseDelta(),this._users}get HasRichTextFormatting(){return void 0===this._deserializedDelta&&this.parseDelta(),this._hasRichTextFormatting}toString(){return this.rawDelta}parseDelta(){var e,t;this._deserializedDelta=JSON.parse(this.rawDelta),null===(t=null===(e=this._deserializedDelta)||void 0===e?void 0:e.ops)||void 0===t||t.forEach(e=>{var t;if(null==e?void 0:e.attributes){e.attributes.link&&(this._NumHyperlinks+=1);const n=e.attributes.atmention,r=e.optional;!n||this.onlyNewMentions&&void 0!==r&&void 0!==r.atmention||null===(t=this._users)||void 0===t||t.push({UserId:n.email,Provider:C.a}),(e.attributes.weight||e.attributes.italic||e.attributes.underline)&&(this._hasRichTextFormatting=!0)}})}}var v=n(21),T=n(217),S=n(2),I=n(119),O=n(7),E=n(19),P=n(113),k=n(91),R=n(5),x=n(103),D=n(259),w=n(198),A=n(172);function j(e,t,n,o,a,s,d){return(C,v)=>{var T,j;const M=Object(c.i)().createActivityObject("CommitComment",e.telemetryVisitor,c.a.None,c.b.NecessaryServiceDataEvent);M.addDocumentMetadata(c.f.Basic);const N=h.b[a.type],L=v(),B=x.b(L),H=R.t(L);if(void 0===H||H.commentDraft.sessionConfiguration.sessionType!==a.type)return M.failTag(593278784,-2130957522),Promise.resolve(I.a.CommitFailed);let U="",V=!1;switch(a.type){case p.b:U=a.commentId;break;case p.d:U=a.parentId,V=!0;break;case p.a:H&&(U=H.commentDraft.sessionConfiguration.draftId||"")}const W=R.j(L),z=!V||Object(g.a)(U,W,e.renderContextType)===m.a.Expanded;M.addDataField("IsCardExpanded",z,c.d.SystemMetadata);let K=d;if((S.f()||S.g())&&(K=function(e,t){var n;if(!t||Object(f.b)(t.commentDraft.sessionConfiguration)||!S.b())return;let r=void 0;const o=S.g()?Object(b.b)(null!==(n=null==e?void 0:e.currentState.assignees)&&void 0!==n?n:[],t.selectedTaskAssignees):void 0;if(o)r={Task:{type:"Task",assigneeUpdate:o}};else{const e=t.selectedTaskAssignee;r=e?{Task:{type:"Task",assignee:e}}:void 0}return r}(B[U],H)),(null==K?void 0:K.Task)&&!Object(O.c)(L.commentState.modelCapabilities)&&(Object(c.i)().assertConditionTag(!1,"Unexpected task assignment when Task Capability is disabled'",590435658),K.Task=void 0),(S.b()&&a.type===p.a||S.c()&&a.type===p.d)&&(M.addDataField("IsPreExistingTask",!!B[U],c.d.SystemMetadata,c.e.Critical),M.addDataField("AffectingTaskMetadata",!!(null==K?void 0:K.Task),c.d.SystemMetadata,c.e.Critical)),M.addDataField("SessionType",N,c.d.SystemMetadata),a.type!==p.a){const e=Object(O.i)(R.c(L),U);e.valid&&(M.addDataField("MatchesCommentAuthor",e.matchesCurrentUser,c.d.SystemMetadata),M.addDataField("ThreadCreationDeltaMs",e.timeElapsed,c.d.SystemMetadata))}M.addDataField("AssociatedCommentId",U,c.d.SystemMetadata),M.addDataField("AtMentionsEnabled",n,c.d.SystemMetadata),M.addDataField("Trackback",e.trackback,c.d.SystemMetadata),M.addDataField("RenderContextType",e.renderContextType,c.d.SystemMetadata),M.addDataField("CommitSource",s,c.d.SystemMetadata);const G=R.h(L);return Object(E.i)(G)?(null===(j=(T=Object(c.i)()).logDiagnosticTrace)||void 0===j||j.call(T,l.a`NoCommitDueToCommitPending`,556827598,c.h.Info,c.c.ProductServiceUsage,e.telemetryVisitor,Object(c.l)("DraftId",H.commentDraft.sessionConfiguration.draftId,c.d.SystemMetadata)),Promise.resolve(I.a.CommitPending)):(C(Object(D.a)(i.h(e,593278785))),o().then(o=>{if(!n){const t=F(C,a,o,0,M,593278786,593278787,e,K);return Promise.resolve(t)}const i=new y(o),s=i.Mentions;M.addDataField("NumberOfMentionsAdded",s.length,c.d.SystemMetadata);const d=Object(c.i)();if(S.e()&&s.length>0&&d.logFloodgateActivity&&d.logFloodgateActivity("Office_Docs_SharedComments_CommitComment"),M.addDataField("NumberOfHyperlinks",i.NumHyperlinks,c.d.SystemMetadata),M.addDataField("CreateCommentWithRichFormatting",i.HasRichTextFormatting,c.d.SystemMetadata),!s.length){const t=F(C,a,o,0,M,593278788,593278789,e,K);return Promise.resolve(t)}return t.grantUsersAccess(s).then(t=>{const n=function(e){const t=e.OperationResult;return"boolean"==typeof t?t:t===u.a.Success}(t),i=function(e){return!!e.Details&&e.Details.Canceled}(t);if(M.addDataField("AllUsersGrantedAccess",n,c.d.SystemMetadata),M.addDataField("ShareDialogCanceled",i,c.d.SystemMetadata),t.OperationResult===u.a.FailedSilently)return Object(r.i)("Check Access Phase failed - share dialog not shown"),M.failTag(593278790,-2130957561),_(C,o,k.a.GrantAccessFailedSilently,593278791,593278792,e),Promise.resolve(I.a.ShareFailed);if(i)return Object(r.i)("Share dialog was canceled by user"),M.successTag(593278793),_(C,o,k.a.GrantAccessCanceled,593278794,554801174,e),Promise.resolve(I.a.ShareFailed);if(!n)return Object(r.i)("Not all users have been granted access - going back to initial state"),M.successTag(593278795),_(C,o,k.a.GrantAccessCanceled,593278796,554784648,e),Promise.resolve(I.a.ShareFailed);const d=F(C,a,o,s.length,M,593278797,593278798,e,K);return Promise.resolve(d)},t=>(M.failTag(593278799,-2130957561),Object(r.i)("Grant Users Access has failed",Object(r.l)(t)),_(C,o,k.a.GrantAccessFailedSilently,593278800,554784393,e),Promise.resolve(I.a.ShareFailed)))},t=>(M.failTag(593278801,-2130957539),C(Object(w.a)(i.h(e,593278802),void 0)),Object(r.i)("getCommentBody failed",Object(r.l)(t)),S.y()&&C(Object(A.a)({draftWarningReason:P.a.CommitFailure,draftWarningType:k.a.CommitFailed},i.h(e,593278803))),Promise.resolve(I.a.CommitFailed))))}}function _(e,t,n,r,o,a){e(Object(w.a)(i.h(a,r),t)),e(Object(A.a)({draftWarningType:n,draftWarningReason:P.a.GrantUsersAccessFailure},i.h(a,o)))}function F(e,t,n,r,o,a,s,l,u){const h=function(e,t,n,r,o){try{switch(t.type){case"CREATE":e(i.o(i.h(r,593278804),{sessionType:t.type,data:{commentBody:n},metadataUpdates:o}));break;case"EDIT":e(i.o(i.h(r,593278805),{sessionType:t.type,data:{commentBody:n,commentId:t.commentId}}));break;case"REPLY":e(i.o(i.h(r,593278806),{sessionType:t.type,data:{commentBody:n,parentId:t.parentId},metadataUpdates:o}));break;default:return Object(c.i)().assertConditionTag(!1,`Unexpected session type '${t.type}'`,593278807),e(Object(w.a)(i.h(r,593278808),n)),-2130957532}}catch(t){if(!Object(v.b)(t)&&!Object(T.a)(t))throw t;return e(Object(w.a)(i.h(r,593278809),n)),S.y()&&e(Object(A.a)({draftWarningReason:P.a.CommitFailure,draftWarningType:k.a.CommitFailed},i.h(r,593278810))),Object(d.a)(t)}return}(e,t,n,l,u);return h?(o.failTag(s,h),I.a.CommitFailed):r?(t.type===p.a?(o.addDataField("CreateThreadWithMentions",!0,c.d.SystemMetadata,c.e.Critical),u&&u.Task&&o.addDataField("CreateThreadWithTaskAssigned",!0,c.d.SystemMetadata,c.e.Critical)):t.type===p.d&&(o.addDataField("CreateReplyWithMentions",!0,c.d.SystemMetadata,c.e.Critical),u&&u.Task&&o.addDataField("CreateReplyWithTaskAssigned",!0,c.d.SystemMetadata,c.e.Critical)),o.successTag(a),I.a.Success):(o.successTag(a),I.a.Success)}var M=n(202),N=n(180),L=n(84),B=n(143),H=n(6),U=n(261),V=n(235),W=n(204);var z=n(62),K=n(271);var G=n(165);function q(e,t){return{requestDeleteComment:(t,n)=>{e(i.E(t,n))},requestDeleteThread:(t,n,r)=>{e(i.F(t,n,r))},requestReopenThread:(t,n,r)=>{e(i.I(t,n,r))},requestResolveThread:(t,n,r)=>{e(i.K(t,n,r))},requestEditCommentSession:(n,r)=>{e(Object(s.a)(n,t.commentAPI,{sessionType:"EDIT",commentId:r},!1,t.peopleAPI)).catch(Object(o.a)(574362624))},requestReplyCommentSession:(n,r)=>{e(Object(s.a)(n,t.commentAPI,{sessionType:"REPLY",threadId:r},!1,t.peopleAPI)).catch(Object(o.a)(574362625))},commitCommentAndFocus:(n,r,o,i,a,s,c,d)=>e(j(n,t.peopleAPI,i,r,o,c,d)).then(e=>(e===I.a.Success&&t.focusManager.focusCommentCardCommand(a,s),e)),discardDraftAsync:(t,n,r,o)=>e(Object(N.a)(t,n,r,o)),discardDraftIfEmpty:(t,n,r)=>e(Object(M.a)(t,n,r)),showLowFidelityWarning:(t,n,r)=>{e(i.S(t,n,r))},clearLowFidelityWarning:t=>{e(i.k(t))},saveDraft:(t,n,r)=>{e(i.L(t,{draftId:n,draftContent:r}))},clearCommentHighlight:(t,n)=>{e(i.i(t,a.a.SharedComments,n))},checkUserAccess:e=>t.peopleAPI.checkUserAccess(e),updateMentioneesStillInDraft:(t,n)=>{e(i.Z(t,n))},addToCurrentMentionees:(t,n)=>{e(i.c(t,n))},updateSelectedTaskAssignee:(t,n)=>{e(i.bb(t,n))},updateSelectedTaskAssignees:(t,n)=>{e(i.cb(t,n))},toggleTaskAssigner:t=>{e(i.U(t))},displayDraftWarning:(t,n,r)=>{e(i.q({draftWarningType:n,draftWarningReason:r},t))},showPostErrorUI:(t,n)=>{e(i.T(t,n))},clearPostErrorUI:(t,n)=>{e(i.l(t,n))},selectCommentCardAndShowLowFidelityWarning:(t,n,r)=>{e(function(e,t,n){return(r,o)=>{var i;const s=o();(null===(i=R.r(s))||void 0===i?void 0:i.selectedCardId)!==t&&r(Object(z.b)(e,t,void 0,z.a.ExpandCard,a.a.SharedComments)),r(Object(K.a)(e,t,n))}}(t,n,r))},draftEmptinessChanged:(t,n,r)=>{e(i.r(t,r,n))},selectComment:(t,n,r,o)=>e(Object(G.b)(t,n,r,o)),collapseCard:(t,n)=>{e(i.m(t,n))},requestUpdateCommentReactions:(n,r,o,i)=>{e(function(e,t,n,r,o){return()=>{const i=Object(c.i)().createActivityObject("CommentReaction",e.telemetryVisitor,c.a.None,c.b.NecessaryServiceDataEvent);t.beginDraftingAsync(n).then(e=>{e.updateProperties("Reaction",{type:"Reaction",reactionType:r,isActive:o}),e.commit(),e.endDrafting(),i.successTag(587317280)}).catch(e=>{i.failTag(587317281,Object(d.a)(e))})}}(n,t.commentAPI,{sessionType:"METADATA",threadId:r},o,i))},requestPresentLinkToComment:(t,n)=>{e(i.H(t,n))}}}function $(e,t){return Object.assign(Object.assign({},q(e,t)),{highlightComment:(t,n)=>{e(i.s(t,n,a.a.SharedComments))},discardDraftAndStartNewCommentSession:n=>{e(Object(s.a)(n,t.commentAPI,{sessionType:"CREATE"},!1,t.peopleAPI)).catch(Object(o.a)(592314377))},queueLoadThreads:(t,n)=>{e(i.z(t,{threadIds:n}))},requestClosePane:t=>{e(i.D(t))},requestDisplayConfiguration:(t,n)=>e(Object(W.a)(t,n)),readyToRender:t=>{e(i.A(t))},requestModalConfirmation:(t,n,r,o)=>{e(i.G(t,n,r,o))},initializeView:n=>{e(function(e,t,n,r,i){return a=>(a(Object(U.a)({renderContextType:e,trackback:595899542,telemetryVisitor:i})),t===B.a.NewThread?(e===H.a.HalfPane&&a(Object(W.a)({renderContextType:e,trackback:595899543,telemetryVisitor:i},{displayMode:L.a.Variable,desiredHeight:0})).catch(Object(o.a)(595645966)),a(Object(s.a)({renderContextType:e,trackback:595898586,telemetryVisitor:i},n,{sessionType:"CREATE"},!1,r)).then(()=>{a(Object(V.a)({renderContextType:e,trackback:595899545,telemetryVisitor:i}))})):a(Object(V.a)({renderContextType:e,trackback:595899546,telemetryVisitor:i})))}(n,t.initializationReason,t.commentAPI,t.peopleAPI,t.telemetryVisitor))},updateRenderLocksForAllDrafts:(t,n)=>{e(i.V(t,n))}})}function Y(e,t){return Object.assign(Object.assign({},q(e,t)),{updateRenderLockForDraft:(t,n,r)=>{e(i.V(t,n,r))},highlightComment:n=>{e(i.s(n,t.resource.id,a.a.SharedComments))},requestDisplayConfiguration:(n,r)=>t.componentTree.componentTreeId.renderContextType!==H.a.HalfPane?Promise.resolve(void 0):e(Object(W.a)(n,r)),queueLoadThread:n=>e(i.z(n,{threadIds:[t.resource.id]}))})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(139),o=n(23),i=n(81);class a{constructor(e,t,n=0,r=!1){this.threadIds=e,this.commentData=t,this.ignoreResolvedThreads=r,this.pointer=0,this.pointer=Math.max(-1,Math.min(n,e.length))}next(){const e=this.pointer,t=this.threadIds.length-1;if(this.pointer<t)do{++this.pointer}while(this.pointer<=t&&this.ignoreResolvedThreads&&Object(r.a)(Object(o.b)(this.commentData,this.threadIds[this.pointer])));return this.pointer<t||this.pointer===t&&e<t?{done:!1,value:this.threadIds[this.pointer]}:{done:!0,value:void 0}}previous(){const e=this.pointer;if(this.pointer>0)do{--this.pointer}while(this.pointer>=0&&this.ignoreResolvedThreads&&Object(r.a)(Object(o.b)(this.commentData,this.threadIds[this.pointer])));return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.threadIds[this.pointer]}:{done:!0,value:void 0}}currentIndex(){return this.pointer}}class s{constructor(e,t=0,n=!1){this.model=e,this.startThreadIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}next(){const e=this.pointer;if(this.pointer<this.model.length-1)do{++this.pointer}while(this.pointer<this.model.length&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&i.f.Resolved));return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&e<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}}previous(){const e=this.pointer;if(this.pointer>0)do{--this.pointer}while(this.pointer>=0&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&i.f.Resolved));return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.model[this.pointer]}:{done:!0}}currentIndex(){return this.pointer}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return fn})),n.d(t,"b",(function(){return Cn})),n.d(t,"e",(function(){return On})),n.d(t,"d",(function(){return En})),n.d(t,"c",(function(){return Pn}));var r,o=n(8),i=n(0),a=n(1),s=n.n(a),c=n(55),d=n(30),l=n(21),u=n(2),p=n(169),h=n(7),f=n(65),m=n(19),g=n(100),b=n(17),C=n(107),y=n(58),v=n(28),T=n(76),S=n(36),I=n(6);!function(e){e[e.Default=0]="Default",e[e.Disabled=1]="Disabled",e[e.ReadOnly=2]="ReadOnly"}(r||(r={}));var O=r,E=n(413),P=n(425),k=n(414),R=n(427),x=n(431),D=n(11),w=n(32),A=n(79),j=n(9),_=n(70),F=n(207),M=n(130),N=n(176),L=n(40),B=n(90),H=n(42),U=n(66),V=n(12),W=n(38),z=n(20),K=n(4);const G=new K.b([K.b.always({flexDirection:"row",justifyContent:"flex-start",alignItems:"center",paddingTop:2,marginLeft:L.b,paddingLeft:6,paddingRight:3,minHeight:31}),K.b.rule({renderContextType:I.a.DiscreteIsolated},{marginLeft:0})]),q=new K.b([K.b.always(e=>({borderBottomWidth:1,borderColor:e.palette.CardBorder}))]);class $ extends a.PureComponent{constructor(){super(...arguments),this.renderWithContexts=(e,t)=>{const n=t.renderContextType,r=this.props.margin?this.props.margin:1,o=n!==I.a.DiscreteIsolated,i=[this.renderStyle(q,e,n),{marginRight:r,marginLeft:r+(o?L.b:0)}];return a.createElement(B.a,{isTabbable:!1,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior},a.createElement(z.a,{style:this.renderStyle(G,e,n),animationClass:this.props.animationClass},a.createElement(a.Fragment,{key:"left"},this.props.leftElement),a.createElement(a.Fragment,{key:"right"},this.props.rightElement)),a.createElement(z.a,{style:i}))},this.render=()=>Object(H.a)(this.renderWithContexts,W.a,U.a)}renderStyle(e,t,n){return Object(V.g)(e,t,n)}}var Y=n(223),J=n(279),Q=n(54),X=n(74),Z=n(288),ee=n(27),te=n(29),ne=n(160),re=n(429),oe=n(289);const ie=(e,t)=>{const n=Object(X.b)(t),r=Object(oe.a)(re.a.customize({root:{style:{flex:0,borderRadius:4,borderWidth:1,padding:1,justifyContent:"center",alignItems:"center",paddingRight:4,paddingLeft:4,paddingTop:4,paddingBottom:4,borderColor:"transparent"}},checkbox:{style:{flex:0,marginEnd:0,marginTop:0,height:16,width:16,alignItems:"center",alignContent:"center"}},checkmark:{accessible:!1,style:{top:void 0}},content:{style:{display:"none"}},tokens:{borderRadius:8,checkboxBackgroundColor:n.buttonBackground,checkboxBorderColor:n.roundCheckboxBorderColor},_overrides:{pressed:{checkmark:{style:{fontWeight:"bold"}},tokens:{checkboxBackgroundColor:n.expandButtonTextColor,checkboxBorderColor:n.expandButtonTextColor,checkmarkColor:n.completedCheckColor}},hovered:{checkmark:{style:{opacity:1}},tokens:{checkmarkColor:n.checkHoverColor,checkboxBackgroundColor:n.buttonHoveredBackground}},focused:{root:{style:{borderColor:e.palette.FocusBorderColor,borderStyle:"dashed",padding:0}}}}}));return r.displayName="RoundCheckbox",r};var ae=n(105),se=n(34);const ce=Object(V.e)({paddingTop:1,paddingLeft:3,flex:1}),de=Object(V.e)({paddingBottom:2,paddingRight:3,paddingLeft:5,borderRadius:2,flex:0});function le(e){return"string"==typeof e?a.createElement(se.a,{variantFluent:"secondaryStandard",key:"text",accessible:!1,acceptsKeyboardFocus:!1},e):e}const ue=a.memo((function(e){const t=Object(u.h)()&&e.assignees.length>1?le(e.localizationAPI.getString(251)):Object(Z.a)(Object(J.b)(e.text),()=>a.createElement(se.a,{variantFluent:"secondarySemibold",key:"name",accessible:!1,acceptsKeyboardFocus:!1},Object(d.k)(e.assignees[0]))).map(le);return a.createElement(a.Fragment,null,t)})),pe=a.memo((function(e){const t=e.localizationAPI.getString(111),n=Object(u.h)()?Object(d.c)(e.assignees):!!(e.assignees&&e.assignees.length&&e.assignees[0].IsCurrentUser),r=ne.c(e.completion);let o,i;e.assignees.length>0?(o=Object(Q.o)(e.assignees,e.localizationAPI),i=Object(Q.p)(e.assignees,r,e.localizationAPI)):(o=Object(Q.s)(e.localizationAPI),i=Object(Q.r)(r,e.localizationAPI));const{id:s,onResolveTaskCheckboxPressed:c}=e,l=a.useCallback(()=>{c&&c(s)},[c,s]),p=Y.a(Object(E.a)(ie));return Object(H.a)((s,c,d)=>{const u=p(s,c),h=Object(X.b)(c),f=[ce];let m=h.text;return n&&(f.push(de,{backgroundColor:h.assignedToYouBackground}),m=h.assignedToYouText),a.createElement(ae.a,{key:"tasktopper",style:ee.m.render(Object(te.c)(d.renderContextType))},a.createElement(u,{isTabbable:e.isTabbable,disabled:e.displayMode===O.ReadOnly||e.displayMode===O.Disabled,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior,checked:r,onChange:l,ariaLabel:i,nodeId:"card-task-header",tooltip:Object(Q.m)(!1,e.localizationAPI)}),a.createElement(ae.a,{style:f,tooltip:Object(Q.q)(n,e.assignees,e.localizationAPI)},a.createElement(se.a,{numberOfLines:1,variantFluent:"secondarySemibold",colorFluent:m,accessible:!1,acceptsKeyboardFocus:!1},e.assignees.length>0&&!n?a.createElement(ue,{text:t,assignees:e.assignees,localizationAPI:e.localizationAPI}):o)))},W.a,A.a,U.a)}));var he=n(225),fe=n(140),me=n(95);const ge=17+ee.g+ee.a,be=new K.b([K.b.always(e=>({justifyContent:"center",paddingRight:16,paddingLeft:17,paddingBottom:1,marginRight:5,marginLeft:5,minHeight:L.e,borderWidth:1,borderColor:e.palette.ExpandButtonBackground,backgroundColor:e.palette.ExpandButtonBackground})),K.b.rule({renderContextType:I.a.DiscreteIsolated},{paddingLeft:ge})]),Ce=new K.b([K.b.always(e=>({borderColor:e.palette.FocusBorderColor,borderStyle:"dashed"}))]),ye=new K.b([K.b.always(e=>({backgroundColor:e.palette.ExpandButtonHoverBackground,borderColor:e.palette.ExpandButtonHoverBackground}))]);function ve(e,t,n,r){return e&&7!==t?r.text:n?r.expandButtonTextHoverColor:r.expandButtonTextColor}const Te=a.memo(e=>{const[t,n]=a.useState(!1),[r,o]=a.useState(fe.a.Unfocused),s=a.useCallback(()=>function(e){e(!0)}(n),[n]),c=a.useCallback(()=>function(e){e(!1)}(n),[n]);return Object(H.a)((n,d)=>{const l=Object(X.b)(d),u=[Object(V.g)(be,n,e.renderContextType)];return t&&u.push(Object(V.g)(ye,n,e.renderContextType)),r===fe.a.FocusOn&&u.push(Object(V.g)(Ce,n,e.renderContextType)),7===n.themeId&&(e.minimumMarginLeftRight?u.push(function(e,t){const n=5-t;return{marginLeft:t,marginRight:t,paddingLeft:(e===I.a.DiscreteIsolated?ge:17)+n,paddingRight:16+n}}(e.renderContextType,e.minimumMarginLeftRight)):Object(i.i)().assertConditionTag(!1,"minimumMarginLeftRight should be defined.",557949464)),a.createElement(me.a,{animationClass:e.animationClass,onPress:e.onPress,accessibilityLabel:e.innerText,nodeId:e.id,testID:e.id,isTabbable:!!e.isTabbable,accessible:!0,onMouseEnter:s,onMouseLeave:c,onFocusStateChange:o,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior},a.createElement(z.a,{style:u},a.createElement(se.a,{textStylePolyester:"MediumApp",variantFluent:"secondarySemibold",colorFluent:ve(e.isCardResolved,n.themeId,t,l),style:e.isCardResolved?Object(V.g)(ee.k,n,e.renderContextType):void 0,accessible:!1},e.innerText)))},W.a,A.a)});Te.displayName="ExpandCardButton";var Se=n(290),Ie=n(137);const Oe=new K.a([K.a.always({flex:0,borderWidth:0,marginTop:1,height:28,width:28})]),Ee=s.a.memo((function(e){const t=e.actions.map((t,n)=>s.a.createElement(Ie.a,{key:n,icon:t.icon,onClick:t.onClick,accessibilityLabel:t.accessibilityLabel,tooltipText:Object(Se.a)(t),disabled:t.disabled,testID:t.id,nodeId:t.id||"",isTabbable:t.isTabbable,text:"",style:Oe.render(Object(te.c)(e.renderContextType)),preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior}));return s.a.createElement(s.a.Fragment,null,t)}));Ee.displayName="ResolvedCardButtons";var Pe=n(111),ke=n(276);const Re=w.StyleSheet.createViewStyle({marginLeft:10}),xe=Object(V.e)({paddingLeft:9}),De=s.a.memo((function(e){return s.a.createElement(W.a.Consumer,null,t=>{const n=Object(Pe.a)({icon:20,themeId:t.themeId,renderTarget:"Pane"});return s.a.createElement(j.View,{key:"text",style:[ee.m.render(Object(te.c)(e.renderContextType)),xe]},n&&s.a.createElement(j.Image,{source:n.source}),s.a.createElement(se.a,{style:Re,numberOfLines:1,variantFluent:"secondarySemibold",accessible:!1,acceptsKeyboardFocus:!1},e.taskCompleter&&u.b()?e.localizationAPI.getStringOrUndefined(202):e.localizationAPI.getStringOrUndefined(197)),e.taskCompleter&&u.b()&&s.a.createElement(ke.a,{accessible:!1,isTabbable:!1,size:w.PersonaImageSize.extraSmall,author:e.taskCompleter,key:"persona",preventDefaultKeyDownBehavior:void 0}))})}));De.displayName="ResolvedCardLabel";var we=n(15);class Ae extends a.PureComponent{constructor(e,t){super(e,t),this.getNewCandidateTaskAssignees=Object(E.a)((e,t)=>{const n=Object(d.d)(e);return t&&Object(d.m)(n,t),n}),this.onEditorFocus=()=>{!this.isActiveDraft()&&!this.isActiveReply()||this.isSelectionWithinCard()||(Object(i.i)().assertConditionTag(u.Y(),"Should have selection in card with draft if NewSelectionInteractions off",572844239),this.props.onCardSelect(this))},this.notifyRenderedOnce=Object(P.a)(()=>{this.props.onCardRendered&&this.props.onCardRendered(this.props)}),this.toggleExpansion=()=>{this.props.cardCollapsedState===y.a.Collapsed?this.props.onCardSelectExpand(this,!0,!1):this.props.onCardCollapse(this)},this.renderExpandButton=e=>{const t=a.Children.count(this.props.children),n=this.props.displayMode===v.a.Resolved,r=this.props.componentTreeId.renderContextType;if(!(this.props.cardCollapsedState===y.a.Expanded||t<=1||(!n||!u.i())&&t<=2))return a.createElement(Te,Object.assign({id:Object(we.P)({id:this.props.id,renderContextType:r}),innerText:Q.t(this.props.localizationAPI,t,n)||"",isCardResolved:n,isTabbable:this.props.isTabbable,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,renderContextType:r,restrictControl_deprecated:!!this.props.restrictActionControls_deprecated,key:"expandButton"},e))},this.getId=this.getId.bind(this),this.onTaskAssigneeUpdated=this.onTaskAssigneeUpdated.bind(this),this.onCardFocus=this.onCardFocus.bind(this)}componentDidMount(){var e,t;this.props.onCardMounted(this.props),this.isActiveDraft()&&(null===(t=(e=Object(i.i)()).logDiagnosticTrace)||void 0===t||t.call(e,k.a`DraftCardMount`,556827602,i.h.Info,i.c.ProductServiceUsage,Object(i.j)(i.g.ReviewedAsNotNecessary),Object(i.l)("CommentId",this.props.id,i.d.SystemMetadata),Object(i.l)("RenderContextType",this.props.componentTreeId.renderContextType,i.d.SystemMetadata),Object(i.l)("CardDisplayMode",this.props.displayMode,i.d.SystemMetadata)))}componentWillUnmount(){var e,t;this.isActiveDraft()&&(null===(t=(e=Object(i.i)()).logDiagnosticTrace)||void 0===t||t.call(e,k.a`DraftCardUnmount`,556827603,i.h.Info,i.c.ProductServiceUsage,Object(i.j)(i.g.ReviewedAsNotNecessary),Object(i.l)("CommentId",this.props.id,i.d.SystemMetadata),Object(i.l)("RenderContextType",this.props.componentTreeId.renderContextType,i.d.SystemMetadata),Object(i.l)("CardDisplayMode",this.props.displayMode,i.d.SystemMetadata)))}getId(){return this.props.id}isActiveReply(){return this.props.displayMode===v.a.Reply||this.props.displayMode===v.a.ReplyPreCommitPending}isActiveDraft(){return this.props.displayMode===v.a.Draft||this.props.displayMode===v.a.DraftPreCommitPending}onTaskAssigneeUpdated(e){this.props.onSelectedTaskAssigneeUpdated(e)}getTaskAssignerProps(){var e;if(!u.b()||!this.props.supportsTasks)return;const t=this.isActiveReply()&&!this.props.taskTopperProps;if((!t||u.c())&&this.props.currentMentionees){const n=t||this.isActiveDraft(),r=Q.n(this.props.localizationAPI,n),o=this.getNewCandidateTaskAssignees(this.props.currentMentionees,null===(e=this.props.taskTopperProps)||void 0===e?void 0:e.assignees),i=this.props.localizationAPI.getString(128);if(o&&0!==Object.keys(o).length)return{renderContextType:this.props.componentTreeId.renderContextType,id:this.props.id,label:r,candidateAssignees:o,isNewThread:this.isActiveDraft(),selectedAssignee:this.props.selectedTaskAssignee,onSelectedTaskAssigneeUpdated:this.onTaskAssigneeUpdated,pickerAriaLabel:i,assignerTooltip:this.props.localizationAPI.getString(182),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,isTabbable:this.props.isTabbable,localizationAPI:this.props.localizationAPI,displayMode:this.props.displayMode,isTaskThread:!!this.props.taskTopperProps}}}isSelectionWithinCard(){return this.props.selected||this.props.hasSelectedChild}renderDraftBoxMessage(e){if(!u.y())return null;const{draftWarningState:t}=this.props;return t||e?a.createElement(he.a,{key:"draftBoxMessage",draftWarningState:t,localizationAPI:this.props.localizationAPI,target:N.a.Card,id:t?Object(we.r)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}):Object(we.H)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),defaultToPostingTip:e}):null}onCardSaveDraft(e){const t=this.isActiveDraft()||this.isActiveReply();e&&t&&this.props.onSaveDraft(this.getId(),e)}renderResolvedOrTaskTopperHelper(e){const{taskTopperProps:t}=this.props,{resolvedButtonsProps:n,preventDefaultKeyDownBehavior:r}=e,o=u.b();if(!(n||o&&t))return;const i=this.props.componentTreeId.renderContextType,s=n&&n.length>0?a.createElement(Ee,{actions:n,renderContextType:i,preventDefaultKeyDownBehavior:r}):void 0,c=t&&!s?a.createElement(pe,Object.assign({},t,{taskTopperCheckboxRef:e.taskTopperCheckboxRef})):a.createElement(De,{localizationAPI:this.props.localizationAPI,renderContextType:i,taskCompleter:(null==t?void 0:t.assignees)&&t.assignees.length>0?t.assignees[0]:void 0});return a.createElement($,Object.assign({leftElement:c,rightElement:s,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior},e.cardTopperContainerProps))}onCardFocus(e){this.props.onCardFocus(this)}}Ae.DisplayName="CommentCard";var je=n(53);const _e=new K.b([K.b.rule({isFluentEnabled:!0},{paddingTop:7,flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-start",paddingRight:ee.g}),K.b.rule({platform:"win32",renderContextType:I.a.DiscreteIsolated},{marginLeft:ee.a}),K.b.rule(te.d,{top:-16,zIndex:99}),K.b.rule({displayClass:je.a.LargeDisplay,renderContextType:I.a.HalfPane},{paddingTop:ee.h,paddingBottom:ee.h,paddingLeft:ee.f,paddingRight:ee.f}),K.b.rule({isFluentEnabled:!1},{padding:ee.g,position:"absolute",right:0,flexDirection:"row",justifyContent:"flex-end",alignItems:"flex-start"})]),Fe=new K.b([K.b.rule(te.d,{marginTop:16,marginLeft:4}),K.b.rule({platform:"win32"},{alignSelf:"flex-start",marginTop:6,marginRight:4})]),Me=new K.b([K.b.rule(te.d,{marginTop:16,marginLeft:8})]),Ne=new K.a([K.a.always({marginLeft:2})]),Le=new K.a([K.a.rule({isFluentEnabled:!0},{marginTop:4,marginLeft:ee.g-4})]),Be=Object(V.e)({paddingTop:4}),He=new K.b([K.b.always(e=>({borderBottomWidth:1,borderColor:e.palette.CardBorder}))]),Ue=new K.b([K.b.rule({isFluentEnabled:!0},{flexDirection:"row",flex:1,justifyContent:"flex-start",alignItems:"flex-start"})]);var Ve=n(57),We=n(214);function ze(e,t){var n;if(void 0===t)return 0;switch(e){case _.h.Like:return(null===(n=t.Like)||void 0===n?void 0:n.currentUserReacted)?23:22}}function Ke(e){switch(e){case _.h.Like:return 207}}function Ge(e){switch(e){case _.h.Like:return 207}}var qe=n(205);const $e={selected:!0},Ye=a.memo(e=>{var t;const{commentId:n,isTabbable:r,localizationAPI:o,onReactionPressed:i,preventDefaultKeyDownBehavior:s,reactionType:c,renderContextType:d,renderHidden:l,style:u,userReactionSummary:p}=e,h=a.useRef(null),f=Object(W.b)(),m=a.useRef(Object(we.l)({id:n,renderContextType:d})),g=a.useCallback(()=>{var t;i(n,!(null===(t=e.userReactionSummary.Like)||void 0===t?void 0:t.currentUserReacted),c)},[i,n,null===(t=e.userReactionSummary.Like)||void 0===t?void 0:t.currentUserReacted,c]),b=Object(Pe.b)({icon:ze(c,p),disabled:!1,renderTarget:"Pane",themeId:f.themeId});return a.createElement(me.a,{ref:h,accessibilityLabel:o.getString(Ge(c)),accessibilityRole:"button",accessibilityState:$e,isTabbable:r&&!l,onPress:g,style:[qe.a,u,l?qe.d:void 0],tooltip:o.getString(Ke(c)),accessible:!l,testID:m.current,nodeId:m.current,preventDefaultKeyDownBehavior:s},a.createElement(j.Image,{source:b.source}))});function Je(e,t,n){let r=void 0,o=void 0;return{items:t.map((t,a)=>{t.isDestructive&&(Object(i.i)().assertConditionTag(void 0===r,'There should only ever be a single "destructive" action at once',595137034),r=a),t.isCancelItem&&(Object(i.i)().assertConditionTag(void 0===o,'There should only ever be a single "cancel" action at once',595137035),o=a);const s=Object(Pe.a)({icon:t.icon,themeId:e,disabled:t.disabled,renderTarget:"ContextualMenu"});return{name:t.text,key:"ContextMenuItem-"+a,onClick:()=>t.onClick(n),icon:s?s.source:void 0}}),destructiveButtonIndex:r,cancelButtonIndex:o}}var Qe=n(179);n(72);class Xe extends a.PureComponent{constructor(){super(...arguments),this.getContextMenuItems=Object(E.a)(Je),this.onEdit=()=>{this.props.onEditRootPost(this.props.id)},this.renderWithContexts=(e,t)=>{var n;const r=t.renderContextType,o=[],i=[this.renderStyle(_e,e,r)];u.i()&&this.props.isResolvedCard&&i.push(Be);const s=V.b(i,0,this.props.extraPaddingRight,0,this.props.extraPaddingLeft);if(u.i()){const t=[this.renderStyle(Ue,e,r),{opacity:this.props.rootAuthorOpacity}];o.push(a.createElement(z.a,{animationClass:"CommentCard_CommentCardHeader",style:t,key:"rootAuthor"},a.createElement(Qe.a,{accessible:!0,isTabbable:this.props.isTabbable&&this.props.rootAuthorOpacity>0,size:w.PersonaImageSize.extraSmall,author:this.props.author,style:this.renderStyle(Ne,e,r),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,nodeId:Object(we.B)({id:this.props.id,renderContextType:r})}),this.renderRootLabel(e,r)))}if(this.props.anchorText&&o.push(a.createElement(z.a,{key:"hint",style:this.renderStyle(Fe,e,r),accessible:!1},a.createElement(se.a,{textStylePolyester:"SmallStandard",variantFluent:"captionStandard"},this.props.anchorText))),o.push(this.renderButtons(e,r)),!u.i())return o.length?a.createElement(B.a,{key:"header",style:s},o):void 0;const c=null!==(n=this.props.cardBorderWeight)&&void 0!==n?n:1,d=r!==I.a.DiscreteIsolated||!1,l=[this.renderStyle(He,e,r),{marginRight:c,marginLeft:c+(d?L.b:0),opacity:1-this.props.rootAuthorOpacity}];return o.length?a.createElement(z.a,null,a.createElement(B.a,{isTabbable:!1,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,style:s},o),a.createElement(z.a,{animationClass:"CommentCard_CommentCardHeader",style:l})):void 0},this.render=()=>Object(H.a)(this.renderWithContexts,W.a,U.a)}renderStyle(e,t,n){return V.g(e,t,n)}isExpanded(e){return e===I.a.HalfPane||this.props.cardCollapsedState===y.a.Expanded}renderRootLabel(e,t){const n=Object(d.k)(this.props.author),r=[this.renderStyle(Ve.e,e,t),this.renderStyle(Le,e,t)];return u.i()&&this.props.isResolvedCard&&!this.isExpanded(t)&&r.push(this.renderStyle(ee.k,e,t)),a.createElement(se.a,{textStylePolyester:"MediumBold",variantFluent:"bodySemibold",style:r,disabled:!1,numberOfLines:u.i()?void 0:1,key:"name",accessible:!1},n)}renderButtons(e,t){if((this.props.displayMode===v.a.Draft||this.props.displayMode===v.a.DraftPreCommitPending)&&t!==I.a.HalfPane){if(u.i())return;const n=Object(we.q)({id:this.props.id,renderContextType:t});return a.createElement(We.a,{onClick:this.props.onCancelDraft,accessibilityLabel:this.props.localizationAPI.getStringOrUndefined(46),isTabbable:this.props.isTabbable,key:"cancel",tooltipText:this.props.localizationAPI.getStringOrUndefined(175),style:[this.renderStyle(Me,e,t)],icon:1,testID:n,nodeId:n,disabled:this.props.displayMode===v.a.DraftPreCommitPending,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,text:""})}if(!this.props.hideActions&&this.props.menuItems.length>0){const n=Object(we.d)({id:this.props.id,renderContextType:t});return a.createElement(a.Fragment,{key:"buttons"},this.renderEditButton(e,t),a.createElement(We.a,{onClick:this.getContextMenuItems(e.themeId,this.props.menuItems,this.props.id),accessibilityLabel:this.props.localizationAPI.getStringOrUndefined(45),isTabbable:this.props.isTabbable,key:"threadAnchorMenu",icon:7,style:this.renderStyle(ee.o,e,t),tooltipText:this.props.localizationAPI.getStringOrUndefined(45),testID:n,nodeId:n,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,text:""}),this.renderReactionButton(e,t))}}renderEditButton(e,t){if(!u.B()||!this.props.allowRootEditButton)return null;const n=Object(we.i)({id:this.props.id,renderContextType:t});return a.createElement(We.a,{onClick:this.onEdit,accessibilityLabel:this.props.localizationAPI.getString(120),isTabbable:this.props.isTabbable,key:"cardEditButton",icon:6,style:this.renderStyle(ee.j,e,t),tooltipText:this.props.localizationAPI.getString(120),nodeId:n,testID:n,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,text:""})}renderReactionButton(e,t){return u.a()&&void 0!==this.props.reactionButtonProps&&void 0!==this.props.reactionButtonProps.reactionType&&void 0!==this.props.reactionButtonProps.userReactionSummary&&void 0!==this.props.reactionButtonProps.onReactionPressed&&void 0!==this.props.isTabbable?a.createElement(Ye,{commentId:this.props.id,isTabbable:this.props.isTabbable,onReactionPressed:this.props.reactionButtonProps.onReactionPressed,reactionType:this.props.reactionButtonProps.reactionType,localizationAPI:this.props.localizationAPI,userReactionSummary:this.props.reactionButtonProps.userReactionSummary,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,style:this.renderStyle(ee.j,e,t),renderHidden:!1,renderContextType:t,key:"cardReactionButton"}):null}}var Ze=Xe,et=n(278),tt=n(150),nt=n(152);const rt=new K.b([K.b.rule({isFluentEnabled:!1},e=>({flex:1,borderColor:e.palette.ButtonBorder,borderLeftWidth:1,alignItems:"stretch"})),K.b.rule({platform:"ios"},{borderLeftWidth:0})]),ot=Object(V.e)({borderLeftWidth:0}),it=new K.b([K.b.rule({isFluentEnabled:!1},{justifyContent:"center",height:48}),K.b.rule({platform:"ios"},{minHeight:45})]),at=w.StyleSheet.createViewStyle({textAlign:"center"}),st=new K.b([K.b.always({flex:0,flexDirection:"row"}),K.b.rule({isFluentEnabled:!1},e=>({borderColor:e.palette.CommandBarBorder,borderTopWidth:nt.a})),K.b.rule({isFluentEnabled:!0},{justifyContent:"flex-end",paddingBottom:10,paddingRight:10}),K.b.rule({platform:"ios"},e=>({borderTopColor:e.palette.CommandBarTopBorder})),...L.z]);class ct extends a.PureComponent{constructor(e,t){super(e,t),this.renderWithTheme=e=>{const t=this.props.actions.map((t,n)=>a.createElement(z.a,{style:[this.renderStyle(rt,e),n?void 0:ot],key:n},a.createElement(me.a,{style:this.renderStyle(it,e),accessibilityLabel:t.accessibilityLabel,onPress:t.onClick,disabled:t.disabled,accessibilityRole:"button",isTabbable:!0,testID:t.id,nodeId:t.id||"",preventDefaultKeyDownBehavior:void 0},a.createElement(se.a,{style:at,textStylePolyester:"MediumSecondary"},t.text))));return a.createElement(j.SafeAreaView,{style:this.renderStyle(st,e)},t)},this.render=()=>Object(H.a)(this.renderWithTheme,W.a),Object(i.i)().assertConditionTag(!u.i(),"CommandBar is not supported in the Fluent UI",544875781)}renderStyle(e,t){return Object(V.g)(e,t,this.props.componentTreeId.renderContextType)}}const dt=Object(tt.a)(ct,{componentTreeId:U.a},"CommandBar");var lt=n(224),ut=n(246),pt=n(238);class ht extends a.PureComponent{render(){const e=Object(te.a)()===je.a.LargeDisplay?ee.f:ee.g;return a.createElement(z.a,{style:V.d},a.createElement(ut.a,{leftChild:this.props.leftButton?a.createElement(pt.a,{text:this.props.leftButton.buttonTitle,onClick:this.props.leftButton.buttonPress,icon:0,nextFocusLeft:this.props.leftButton.nextFocusLeft,nextFocusRight:this.props.leftButton.nextFocusRight}):void 0,rightChild:this.props.rightButton?a.createElement(pt.a,{text:this.props.rightButton.buttonTitle,onClick:this.props.rightButton.buttonPress,icon:0,nextFocusLeft:this.props.rightButton.nextFocusLeft,nextFocusRight:this.props.rightButton.nextFocusRight}):void 0,showShadow:!!this.props.showShadow,outerSpacing:e}),this.props.children)}}var ft=n(213),mt=n(215);function gt(e,t,n,r){return e?{typeID:"Comment",author:Object(d.k)(t),dateTime:n,target:Object(we.b)(r)}:void 0}var bt=n(134),Ct=n(188),yt=n(112);function vt(e){if(e!==bt.d.None)return"CommentCard"}function Tt(e){if(e!==bt.d.None)return"CommentCard_OverflowRepliesContainer"}function St(e){if(e!==bt.d.None)return"CommentCard_Reply"}function It(e){if(e!==bt.d.None)return"CommentCard_ExpandButton"}function Ot(e){if(e!==bt.d.None)return"CommentCard_AllRepliesContainer"}var Et,Pt=Object(tt.a)(class extends Ae{constructor(e,t){super(e,t),this._postScrollView=null,this._draftInputRef=null,this.cardDraftBoxRef=a.createRef(),this.cardRootRef=a.createRef(),this.hoverManager=new mt.a,this.cardHeight=0,this.cardLayoutInProgress=!1,this.scrollableContentLayoutInProgress=!1,this.getCardBoxRef=()=>u.d()?this.cardDraftBoxRef.current:this._draftInputRef,this.onHoverChange=e=>{this.props.onCardHighlightChange(this,e)},this.onFocusStateChange=e=>{this.setState({focusState:e})},this.onExpandButtonPress=()=>{this.onExpand(!0)},this.resizeAfterCardSizeChanges=e=>{if(this.scrollableContentLayoutInProgress||this.props.displayMode===v.a.ReplyPreCommitPending||this.props.displayMode===v.a.ReplyPostCommitPending||e!==this.cardHeight)return this.cardHeight;this.cardLayoutInProgress=!1,this.updateScrollViewBoundHeight()},this.resizeAfterPostDataChanges=e=>{if(this._postScrollView){if(e.postContentHeight!==this._postListSizes.postContentHeight)return this._postListSizes;this.scrollableContentLayoutInProgress=!1,this.updateScrollViewBoundHeight()}else this.scrollableContentLayoutInProgress=!1},this.onEditorMount=()=>{this.props.onCardEditorMounted(this.props.id)},this.onDraftEmptinessChanged=e=>{this.props.onDraftEmptinessChanged(this,e)},this.createMemoizedReactionButtonProps=Object(E.a)((e,t,n,r,o,a,s,c)=>{if(u.a())return Object(i.i)().assertConditionTag(void 0!==c,"userReactionSummary should not be undefined when gate is enabled",527771653),{commentId:e,renderContextType:t,isTabbable:n,onReactionPressed:r,reactionType:o,localizationAPI:a,userReactionSummary:null!=c?c:{Like:{count:0,currentUserReacted:!1}},preventDefaultKeyDownBehavior:s}}),this.onLayout=e=>{this.setState({cardWidth:e.nativeEvent.layout.width})},this.onScroll=e=>{const t=e.nativeEvent.contentOffset.y>L.f;this.setState({isInnerContentSufficientlyScrolled:t})},this.renderCardBackground=(e,t)=>{if(!u.i())return;const n=[this.renderStyle(L.n,e),this.isSelectionWithinCard()&&this.renderStyle(L.m,e),this.state.focusState===D.b.FocusOn&&this.renderStyle(L.j,e),this.props.highlightCard&&this.renderStyle(L.k,e),this.props.displayMode===v.a.Resolved&&this.props.cardCollapsedState===y.a.Collapsed&&this.renderStyle(L.l,e)];return a.createElement(z.a,{style:n,animationClass:vt(t)})},this.logCardRendered=Object(P.a)(()=>{var e,t;this.isActiveDraft()&&(null===(t=(e=Object(i.i)()).logDiagnosticTrace)||void 0===t||t.call(e,k.a`DraftCardRendered`,556827599,i.h.Info,i.c.ProductServiceUsage,Object(i.j)(i.g.ReviewedAsNotNecessary),Object(i.l)("CommentId",this.props.id,i.d.SystemMetadata),Object(i.l)("RenderContextType",this.props.componentTreeId.renderContextType,i.d.SystemMetadata),Object(i.l)("CardDisplayMode",this.props.displayMode,i.d.SystemMetadata)))}),this.onCardLayout=e=>{var t,n;this.logCardRendered(),this.cardHeight=e.nativeEvent.layout.height,!this.cardLayoutInProgress&&this.isMaxHeightDefined()&&(this.cardLayoutInProgress=!0,this._resizeAfterCardSizeChangesDebouncer(this.cardHeight)),null===(n=(t=this.props).onCardLayout)||void 0===n||n.call(t,this.props.id,e)},this.getCardAnnotationId=Object(E.a)((e,t,n,r)=>Object(we.O)(e,t,n,r)),this.onPress=()=>{this.onExpand(!1)},this.renderWithContexts=(e,t,n)=>{var r,o,i;let s;const c=this.renderStyle(L.s,t);this.props.displayMode===v.a.Loading?(s=[L.t],s.push({height:Object(nt.c)({itemCount:null!==(r=this.props.itemCount)&&void 0!==r?r:1,readOnly:!1,isTask:!!this.props.taskTopperProps})})):s=[this.renderStyle(L.i,t)],!u.i()&&this.props.contentBackgroundColor&&s.push({backgroundColor:t.palette[this.props.contentBackgroundColor]}),this.props.displayMode===v.a.Resolved&&s.push(this.renderStyle(L.r,t)),this.props.isNewThread&&this.props.foldableLayoutState===_.e.DoublePortrait&&s.push(L.o);const d=this.props.componentTreeId.renderContextType,l=this.props.componentTreeId.contextIdentifier,p=d===I.a.HalfPane&&this.isActiveReply(),h=this.props.displayMode===v.a.CardPostCommitPending||this.props.displayMode===v.a.ReplyPostCommitPending,f=Object(we.j)({id:this.props.id,renderContextType:d},this.props.isNewThread);return a.createElement(me.a,Object.assign({onFocus:this.onCardFocus,style:[c,this.props.style],accessibilityElementsHidden:!this.isSelectionWithinCard()&&d===I.a.HalfPane,nodeId:f,nodeData:this.getComponentDelegate,ref:this.cardRootRef,accessible:!0,accessibilityLabel:this.props.accessibilityLabel,accessibilityDescription:this.props.accessibilityDescription,accessibilityRole:"treeitem",accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize,accessibilityLevel:null!==(o=this.props.accessibilitySetLevel)&&void 0!==o?o:1,accessibilityState:{expanded:this.props.cardCollapsedState===y.a.Expanded,selected:this.props.selected},accessibilityActions:Object(ft.a)(["Expand","Collapse"]),onAccessibilityAction:this.onAccessibilityAction,testID:f,onFocusStateChange:this.onFocusStateChange,onPress:this.onPress,isTabbable:this.props.isTabbable,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,animationClass:vt(e),onLayout:this.onCardLayout,accessibilityAnnotation:gt(!!this.props.isUIAAnnotationPatternEnabled,this.props.author,this.props.timestamp,l),nativeID:this.getCardAnnotationId(d,l,this.props.id,this.props.isNewThread),onAccessibilityOrKeyPress:this.toggleExpansion},this.hoverManager.viewProps),this.renderCardBackground(t,e),this.renderResolvedOrTaskTopper(e),u.i()&&this.renderCardHeader(),a.createElement(B.a,{style:s,onLayout:this.onLayout,animationClass:vt(e)},p?a.createElement(ht,{leftButton:{buttonTitle:this.props.localizationAPI.getString(15),buttonPress:this.onAttemptDiscardDraft,nextFocusRight:null===(i=this.getCardBoxRef())||void 0===i?void 0:i.getEditorWrapperRefHandle()}},a.createElement(z.a,{style:V.d},this.getCommentCardInnerContent(e,t,n))):this.props.displayMode===v.a.Loading?this.renderLoadingUI(V.a):[this.getCommentCardInnerContent(e,t,n),!1,h&&this.renderPendingUI(t)]),this.renderFocusBar(t,e))},this.render=()=>Object(H.a)(this.renderWithContexts,bt.c,W.a,A.a),this.state={cardWidth:0,focusState:D.b.Unfocused,innerContentBoundHeight:this.isMaxHeightDefined()?2:void 0,isInnerContentSufficientlyScrolled:!1},this._postListSizes={postListHeight:0,postContentHeight:0},this.onAttemptDiscardDraft=this.onAttemptDiscardDraft.bind(this),this.onExpand=this.onExpand.bind(this),this.onPost=this.onPost.bind(this),this.onEditorPress=this.onEditorPress.bind(this),this.onDraftingInputSizeChange=this.onDraftingInputSizeChange.bind(this),this.setPostScrollView=this.setPostScrollView.bind(this),this.onLayout=this.onLayout.bind(this),this.setCardDraftBoxRef_deprecated=this.setCardDraftBoxRef_deprecated.bind(this),this.onPostScrollViewLayout=this.onPostScrollViewLayout.bind(this),this.onPostScrollViewContentSizeChange=this.onPostScrollViewContentSizeChange.bind(this),this.getContentsAsync=this.getContentsAsync.bind(this),this.getCursorPositionAsync=this.getCursorPositionAsync.bind(this),this.getComponentDelegate=this.getComponentDelegate.bind(this),this.onEditorBlur=this.onEditorBlur.bind(this),this.onEditorEscapeRequested=this.onEditorEscapeRequested.bind(this),this.onAccessibilityAction=this.onAccessibilityAction.bind(this),this.onCardSaveDraft=this.onCardSaveDraft.bind(this),this.focus=this.focus.bind(this),this.blur=this.blur.bind(this),this._scrollAfterNewPostDebouncer=Object(R.a)((e,t)=>t,this.scrollToEndAfterNewPost.bind(this),()=>this._postListSizes,250,1e3),this._resizeAfterPostDataChangesDebouncer=Object(R.a)((e,t)=>t,this.resizeAfterPostDataChanges,()=>this._postListSizes,o.b?75:10),this._resizeAfterCardSizeChangesDebouncer=Object(R.a)((e,t)=>t,this.resizeAfterCardSizeChanges,()=>this.cardHeight,o.b?75:10,o.b?250:50),this.hoverChangeEventSubscription=this.hoverManager.hoverChangeEvent.subscribe(this.onHoverChange)}isSessionActiveOrPending(e){return e===v.a.Draft||e===v.a.Reply||e===v.a.DraftPreCommitPending||e===v.a.ReplyPreCommitPending}componentDidUpdate(e){var t;this.isSessionActiveOrPending(e.displayMode)&&!this.isSessionActiveOrPending(this.props.displayMode)&&(null===(t=this.getCardBoxRef())||void 0===t||t.clear());const n=this.props.componentTreeId.renderContextType;n!==I.a.HalfPane||this.props.displayMode!==v.a.Reply&&this.props.displayMode!==v.a.ReplyPreCommitPending||e.displayMode===v.a.Reply||e.displayMode===v.a.ReplyPreCommitPending||this._postScrollView&&this._postScrollView.scrollTo({x:0,y:0,animated:!1}),n===I.a.HalfPane&&this.props.displayMode===v.a.Normal&&e.displayMode===v.a.ReplyPostCommitPending&&this._scrollAfterNewPostDebouncer(this._postListSizes)}componentWillUnmount(){super.componentWillUnmount(),this.hoverChangeEventSubscription&&this.hoverChangeEventSubscription.unsubscribe()}focus(){this.cardRootRef&&this.cardRootRef.current&&this.cardRootRef.current.focus()}blur(){this.cardRootRef&&this.cardRootRef.current&&this.cardRootRef.current.blur()}onEditorBlur(){this.props.onEditorBlur&&this.props.onEditorBlur(this)}onEditorEscapeRequested(){u.Y(),this.focus()}getContentsAsync(){const e=this.getCardBoxRef();return e?e.getContentsAsync():(Object(i.i)().assertConditionTag(!1,"Draft input box not set",593799008),Promise.resolve(Object(yt.b)()))}getCursorPositionAsync(){return Promise.resolve(void 0)}setPostScrollView(e){this._postScrollView=e}onPostScrollViewLayout(e){this._postListSizes.postListHeight=e.nativeEvent.layout.height}onPostScrollViewContentSizeChange(e,t){this._postListSizes.postContentHeight=t,this.isMaxHeightDefined()&&(this.scrollableContentLayoutInProgress||(this.scrollableContentLayoutInProgress=!0,this._resizeAfterPostDataChangesDebouncer(this._postListSizes)))}getCardHeightExcludingInnerContent(){if(this.isMaxHeightDefined()&&void 0!==this.state.innerContentBoundHeight)return this.cardHeight-this.state.innerContentBoundHeight}getCardMaxHeight(){var e;return void 0!==(null===(e=this.props.maximumDimensions)||void 0===e?void 0:e.height)?Math.max(this.props.maximumDimensions.height,L.c):void 0}isMaxHeightDefined(){var e;return void 0!==(null===(e=this.props.maximumDimensions)||void 0===e?void 0:e.height)}calculateInnerContentBoundHeight(){const e=this.getCardMaxHeight(),t=this.getCardHeightExcludingInnerContent();if(void 0===e||void 0===t)return;let n;n=Math.max(Math.min(e-t,this._postListSizes.postContentHeight+2),L.d);const r=4-n%4;return r<4&&(n+=r),n}updateScrollViewBoundHeight(){this.scrollableContentLayoutInProgress||this.cardLayoutInProgress||this.setState({innerContentBoundHeight:this.calculateInnerContentBoundHeight()})}onPost(e){this.props.onPost(this,e)}onExpand(e){this.props.onCardSelectExpand(this,e,this.state.focusState===D.b.Unfocused||!e&&this.props.selected&&this.state.focusState===D.b.FocusWithin)}scrollToEndAfterNewPost(e){if(this.props.displayMode===v.a.Normal&&this.props.componentTreeId.renderContextType===I.a.HalfPane&&this.isSelectionWithinCard())return e.postContentHeight!==this._postListSizes.postContentHeight||e.postListHeight!==this._postListSizes.postListHeight?this._postListSizes:void(this._postScrollView&&this._postScrollView.scrollTo({x:0,y:Object(Ct.c)(!0,e.postListHeight,e.postContentHeight,0,e.postContentHeight),animated:!1}))}renderRootPost(e){if(0!==e.length)return e[0]}renderFooterReply(e){const t=e.length-1;if(!(t<=1))return e[t]}renderOverflowReplies(e,t){if(t.length<=1)return;if(t.length>2&&this.props.cardCollapsedState===y.a.Collapsed)return;let n;return n=2===t.length?t.length:t.length-1,a.createElement(lt.b,{style:[V.d,V.c],key:"overflow-posts",animationClass:Tt(e),shouldRenderView:t.length>2},a.createElement(a.Fragment,null,t.slice(1,n)))}getWrappedContent(e,t){const n=a.Children.toArray(this.props.children),r=this.renderRootPost(n);if(!r)return null;const o=[r];if(this.props.cardCollapsedState===y.a.Collapsed){const e=this.renderExpandButton({animationClass:It(t),minimumMarginLeftRight:L.w(this.state.focusState,this.isSelectionWithinCard()),onPress:this.onExpandButtonPress});o.push(e)}if(!u.i()||this.props.displayMode!==v.a.Resolved||this.props.cardCollapsedState===y.a.Expanded){const e=this.renderOverflowReplies(t,n),r=this.renderFooterReply(n),i=e||r?a.createElement(z.a,{style:[V.d,V.c],key:"all-replies",animationClass:Ot(t)},e,r):void 0;o.push(i)}if(u.i()||o.push(this.renderCardHeader()),this.props.componentTreeId.renderContextType===I.a.HalfPane&&!this.props.disableScroll)return a.createElement(z.a,{style:V.d,key:"content",testID:Object(we.g)()},a.createElement(j.ScrollView,{keyboardShouldPersistTaps:"always",ref:this.setPostScrollView,scrollEnabled:this.props.isTabbable,onLayout:this.onPostScrollViewLayout,onContentSizeChange:this.onPostScrollViewContentSizeChange,testID:Object(we.f)()},o));const i=[V.d,V.c];u.i()&&e&&i.push(L.A);let s=o;return this.isMaxHeightDefined()&&(s=a.createElement(j.ScrollView,{ref:this.setPostScrollView,onContentSizeChange:this.onPostScrollViewContentSizeChange,onScroll:this.onScroll,style:{height:this.state.innerContentBoundHeight}},o)),a.createElement(B.a,{style:i,key:"content",animationClass:vt(t)},s)}getCommentCardInnerContent(e,t,n){this.notifyRenderedOnce();const r=this.props.hideDraftBox||this.props.isReadOnly||this.props.displayMode===v.a.Resolved,o=this.getWrappedContent(r,e);let i;u.i()||this.props.displayMode!==v.a.Resolved?r||(i=this.renderCardDraftBox(e)):i=this.renderCommandBar(e);return[o,i,!u.i()&&this.renderDraftBoxMessage(!1),this.props.hasLowFidelityChild&&this.renderLowFidelityFooter(e,t,n)]}onEditorPress(){this.isActiveReply()||this.isActiveDraft()||this.props.onEditorPress(this)}onAttemptDiscardDraft(){this.props.onCancel(this)}renderStyle(e,t){return V.g(e,t,this.props.componentTreeId.renderContextType)}getCommandBarItems(){return this.props.menuItems.map(e=>{var t;return{id:Object(we.c)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType},null!==(t=e.id)&&void 0!==t?t:e.text),text:e.text,onClick:()=>{e.onClick(this.props.id)},accessibilityLabel:e.text,icon:e.icon,isTabbable:this.props.isTabbable}})}renderCommandBar(e){const t=this.getCommandBarItems();if(0!==t.length)return a.createElement(dt,{actions:t,key:"heroBar",preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,animationClass:St(e)})}setCardDraftBoxRef_deprecated(e){this._draftInputRef=e}getDraftBoxMaxHeight(){const e=this.getCardMaxHeight();if(e){const t=Math.round(e/4);return void 0===this.props.maxDraftHeight?t:Math.min(t,this.props.maxDraftHeight)}return this.props.maxDraftHeight}renderCardDraftBox(e){const t=this.isActiveDraft(),n=this.isActiveReply(),r=this.props.componentTreeId.renderContextType;let o,i;o=u.i()?n||t:Object(te.h)(r)&&n||r===I.a.HalfPane&&t,t?i=this.props.localizationAPI.getStringOrUndefined(46):n&&(i=this.props.localizationAPI.getStringOrUndefined(175));const s=this.props.displayMode===v.a.Reply||this.props.displayMode===v.a.Draft,c=this.props.displayMode===v.a.ReplyPreCommitPending||this.props.displayMode===v.a.DraftPreCommitPending,d=Q.f(this.props.localizationAPI,this.props.supportsAtMentions,t,this.props.cardRelativeDraftingState);let l=M.a.None;s?l=M.a.Editing:c&&(l=M.a.Pending);const p=Q.c(this.props.localizationAPI,this.props.displayMode,!!this.props.taskTopperProps,this.props.selectedTaskAssignee);return a.createElement(et.b,{draftWarningState:this.props.draftWarningState,availableScreenHeight:this.props.availableScreenHeight,cancelLabel:i,sendLabel:p,editorAllyLabel:d,id:Object(we.e)({id:this.props.id,renderContextType:r}),parentId:this.props.id,editMode:l,isNewComment:t,isTabbable:this.props.isTabbable,maxDraftHeight:this.getDraftBoxMaxHeight(),richTextCapabilities:this.props.richTextCapabilities,sizingMode:t&&r===I.a.HalfPane?"flex":"content-size",mentionEditorProps:this.props.mentionEditorProps,onCancel:this.onAttemptDiscardDraft,onInputSizeChange:this.onDraftingInputSizeChange,onDraftEmptinessChanged:this.onDraftEmptinessChanged,onEditorMount:this.onEditorMount,onUnmount:this.onCardSaveDraft,onPost:this.onPost,onPress:this.onEditorPress,onFocus:this.onEditorFocus,onBlur:this.onEditorBlur,onEscapePressed:this.onEditorEscapeRequested,placeholder:d,shouldRestoreDraftOnMount:this.isSessionActiveOrPending(this.props.displayMode),showCancel:o,peoplePickerWidth:this.state.cardWidth,extraPaddingLeft:this.props.extraPaddingLeft,extraPaddingRight:this.props.extraPaddingRight,sendTestID:Object(we.M)({id:this.props.id,renderContextType:r}),cancelTestID:t&&u.i()?Object(we.q)({id:this.props.id,renderContextType:r}):Object(we.L)({id:this.props.id,renderContextType:r}),savedDraftContent:this.props.savedDraftContent,isDraftEmpty:this.props.isDraftEmpty,ref:u.d()?this.cardDraftBoxRef:this.setCardDraftBoxRef_deprecated,key:"draftBox",isEditorFocusable:!this.props.cardRelativeDraftingState||this.props.cardRelativeDraftingState===T.a.InCard,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,animationClass:St(e),taskAssigner:this.getTaskAssignerProps(),isCardHovered:this.props.highlightCard,focusManagerKeyDownHandler:this.props.commentEditorAdditionalKeyDownHandler,telemetryId:this.props.draftId,localizationAPI:this.props.localizationAPI})}shouldShowContextMenu(){return this.props.menuItems.length>0&&this.props.displayMode!==v.a.Resolved&&this.props.displayMode!==v.a.CardPostCommitPending}renderResolvedOrTaskTopper(e){if(!u.i())return;const t={cardTopperContainerProps:{animationClass:St(e),margin:L.w(this.state.focusState,this.isSelectionWithinCard())},preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,resolvedButtonsProps:this.props.displayMode===v.a.Resolved?this.getCommandBarItems():void 0};return this.renderResolvedOrTaskTopperHelper(t)}renderCardHeader(){if(!(this.props.hideHeader||u.i()&&this.props.displayMode===v.a.Loading))return a.createElement(Ze,{key:"header",id:this.props.id,author:this.props.author,isResolvedCard:this.props.displayMode===v.a.Resolved,localizationAPI:this.props.localizationAPI,displayMode:this.props.displayMode,cardCollapsedState:this.props.cardCollapsedState,onCancelDraft:this.onAttemptDiscardDraft,menuItems:this.props.menuItems,extraPaddingLeft:this.props.extraPaddingLeft,extraPaddingRight:this.props.extraPaddingRight,rootAuthorOpacity:this.state.isInnerContentSufficientlyScrolled?0:1,hideActions:!this.shouldShowContextMenu(),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,anchorText:this.props.anchorText,isTabbable:this.props.isTabbable,cardBorderWeight:L.w(this.state.focusState,this.isSelectionWithinCard()),allowRootEditButton:this.props.allowRootEditButton,onEditRootPost:this.props.onEditRootPost,reactionButtonProps:this.createMemoizedReactionButtonProps(this.props.id,this.props.componentTreeId.renderContextType,this.props.isTabbable,this.props.onReactionUpdated,F.a.Like,this.props.localizationAPI,this.props.preventDefaultKeyDownBehavior,this.props.userReactionSummary)})}renderFocusBar(e,t){if(!Object(te.h)(this.props.componentTreeId.renderContextType))return;if(u.i())return;const n=[this.renderStyle(L.h,e)];return(this.isSelectionWithinCard()||this.props.highlightCard||this.state.focusState===D.b.FocusOn)&&n.push(this.renderStyle(L.g,e)),a.createElement(z.a,{style:n,key:"focusBar",animationClass:vt(t)})}onDraftingInputSizeChange(e){this.props.onDraftingInputSizeChange(this,e)}renderLoadingUI(e){const t={id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType};return a.createElement(z.a,{testID:Object(we.h)(t),style:L.B},a.createElement(x.a,{delay:e},a.createElement(w.Spinner,{size:"large"})))}renderPendingUI(e){const t=u.i()?V.a:void 0,n=u.i()?void 0:V.a;let r;r=u.i()?7===e.themeId?e.palette.CardReplyBackground:!u.o()&&this.props.highlightCard?e.palette.CardHoveredBackground+"7F":e.palette.CardReplyBackground+"7F":7===e.themeId?e.palette.CardReplyBackground:e.palette.CardReplyBackground+"7F";const o=[this.renderStyle(L.p,e),{backgroundColor:r}];return a.createElement(x.a,{delay:t,key:"spinner"},a.createElement(z.a,{style:this.renderStyle(L.q,e)},a.createElement(z.a,{style:o},this.renderLoadingUI(n))))}renderLowFidelityFooter(e,t,n){const r=Object(X.b)(n),o=Object(Pe.a)({icon:26,themeId:t.themeId,renderTarget:"Pane"}),i=this.props.localizationAPI.getString(237),s=this.props.localizationAPI.getString(238),c=L.w(this.state.focusState,this.isSelectionWithinCard());return a.createElement(z.a,{style:L.x(c),animationClass:St(e)},a.createElement(z.a,{style:this.renderStyle(L.y(c),t)},o&&a.createElement(j.Image,{source:o.source,style:L.v}),a.createElement(z.a,{style:L.u},a.createElement(se.a,{textStylePolyester:"MediumBold",variantFluent:"secondarySemibold",colorFluent:r.subTextColor},i),a.createElement(se.a,{textStylePolyester:"MediumSecondary",variantFluent:"secondaryStandard",colorFluent:r.subTextColor},s))))}getComponentDelegate(){return this}onAccessibilityAction(e){if(e)switch(e.nativeEvent.actionName){case"Expand":return void(this.props.cardCollapsedState!==y.a.Expanded&&this.onExpand(!1));case"Collapse":this.props.cardCollapsedState!==y.a.Collapsed&&this.props.onCardCollapse(this)}}},{componentTreeId:U.a},Ae.DisplayName),kt=n(106);!function(e){e[e.RootPost=1]="RootPost",e[e.ReplyPost=2]="ReplyPost",e[e.ViewMoreRepliesButton=3]="ViewMoreRepliesButton"}(Et||(Et={}));var Rt=Et,xt=n(83),Dt=n(3);const wt=new K.a([K.a.always({flexDirection:"row",marginBottom:4,alignItems:"center"})]),At=w.StyleSheet.createViewStyle({marginLeft:5,flex:1}),jt=Object(V.e)({height:12,width:12,flex:0,marginTop:2});var _t=a.memo((function(e){const t=Object(W.b)(),n=Object(U.b)().renderContextType,r=Object(Pe.a)({icon:e.icon,themeId:t.themeId,renderTarget:"Pane"});return a.createElement(z.a,{style:wt.render(Object(te.c)(n))},r&&a.createElement(z.a,{style:jt},a.createElement(j.Image,{source:r.source,style:V.d})),a.createElement(se.a,{numberOfLines:1,style:At,accessible:!1,tooltip:e.description},e.description))}));const Ft=new K.a([K.a.rule({isFluentEnabled:!1},{marginTop:ee.c}),K.a.rule({isFluentEnabled:!0},{marginTop:3})]),Mt=a.memo((function(e){return Object(H.a)(t=>{const n=Object(X.b)(t);return a.createElement(se.a,{style:Ft.render(Object(te.c)(e.renderContextType)),textStylePolyester:u.i()?"SmallSecondary":"SmallStandard",colorFluent:n.subTextColor,variantFluent:"captionStandard",accessible:!1},e.timestamp)},A.a)}));Mt.displayName="RenderableItemTimestamp";class Nt extends a.PureComponent{constructor(){super(...arguments),this.onFocusParent=()=>this.props.onFocusParent(this),this.saveDraftIfEditing=e=>{this.isEditingOrPending(this.props.postDisplayMode)&&this.props.onSaveDraft(this.getId(),e)}}get textEditorRef(){return this._textEditorRef}componentDidMount(){this.props.onPostMounted(this.props.id)}componentWillUnmount(){this.textEditorRef&&this.saveDraftIfEditing(this.textEditorRef)}setContents(e){this.textEditorRef&&this.textEditorRef.setContents(e)}getContentsAsync(){return this.textEditorRef?this.textEditorRef.getContentsAsync():Promise.resolve("")}getCursorPositionAsync(){return this.textEditorRef?this.textEditorRef.getCursorPositionAsync():Promise.resolve(void 0)}getId(){return this.props.id}isEditingOrPending(e){return e===S.a.Editing||e===S.a.EditPreCommitPending}renderTimestamp(){if(this.props.collapsed||this.props.postDisplayMode===S.a.New_nonFluent||this.isEditingOrPending(this.props.postDisplayMode))return;const e=this.props.componentTreeId.renderContextType;return a.createElement(Mt,Object.assign({},{timestamp:this.props.timestamp,id:Object(we.G)({id:this.props.id,renderContextType:e}),renderContextType:e,resolved:this.props.postDisplayMode===S.a.Resolved}))}getActionBarItemsAsButtonProps(e){return e.actionBarItems.map((t,n)=>{const{id:r,onClick:o}=t,i=Object(Dt.f)(t,["id","onClick"]);return Object.assign(Object.assign({},i),{id:Object(we.a)({id:e.id,renderContextType:this.props.componentTreeId.renderContextType},n),onClick:()=>t.onClick(this),onKeyDown:e=>{var n;return null===(n=t.onKeyDown)||void 0===n?void 0:n.call(t,e,this)},isTabbable:e.isTabbable})})}shouldShowHistoryItemTaskHeader(){return this.props.taskHistoryProps.length>0&&!this.props.collapsed&&u.b()}renderHistoryItemContent(){if(0!==this.props.taskHistoryProps.length&&this.shouldShowHistoryItemTaskHeader())return this.props.taskHistoryProps.map((e,t)=>a.createElement(_t,Object.assign({},e,{key:e.description})))}renderDraftBoxMessage(e){if(!u.y())return null;const{draftWarningState:t}=this.props;return t||e?a.createElement(he.a,{key:"draftBoxMessage",draftWarningState:t,localizationAPI:this.props.localizationAPI,target:N.a.Post,id:t?Object(we.r)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}):Object(we.H)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),defaultToPostingTip:e}):null}}Nt.DisplayName="CommentPost";const Lt=new K.b([K.b.always(e=>({backgroundColor:e.palette.UnreadDotColor,borderColor:e.palette.UnreadDotBorderColor,borderRadius:4,borderStyle:"solid",borderWidth:1,height:8,width:8,position:"absolute",top:23,left:-6}))]),Bt=a.memo((function(e){return a.createElement(W.a.Consumer,null,t=>a.createElement(j.View,{style:Object(V.g)(Lt,t,e.renderContextType)}))}));var Ht=n(154),Ut=n(296);class Vt extends a.PureComponent{render(){return a.createElement(Ut.a,{buttons:this.props.actions,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior})}}var Wt=n(297),zt=n(298),Kt=n(292),Gt=n(275),qt=n(39);const $t=B.a;class Yt extends $t{constructor(){super(...arguments),this.getNextTabTarget=(e,t)=>{const n=super.getNextTabTarget(e,t);return n||this.props.disabled?n:super.getNextTabTarget(e,!0)}}}var Jt=n(18);function Qt(e){return u.i()&&(e.isReadOnly||e.postDisplayMode===S.a.Normal||e.postDisplayMode===S.a.Resolved)&&e.isNew}var Xt=n(242),Zt=n(201),en=n(151);class tn extends Nt{constructor(e,t){super(e,t),this._postContainerRef=a.createRef(),this.hoverManager=new mt.a,this.fullPanePickerTarget=a.createRef(),this.rteRef=a.createRef(),this.onHoverChange=e=>{this.setState({isHovered:e})},this.onFocusStateChange=e=>{this.setState({focusState:e})},this.onDraftEmptinessChanged=e=>{this.props.onDraftEmptinessChanged(this,e)},this.onEditorHeightChange=e=>{this.setState({editorHeight:e})},this.onEditorMount=()=>{this.props.onPostEditorMounted(this.props.id)},this.onEdit=()=>{this.props.onEdit(this.props.id)},this.createOnPressHandler=Object(E.c)({},nn,()=>[this.state.focusState,this.props.onSelect,this.props.postDisplayMode,this.props.collapsed,!!this.props.selected,this,this._postContainerRef]),this.createMemoizedContextualMenuProps=Object(E.a)((e,t,n)=>{}),this.setEditorWrapperRef=e=>{this.setState({editorWrapperRef:e})},this.onActionMenuOpened=()=>{this.props.selected||this.props.onSelect(this,!1)},this.renderPostHeader=(e,t)=>{if(this.props.parent&&u.i())return;const n=a.createElement(se.a,{style:this.renderStyle(Ve.e,e),variantFluent:"bodySemibold",textStylePolyester:"MediumBold",disabled:!1,numberOfLines:u.i()?void 0:1,accessible:!1},Object(d.k)(this.props.author));if(!u.i())return n;const r=t.shouldShowActionMenu?"visible":"hidden",o=this.renderEditButton(e,r),i=this.renderActionMenu(e,r),s=this.renderReactionButton(e,!t.shouldShowActionMenu);return a.createElement(z.a,{style:this.renderStyle(Ve.o,e)},n,o,i,s)},this.onCollapseParent=()=>this.props.onCollapseParent(this),this.renderWithContexts=(e,t,n)=>{const r=u.i()&&Object(Xt.a)(this.props.postDisplayMode),o=this.props.postDisplayMode===S.a.Resolved,i=this.props.componentTreeId.renderContextType;let s,c;u.i()?(s=!r&&this.isInEdit()&&Object(te.h)(i),c=!this.props.collapsed&&(this.props.selected||this.state.isHovered)&&0!==this.props.actionBarItems.length&&!this.isInEdit()):(s=!r&&this.isInEdit()&&Object(te.h)(i),c=!1);const d=[this.renderStyle(Ve.s,t)];!(i===I.a.HalfPane&&this.isEditingOrPending(this.props.postDisplayMode))&&this.isReply()&&d.push(this.renderStyle(Ve.u,t)),s&&d.push(Ve.t),o&&d.push(this.renderStyle(Ve.v,t)),this.state.focusState===D.b.FocusOn&&d.push(this.renderStyle(Ve.n,t)),u.i()&&this.props.collapsed&&this.props.postDisplayMode===S.a.Resolved?d.push(this.renderStyle(Ve.h,t)):u.i()&&!u.o()&&this.props.isCardHovered?d.push(this.renderStyle(Ve.g,t)):d.push(this.renderStyle(Ve.f,t));const l=V.b(d,0,this.props.extraPaddingRight,0,this.props.extraPaddingLeft),p=[this.renderStyle(Ve.l,t)];u.i()&&this.isInEdit()&&p.push(Ve.m);const h=this.props.parent&&u.i();h&&p.push(Ve.w);let f=[];if(r)f=[this.renderLowFidelityWarning()];else{const e=this.createMemoizedContextualMenuProps(t.themeId,this.props.actionBarItems,this.props.id);f=[a.createElement(Gt.a,{key:"contents",ref:this._postContainerRef,accessibilityLabel:this.props.accessibilityLabel,accessibilityRole:"treeitem",isTabbable:this.props.isTabbable&&(!this.isInEdit()||!0),nodeId:Object(qt.a)({componentType:Jt.a.Post,id:this.props.id,renderContextType:i}),accessibilityState:this.props.selected?tn.selectedAccessibilityState:void 0,testID:Object(we.F)({id:this.props.id,renderContextType:i}),onFocusStateChange:this.onFocusStateChange,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,onPress:this.createOnPressHandler(e,!1),accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize,accessible:!0,onAccessibilityOrKeyPress:!this.props.collapsed&&this.props.parent?this.onCollapseParent:void 0,accessibilityDescription:Object(en.b)(this.props.commentBody),accessibilityAnnotation:this.isReply()?gt(!!this.props.isUIAAnnotationPatternEnabled,this.props.author,this.props.timestamp,this.props.componentTreeId.contextIdentifier):void 0},a.createElement(z.a,{style:l},a.createElement(a.Fragment,null,!h&&a.createElement(Qe.a,{accessible:!0,isTabbable:this.props.isTabbable&&!0,disabled:!u.i()&&o,nodeId:Object(we.B)({id:this.props.id,renderContextType:i}),size:u.i()?w.PersonaImageSize.extraSmall:w.PersonaImageSize.small,author:this.props.author,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior}),a.createElement(Yt,{nodeId:"post-ftz",style:p,focusable:!1,pointerEvents:"box-none",disabled:!this.isInEdit()||u.Y()},a.createElement(lt.b,{shouldRenderView:!1,style:p},a.createElement(a.Fragment,null,this.renderPostHeader(t,{isResolved:o,shouldShowActionMenu:c}),Qt(this.props)&&a.createElement(Bt,{dotType:this.props.parent?Rt.RootPost:Rt.ReplyPost,hasTaskTopper:!1,renderContextType:i}),this.renderHistoryItemContent(),this.props.postDisplayMode!==S.a.New_nonFluent&&this.renderTextViewOrEditor(t,n,e),this.renderTimestamp(),u.i()&&this.renderDraftBoxMessage(!1),s&&a.createElement(Vt,{actions:this.getActionBarItemsAsButtonProps(this.props),barContainerStyle:this.renderStyle(Ve.c,t),buttonStyle:this.renderStyle(Ve.b,t),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior}),!u.i()&&this.renderDraftBoxMessage(!1))))))),!u.i()&&this.props.postDisplayMode===S.a.EditPreCommitPending&&a.createElement(z.a,{style:this.renderStyle(Ve.x,t),key:"Spinner"},a.createElement(x.a,{delay:V.a},a.createElement(w.Spinner,{size:"large"})))]}return a.createElement(z.a,Object.assign({style:this.renderStyle(Ve.d,t),onLayout:this.onLayout,animationClass:e!==bt.d.None?"CommentCard_Reply":void 0,ref:this.fullPanePickerTarget},this.hoverManager.viewProps),this.isInEdit()&&i===I.a.HalfPane?a.createElement(ht,{leftButton:{buttonTitle:this.props.localizationAPI.getString(15),buttonPress:this.onCancel},rightButton:{buttonTitle:this.props.localizationAPI.getString(14),buttonPress:this.onCommitButtonClick},showShadow:!0},a.createElement(j.ScrollView,{keyboardShouldPersistTaps:"always"},f)):f)},this.render=()=>Object(H.a)(this.renderWithContexts,bt.c,W.a,A.a),this.onCommit=this.onCommit.bind(this),this.onCommitButtonClick=this.onCommitButtonClick.bind(this),this.onCancel=this.onCancel.bind(this),this.onLayout=this.onLayout.bind(this),this.state={postWidth:void 0,isHovered:!1,focusState:D.b.Unfocused,editorHeight:void 0,editorWrapperRef:null,preEditText:e.commentBody,isTransitioningToEdit:!1},this.hoverChangeEventSubscription=this.hoverManager.hoverChangeEvent.subscribe(this.onHoverChange)}get textEditorRef(){if(!this.rteRef.current)return;const e=this.rteRef.current.getData();return Object(Zt.a)(e)?e:void 0}static getDerivedStateFromProps(e,t){return e.postDisplayMode!==S.a.Editing||t.isTransitioningToEdit?e.postDisplayMode!==S.a.Editing&&t.isTransitioningToEdit?{isTransitioningToEdit:!1}:{}:{isTransitioningToEdit:!0,preEditText:e.commentBody}}componentDidUpdate(e){this.props.commentBody!==e.commentBody&&this.textEditorRef&&!this.isEditingOrPending(this.props.postDisplayMode)&&this.textEditorRef.setContents(this.props.commentBody),!this.isEditingOrPending(this.props.postDisplayMode)&&this.isEditingOrPending(e.postDisplayMode)&&this.props.postDisplayMode!==S.a.PendingEdit&&this.textEditorRef&&this.textEditorRef.setContents(this.props.commentBody),Object(i.i)().assertConditionTag(void 0===this.props.draftId||this.isEditingOrPending(this.props.postDisplayMode),"post has draft state and is not in editing mode",593802706)}componentWillUnmount(){super.componentWillUnmount(),this.hoverChangeEventSubscription&&this.hoverChangeEventSubscription.unsubscribe()}isInEdit(){return this.isEditingOrPending(this.props.postDisplayMode)}isReply(){return!this.props.parent}onCommit(e){this.props.onCommit(this,e)}onCommitButtonClick(){this.onCommit(kt.a.CommitButton)}onCancel(){this.props.onCancel(this)}renderStyle(e,t){return V.g(e,t,this.props.componentTreeId.renderContextType)}onLayout(e){this.setState({postWidth:e.nativeEvent.layout.width})}getPickerPosition(){const e=this.props.componentTreeId.renderContextType===I.a.FullPane?this.fullPanePickerTarget.current:this.state.editorWrapperRef;if(e&&this.state.postWidth)return{target:e,left:0,top:0,width:this.state.postWidth,height:this.props.availableScreenHeight||0}}renderLowFidelityWarning(){const e=this.props.componentTreeId.renderContextType;return a.createElement(zt.a,Object.assign({},Object(Kt.a)(this.props.postDisplayMode===S.a.LowFidelityWarningEdit?b.a.Edit:b.a.DeleteReply,{onCancel:this.props.onLowFidelityWarningCancel,onConfirm:this.props.onLowFidelityWarningConfirm},e,this.props.localizationAPI),{preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,key:"lowFidelityWarning",nodeId:Object(qt.a)({componentType:Jt.a.Post,id:this.props.id,renderContextType:e})}))}renderTextViewOrEditor(e,t,n){const r=this.props.postDisplayMode===S.a.Editing,o=r?xt.a.Editing:xt.a.ReadOnly,i=r?this.props.savedDraftContent:void 0,s=[this.renderStyle(Ve.i,e)],c=this.props.postDisplayMode===S.a.Resolved,d=this.props.componentTreeId.renderContextType;let l=!1,p=void 0;if(u.i()){if(c&&this.props.collapsed&&s.push(this.renderStyle(ee.k,e)),this.isEditingOrPending(this.props.postDisplayMode)){if(s.push(this.renderStyle(ee.i,e),this.renderStyle(Ve.j,e)),u.y()&&this.props.draftWarningState){const e=Object(X.b)(t);s.push(V.f(Ht.g,e,d))}}else this.props.collapsed&&(s.push(Ve.k),l=!!(this.state.editorHeight&&this.state.editorHeight>=Ve.a));l&&(p=this.renderStyle(this.props.collapsed&&c?Ve.q:!u.o()&&this.props.isCardHovered?Ve.p:Ve.r,e))}const h=this.props.isTabbable&&!l;return a.createElement(z.a,{style:s,ref:this.setEditorWrapperRef,collapsable:!1},a.createElement(Wt.a,Object.assign({nodeId:Object(qt.a)({id:this.props.id,renderContextType:d,componentType:Jt.a.PostEditor}),id:Object(we.C)({id:this.props.id,renderContextType:d}),ref:this.rteRef,defaultValue:this.isEditingOrPending(this.props.postDisplayMode)?this.state.preEditText:this.props.commentBody,displayMode:o,savedDraftContent:i,isDraftEmpty:this.props.isDraftEmpty,richTextCapabilities:this.props.richTextCapabilities,shouldRestoreContentOnMount:this.isEditingOrPending(this.props.postDisplayMode),onPress:this.createOnPressHandler(n,!0),peoplePickerPosition:this.getPickerPosition(),isTabbable:h,focusable:!this.props.collapsed||h,onContentSizeChange:this.onEditorHeightChange,onCommitRequested:this.onCommit,onEscapeRequested:this.onFocusParent,onDraftEmptinessChanged:this.onDraftEmptinessChanged,onMount:this.onEditorMount,onUnmount:this.saveDraftIfEditing,maxHeight:this.props.collapsed?Ve.a:void 0,accessibilityLabel:Object(Q.l)(this.props.localizationAPI),focusManagerKeyDownHandler:this.props.commentEditorAdditionalKeyDownHandler,localizationAPI:this.props.localizationAPI},this.props.mentionableEditorProps)),l&&a.createElement(z.a,{style:p}))}renderActionMenu(e,t){const n=this.props.componentTreeId.renderContextType;return this.isReply()&&a.createElement(Ie.a,{onClick:Je(e.themeId,this.props.actionBarItems,this.props.id),accessibilityLabel:this.props.localizationAPI.getString(123),style:this.renderStyle(ee.o,e),text:"",isTabbable:this.props.isTabbable,key:"threadAnchorMenu",icon:7,tooltipText:this.props.localizationAPI.getString(123),nodeId:Object(we.D)({id:this.props.id,renderContextType:n}),testID:Object(we.D)({id:this.props.id,renderContextType:n}),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,visibility:t,onMenuOpened:this.onActionMenuOpened})}renderEditButton(e,t){if(!u.B()||!this.props.isEditable)return null;const n=this.props.componentTreeId.renderContextType;return a.createElement(Ie.a,{icon:6,onClick:this.onEdit,accessibilityLabel:this.props.localizationAPI.getString(120),text:"",isTabbable:this.props.isTabbable,key:"postEditButton",tooltipText:this.props.localizationAPI.getString(120),nodeId:Object(we.E)({id:this.props.id,renderContextType:n}),testID:Object(we.E)({id:this.props.id,renderContextType:n}),visibility:t,style:this.renderStyle(ee.j,e),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior})}renderReactionButton(e,t){return!u.a()||void 0===this.props.userReactionSummary||this.props.preventReacting?null:a.createElement(Ye,{commentId:this.props.id,isTabbable:this.props.isTabbable,onReactionPressed:this.props.onReactionUpdated,reactionType:F.a.Like,localizationAPI:this.props.localizationAPI,userReactionSummary:this.props.userReactionSummary,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,style:this.renderStyle(ee.j,e),renderHidden:t,renderContextType:this.props.componentTreeId.renderContextType,key:"cardReactionButton"})}}function nn(e,t,n,r,o,i,a,s,c){if(!(o!==S.a.New_nonFluent))return;const d=i||!a&&!0,l=!t&&n===D.b.Unfocused;return l||d?()=>r(s,l):void 0}tn.selectedAccessibilityState={selected:!0};var rn=Object(tt.a)(tn,{componentTreeId:U.a},Nt.DisplayName);const on={getCardA11yLabel:function(e,t,n,r,o,i,a,s,c,l){if(t===v.a.Draft||t===v.a.DraftPreCommitPending)return r?e.formatString(224,r):e.getString(223);if(t===v.a.Loading)return e.getString(225);const u=[],p=i?ne.c(i.completion):t===v.a.Resolved;if(i){const t=null==i?void 0:i.assignees[0];t?u.push(e.formatString(p?215:214,Object(d.k)(t))):u.push(e.getString(p?217:216)),u.push(e.formatString(212,n))}else u.push(e.formatString(p?213:211,n));return r&&u.push(e.formatString(218,r)),t!==v.a.Reply&&a!==T.a.InChildPost||u.push(e.getString(222)),1===o?u.push(e.getString(219)):o>1&&u.push(e.formatString(220,String(o))),t!==v.a.CardPostCommitPending&&t!==v.a.ReplyPostCommitPending||u.push(e.getString(221)),s&&(u.push(e.getString(237)),u.push(e.getString(238))),u.join(e.getString(226))},getPostA11yLabel:(e,t,n,r,o)=>{const{isUnread:i,author:a,timestamp:s}=o;return r.formatString(t===S.a.PendingDraft||t===S.a.PendingEdit?210:i?209:208,a,s)},getTaskHistoryItemA11yLabel:(e,t,n)=>t&&n?e.formatString(232,t,n):(Object(i.i)().assertConditionTag(!1,"Task History Item accessibility label not resolving properly",557352448),e.getString(119)),getTaskHistoryA11yDescription:e=>{if(e.length>0)return e.map(e=>e.description).join(", ");Object(i.i)().assertConditionTag(!1,"Task History Item accessibility description not resolving properly",527765771)}};const an=Object(V.e)({minHeight:24,flexDirection:"row",alignItems:"center"}),sn={selected:!0};function cn(e,t,n){return Object(V.g)(e,t,n)}const dn=a.memo(a.forwardRef((e,t)=>{const{id:n,collapsed:r,onSelect:o,author:i,preventDefaultKeyDownBehavior:s}=e,c=Object(W.b)(),{componentTreeId:d,renderHistoryItemContent:l,renderTimestamp:u,imperativeHandle:p}=function(e,t){const{id:n,timestamp:r,historyItemContent:o}=e,i=Object(U.b)(),s=a.useCallback(()=>n,[n]),c=a.useCallback(()=>a.createElement(Mt,{timestamp:r,id:Object(we.G)({id:n,renderContextType:i.renderContextType}),renderContextType:i.renderContextType}),[n,r,i]),d=a.useCallback(()=>o.map(e=>a.createElement(_t,{icon:e.icon,description:e.description,key:e.description})),[o]),l=a.useMemo(()=>({getId:s}),[s]);return Object(a.useImperativeHandle)(t,()=>l,[l]),{getId:s,renderTimestamp:c,renderHistoryItemContent:d,componentTreeId:i,imperativeHandle:l}}(e,t),h=d.renderContextType,[f,m]=a.useState(D.b.Unfocused),g=a.useMemo(()=>{const e=[cn(Ve.s,c,h),cn(Ve.u,c,h)];return f===D.b.FocusOn&&e.push(cn(Ve.n,c,h)),e},[c,h,f]),b=a.useCallback(e=>{m(e)},[m]),C=a.useCallback(()=>{const e=f===D.b.Unfocused;o(p,e)},[o,f,p]),y=a.useCallback(()=>a.createElement(Qe.a,{nodeId:Object(we.B)({id:n,renderContextType:h}),size:w.PersonaImageSize.extraSmall,author:i,preventDefaultKeyDownBehavior:s}),[n,i,s,h]),v=a.useCallback(()=>a.createElement(z.a,{style:an},a.createElement(se.a,{textStylePolyester:"MediumBold",variantFluent:"bodySemibold",key:"name",accessible:!1},i.DisplayName||"")),[i]);return a.createElement(me.a,{isTabbable:e.selected&&!e.collapsed,preventDefaultKeyDownBehavior:s,style:cn(Ve.d,c,h),key:n,focusable:!0,nodeId:Object(qt.a)({componentType:Jt.a.Post,id:n,renderContextType:h}),onPress:C,accessible:!0,accessibilityLabel:e.accessibilityLabel,accessibilityState:e.selected?sn:void 0,accessibilityRole:"treeitem",accessibilityPositionInSet:e.accessibilityPositionInSet,accessibilitySetSize:e.accessibilitySetSize,accessibilityDescription:on.getTaskHistoryA11yDescription(e.historyItemContent),onFocusStateChange:b},a.createElement(z.a,{style:g},y(),a.createElement(z.a,{style:Ve.l.render(Object(te.c)(h))},v(),l(),!r&&u())))}));var ln=n(96),un=n(64),pn=n(60),hn=n(24);function fn(e,t){return e===t||e.length===t.length&&e.every((e,n)=>hn.f(e[0])===hn.f(t[n][0]))}function mn(e,t){return!!t&&t.selectedCardId===e&&!Object(b.j)(t.selectionDetails)}function gn(e,t){return!!t&&t.selectedCardId===e&&Object(b.j)(t.selectionDetails)}function bn(e,t){return!!t&&Object(b.j)(t.selectionDetails)&&t.selectionDetails.selectedPostId===e}function Cn(e,t,n,r,o){switch(e){case ln.a.AllCardsTabbable:return!0;case ln.a.ExpandedCardOrFirstCardTabbable:if(o){const e=mn(t,o),n=gn(t,o);return e||r===y.a.Expanded&&n}return n;case ln.a.ExpandedCardTabbable:return!!o&&r===y.a.Expanded;case ln.a.SelectedCardTabbable:return!!o&&o.selectedCardId===t}}function yn(e,t,n,r,o,i){if(r===S.a.PendingEdit||r===S.a.PendingDraft)return bn(t,i);switch(e){case ln.b.AllPostsTabbable:return!0;case ln.b.ExpandedCardPostsTabbable:return o===y.a.Expanded;case ln.b.ExpandedCardRootPostTabbable:{const e=bn(t,i),a=mn(n||t,i);return r!==S.a.New_nonFluent&&(e||a&&o===y.a.Expanded&&!n)}case ln.b.SelectedPostTabbable:return bn(t,i)}}function vn(e,t,n){return y.a.Collapsed===e||void 0!==n&&(n!==T.a.InChildPost||!t)}function Tn(e,t,n,r,s,l,p,h,f,y,v,T,I,O,E,P,k,R){const{localizationAPI:x,selectedState:D,isDraftThread:w,isCommentsContextReadOnly:A,draftState:j,cardCollapsedState:_}=e;let F=!1;D&&Object(b.j)(D.selectionDetails)&&(F=D.selectionDetails.selectedPostId===t.commentId);const M=function(e,t,n,r,a,s,c){if(t.pending!==g.a.None)return Object(i.i)().assertConditionTag(t.pending!==g.a.Delete,"Post with PostPendingType.Delete should not attempt to be rendered. Falling back to PendingEdit display mode.",595153811),c?S.a.PendingDraft:S.a.PendingEdit;if(s){if(c)return Object(i.i)().assertConditionTag(!u.i(),"New post should not be rendered while drafting in fluent.",574755652),S.a.New_nonFluent;if(n.postIdToDraftIdMap[e.commentId])return Object(m.i)(n)?S.a.EditPreCommitPending:S.a.Editing}if(r&&Object(b.b)(r)===e.commentId)switch(r.selectionDetails.lowFidelityWarningType){case void 0:break;case b.a.DeleteReply:return S.a.LowFidelityWarningDelete;case b.a.Edit:return S.a.LowFidelityWarningEdit;case b.a.DeleteThread:return u.i()?S.a.LowFidelityWarningDelete:S.a.Normal;default:Object(o.m)(r.selectionDetails)}if(t.displayingErrorUI)return S.a.Error;if(a)return S.a.Resolved;return S.a.Normal}(t,n,j,D,r,f,w),N=!!(t.commentFlags&c.a.ReadOnly||A),L=n.displayDate||"",B=j.postIdToDraftIdMap[t.commentId],H=B?j.drafts[B]:void 0,U=!!H&&H.renderContextType!==e.renderContextType,V=f&&H?Object.assign({draftId:B},Object(m.g)(H)):{};return a.createElement(rn,Object.assign({},e.postCallbacks,V,{postDisplayMode:M,isReadOnly:N,id:t.commentId,author:t.author,authorColor:null==l?void 0:l.authorColor,authorImageURL:null==l?void 0:l.authorImageURL,timestamp:L,commentBody:t.commentBody,parent:""===t.parentId,lowFidelityWarningString:F?Q.j(x,D):"",selected:F,isTabbable:yn(s,t.commentId,t.parentId,M,_,D),supportsAtMentions:e.isAtMentionEnabled,localizationAPI:x,actionBarItems:e.getActionBarItems(M,null==D?void 0:D.selectionDetails.lowFidelityWarningType,E,""===t.parentId,N,t.commentFlags,u.t(),u.i()),accessibilityLabel:on.getPostA11yLabel(0===t.parentId.length,M,N,x,{author:Object(d.k)(t.author),timestamp:L,repliesCount:p,commentBody:t.commentBody,isReplyPending:h,isUnread:u.i()&&!!(t.commentFlags&c.a.IsNew),anchorHintText:t.anchorHintText}),key:t.commentId,mentionableEditorProps:e.mentionableEditorProps,taskHistoryProps:v,accessibilityPositionInSet:y.accessibilityPositionInSet,accessibilitySetSize:y.accessibilitySetSize,isNew:!!(t.commentFlags&c.a.IsNew),scrollingContainerId:T,isCardHovered:e.isCardHighlighted,availableScreenHeight:e.availableScreenHeight,extraPaddingLeft:e.extraPaddingLeft,extraPaddingRight:e.extraPaddingRight,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior,collapsed:I,restrictActionControls_deprecated:O,preventReacting:N||E===C.a.None,richTextCapabilities:e.richTextCapabilities,usersByReactionType:u.a()?t.usersByReactionType:void 0,userReactionSummary:u.a()?t.userReactionSummary:void 0,truncationOverlayColor:u.E()?void 0:P,dulledAtMentions:k,isUIAAnnotationPatternEnabled:e.isUIAAnnotationPatternEnabled,isEditable:!(t.commentFlags&c.a.EditRestricted||t.commentFlags&c.a.ReadOnly||E!==C.a.Any),cardSelected:R,hasDraftInOtherRenderContext:U}))}function Sn(e,t,n,r,o,i,s,c,d,l,u){const p=hn.e(t,e),h=hn.a(t.taskId,t.records[0].recordId);let f=!1;i&&Object(b.j)(i.selectionDetails)&&(f=i.selectionDetails.selectedPostId===h);const m=u.displayDate;return a.createElement(dn,{historyItemContent:p,onSelect:n.onSelect,id:h,key:h,author:t.records[0].user,timestamp:m,selected:f,authorColor:null==r?void 0:r.authorColor,authorImageURL:null==r?void 0:r.authorImageURL,resolved:o,collapsed:s,restrictActionControls_deprecated:c,accessibilitySetSize:d.accessibilitySetSize,accessibilityPositionInSet:d.accessibilityPositionInSet,accessibilityLabel:on.getTaskHistoryItemA11yLabel(e,t.records[0].user.DisplayName,m),preventDefaultKeyDownBehavior:l})}const In=a.memo((function(e){const{thread:t,renderContextType:n,cardState:r,postOrHistoryRecordStates:s,postCallbacks:S,cardCallbacks:E,localizationAPI:P,selectedState:k,isolationEdit:R,isDraftThread:x,isCommentsContextReadOnly:D,keyboardingOptions:w,personaIconPropertiesMap:A,draftState:j,cardCollapsedState:_,cardRelativeDraftingState:F,maximumDimensions:M,preventDefaultKeyDownBehavior:N,restrictActionControls_deprecated:L,allowedDraftingSession:B,taskState:H,isCardTabbable:U,tabFocusTrapBehavior:V}=e,W=hn.i(t),z=W.commentId,K=F===T.a.InChildPost,G=!!(W.commentFlags&c.a.Resolved),q=s[0].displayDate||"",$=[],Y=function(e,t,n,r,i,a){if(Object(h.N)(t.loadState))return v.a.Loading;switch(t.pending){case f.a.Card:case f.a.Delete:return v.a.CardPostCommitPending;case f.a.Editor:return v.a.ReplyPostCommitPending;case f.a.None:break;default:Object(o.m)(t.pending)}if(a)return Object(m.i)(n)?v.a.DraftPreCommitPending:v.a.Draft;if(r&&r.selectedCardId===e.commentId&&Object(b.d)(r)&&!u.i())return v.a.LowFidelityWarningOnDeleteThread;if(i){if(n.cardIdToDraftIdMap[e.commentId])return Object(m.i)(n)?v.a.ReplyPreCommitPending:v.a.Reply;if(n.pendingDraft&&"REPLY"===n.pendingDraft.sessionType&&n.pendingDraft.threadId===e.commentId)return v.a.ReplySessionRequestPending}if(e.commentFlags&c.a.Resolved)return v.a.Resolved;return v.a.Normal}(W,r,j,k,!u.m()||F===T.a.InCard,x),J=mn(W.commentId,k),Q=D||!!(W.commentFlags&c.a.ReadOnly),X=gn(W.commentId,k),Z=Object(te.b)(Y===v.a.Resolved,J||X),ee=Object(te.i)(Y===v.a.Resolved,_===y.a.Collapsed,J||X),re=t.length-1;let oe=!1;const ie=!Object(h.N)(r.loadState),ae=n!==I.a.HalfPane&&!u.i();if(ie&&(!x||ae))for(let o=0;o<t.length;o++){const i=t[o],a=s[o];if(Object(un.a)(i)){i.commentModel.commentFlags&c.a.LowFidelity&&(oe=!0);const s=i.commentModel.commentId,d=Object(h.J)(j)===s,m=!!j.postIdToDraftIdMap[s];if(!a)throw new l.a("Post Or History Record state undefined for comment "+s,589103624,-2130957493);if((!R||!K||m)&&Object(g.b)(a)&&a.pending!==g.a.Delete){const s=Object(un.b)(i)?hn.e(i.historyItem,P):[],c=vn(_,d,F);$.push(Tn(e,i.commentModel,a,G,w.postTabbingMode,u.A()?Object(p.d)(A,i.commentModel.author):void 0,re,r.pending===f.a.Editor,!u.m()||K||x,{accessibilitySetSize:t.length,accessibilityPositionInSet:o+1},s,M&&M.height?Object(we.J)({id:z,renderContextType:n}):Object(pn.c)(n)?Object(we.m)():void 0,_===y.a.Collapsed,c,B,Z,ee,J))}}else u.b()&&$.push(Sn(P,i.historyItem,S,u.A()?Object(p.d)(A,i.historyItem.records[0].user):void 0,G,k,_===y.a.Collapsed,L,{accessibilitySetSize:t.length,accessibilityPositionInSet:o+1},N,a))}const se=B===C.a.None;return function(e,t,n,r,o,i,s,l,p,f,g,y,v){const{cardState:S,cardCallbacks:I,localizationAPI:O,selectedState:E,isAtMentionEnabled:P,areTasksEnabled:k,draftState:R,cardCollapsedState:x,cardRelativeDraftingState:D,maximumDimensions:w,isolationEdit:A,richTextCapabilities:j,thread:_}=e,F=Object(h.N)(S.loadState)?S.loadState.initialItemCount:r.length,M=R.cardIdToDraftIdMap[t.commentId],N=M?R.drafts[M]:void 0,L=(!u.m()||D===T.a.InCard)&&N?Object.assign({draftId:M},Object(m.g)(N)):{};return a.createElement(Pt,Object.assign({},I,L,{cardCollapsedState:x,selected:p,isReadOnly:y,hasSelectedChild:f,hasLowFidelityChild:g,displayMode:o,id:t.commentId,supportsAtMentions:P,isTabbable:e.isCardTabbable,localizationAPI:O,accessibilityLabel:on.getCardA11yLabel(O,o,Object(d.k)(t.author),t.anchorHintText,F-1,n,D,g&&!0,l,t.commentBody),accessibilityDescription:Object(en.b)(hn.i(_).commentBody),anchorText:t.anchorHintText,author:t.author,authorColor:i?i.authorColor:"",authorImageURL:i?i.authorImageURL:"",cardRelativeDraftingState:D,supportsTasks:k,taskTopperProps:n,isNewThread:e.isDraftThread,foldableLayoutState:e.foldableLayoutState,accessibilityPositionInSet:e.accessibilityPositionInSet,accessibilitySetSize:e.accessibilitySetSize,accessibilitySetLevel:e.accessibilitySetLevel,maximumDimensions:w,scrollingContainerId:s,itemCount:F,menuItems:e.getCardContextualMenuItems(t.commentFlags,e.allowedDraftingSession,e.isResolveSupported,Object(b.i)(t,E),!!e.taskState,u.t(),u.i()),allowRootEditButton:!(t.commentFlags&c.a.EditRestricted||t.commentFlags&c.a.ReadOnly||Object(b.i)(t,E))&&e.allowedDraftingSession===C.a.Any,mentionEditorProps:e.mentionEditorProps,onCardLayout:e.onCardLayout,timestamp:l,restrictActionControls_deprecated:e.restrictActionControls_deprecated,preventReacting:y||e.allowedDraftingSession===C.a.None,contentBackgroundColor:e.contentBackgroundColor,maxDraftHeight:e.maxDraftHeight,availableScreenHeight:e.availableScreenHeight,extraPaddingLeft:e.extraPaddingLeft,extraPaddingRight:e.extraPaddingRight,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior,highlightCard:e.isCardHighlighted,hideDraftBox:A||e.isCommentsContextReadOnly,hideHeader:A,disableScroll:A,style:e.cardStyle,richTextCapabilities:j,usersByReactionType:u.a()?t.usersByReactionType:void 0,userReactionSummary:u.a()?t.userReactionSummary:void 0,isUIAAnnotationPatternEnabled:e.isUIAAnnotationPatternEnabled,tabFocusTrapBehavior:v}),r)}(e,W,H?function(e,t,n,r,o,a,s,c){if(!u.b())return;let d=t.completion;const l=d===ne.a;r!==l&&(Object(i.i)().assertConditionTag(!1,"Comment and task resolve state don't match",570826896),d=r?ne.a:0);return{id:e,title:t.title,assignees:t.assignees,completion:d,onResolveTaskCheckboxPressed:a,localizationAPI:n,displayMode:o,preventDefaultKeyDownBehavior:s,isTabbable:c}}(z,H,P,!!(W.commentFlags&c.a.Resolved),Q?O.ReadOnly:se?O.Disabled:O.Default,E.onTaskTopperCheckboxPressed,N,U&&!se):void 0,$,Y,u.A()?Object(p.d)(A,W.author):void 0,Object(pn.c)(n)?Object(we.m)():void 0,q,J,X,oe,Q,V)}));function On(e){return a.createElement(In,Object.assign({},e))}function En(e,t,n,r){if(!e)return;if(!n[e.selectedCardId]||n[e.selectedCardId].pending===f.a.Delete)return;const o=Object(h.G)(t);return o!==e.selectedCardId?e.selectedCardId:t.pendingDraft||t.drafts[o]&&(!t.drafts[o].isInCurrentContext||t.drafts[o].renderContextType!==r)?void 0:e.selectedCardId}function Pn(e,t,n){return e.map(e=>{const r=hn.f(e);return t[r]||n&&n[r]})}},,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Execute=0]="Execute",e[e.CheckEnabled=1]="CheckEnabled",e[e.CheckToggled=2]="CheckToggled"}(r||(r={}))},function(e,t,n){"use strict";t.a=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),o=n(0),i=n(1);function a(e,t,n){class a extends i.Component{constructor(){super(...arguments),this.allContextContents={},this.keys=Object.keys(t),this.renderFunction=this.keys.reduceRight((n,r)=>(o,a)=>{const s=t[r];return i.createElement(s.Consumer,null,t=>(this.allContextContents[r]=t,null===n?i.createElement(e,Object.assign({ref:o},a,this.allContextContents)):n(o,a)))},null),this.render=()=>{const t=this.props,{forwardedRef:n}=t,a=Object(r.f)(t,["forwardedRef"]);return this.renderFunction?this.renderFunction(n,a):(Object(o.i)().assertConditionTag(!1,"Contexts failed to wrap, default to null.",558724946),i.createElement(e,Object.assign({},a,{ref:n},this.allContextContents)))}}}const s=i.forwardRef((e,t)=>i.createElement(a,Object.assign({key:"ContextualizedWrapperComponent",forwardedRef:t},e)));return s.displayName=n,s}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r;n(8),n(21);class o{constructor(){this.ops=[]}insert(e,t,n){return this.ops.push({insert:e,attributes:t,optional:n}),this}toDelta(){return{ops:this.ops}}toJSON(){return JSON.stringify(this.toDelta())}}function i(e){return function(e){if(!e.ops)return"";return e.ops.map(e=>e.insert).join("")}(JSON.parse(e))}!function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a}));const r=1,o=void 0,i={PostHeight:50,ExpandButtonHeight:22,ReplyDraftHeight:44,TaskTopper:0};function a({itemCount:e,readOnly:t,isTask:n}){let o=i.PostHeight;return e>1&&(o+=i.PostHeight+r),e>2&&(o+=i.ExpandButtonHeight+r),t||(o+=i.ReplyDraftHeight+r),n&&(o+=i.TaskTopper),o}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(0),o=n(2),i=n(19);function a(e,t,n,o,a){if(-1!==n&&Object(i.e)(t)<Object(i.e)(e)){const e=Object(r.i)().createActivityObject("SilentDraftDiscard",Object(r.j)(r.g.GlobalAPI),r.a.None,r.b.NecessaryServiceDataEvent);e.addDataField("DiscardReason",null!=n?n:0,r.d.SystemMetadata),e.addDataField("Source",o,r.d.SystemMetadata),e.successTag(a)}}function s(e,t,n){if(o.v()){const o=Object(r.i)().createActivityObject("MarkCommentCreation",n,r.a.None,r.b.NecessaryServiceDataEvent);o.addDataField("DraftId",e,r.d.SystemMetadata),o.addDataField("CommentId",t,r.d.SystemMetadata),o.addDocumentMetadata(r.f.Basic),o.successTag(591152859)}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"g",(function(){return u}));var r=n(4),o=n(12);const i=new r.a([r.a.always({flexDirection:"column",alignItems:"stretch",borderWidth:0,paddingTop:4,paddingLeft:8,paddingRight:9,paddingBottom:9})]),a=Object(o.e)({paddingBottom:4}),s=new r.b([r.b.always({paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderColor:"transparent",borderWidth:1,marginLeft:1})]),c=new r.b([r.b.always(e=>({borderColor:e.palette.FocusBorderColor,borderRadius:2,borderStyle:"dashed"}))]),d=new r.b([r.b.always(e=>({backgroundColor:e.palette.CardDraftBoxBackgroundHovered}))]),l=new r.b([r.b.always(e=>({borderColor:e.palette.CardDraftBoxBorderHovered}))]),u=new r.b([r.b.always(e=>({borderColor:e.warningDraftboxColor}))])},function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"d",(function(){return g}));var r=n(0),o=n(11),i=n(55),a=n(2),s=n(106),c=n(17),d=n(107),l=n(36),u=n(15),p=(n(72),n(242));const h=(e,t,n,r,o,s,u,h,f)=>{if(Object(p.a)(t)&&n===c.a.Edit)return[e.proceedItemForLowFidelityWarningEdit,e.cancelLowFidelityWarningEditItem];if(Object(p.a)(t)&&n===c.a.DeleteReply)return[e.deleteItemForLowFidelityWarningDelete,e.cancelLowFidelityWarningDeleteItem];if(t===l.a.Error)return[e.retry,o?e.deleteRootItem:e.deleteItem];if(t===l.a.Resolved)return[];if(f&&t===l.a.EditPreCommitPending)return s?[]:[e.saveItemPending,e.cancelEditItem];if(t===l.a.Editing||t===l.a.EditPreCommitPending)return s?[]:[e.saveItem,e.cancelEditItem];const m=[];return h&&m.push(e.linkToCommentMenuItem),s||r===d.a.None||(r!==d.a.Any||a.B()||u&i.a.EditRestricted||m.push(e.editItem),u&i.a.DeleteRestricted||o||m.push(e.deleteItem)),m};function f(e,t,n,o,s,c,l,u){const p=[];if(l&&p.push(e.linkToComment),n===d.a.None||t&i.a.ReadOnly)return p;const h=(t&i.a.Resolved)>0,f=c?e.resolveTask:e.resolveThread,m=c?e.deleteTask:e.deleteThread;return Object(r.i)().assertConditionTag(o||!h,"Card cannot be resolved when resolved is not supported",593764383),h&&o?(p.push(e.reopenThread),t&i.a.DeleteRestricted||p.push(m),p):(n!==d.a.Any||!u||a.B()||t&i.a.EditRestricted||s||p.push(e.editRootPost),l&&o&&p.push(f),t&i.a.DeleteRestricted||p.push(m),!l&&o&&p.push(f),p)}function m(e,t){const n={text:e.getString(5),icon:3,onClick:t.onDeleteThread,isDestructive:!0,tooltipText:e.getString(5)},r={text:e.getString(3),icon:5,onClick:t.onResolveThread},o=e.getString(4);return{deleteThread:n,resolveThread:r,reopenThread:{id:Object(u.K)(),text:o,icon:a.i()?16:4,onClick:t.onReopenThread,tooltipText:o},cancel:{text:e.getString(15),icon:0,onClick:()=>{},isCancelItem:!0},editRootPost:{text:e.getString(120),onClick:t.onEditRootPost,icon:6,accessibilityLabel:e.getStringOrUndefined(40)},linkToComment:{text:e.getString(207),onClick:t.onPresentLinkToComment,icon:25,tooltipText:e.getString(207)},deleteTask:Object.assign(Object.assign({},n),{text:e.getString(206),tooltipText:e.getString(206)}),resolveTask:{text:e.getString(126),icon:5,onClick:t.onResolveThread}}}function g(e,t){const n={text:e.getString(184),onClick:t.onClearError,icon:19,accessibilityLabel:e.getStringOrUndefined(184)},i={text:e.getString(5),onClick:t.onDelete,icon:3,accessibilityLabel:e.getStringOrUndefined(5),isDestructive:!0},c={text:a.i()?e.getString(121):e.getString(2),onClick:t.onDelete,icon:3,accessibilityLabel:e.getStringOrUndefined(41),isDestructive:!0},d={text:a.i()?e.getString(120):e.getString(1),onClick:t.onEdit,icon:6,accessibilityLabel:e.getStringOrUndefined(40)},l={text:e.getString(15),icon:1,onClick:t.onCancel,onKeyDown:(e,n)=>{n?Object(o.q)(e.key)===o.c.Enter&&t.onCancel(n):Object(r.i)().assertConditionTag(!1,"CommentPostInterface ref is undefined for cancelEditItem.",544477844)},accessibilityLabel:e.getStringOrUndefined(39),isCancelItem:!0,usePrimaryButtonStyling:!1,tooltipText:e.getString(15)},u={text:e.getString(15),onClick:()=>{},icon:0,accessibilityLabel:e.getString(15),isCancelItem:!0,tooltipText:e.getString(15)},p={text:e.getString(14),icon:24,onClick:e=>t.onCommit(e,s.a.CommitButton),onKeyDown:(e,n)=>{n?Object(o.q)(e.key)===o.c.Enter&&t.onCommit(n,s.a.CommitButton):Object(r.i)().assertConditionTag(!1,"CommentPostInterface ref is undefined for saveItem.",544477845)},accessibilityLabel:e.getStringOrUndefined(38),usePrimaryButtonStyling:!0,tooltipText:e.getString(173)},h=Object.assign(Object.assign({},p),{showDelayedSpinner:!0}),f={text:a.i()?e.getString(121):e.getString(2),onClick:t.onLowFidelityWarningConfirm,icon:3,accessibilityLabel:e.getStringOrUndefined(41),isDestructive:!0},m={text:e.getString(15),onClick:t.onLowFidelityWarningCancel,accessibilityLabel:e.getStringOrUndefined(43),icon:0,isCancelItem:!0},g={text:e.getString(37),onClick:t.onLowFidelityWarningConfirm,accessibilityLabel:e.getStringOrUndefined(42),icon:0};return{retry:n,deleteRootItem:i,cancelEditItem:l,cancelItem:u,cancelLowFidelityWarningDeleteItem:m,cancelLowFidelityWarningEditItem:{text:e.getString(15),icon:1,onClick:t.onLowFidelityWarningCancel,accessibilityLabel:e.getStringOrUndefined(39),isCancelItem:!0,tooltipText:e.getString(15)},deleteItem:c,deleteItemForLowFidelityWarningDelete:f,editItem:d,proceedItemForLowFidelityWarningEdit:g,saveItem:p,saveItemPending:h,linkToCommentMenuItem:{text:e.getString(207),onClick:t.onPresentLinkToComment,icon:25}}}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(1),o=r.createContext(void 0),i=function(){return r.useContext(o)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(8);var r=n(0),o=n(6),i=n(10);const a=(s={renderContextType:o.a.None,telemetryVisitor:Object(r.j)(r.g.ReviewedAsNotNecessary),trackback:595735680},Object(i.b)("",{},s));var s},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(77),o=n(30);const i=100;function a(e){return e===i}function s(e,t){const n=Object.assign({},t);Object(o.m)(n,e);const i=[];Object.keys(n).forEach(e=>{const t=n[e].assignee;Object(r.d)(t)||i.push(t)});const a=t?e.filter(e=>void 0===t[Object(o.i)(e)]):[...e];if(0!==i.length||0!==a.length)return{assigneesToAdd:i,assigneesToRemove:a}}},function(e,t,n){var r=n(401);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f}));var r=n(9),o=n(41),i=n(190),a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function s(e,t){return{background:e.white,bodyStandoutBackground:e.neutralLighterAlt,bodyFrameBackground:e.white,bodyFrameDivider:e.neutralLight,bodyText:e.neutralPrimary,bodyTextChecked:e.black,subText:e.neutralSecondary,bodyDivider:e.neutralLight,disabledBackground:t?e.neutralQuaternaryAlt:e.neutralLighter,disabledText:e.neutralTertiary,disabledBodyText:e.neutralTertiary,disabledSubtext:e.neutralQuaternary,disabledBodySubtext:e.neutralTertiaryAlt,focusBorder:e.neutralSecondary,variantBorder:e.neutralLight,variantBorderHovered:e.neutralTertiary,defaultStateBackground:e.neutralLighterAlt,errorText:t?"#ff5f5f":e.redDark,warningText:t?o.b.color.white:o.b.color.grey[20],errorBackground:t?"rgba(232, 17, 35, .5)":"rgba(245, 135, 145, .2)",blockingBackground:t?"rgba(234, 67, 0, .5)":"rgba(250, 65, 0, .2)",warningBackground:t?"rgba(255, 251, 0, .6)":"rgba(255, 200, 10, .2)",warningHighlight:t?"#fff100":"#ffb900",successBackground:t?"rgba(186, 216, 10, .4)":"rgba(95, 210, 85, .2)",inputBorder:e.neutralTertiary,inputBorderHovered:e.neutralPrimary,inputBackground:e.white,inputBackgroundChecked:e.themePrimary,inputBackgroundCheckedHovered:e.themeDarkAlt,inputForegroundChecked:e.white,inputFocusBorderAlt:e.themePrimary,smallInputBorder:e.neutralSecondary,inputText:e.neutralPrimary,inputTextHovered:e.neutralDark,inputPlaceholderText:e.neutralSecondary,buttonBackground:e.neutralLighter,buttonBackgroundChecked:e.neutralTertiaryAlt,buttonBackgroundHovered:e.neutralLight,buttonBackgroundCheckedHovered:e.neutralLight,buttonBackgroundPressed:e.neutralLight,buttonBackgroundDisabled:e.neutralLighter,buttonBorder:e.neutralSecondaryAlt,buttonText:t?e.black:e.neutralPrimary,buttonTextHovered:t?e.neutralPrimary:e.neutralDark,buttonTextChecked:e.neutralDark,buttonTextCheckedHovered:e.black,buttonTextPressed:e.neutralDark,buttonTextDisabled:e.neutralTertiary,buttonBorderDisabled:e.neutralLighter,buttonBorderFocused:e.neutralSecondaryAlt,primaryButtonBackground:e.themePrimary,primaryButtonBackgroundHovered:e.themeDarkAlt,primaryButtonBackgroundPressed:e.themeDark,primaryButtonBackgroundDisabled:e.neutralLighter,primaryButtonBorder:"transparent",primaryButtonBorderFocused:"transparent",primaryButtonText:e.white,primaryButtonTextHovered:e.white,primaryButtonTextPressed:e.white,primaryButtonTextDisabled:e.neutralQuaternary,accentButtonBackground:e.accent,accentButtonText:e.white,menuBackground:t?e.neutralLighter:e.white,menuDivider:e.neutralTertiaryAlt,menuIcon:t?e.themeDarkAlt:e.themePrimary,menuHeader:t?e.black:e.themePrimary,menuItemBackgroundHovered:t?e.neutralQuaternaryAlt:e.neutralLighter,menuItemBackgroundPressed:t?e.neutralQuaternary:e.neutralLight,menuItemText:e.neutralPrimary,menuItemTextHovered:e.neutralDark,listBackground:e.white,listText:e.neutralPrimary,listItemBackgroundHovered:e.neutralLighter,listItemBackgroundChecked:e.neutralLight,listItemBackgroundCheckedHovered:e.neutralQuaternaryAlt,listHeaderBackgroundHovered:e.neutralLighter,listHeaderBackgroundPressed:e.neutralLight,actionLink:e.neutralPrimary,actionLinkHovered:e.neutralDark,link:e.themePrimary,linkHovered:e.themeDarker,linkPressed:e.themeDark,defaultBackground:e.neutralLighter,defaultBorder:e.neutralSecondaryAlt,defaultContent:t?e.black:e.neutralPrimary,defaultIcon:t?e.black:e.neutralPrimary,defaultHoveredBackground:e.neutralLight,defaultHoveredBorder:e.neutralSecondaryAlt,defaultHoveredContent:t?e.neutralPrimary:e.neutralDark,defaultHoveredIcon:t?e.neutralPrimary:e.neutralDark,defaultFocusedBackground:e.neutralLight,defaultFocusedBorder:e.neutralSecondaryAlt,defaultFocusedContent:t?e.neutralPrimary:e.neutralDark,defaultFocusedIcon:t?e.neutralPrimary:e.neutralDark,defaultPressedBackground:e.neutralLight,defaultPressedBorder:e.neutralSecondaryAlt,defaultPressedContent:e.neutralDark,defaultPressedIcon:e.neutralDark,defaultDisabledBackground:e.neutralLighter,defaultDisabledBorder:e.neutralLighter,defaultDisabledContent:e.neutralTertiary,defaultDisabledIcon:e.neutralTertiary,ghostBackground:e.white,ghostBorder:e.white,ghostContent:e.neutralPrimary,ghostIcon:e.neutralPrimary,ghostHoveredBackground:e.neutralLighter,ghostHoveredBorder:e.neutralLighter,ghostHoveredContent:e.neutralDark,ghostHoveredIcon:e.neutralDark,ghostFocusedBackground:e.neutralLighter,ghostFocusedBorder:e.neutralSecondaryAlt,ghostFocusedContent:e.neutralDark,ghostFocusedIcon:e.neutralDark,ghostPressedBackground:e.neutralLight,ghostPressedBorder:e.neutralLight,ghostPressedContent:e.neutralDark,ghostPressedIcon:e.neutralDark,ghostDisabledBackground:e.white,ghostDisabledBorder:e.white,ghostDisabledContent:e.neutralTertiary,ghostDisabledIcon:e.neutralTertiary,brandedBackground:e.themePrimary,brandedBorder:e.themeDark,brandedContent:e.white,brandedIcon:e.white,brandedHoveredBackground:e.themeDarkAlt,brandedHoveredBorder:e.themeDarker,brandedHoveredContent:e.white,brandedHoveredIcon:e.white,brandedFocusedBackground:e.themeDarkAlt,brandedFocusedBorder:e.themeDarker,brandedFocusedContent:e.white,brandedFocusedIcon:e.white,brandedPressedBackground:e.themeDark,brandedPressedBorder:e.themeDarker,brandedPressedContent:e.white,brandedPressedIcon:e.white,brandedDisabledBackground:e.neutralLighter,brandedDisabledBorder:e.neutralLighter,brandedDisabledContent:e.neutralQuaternary,brandedDisabledIcon:e.neutralQuaternary,defaultCheckedBackground:e.neutralTertiaryAlt,defaultCheckedContent:e.neutralDark,defaultCheckedHoveredBackground:e.neutralLight,defaultCheckedHoveredContent:t?e.neutralPrimary:e.neutralDark,brandedCheckedBackground:e.neutralTertiaryAlt,brandedCheckedContent:e.neutralDark,brandedCheckedHoveredBackground:e.neutralLight,brandedCheckedHoveredContent:t?e.neutralPrimary:e.neutralDark,ghostCheckedBackground:e.neutralLight,ghostCheckedContent:e.black,ghostCheckedHoveredBackground:e.neutralLighter,ghostCheckedHoveredContent:e.neutralDark,ghostCheckedHoveredBorder:e.neutralDark,ghostSecondaryContent:e.neutralSecondary,ghostFocusedSecondaryContent:e.neutralSecondary,ghostHoveredSecondaryContent:e.neutralSecondary,ghostPressedSecondaryContent:e.neutralSecondary,brandedSecondaryContent:e.neutralLighterAlt,brandedFocusedSecondaryContent:e.neutralLighterAlt,brandedHoveredSecondaryContent:e.neutralLighterAlt,brandedPressedSecondaryContent:e.neutralLighterAlt,defaultDisabledSecondaryContent:e.neutralTertiary,defaultHoveredSecondaryContent:e.neutralTertiary,defaultPressedSecondaryContent:e.neutralTertiary,checkmarkColor:e.white,checkboxBackground:e.themePrimary,checkboxBackgroundDisabled:e.neutralLighter,checkboxBorderColor:e.neutralSecondaryAlt,personaActivityRing:e.white,personaActivityGlow:e.themePrimary}}var c={colors:a(a({},s({black:o.b.color.black,neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",white:o.b.color.white,red:o.b.color.red.primary,redDark:o.b.color.burgundy.primary,themeDarker:o.b.color.brand.shade40,themeDark:o.b.color.brand.shade20,themeDarkAlt:o.b.color.brand.shade10,themePrimary:o.b.color.brand.primary,themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:o.b.color.brand.tint40,themeLighter:o.b.color.brand.tint50,themeLighterAlt:o.b.color.brand.tint60,accent:o.b.color.brand.primary,blackTranslucent40:"rgba(0,0,0,.4)"})),Object(i.a)("light")),typography:function(){var e={sizes:{caption:o.b.font.size[100],secondary:o.b.font.size[200],body:o.b.font.size[300],subheader:o.b.font.size[400],header:o.b.font.size[500],hero:o.b.font.size[700],heroLarge:42},weights:{regular:o.b.font.weight.regular,semiBold:o.b.font.weight.semibold},families:{primary:"Segoe UI",secondary:"Segoe UI",cursive:"System",monospace:"System",sansSerif:"System",serif:"System"},variants:{captionStandard:{face:"primary",size:"caption",weight:"regular"},secondaryStandard:{face:"primary",size:"secondary",weight:"regular"},secondarySemibold:{face:"primary",size:"secondary",weight:"semiBold"},bodyStandard:{face:"primary",size:"body",weight:"regular"},bodySemibold:{face:"primary",size:"body",weight:"semiBold"},subheaderStandard:{face:"primary",size:"subheader",weight:"regular"},subheaderSemibold:{face:"primary",size:"subheader",weight:"semiBold"},headerStandard:{face:"primary",size:"header",weight:"regular"},headerSemibold:{face:"primary",size:"header",weight:"semiBold"},heroStandard:{face:"primary",size:"hero",weight:"regular"},heroSemibold:{face:"primary",size:"hero",weight:"semiBold"},heroLargeStandard:{face:"primary",size:"heroLarge",weight:"regular"},heroLargeSemibold:{face:"primary",size:"heroLarge",weight:"semiBold"}}};if("macos"===r.Platform.OS||"ios"===r.Platform.OS){e.families={primary:"System",secondary:"System",cursive:"System",monospace:"System",sansSerif:"System",serif:"System"}}if("win32"===r.Platform.OS){e.families={primary:"Segoe UI",secondary:"Segoe UI Semibold",cursive:"System",monospace:"System",sansSerif:"System",serif:"System"};e.variants={captionStandard:{face:"primary",size:"caption",weight:"regular"},secondaryStandard:{face:"primary",size:"secondary",weight:"regular"},secondarySemibold:{face:"secondary",size:"secondary",weight:"semiBold"},bodyStandard:{face:"primary",size:"body",weight:"regular"},bodySemibold:{face:"secondary",size:"body",weight:"semiBold"},subheaderStandard:{face:"primary",size:"subheader",weight:"regular"},subheaderSemibold:{face:"secondary",size:"subheader",weight:"semiBold"},headerStandard:{face:"primary",size:"header",weight:"regular"},headerSemibold:{face:"secondary",size:"header",weight:"semiBold"},heroStandard:{face:"primary",size:"hero",weight:"regular"},heroSemibold:{face:"secondary",size:"hero",weight:"semiBold"},heroLargeStandard:{face:"primary",size:"heroLarge",weight:"regular"},heroLargeSemibold:{face:"secondary",size:"heroLarge",weight:"semiBold"}}}return e}(),spacing:{s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"},components:{},host:{appearance:"light"}},d={colors:a(a({},s({themeDarker:"#82c7ff",themeDark:o.b.color.brand.tint30,themeDarkAlt:o.b.color.brand.tint20,themePrimary:o.b.color.brand.tint10,themeSecondary:o.b.color.brand.primary,themeTertiary:"#235a85",themeLight:o.b.color.brand.shade30,themeLighter:o.b.color.brand.shade50,themeLighterAlt:o.b.color.brand.shade60,black:o.b.color.white,neutralDark:"#faf9f8",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralSecondary:"#a19f9d",neutralSecondaryAlt:"#979693",neutralTertiary:"#797775",neutralTertiaryAlt:"#484644",neutralQuaternary:"#3b3a39",neutralQuaternaryAlt:"#323130",neutralLight:"#292827",neutralLighter:"#252423",neutralLighterAlt:"#201f1e",white:"#1b1a19",red:o.b.color.red.primary,accent:o.b.color.brand.primary,redDark:"#f1707b",blackTranslucent40:"rgba(0,0,0,.4)"},!0)),Object(i.a)("dark")),typography:c.typography,spacing:c.spacing,components:{},host:{appearance:"dark"}},l={colors:a({background:"#000000",bodyStandoutBackground:"#000000",bodyFrameBackground:"#000000",bodyFrameDivider:"#000000",bodyText:"#ffffff",bodyTextChecked:"#000000",subText:"#ffffff",bodyDivider:"#ffffff",disabledBackground:"#000000",disabledText:"#3ff23f",disabledBodyText:"#3ff23f",disabledSubtext:"#3ff23f",disabledBodySubtext:"#3ff23f",focusBorder:"#ffffff",variantBorder:"#ffffff",variantBorderHovered:"#ffffff",defaultStateBackground:"#000000",errorText:"#ffffff",warningText:"#ffffff",errorBackground:"#000000",blockingBackground:"#000000",warningBackground:"#000000",warningHighlight:"#ffffff",successBackground:"#000000",inputBorder:"#ffffff",inputBorderHovered:"#1aebff",inputBackground:"#000000",inputBackgroundChecked:"#1aebff",inputBackgroundCheckedHovered:"#1aebff",inputForegroundChecked:"#000000",inputFocusBorderAlt:"#ffffff",smallInputBorder:"#ffffff",inputText:"#ffffff",inputTextHovered:"#000000",inputPlaceholderText:"#ffffff",buttonBackground:"#000000",buttonBackgroundChecked:"#1aebff",buttonBackgroundHovered:"#1aebff",buttonBackgroundCheckedHovered:"#1aebff",buttonBackgroundPressed:"#1aebff",buttonBackgroundDisabled:"#000000",buttonBorder:"#ffffff",buttonText:"#ffffff",buttonTextHovered:"#000000",buttonTextChecked:"#000000",buttonTextCheckedHovered:"#000000",buttonTextPressed:"#000000",buttonTextDisabled:"#3ff23f",buttonBorderDisabled:"#3ff23f",buttonBorderFocused:"#ffffff",primaryButtonBackground:"#000000",primaryButtonBackgroundHovered:"#1aebff",primaryButtonBackgroundPressed:"#1aebff",primaryButtonBackgroundDisabled:"#000000",primaryButtonBorder:"#ffffff",primaryButtonBorderFocused:"#ffffff",primaryButtonText:"#ffffff",primaryButtonTextHovered:"#000000",primaryButtonTextPressed:"#000000",primaryButtonTextDisabled:"#3ff23f",accentButtonBackground:"#000000",accentButtonText:"#ffffff",menuBackground:"#000000",menuDivider:"#ffffff",menuIcon:"#ffffff",menuHeader:"#ffffff",menuItemBackgroundHovered:"#1aebff",menuItemBackgroundPressed:"#1aebff",menuItemText:"#ffffff",menuItemTextHovered:"#000000",listBackground:"#000000",listText:"#ffffff",listItemBackgroundHovered:"#1aebff",listItemBackgroundChecked:"#1aebff",listItemBackgroundCheckedHovered:"#1aebff",listHeaderBackgroundHovered:"#1aebff",listHeaderBackgroundPressed:"#1aebff",actionLink:"#ffff00",actionLinkHovered:"#ffffff",link:"#ffff00",linkHovered:"#ffffff",linkPressed:"#ffffff",defaultBackground:"#000000",defaultBorder:"#ffffff",defaultContent:"#ffffff",defaultIcon:"#ffffff",defaultHoveredBackground:"#1aebff",defaultHoveredBorder:"#1aebff",defaultHoveredContent:"#000000",defaultHoveredIcon:"#000000",defaultFocusedBackground:"#000000",defaultFocusedBorder:"#ffffff",defaultFocusedContent:"#ffffff",defaultFocusedIcon:"#ffffff",defaultPressedBackground:"#1aebff",defaultPressedBorder:"#1aebff",defaultPressedContent:"#000000",defaultPressedIcon:"#000000",defaultDisabledBackground:"#000000",defaultDisabledBorder:"#3ff23f",defaultDisabledContent:"#3ff23f",defaultDisabledIcon:"#3ff23f",ghostBackground:"#000000",ghostBorder:"#000000",ghostContent:"#ffffff",ghostIcon:"#ffffff",ghostHoveredBackground:"#1aebff",ghostHoveredBorder:"#1aebff",ghostHoveredContent:"#000000",ghostHoveredIcon:"#000000",ghostFocusedBackground:"#000000",ghostFocusedBorder:"#ffffff",ghostFocusedContent:"#ffffff",ghostFocusedIcon:"#ffffff",ghostPressedBackground:"#1aebff",ghostPressedBorder:"#1aebff",ghostPressedContent:"#000000",ghostPressedIcon:"#000000",ghostDisabledBackground:"#000000",ghostDisabledBorder:"#000000",ghostDisabledContent:"#3ff23f",ghostDisabledIcon:"#3ff23f",brandedBackground:"#000000",brandedBorder:"#ffffff",brandedContent:"#ffffff",brandedIcon:"#ffffff",brandedHoveredBackground:"#1aebff",brandedHoveredBorder:"#1aebff",brandedHoveredContent:"#000000",brandedHoveredIcon:"#000000",brandedFocusedBackground:"#000000",brandedFocusedBorder:"#ffffff",brandedFocusedContent:"#ffffff",brandedFocusedIcon:"#ffffff",brandedPressedBackground:"#1aebff",brandedPressedBorder:"#1aebff",brandedPressedContent:"#000000",brandedPressedIcon:"#000000",brandedDisabledBackground:"#000000",brandedDisabledBorder:"#3ff23f",brandedDisabledContent:"#3ff23f",brandedDisabledIcon:"#3ff23f",defaultCheckedBackground:"#1aebff",defaultCheckedContent:"#000000",defaultCheckedHoveredBackground:"#1aebff",defaultCheckedHoveredContent:"#000000",brandedCheckedBackground:"#1aebff",brandedCheckedContent:"#000000",brandedCheckedHoveredBackground:"#1aebff",brandedCheckedHoveredContent:"#000000",ghostCheckedBackground:"#1aebff",ghostCheckedContent:"#000000",ghostCheckedHoveredBackground:"#1aebff",ghostCheckedHoveredContent:"#000000",ghostCheckedHoveredBorder:"#000000",ghostSecondaryContent:"#ffffff",ghostFocusedSecondaryContent:"#ffffff",ghostHoveredSecondaryContent:"#000000",ghostPressedSecondaryContent:"#000000",brandedSecondaryContent:"#ffffff",brandedFocusedSecondaryContent:"#ffffff",brandedHoveredSecondaryContent:"#000000",brandedPressedSecondaryContent:"#000000",defaultDisabledSecondaryContent:"#ffffff",defaultHoveredSecondaryContent:"#000000",defaultPressedSecondaryContent:"#000000",checkmarkColor:"#ffffff",checkboxBackground:"#000000",checkboxBackgroundDisabled:"#000000",checkboxBorderColor:"#ffffff",personaActivityRing:"#ffffff",personaActivityGlow:"transparent"},Object(i.a)("highContrast")),typography:c.typography,spacing:c.spacing,components:{},host:{appearance:"highContrast"}},u=n(300),p=n(281),h=n.n(p);function f(e){void 0===e&&(e={});var t=new u.a({},(function(){var t=Object(i.b)(e.appearance,e.defaultAppearance||"light");switch(t){case"light":return c;case"dark":return d;case"highContrast":return l;default:h()(t)}}));return r.Appearance&&"dynamic"===e.appearance&&r.Appearance.addChangeListener((function(){t.invalidate()})),t}},function(e,t,n){"use strict";var r=n(132),o=n(116);var i=function(e){return Object(o.a)(e)&&"[object Arguments]"==Object(r.a)(e)},a=Object.prototype,s=a.hasOwnProperty,c=a.propertyIsEnumerable,d=i(function(){return arguments}())?i:function(e){return Object(o.a)(e)&&s.call(e,"callee")&&!c.call(e,"callee")};t.a=d},function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));n(8);var r=n(0),o=n(45),i=n(68),a=n(86),s=n(63),c=n(80),d=n(6),l=n(142),u=n(60),p=n(240),h=n(25),f=n(21),m=n(85),g=n(61),b=n(2),C=n(7),y=n(19),v=n(5),T=n(33),S=n(10),I=n(22),O=n(257),E=n(258),P=n(159),k=n(270),R=n(202),x=n(181);function D(e,t,n,D,w){return(A,j)=>{const _=j(),F=Object(r.i)().createActivityObject("RequestInitCommentSession",e.telemetryVisitor,r.a.None,r.b.NecessaryServiceDataEvent),M=a.b[n.sessionType];return F.addDataField("SessionType",M,r.d.SystemMetadata),F.addDataField("Trackback",e.trackback,r.d.SystemMetadata),F.addDataField("RenderContextType",e.renderContextType,r.d.SystemMetadata),F.addDataField("PaneVisibilityState",T.e(_),r.d.SystemMetadata),b.b()||n.sessionType!==i.c?(v.n(_).atMention===o.b.Enabled&&Object(p.a)().catch(Object(h.a)(591397600)),A(Object(R.a)(e,I.a.SharedComments,a.c(n))).catch(e=>(Object(h.a)(591397602)(e),{draftDiscardResult:o.g.Unhandled,draftDiscardBehavior:c.a.CannotAutoDiscard})).then(o=>{var i,c;F.addDataField("DraftDiscardBehavior",o.draftDiscardBehavior,r.d.SystemMetadata);const p=j(),h=v.h(p);if(Object(y.d)(h)||v.g(p)&&a.d(n))return F.addDataField("SessionAlreadyRequested",!0,r.d.SystemMetadata),F.addDataField("DraftRenderContextType",null!==(c=null===(i=Object(C.K)(h))||void 0===i?void 0:i.renderContextType)&&void 0!==c?c:d.a.None,r.d.SystemMetadata),F.successTag(591397633),Promise.resolve(A(P.a));F.addDataField("SessionAlreadyRequested",!1,r.d.SystemMetadata),A(Object(k.a)(Object(S.a)(e,591397634),n,D));return t.beginDraftingAsync(n).then(t=>{if(void 0===t.sessionConfiguration)throw new f.a(g.e,589103630,-2130957532);a.d(n)&&b.A()&&A(Object(x.a)(Object(S.a)(e,591397635),[],[],w,t.author)),F.addDataField("DraftId",t.sessionConfiguration.draftId,r.d.SystemMetadata);const o=j(),i=function(e,t,n){if(t!==s.a.Closed&&e!==d.a.DiscreteIsolated)return Object(l.a)(n);if(!Object(u.c)(e))return e;if(b.m()&&t===s.a.Closed)return d.a.None;return Object(l.a)(n)}(e.renderContextType,T.e(o),T.d(o).containerType);return F.addDataField("DraftRenderContextType",i,r.d.SystemMetadata),Object(r.i)().assertConditionTag(i===e.renderContextType||e.renderContextType===d.a.None,`Requested starting a draft in RenderContextType:${e.renderContextType} but had to lock to RenderContextType:${i} based on pane state`,554714642),F.successTag(591397640),A(Object(E.a)(Object(S.a)(e,591397641),t,i))}).catch(t=>((t.message||t).includes("LegacyConvertDialog")?F.successTag(591397643):F.failTag(591397642,Object(m.a)(t)),A(Object(O.a)(Object(S.a)(e,591397644),n,t))))})):(F.failTag(591397599,-2130957513),Promise.resolve(A(P.a)))}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return h}));var r=n(8),o=n(0),i=n(39),a=n(18),s=n(82),c=n(17),d=n(5),l=n(10),u=n(62);function p(e,t,n,p){return(h,f)=>{h(Object(l.b)("SELECT_COMMENT",n,t));const m=f(),g=Object(d.r)(m);return p&&g&&g.selectedCardId===n.selectedCard&&(n.selectType!==u.a.SelectPost||Object(c.j)(g.selectionDetails)&&g.selectionDetails.selectedPostId===n.selectedPost)?e?new Promise(n=>setTimeout(()=>{let l;if(Object(c.j)(g.selectionDetails))l={componentType:a.a.Post,id:g.selectionDetails.selectedPostId,renderContextType:t.renderContextType};else{const e=Object(d.h)(m).drafts[g.selectedCardId],n=!!e&&"CREATE"===e.commentDraft.sessionConfiguration.sessionType;l={componentType:Object(i.b)(n),id:g.selectedCardId,renderContextType:t.renderContextType}}const u=e.getComponentById(l);u?(s.a&&Object(r.i)(`Focusing comment ${l.id} with render context type ${l.renderContextType} after selection.`),u.focus()):Object(o.i)().assertConditionTag(!1,"Couldn't find focus target after select: "+JSON.stringify(l),590104655),n()})):(Object(o.i)().assertConditionTag(!1,"Expected componentTree to be set",579744148),Promise.resolve()):Promise.resolve()}}function h(e,t,n){return Object.assign({selectedCard:e,source:t},n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(126),o=n.n(r),i=n(47),a=n.n(i);function s(e,t,n,r,i,s,c){var d=t(e);if(0===d)return i;var l=c.offset,u=c.velocity,p=c.visibleLength,h=Math.max(0,l),f=h+p,m=(r-1)*p,g=u>1?"after":u<-1?"before":"none",b=Math.max(0,h-.5*m),C=Math.max(0,f+.5*m);if(s(d-1).offset<b)return{first:Math.max(0,d-1-n),last:d-1};var y=function(e,t,n){for(var r=[],o=0,i=0;i<t;i++)for(var s=n(i),c=s.offset+s.length,d=0;d<e.length;d++)if(null==r[d]&&c>=e[d]&&(r[d]=i,o++,d===e.length-1))return a()(o===e.length,"bad offsets input, should be in increasing order: %s",JSON.stringify(e)),r;return r}([b,h,f,C],d,s),v=o()(y,4),T=v[0],S=v[1],I=v[2],O=v[3];T=null==T?0:T,O=null==O?d-1:O;for(var E={first:S=null==S?Math.max(0,T):S,last:I=null==I?Math.min(O,S+n-1):I},P=function(e,t){return t.last-t.first+1-Math.max(0,1+Math.min(t.last,e.last)-Math.max(t.first,e.first))}(i,E);!(S<=T&&I>=O);){var k=P>=n,R=S<=i.first||S>i.last,x=S>T&&(!k||!R),D=I>=i.last||I<i.first,w=I<O&&(!k||!D);if(k&&!x&&!w)break;!x||"after"===g&&w&&D||(R&&P++,S--),!w||"before"===g&&x&&R||(D&&P++,I++)}if(!(I>=S&&S>=0&&I<d&&S>=T&&I<=O&&S<=E.first&&I>=E.last))throw new Error("Bad window calculation "+JSON.stringify({first:S,last:I,itemCount:d,overscanFirst:T,overscanLast:O,visible:E}));return{first:S,last:I}}function c(e,t){return"object"==typeof e&&null!=(null==e?void 0:e.key)?e.key:"object"==typeof e&&null!=(null==e?void 0:e.id)?e.id:String(t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return Ci})),n.d(t,"c",(function(){return tc})),n.d(t,"b",(function(){return rc}));var r={};n.r(r),n.d(r,"requiredEvents",(function(){return Qa})),n.d(r,"rsdEvents",(function(){return Xa}));var o=n(109),i=n(1),a=n(89),s=n(47),c=n.n(s),d=function(e){return"function"==typeof e},l=function(e){return e},u=function(e){return null===e};function p(e,t,n){void 0===t&&(t=l),c()(d(t)||u(t),"Expected payloadCreator to be a function, undefined or null");var r=u(t)||t===l?l:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return e instanceof Error?e:t.apply(void 0,[e].concat(r))},o=d(n),i=e.toString(),a=function(){var t=r.apply(void 0,arguments),i={type:e};return t instanceof Error&&(i.error=!0),void 0!==t&&(i.payload=t),o&&(i.meta=n.apply(void 0,arguments)),i};return a.toString=function(){return i},a}var h=n(3),f={},m={};function g(e,t){f[e]=t}var b=void 0;function C(e,t){return function(n){return function(n){return function(r){var o=r,i=f[o.type],a=m[o.type],s=t.eventNames&&t.eventNames[o.type];if(Boolean(void 0!==i||s)){var c=i&&void 0!==o.payload?i(o.payload,t):void 0;if(null!==c){var d=function(e){if(!e)return[void 0,void 0];var t=e.logger;return[Object(h.f)(e,["logger"]),t]}(c),l=d[0],u=d[1],p=a&&o.meta&&o.meta.metaPayload?a(o.meta.metaPayload,t):{},g=Object(h.a)(Object(h.a)({},l),p);b&&b(g);var C=o.meta&&o.meta.featureName||"None",y=o.meta&&o.meta.exportOptions||void 0;(u||e).logTrace({eventId:s||o.type,featureName:C,exportOptions:y,properties:g})}}return n(r)}}}}function y(e,t){return g(e,t.getLogProperties||null),p(e,(function(e){return e}),(function(){return{featureName:t.featureName,exportOptions:t.exportOptions||null}}))}const v=y("AdditionalSuggestionsRequestedAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"AdditionalSuggestionsRequested"}}),T=y("QueryChangedAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"QueryChange"},getLogProperties:e=>({queryLength:e.query.length.toString()})}),S=y("QueryFinishedAction",{featureName:"NoLogging"}),I=y("PickerDismissedAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"DismissPicker"},getLogProperties:e=>({dismissalReason:e.dismissalReason,queryLength:e.queryLength.toString(),suggestionsShown:e.suggestionsShown.toString()})}),O=(y("SuggestionListShownAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"SuggestionListShown"}}),y("SuggestionPressedAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"PressPerson"},getLogProperties:e=>({suggestionSource:e.suggestionSource,suggestionOrigin:e.suggestionOrigin,queryLength:e.queryLength.toString(),suggestionsShown:e.suggestionsShown.toString(),pickedSuggestionIndex:e.pickedSuggestionIndex.toString()})}));function E(e,t){return t}var P=n(211),k=n(117),R=n(163),x=n(75),D=k.a?k.a.isConcatSpreadable:void 0;var w=function(e){return Object(x.a)(e)||Object(R.a)(e)||!!(D&&e&&e[D])};var A=function e(t,n,r,o,i){var a=-1,s=t.length;for(r||(r=w),i||(i=[]);++a<s;){var c=t[a];n>0&&r(c)?n>1?e(c,n-1,r,o,i):Object(P.a)(i,c):o||(i[i.length]=c)}return i};var j=function(e){return(null==e?0:e.length)?A(e,1):[]};function _(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}function F(){for(var e=_(),t=0,n="",r=0;r<36;r++)switch(r){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[r-t]%4+8).toString(16);break;default:n+=(e[r-t]%16).toString(16)}return n}var M=Object.prototype.hasOwnProperty;function N(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}var L=n(123),B=function(){try{var e=Object(L.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var H=function(e,t,n){"__proto__"==t&&B?B(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},U=n(149),V=Object.prototype.hasOwnProperty;var W=function(e,t,n){var r=e[t];V.call(e,t)&&Object(U.a)(r,n)&&(void 0!==n||t in e)||H(e,t,n)};var z=function(e,t,n,r){var o=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var s=t[i],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),o?H(n,s,c):W(n,s,c)}return n};var K=function(e){return e};var G=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},q=Math.max;var $=function(e,t,n){return t=q(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=q(r.length-t,0),a=Array(i);++o<i;)a[o]=r[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=r[o];return s[t]=n(a),G(e,this,s)}};var Y=function(e){return function(){return e}},J=B?function(e,t){return B(e,"toString",{configurable:!0,enumerable:!1,value:Y(t),writable:!0})}:K,Q=Date.now;var X=function(e){var t=0,n=0;return function(){var r=Q(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(J);var Z=function(e,t){return X($(e,t,K),e+"")},ee=n(121),te=n(174),ne=n(97);var re=function(e,t,n){if(!Object(ne.a)(n))return!1;var r=typeof t;return!!("number"==r?Object(ee.a)(n)&&Object(te.a)(t,n.length):"string"==r&&t in n)&&Object(U.a)(n[t],e)};var oe=function(e){return Z((function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&re(n[0],n[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++r<o;){var s=n[r];s&&e(t,s,r,i)}return t}))},ie=n(175),ae=n(184),se=Object.prototype.hasOwnProperty,ce=oe((function(e,t){if(Object(ie.a)(t)||Object(ee.a)(t))z(t,Object(ae.a)(t),e);else for(var n in t)se.call(t,n)&&W(e,n,t[n])}));function de(e){return"string"==typeof e?Object.keys(e.split("")):"number"==typeof e||"boolean"==typeof e?[]:Object.keys(e)}function le(e,t){if(null==e)return e;for(var n={},r=0,o=de(e);r<o.length;r++){var i=o[r];t(e[i])&&(n[i]=e[i])}return n}function ue(e,t){return ce({},e,t)}function pe(e,t){return e.hasOwnProperty(t)}function he(e){return"object"==typeof e&&!!e&&pe(e,"family")&&pe(e,"code")&&"string"==typeof e.family&&"number"==typeof e.code}var fe="undefined"!=typeof window&&window.performance;function me(){if(!(fe&&fe.mark&&Math&&Math.random))return"";var e="Midgard Mark ".concat(Math.random());return fe.mark(e),e}var ge="ClientScenario",be="Feature",Ce="StatusCode",ye="RequestId",ve="RetryAttemptedAfterAuthFailure",Te="RetryLimitExceeded",Se="midgardError";function Ie(e){var t,n,r,o,i=e.scenarioName,a=e.featureName,s=e.operation,c=e.monitorStarter,d=e.requestId,l=e.extraProps,u=e.extraLogPropsOnFinish,p=e.successAction,f=e.errorAction,m=e.treatAsSuccessCondition,g=e.treatAsExpectedError,b=e.skipTrace,C=Object(h.a)(Object(h.a)(Object(h.a)({},l),((t={})[be]=a,t)),d?((n={})[ye]=d,n):{}),y=b?void 0:(r="🚀 data call : ".concat(i),o=me(),{stop:function(){try{fe&&fe.measure&&fe.measure(r,o)}catch(e){}}}),v=c.startMonitor(i,a,C),T="function"==typeof u?{success:u,failure:u}:u,S=s();return S.then((function(e){return null==y||y.stop(),e})).then((function(e){return Oe({monitor:v,result:e,extraProps:Object(h.a)(Object(h.a)({},C),null==T?void 0:T.success(e)),successAction:p})}),(function(e){return function(e){var t,n,r,o,i=e.monitor,a=e.failure,s=e.extraProps,c=e.successAction,d=e.errorAction,l=e.treatAsSuccessCondition,u=e.treatAsExpectedError,p=Object(h.a)(Object(h.a)(Object(h.a)(Object(h.a)(Object(h.a)({},s),a&&a.statusCode?((t={})[Ce]=a.statusCode.toString(),t):{}),a&&he(a.midgardError)?((n={})[Se]=a.midgardError,n):{}),a&&a.retryAttemptedAfterAuthFailure?((r={})[ve]=a.retryAttemptedAfterAuthFailure.toString(),r):{}),a&&a.retryLimitExceeded?((o={})[Te]=a.retryLimitExceeded.toString(),o):{});if(l&&l(a))return void Oe({monitor:i,result:void 0,extraProps:p,successAction:c});a&&a.isExpected||u&&u(a)?i.expectedFailure(a.qosTagId,p):i.unexpectedFailure(a?a.qosTagId:"Unknown",p);d&&d(a)}({monitor:v,failure:e,extraProps:Object(h.a)(Object(h.a)({},C),null==T?void 0:T.failure(e)),successAction:p,errorAction:f,treatAsSuccessCondition:m,treatAsExpectedError:g})})).catch((function(e){v.unexpectedFailure("FailedDispatch",{Error:e.toString(),featureName:a})})),S}function Oe(e){var t=e.monitor,n=e.result,r=e.extraProps,o=e.successAction;t.success(void 0,r),o&&o(n,r)}function Ee(e,t){return y(e,{featureName:t,getLogProperties:function(e,t){return t.logDataScenarioActions?{}:null}})}function Pe(e,t,n){return{success:function(r){return Object(h.a)(Object(h.a)(Object(h.a)({},e.success&&e.success(r)),e.fromParameters&&e.fromParameters(n)),e.fromOptions&&e.fromOptions(t))},failure:function(r){return Object(h.a)(Object(h.a)(Object(h.a)({},e.failure&&e.failure(r)),e.fromParameters&&e.fromParameters(n)),e.fromOptions&&e.fromOptions(t))}}}function ke(e,t,n){var r=this,o=Ee("".concat(t,"StartedAction"),"DataLoadStartAction"),i=Ee("".concat(t,"SucceededAction"),e),a=Ee("".concat(t,"FailedAction"),e),s=Ee("".concat(t,"ResetAction"),e);return{fetch:function(e,t,s){return Object(h.b)(r,void 0,void 0,(function(){var r,c,d,l,u,p,f,m;return Object(h.d)(this,(function(h){switch(h.label){case 0:r=e.dispatch,c=e.clientScenario,d=e.processResponse,l=F(),r(o({storeKey:t,requestId:l,parameters:s,timestamp:Date.now()})),h.label=1;case 1:return h.trys.push([1,6,,7]),[4,n(e,{requestId:l,storeKey:t,clientScenario:c},s)];case 2:return u=h.sent(),d?[4,d(u)]:[3,4];case 3:return p=h.sent(),[3,5];case 4:p=u,h.label=5;case 5:return f={storeKey:t,requestId:l,parameters:s,response:p,timestamp:Date.now()},r(i(f)),[2,f];case 6:throw m=h.sent(),r(a({storeKey:t,requestId:l,parameters:s,error:Re(m),timestamp:Date.now()})),m;case 7:return[2]}}))}))},startAction:o,successAction:i,errorAction:a,resetAction:s,scenarioName:t}}function Re(e){var t,n,r,o,i;return e?"string"==typeof e?r=e:("boolean"==typeof e.isExpected&&(t=e.isExpected),"string"==typeof e.qosTagId&&(n=e.qosTagId),"string"==typeof e.message&&(r=e.message),"number"==typeof e.statusCode&&(o=e.statusCode),"string"==typeof e.responseText&&(i=e.responseText)):r=e+"",{qosTagId:n,isExpected:t,message:r,statusCode:o,responseText:i}}function xe(e){var t=this,n=[];return Object(h.a)(Object(h.a)({},e),{fetch:function(r,o,i){var a=JSON.stringify({storeKey:o,parameters:i}),s=n.find((function(e){return a===e.key&&function(e,t){if(N(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var o=0;o<n.length;o++)if(!M.call(t,n[o])||!N(e[n[o]],t[n[o]]))return!1;return!0}(r,e.options)}));if(s&&s.promise)return s.promise;var c=Object(h.b)(t,void 0,void 0,(function(){var t;return Object(h.d)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,,2,3]),[4,e.fetch(r,o,i)];case 1:return[2,a.sent()];case 2:return t=n.indexOf(d),n.splice(t,1),[7];case 3:return[2]}}))})),d={options:r,promise:c,key:a};return n.push(d),c}})}function De(e,t,n,r){if(!t.length)return e;var o=Object(h.a)({},e),i=!1;return t.forEach((function(e,t){var a=r(e,t),s=n(e,t,a);o[s]!==a&&(o[s]=a,i=!0)})),i?o:e}var we={create:function(e){var t={};if(null==e)return t;if(e instanceof Array)for(var n=0;n<e.length;n++){var r=e[n];t[r[0]]=r[1]}else Object.keys(e).forEach((function(n){t[n]=e[n]}));return t},map:function(e,t){if(!e)return e;var n={},r=!1;return Object.keys(e).forEach((function(o){var i=e[o],a=t(o,i,e);n[o]=a,r=r||a!==i})),r?n:e},filter:function(e,t){if(!e)return e;var n={},r=!1;return Object.keys(e).forEach((function(o){var i=e[o];t(o,i,e)?n[o]=i:r=!0})),r?n:e},get:function(e,t){if(e)return e[t]},insert:function(e,t,n){if(e&&e[t]===n)return e;var r=Object(h.a)({},e);return r[t]=n,r},insertArray:function(e,t,n){return De(e,t,n,(function(e){return e}))},insertArrayWith:De,remove:function(e,t){if(!e)return e;if(!(t in e))return e;var n=Object(h.a)({},e);return delete n[t],n},replace:function(e,t,n){var r=e?Object(h.a)({},e):{};return r[t]=n(r[t]),r},replaceMany:function(e,t,n){if(t.length){var r=Object(h.a)({},e);return t.forEach((function(e){r[e]=n(r[e],e)})),r}return e},keys:function(e){return e?Object.keys(e):[]},values:function(e){var t=[];return e&&Object.keys(e).forEach((function(n){var r=e[n];t.push(r)})),t},entries:function(e){var t=[];return e&&Object.keys(e).forEach((function(n){var r=e[n];t.push([n,r])})),t}},Ae=function(e){return e!=e};function je(e,t){if(e===t)return!0;if(Ae(e)&&Ae(t))return!0;if(!e||!t)return!1;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!je(e[n],t[n]))return!1;return!0}if(Array.isArray(e)||Array.isArray(t))return!1;if("[object Date]"===Object.prototype.toString.call(e)&&"[object Date]"===Object.prototype.toString.call(t))return e.getTime()===t.getTime();if("object"==typeof e&&"object"==typeof t){for(var r=0,o=Object.keys(e);r<o.length;r++){if(!je(e[s=o[r]],t[s]))return!1}for(var i=0,a=Object.keys(t);i<a.length;i++){var s;if(!((s=a[i])in e))return!1}return!0}return!1}var _e,Fe,Me;y("ReduxStateJanitorStartedAction",{featureName:"NoLogging"});function Ne(){var e={},t={};return{handlePayload:function(n,r){var o=n.toString();if(e[o]||t[o])throw new Error("Already handling an action type named ".concat(o));return e[o]=r,this},handleAction:function(n,r){var o=n.toString();if(e[o]||t[o])throw new Error("Already handling an action type named ".concat(o));return t[o]=r,this},done:function(n,r){var o=Object(h.a)({},e),i=Object(h.a)({},t);return function(e,t){if(void 0===e&&(e=n),"ReduxStateJanitorStartedAction"===t.type)return r?r(e):n;var a=o[t.type];if(a)e=a(e,t.payload);else{var s=i[t.type];s&&(e=s(e,t))}return e}}}}var Le=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},Be="undefined"!=typeof console?console:void 0,He={trace:(null!==(_e=null==Be?void 0:Be.trace)&&void 0!==_e?_e:Le).bind(Be),warn:(null!==(Fe=null==Be?void 0:Be.warn)&&void 0!==Fe?Fe:Le).bind(Be),table:(null!==(Me=null==Be?void 0:Be.table)&&void 0!==Me?Me:Le).bind(Be)},Ue=n(349),Ve="undefined"!=typeof __WHY_DID_YOU_RECOMPUTE__&&__WHY_DID_YOU_RECOMPUTE__||"undefined"!=typeof globalThis&&globalThis.__WHY_DID_YOU_RECOMPUTE__,We={empty:!0},ze={},Ke="undefined"==typeof WeakMap?null:WeakMap,Ge=function(e,t){if(void 0===t&&(t=100),!Ke)return e;var n=$e(),r=0,o=0,i=Ve?new Map:void 0,a=Ve?new Error("Memoized function defined").stack:"";return function(){for(var s,c,d,l,u=[],p=0;p<arguments.length;p++)u[p]=arguments[p];var f=n;(0!==o||t>0&&r>t)&&(n=$e(),r=0,o=0,null==i||i.clear()),f=n;for(var m=function(e){var t=qe(u[e]);if(!(null===(s=f.map)||void 0===s?void 0:s.has(t))&&(null===(c=f.map)||void 0===c||c.set(t,$e()),Ve&&i)){var n=null!==(d=i.get(f))&&void 0!==d?d:[],r=n.filter((function(e){return e!==t&&Object(Ue.a)(e,t)}))[0];if(r){He.warn("Why-did-you-recompute: Identical (deep-comparison) past arguments to memoizeFunction found with differing instance equality: ");var o=new Error("Indentical argument passed").stack,p=function(e,t){He.table(e),Object.keys(e).forEach((function(n){var r=e[n],o=t[n];r!==o&&Object(Ue.a)(r,o)&&(He.warn("Duplication present in child prop '".concat(n,"'")),p(r,o))}))};p(r,t),He.warn(o),He.warn(a)}i.set(f,Object(h.g)(Object(h.g)([],Object(h.e)(n),!1),[t],!1))}f=null===(l=f.map)||void 0===l?void 0:l.get(t)},g=0;g<u.length;g++)m(g);return f.hasOwnProperty("value")||(f.value=e.apply(void 0,Object(h.g)([],Object(h.e)(u),!1)),r++),f.value}};function qe(e){return e?"object"==typeof e||"function"==typeof e?e:(ze[e]||(ze[e]={val:e}),ze[e]):We}function $e(){return{map:Ke?new Ke:null}}var Ye=Object.keys;var Je=n(92);function Qe(e,t){var n=e.name;return Object(Je.createSelector)((function(t){return we.get(t.stores,n)||e.initialState}),(function(e){return function(e){var t,n,r={};try{for(var o=Object(h.h)(Ye(e)),i=o.next();!i.done;i=o.next()){var a=i.value,s=e[a];r[a]="function"==typeof s?Ge(s.bind(r)):s}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}(t(e))}))}function Xe(e,t,n){var r=t(void 0,{type:void 0});return{name:e,initialState:r,reducer:t,getSelectors:Qe({name:e,initialState:r},n)}}var Ze=function(e){return t={getLatestSuccess:function(t){var n=we.get(e,t.key);return n&&n.response||void 0},getLatestSuccessWithTimestamp:function(t){var n=we.get(e,t.key);return{response:n&&n.response||void 0,timestamp:n&&n.successTimestamp||0}},getLatestError:function(t){var n=we.get(e,t.key);return n&&n.error||void 0}},n=function(t){var n=we.get(e,t.key);return{isLoading:Boolean(null==n?void 0:n.isCallInProgress),hasError:Boolean(null==n?void 0:n.error),hasLoadedPreviously:Boolean(null==n?void 0:n.response)}},Object(h.a)({isLoading:function(e){var t=n(e);return!!t&&t.isLoading&&(!t.hasLoadedPreviously||t.hasError)},isCallInProgress:function(e){var t=n(e);return!!t&&t.isLoading},hasError:function(e){var t=n(e);return!!t&&t.hasError},hasLoaded:function(e){var t=n(e);return!!t&&(t.hasLoadedPreviously||t.hasError)},hasLoadedPreviously:function(e){var t=n(e);return!!t&&t.hasLoadedPreviously},hasStartedPreviously:function(e){var t=n(e);return!!t&&(t.isLoading||t.hasLoadedPreviously||t.hasError)}},t);var t,n},et={hasStarted:!1,response:null,error:null,isCallInProgress:!1,successTimestamp:0};function tt(e,t){return je(e.response,t.response)?e.response:t.response}function nt(e,t,n){void 0===n&&(n=tt);var r=function(e){return function(t,n){var r=n.payload.storeKey.key,o=we.get(t,r)||et,i=e(o,n.payload);return o.isCallInProgress===i.isCallInProgress&&o.response===i.response&&je(o.error,i.error)||(t=we.insert(t,r,i)),t}},o=r((function(e,t){return Object(h.a)(Object(h.a)({},e),{isCallInProgress:!0,hasStarted:!0})})),i=r((function(e,t){return Object(h.a)(Object(h.a)({},e),{isCallInProgress:!1,error:Object(h.a)(Object(h.a)({},t.error),{requestId:t.requestId})})})),a=r((function(e,t){return Object(h.a)(Object(h.a)({},e),{isCallInProgress:!1,response:n(e,t),error:null,successTimestamp:t.timestamp})})),s=r((function(e,t){return Object(h.a)(Object(h.a)({},e),{isCallInProgress:!1,response:null,error:null})}));return Xe(e,Ne().handleAction(t.startAction,o).handleAction(t.errorAction,i).handleAction(t.successAction,a).handleAction(t.resetAction,s).done(null),Ze)}const rt=function(e,t,n,r){var o=this;return ke(e,t,(function(i,a,s){return Object(h.b)(o,void 0,void 0,(function(){var o,c,d,l,u,p,f;return Object(h.d)(this,(function(h){return o=i.monitorStarter,c=i.treatAsExpectedError,d=i.clientScenario,l=a.requestId,u=a.storeKey,p=function(){return n(i,{requestId:l,storeKey:u,clientScenario:d},s)},[2,Ie({scenarioName:t,featureName:e,requestId:l,monitorStarter:o,extraProps:d?(f={},f[ge]=d,f):void 0,treatAsExpectedError:c,extraLogPropsOnFinish:r&&Pe(r,i,s),operation:p})]}))}))}))}("PickerHostAppSuggestions","GetHostAppSuggestions",(e,t,n)=>n.getHostAppSuggestions(n.query,n.options),{success:e=>({responseLength:e?e.length.toString():"0"}),fromParameters:e=>{var t,n;return{queryLength:(null===(t=e.query)||void 0===t?void 0:t.length.toString())||"0",didSearchDirectory:(null===(n=e.options)||void 0===n?void 0:n.searchDirectory)||"false"}}}),ot=nt("HostAppSuggestionsStore",rt);var it=n(189),at=n(220);var st=function(e,t,n,r){var o=n.length,i=o,a=!r;if(null==e)return!i;for(e=Object(e);o--;){var s=n[o];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<i;){var c=(s=n[o])[0],d=e[c],l=s[1];if(a&&s[2]){if(void 0===d&&!(c in e))return!1}else{var u=new it.a;if(r)var p=r(d,l,c,e,t,u);if(!(void 0===p?Object(at.a)(l,d,3,r,u):p))return!1}}return!0};var ct=function(e){return e==e&&!Object(ne.a)(e)};var dt=function(e){for(var t=Object(ae.a)(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,ct(o)]}return t};var lt=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}};var ut=function(e){var t=dt(e);return 1==t.length&&t[0][2]?lt(t[0][0],t[0][1]):function(n){return n===e||st(n,e,t)}},pt=n(132),ht=n(116);var ft=function(e){return"symbol"==typeof e||Object(ht.a)(e)&&"[object Symbol]"==Object(pt.a)(e)},mt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gt=/^\w*$/;var bt=function(e,t){if(Object(x.a)(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ft(e))||(gt.test(e)||!mt.test(e)||null!=t&&e in Object(t))},Ct=n(203);function yt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(yt.Cache||Ct.a),n}yt.Cache=Ct.a;var vt=yt;var Tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,St=/\\(\\)?/g,It=function(e){var t=vt(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Tt,(function(e,n,r,o){t.push(r?o.replace(St,"$1"):n||e)})),t}));var Ot=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o},Et=k.a?k.a.prototype:void 0,Pt=Et?Et.toString:void 0;var kt=function e(t){if("string"==typeof t)return t;if(Object(x.a)(t))return Ot(t,e)+"";if(ft(t))return Pt?Pt.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n};var Rt=function(e){return null==e?"":kt(e)};var xt=function(e,t){return Object(x.a)(e)?e:bt(e,t)?[e]:It(Rt(e))};var Dt=function(e){if("string"==typeof e||ft(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t};var wt=function(e,t){for(var n=0,r=(t=xt(t,e)).length;null!=e&&n<r;)e=e[Dt(t[n++])];return n&&n==r?e:void 0};var At=function(e,t,n){var r=null==e?void 0:wt(e,t);return void 0===r?n:r};var jt=function(e,t){return null!=e&&t in Object(e)},_t=n(209);var Ft=function(e,t,n){for(var r=-1,o=(t=xt(t,e)).length,i=!1;++r<o;){var a=Dt(t[r]);if(!(i=null!=e&&n(e,a)))break;e=e[a]}return i||++r!=o?i:!!(o=null==e?0:e.length)&&Object(_t.a)(o)&&Object(te.a)(a,o)&&(Object(x.a)(e)||Object(R.a)(e))};var Mt=function(e,t){return null!=e&&Ft(e,t,jt)};var Nt=function(e,t){return bt(e)&&ct(t)?lt(Dt(e),t):function(n){var r=At(n,e);return void 0===r&&r===t?Mt(n,e):Object(at.a)(t,r,3)}};var Lt=function(e){return function(t){return null==t?void 0:t[e]}};var Bt=function(e){return function(t){return wt(t,e)}};var Ht=function(e){return bt(e)?Lt(Dt(e)):Bt(e)};var Ut=function(e){return"function"==typeof e?e:null==e?K:"object"==typeof e?Object(x.a)(e)?Nt(e[0],e[1]):ut(e):Ht(e)},Vt=n(301);var Wt=function(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1};var zt=function(e){return e!=e};var Kt=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1};var Gt=function(e,t,n){return t==t?Kt(e,t,n):Wt(e,zt,n)};var qt=function(e,t){return!!(null==e?0:e.length)&&Gt(e,t,0)>-1};var $t=function(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1},Yt=n(283),Jt=n(194);var Qt=function(){},Xt=n(210),Zt=Jt.a&&1/Object(Xt.a)(new Jt.a([,-0]))[1]==1/0?function(e){return new Jt.a(e)}:Qt;var en=function(e,t,n){var r=-1,o=qt,i=e.length,a=!0,s=[],c=s;if(n)a=!1,o=$t;else if(i>=200){var d=t?null:Zt(e);if(d)return Object(Xt.a)(d);a=!1,o=Yt.a,c=new Vt.a}else c=t?[]:s;e:for(;++r<i;){var l=e[r],u=t?t(l):l;if(l=n||0!==l?l:0,a&&u==u){for(var p=c.length;p--;)if(c[p]===u)continue e;t&&c.push(u),s.push(l)}else o(c,u,n)||(c!==s&&c.push(u),s.push(l))}return s};var tn=function(e,t){return e&&e.length?en(e,Ut(t,2)):[]};function nn(e){return rn(e).then(an)}function rn(e){var t=e.scenarioName,n=e.featureName,r=e.operation,o=e.monitorStarter,i=e.requestId,a=e.extraProps,s=e.extraLogPropsOnFinish,c=e.successAction,d=void 0===c?function(){}:c,l=e.errorAction,u=e.treatAsSuccessCondition,p=e.treatAsExpectedError,f=e.wrapWithLogging,m="function"==typeof s?{success:s,failure:s}:s,g=function(){return r().then(on)};return Ie({operation:f?function(){return f(g)}:g,scenarioName:t,featureName:n,extraProps:a,monitorStarter:o,requestId:i,extraLogPropsOnFinish:{success:function(e){return Object(h.a)(Object(h.a)({},m&&m.success(e)),function(e){var t=!!e.additionalRequestInformation&&e.additionalRequestInformation.didMakeAuthTokenRequest,n=e.additionalRequestInformation?e.additionalRequestInformation.durationWaitingOnAuthToken.toString():"0",r=!!e.additionalRequestInformation&&e.additionalRequestInformation.didMakeConfigRequest,o=e.RequestDurationFromEvents?"".concat(e.RequestDurationFromEvents):void 0;return Object(h.a)(Object(h.a)({},sn(e.Headers)),{didMakeAuthTokenRequest:t,durationWaitingOnAuthToken:n,didMakeConfigRequest:r,eventDuration:o})}(e))},failure:function(e){return Object(h.a)(Object(h.a)({},m&&m.failure(e)),sn(e.headers))}},successAction:function(e,t){return d(e&&an(e),t)},errorAction:l,treatAsSuccessCondition:u,treatAsExpectedError:p})}function on(e){return function(e,t){var n=null==t?void 0:t["x-correlationid"];return Object(h.a)(Object(h.a)({},e),n?{debug:{traceId:n}}:{})}(e,e.Headers)}function an(e){return e.parsedResponse}function sn(e){if(!e)return{};var t={};if(e["x-inboundduration"]&&(t["x-inboundduration"]=e["x-inboundduration"]),e["x-beserver"]&&(t["x-beserver"]=e["x-beserver"]),e["x-serverversion"]&&(t["x-serverversion"]=e["x-serverversion"]),e["x-correlationid"]&&(t["x-correlationid"]=e["x-correlationid"]),e["x-datacenter"]&&(t["x-datacenter"]=e["x-datacenter"]),t.iswebsocketrequest=e["x-websocketcorrelationid"]?"1":"0",e["x-azure-ref"]){var n=function(e){if(!e||!e.trim())return null;try{var t=atob(e.substring(1)).substring(24);return/^([\dA-Za-z]+)\0([\d-A-Za-z]{36})$/.test(t)?t.split("\0"):null}catch(e){return null}}(e["x-azure-ref"]);n&&(t["x-azure-ref"]=e["x-azure-ref"],t["".concat("x-azure-ref","-EdgeLocation")]=n[0],t["".concat("x-azure-ref","-EdgeRequestId")]=n[1])}return t}function cn(e,t,n){var r=Pe(e,t,n);return{success:function(e){return r.success(e.parsedResponse)},failure:r.failure}}function dn(e,t,n){return ln(e,t,nn,n)}function ln(e,t,n,r){var o=this,i=r&&r.debounce||!1,a=r&&r.httpMethod||"Get",s=r&&r.logPropertyExtractors,c="".concat(a).concat(e),d=ke(e,c,(function(r,i,a){return Object(h.b)(o,void 0,void 0,(function(){var o,d,l,u,p,f,m,g;return Object(h.d)(this,(function(h){return o=r.monitorStarter,d=r.lokiRestProvider,l=r.treatAsExpectedError,u=r.clientScenario,p=r.wrapWithLogging,f=i.requestId,m=function(){return t(d,{requestId:f,clientScenario:u},a)},[2,n({scenarioName:c,featureName:e,requestId:f,monitorStarter:o,treatAsExpectedError:l,extraProps:u?(g={},g[ge]=u,g):void 0,extraLogPropsOnFinish:s&&cn(s,i,a),operation:m,wrapWithLogging:p})]}))}))}));return i?xe(d):d}var un=new Map;function pn(e,t,n){var r=un.get(n)||new Map;r.set(e,t),un.set(n,r)}function hn(e,t){var n=un.get(t);return n?n.get(e):void 0}function fn(e,t){var n=un.get(t);n&&n.delete(e)}function mn(e,t,n){pn(e,t,n),function(e,t){try{window.sessionStorage&&window.sessionStorage.setItem(e,t)}catch(e){}}(e,t)}function gn(e,t){var n=function(e){try{if(window.sessionStorage){var t=window.sessionStorage.getItem(e);return null===t?void 0:t}return}catch(e){return}}(e);return void 0!==n?n:hn(e,t)}function bn(e,t){fn(e,t),function(e){try{window.sessionStorage&&window.sessionStorage.removeItem(e)}catch(e){}}(e)}var Cn,yn,vn,Tn,Sn,In=function(){function e(e,t){this.rateLimit=e,this.slidingWindowDuration=t,this.currentRate=0,this.throttledRetryAfter=new Map}return e.prototype.updateRateLimit=function(){var e,t,n=this;this.currentRate++,e=function(){return n.currentRate=Math.max(n.currentRate-1,0)},t=this.slidingWindowDuration,window.setTimeout((function(){return e()}),t)},e.prototype.execute=function(e){if(this.currentRate>=this.rateLimit)throw new Error("Rate limit reached");this.updateRateLimit(),e()},e.prototype.executeWithThrottling=function(e,t){var n,r=this,o=this.currentRate>=this.rateLimit;if(!o&&t&&(o=(n=this.throttledRetryAfter.get(t))&&n>Date.now()||!1),o)throw new Error("Rate limit reached");return this.updateRateLimit(),t?new Promise((function(o,i){e().then((function(e){void 0!==n&&t&&r.throttledRetryAfter.delete(t),o(e)})).catch((function(e){var n;if(429===e.statusCode&&(null===(n=e.headers)||void 0===n?void 0:n["Retry-After"])){var o=Number(e.headers["Retry-After"]);if(!Object.is(o,NaN)&&o>0){var a=Date.now()+1e3*o;r.throttledRetryAfter.set(t,a)}}i(e)}))})):e()},e}();function On(e){return"loki-auth-token"===e.family&&e.code in Cn?e.code:void 0}function En(e){return{family:"loki-auth-token",code:e}}(yn=Cn||(Cn={}))[yn.AUTH_INTERNET_CONNECTION_IS_NOT_AVAILABLE=0]="AUTH_INTERNET_CONNECTION_IS_NOT_AVAILABLE",yn[yn.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS=1]="AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS",yn[yn.EXPECTED_ERROR=2]="EXPECTED_ERROR",yn[yn.EXPECTED_TOKEN_INVALIDATED_ERROR=3]="EXPECTED_TOKEN_INVALIDATED_ERROR",yn[yn.GET_AUTH_TOKEN_TIMEOUT=4]="GET_AUTH_TOKEN_TIMEOUT",yn[yn.INVALID_AUTH_TOKEN=5]="INVALID_AUTH_TOKEN",yn[yn.GENERIC_TOKEN_ERROR=6]="GENERIC_TOKEN_ERROR",yn[yn.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED=7]="AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED",yn[yn.BAD_REFRESH_TOKEN=8]="BAD_REFRESH_TOKEN",yn[yn.CONDITIONAL_ACCESS_BLOCKED=9]="CONDITIONAL_ACCESS_BLOCKED",yn[yn.PRECONDITION_VIOLATED=10]="PRECONDITION_VIOLATED",yn[yn.POLICY_REQUIRED_ERROR=11]="POLICY_REQUIRED_ERROR",yn[yn.DEVICE_CONNECTION_IS_NOT_AVAILABLE=12]="DEVICE_CONNECTION_IS_NOT_AVAILABLE",yn[yn.BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN=13]="BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN",yn[yn.TIMEOUT_FETCHING_TOKEN=14]="TIMEOUT_FETCHING_TOKEN",yn[yn.NO_RESPONSE_FROM_SERVICE=15]="NO_RESPONSE_FROM_SERVICE",yn[yn.TIMEOUT_ERROR=16]="TIMEOUT_ERROR",yn[yn.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED=17]="AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED",yn[yn.AD_ERROR_SERVER_USER_INPUT_NEEDED=18]="AD_ERROR_SERVER_USER_INPUT_NEEDED",yn[yn.kCFURLErrorTimedOut=19]="kCFURLErrorTimedOut",yn[yn.kCFURLErrorCannotFindHost=20]="kCFURLErrorCannotFindHost",yn[yn.kCFURLErrorCannotConnectToHost=21]="kCFURLErrorCannotConnectToHost",yn[yn.kCFURLErrorNetworkConnectionLost=22]="kCFURLErrorNetworkConnectionLost",yn[yn.kCFURLErrorNotConnectedToInternet=23]="kCFURLErrorNotConnectedToInternet",yn[yn.kCFURLErrorInternationalRoamingOff=24]="kCFURLErrorInternationalRoamingOff",yn[yn.kCFURLErrorCallIsActive=25]="kCFURLErrorCallIsActive",yn[yn.kCFURLErrorDataNotAllowed=26]="kCFURLErrorDataNotAllowed",yn[yn.kCFURLErrorSecureConnectionFailed=27]="kCFURLErrorSecureConnectionFailed",yn[yn.UNKNOWN_ERROR=28]="UNKNOWN_ERROR",yn[yn.UNKNOWN_200_ERROR=29]="UNKNOWN_200_ERROR",yn[yn.UNKNOWN_203_ERROR=30]="UNKNOWN_203_ERROR",yn[yn.UNKNOWN_STRING_ERROR=31]="UNKNOWN_STRING_ERROR",yn[yn.UNKNOWN_ERROR_CAUGHT_IN_PROMISE=32]="UNKNOWN_ERROR_CAUGHT_IN_PROMISE",yn[yn.BROKER_AUTHENTICATOR_NOT_RESPONDING=33]="BROKER_AUTHENTICATOR_NOT_RESPONDING",yn[yn.NO_NETWORK_CONNECTION_POWER_OPTIMIZATION=34]="NO_NETWORK_CONNECTION_POWER_OPTIMIZATION",yn[yn.BROKER_AUTHENTICATOR_IO_EXCEPTION=35]="BROKER_AUTHENTICATOR_IO_EXCEPTION",yn[yn.IO_EXCEPTION=36]="IO_EXCEPTION",yn[yn.NO_ACCOUNTS_FOUND=37]="NO_ACCOUNTS_FOUND",yn[yn.DISALLOWED_MSA_ACCOUNT=38]="DISALLOWED_MSA_ACCOUNT",yn[yn.NO_M365_ACCOUNT=39]="NO_M365_ACCOUNT",yn[yn.WIN32_UNKNOWN_ERROR=40]="WIN32_UNKNOWN_ERROR",yn[yn.WIN32_PERSONAJS_ERROR=41]="WIN32_PERSONAJS_ERROR",yn[yn.AUTH_RATE_LIMIT_EXCEEDED=42]="AUTH_RATE_LIMIT_EXCEEDED";var Pn=function(e){return"".concat("LokiAuthToken").concat(e)},kn=function(e){return"EXP".concat(Pn(e))};function Rn(e){return Boolean(e&&("string"==typeof e||Object.keys((t=e,le(t,(function(e){return null!=e&&""!==e&&(!(e instanceof Array)||e.length>0)})))).length));var t}var xn=((vn={})[Cn.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED]=1,vn[Cn.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS]=1,vn[Cn.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED]=1,vn[Cn.AD_ERROR_SERVER_USER_INPUT_NEEDED]=1,vn[Cn.BAD_REFRESH_TOKEN]=1,vn[Cn.CONDITIONAL_ACCESS_BLOCKED]=1,vn[Cn.POLICY_REQUIRED_ERROR]=1,vn[Cn.PRECONDITION_VIOLATED]=1,vn),Dn=((Tn={})[Cn.DEVICE_CONNECTION_IS_NOT_AVAILABLE]=1,Tn[Cn.BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN]=1,Tn[Cn.TIMEOUT_FETCHING_TOKEN]=1,Tn[Cn.BROKER_AUTHENTICATOR_NOT_RESPONDING]=1,Tn[Cn.NO_NETWORK_CONNECTION_POWER_OPTIMIZATION]=1,Tn[Cn.BROKER_AUTHENTICATOR_IO_EXCEPTION]=1,Tn[Cn.IO_EXCEPTION]=1,Tn[Cn.GENERIC_TOKEN_ERROR]=1,Tn[Cn.NO_RESPONSE_FROM_SERVICE]=1,Tn[Cn.TIMEOUT_ERROR]=1,Tn[Cn.kCFURLErrorTimedOut]=1,Tn[Cn.kCFURLErrorCannotFindHost]=1,Tn[Cn.kCFURLErrorCannotConnectToHost]=1,Tn[Cn.kCFURLErrorNetworkConnectionLost]=1,Tn[Cn.kCFURLErrorNotConnectedToInternet]=1,Tn[Cn.kCFURLErrorInternationalRoamingOff]=1,Tn[Cn.kCFURLErrorCallIsActive]=1,Tn[Cn.kCFURLErrorDataNotAllowed]=1,Tn[Cn.kCFURLErrorSecureConnectionFailed]=1,Tn),wn=((Sn={})[Cn.EXPECTED_ERROR]=1,Sn[Cn.EXPECTED_TOKEN_INVALIDATED_ERROR]=1,Sn[Cn.GET_AUTH_TOKEN_TIMEOUT]=1,Sn);function An(e){return!!(he(e)&&On(e)&&xn[e.code])}function jn(e){return!!(he(e)&&On(e)&&(An(e)||Dn[e.code]||wn[e.code]))}function _n(e){var t,n=null===(t=e.headers)||void 0===t?void 0:t["x-msedge-ref"];return n&&n.substring("Ref A: ".length,n.indexOf(" Ref B:"))}function Fn(e,t,n){switch(e){case"203":return En("interaction_required"===n&&"200"===t?Cn.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED:Cn.UNKNOWN_203_ERROR);case"200":return En("200"===t?Cn.AD_ERROR_SERVER_USER_INPUT_NEEDED:Cn.UNKNOWN_200_ERROR);case"PersonaJsError":case"RichApi.Error":return En("InstanceNotFound"===t?Cn.EXPECTED_ERROR:Cn.WIN32_PERSONAJS_ERROR);case"SafePersonaJsError":return En(Cn.WIN32_PERSONAJS_ERROR);case"UnknownWin32Error":return En(Cn.WIN32_UNKNOWN_ERROR);case"DEVICE_CONNECTION_IS_NOT_AVAILABLE":return En(Cn.DEVICE_CONNECTION_IS_NOT_AVAILABLE);case"BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN":return En(Cn.BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN);case"BROKER_AUTHENTICATOR_NOT_RESPONDING":return En(Cn.BROKER_AUTHENTICATOR_NOT_RESPONDING);case"AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED":return En(Cn.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED);case"NO_NETWORK_CONNECTION_POWER_OPTIMIZATION":return En(Cn.NO_NETWORK_CONNECTION_POWER_OPTIMIZATION);case"BROKER_AUTHENTICATOR_IO_EXCEPTION":return En(Cn.BROKER_AUTHENTICATOR_IO_EXCEPTION);case"IO_EXCEPTION":return En(Cn.IO_EXCEPTION);case"GENERIC_TOKEN_ERROR":return En(Cn.GENERIC_TOKEN_ERROR);case"TIMEOUT_ERROR":return En(Cn.TIMEOUT_ERROR);case"POLICY_REQUIRED_ERROR":return En(Cn.POLICY_REQUIRED_ERROR);case"Timeout: getting the token timed out":return En(Cn.TIMEOUT_FETCHING_TOKEN);case"BAD_REFRESH_TOKEN":return En(Cn.BAD_REFRESH_TOKEN);case"CONDITIONAL_ACCESS_BLOCKED":return En(Cn.CONDITIONAL_ACCESS_BLOCKED);case"NO_RESPONSE_FROM_SERVICE":return En(Cn.NO_RESPONSE_FROM_SERVICE);case"PRECONDITION_VIOLATED":return En(Cn.PRECONDITION_VIOLATED);case"NO_ACCOUNTS_FOUND":return En(Cn.NO_ACCOUNTS_FOUND);case"DISALLOWED_MSA_ACCOUNT":return En(Cn.DISALLOWED_MSA_ACCOUNT);case"NO_M365_ACCOUNT":return En(Cn.NO_M365_ACCOUNT);case"10013":return En(Cn.AD_ERROR_SERVER_USER_INPUT_NEEDED);case"-1001":return En(Cn.kCFURLErrorTimedOut);case"-1003":return En(Cn.kCFURLErrorCannotFindHost);case"-1004":return En(Cn.kCFURLErrorCannotConnectToHost);case"-1005":return En(Cn.kCFURLErrorNetworkConnectionLost);case"-1009":return En(Cn.kCFURLErrorNotConnectedToInternet);case"-1018":return En(Cn.kCFURLErrorInternationalRoamingOff);case"-1019":return En(Cn.kCFURLErrorCallIsActive);case"-1020":return En(Cn.kCFURLErrorDataNotAllowed);case"-1200":return En(Cn.kCFURLErrorSecureConnectionFailed);default:var r=parseInt(e||"",10);return!isNaN(r)&&{family:"loki-auth-token",code:1e4+r}||void 0}}var Mn;!function(e){e[e.TIMEOUT=0]="TIMEOUT",e[e.CANCELLED=1]="CANCELLED",e[e.FAILED=2]="FAILED"}(Mn||(Mn={}));function Nn(e){return{family:"xml-http-request-executor",code:e}}var Ln=/\?/;function Bn(e,t){return{message:e.status?"":"UndefinedOrAbortedRequestStatus_".concat(t),statusCode:e.status,responseText:"blob"!==e.responseType?e.responseText:void 0,isExpected:!1,shouldRetryAsXhrRequest:!1,headers:Hn(e.getAllResponseHeaders()),midgardError:Nn(Mn.FAILED)}}function Hn(e){if(e){var t={};return e.split("\r\n").forEach((function(e){var n=e.indexOf(": ");t[e.substr(0,n).toLowerCase()]=e.substr(n+2)})),t}return{}}var Un,Vn=function(){function e(e,t,n,r,o,i,a){if(void 0===a&&(a="text"),this.url=e,this.verb=t,this.timeout=n,this.body=o,this.withCredentials=i,this.responseType=a,this.isConvertGetPostRequest=!1,this.headers={},r&&"GET"===this.verb){this.isConvertGetPostRequest=!0,this.verb="POST";var s=Ln.test(this.url);this.url="".concat(this.url).concat(s?"&":"?").concat("ConvertGetPost","=true")}}return e.prototype.setHeader=function(e,t){this.headers[e]=t},e.prototype.setTimeout=function(e){this.timeout=e},e.prototype.go=function(e){var t,n=this;return void 0===e&&(e="REST"),new Promise((function(r,o){var i=new XMLHttpRequest;if(i.open(n.verb,n.url),i.timeout=n.timeout,i.withCredentials=n.withCredentials||!1,n.responseType&&(i.responseType=n.responseType),n.isConvertGetPostRequest)n.body=JSON.stringify(n.headers);else for(var a in n.headers)n.headers.hasOwnProperty(a)&&i.setRequestHeader(a,n.headers[a]);i.onload=function(a){if(i.status>=200&&i.status<300){var s=function(e,t){if(e&&t&&0!==t)return Math.ceil(t-e)}(t,a.timeStamp);r(n.getResponseObjectFromRequest(i,s))}else o(Bn(i,e))},i.onerror=function(){o(Bn(i,e))},i.ontimeout=function(){o({statusCode:i.status,message:"RequestTimeout",isExpected:!0,shouldRetryAsXhrRequest:!1,headers:void 0,midgardError:Nn(Mn.TIMEOUT)})},i.onabort=function(){o({statusCode:i.status,message:"Cancelled",isExpected:!1,shouldRetryAsXhrRequest:!1,headers:void 0,midgardError:Nn(Mn.CANCELLED)})},t=function(){try{if("function"==typeof CustomEvent)return new CustomEvent("Event").timeStamp;if("undefined"!=typeof document)return document.createEvent("Event").timeStamp}catch(e){}}(),i.send(n.body)}))},e.prototype.getResponseObjectFromRequest=function(e,t){return{Body:"blob"===e.responseType?e.response:e.responseText,StatusCode:e.status,Headers:Hn(e.getAllResponseHeaders()),ResponseUrl:e.responseURL,RequestDurationFromEvents:t}},e}();function Wn(e){return{family:"loki-rest-utils",code:e}}!function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",e[e.INVALID_RESPONSE=1]="INVALID_RESPONSE",e[e.REQUEST_FAILED=2]="REQUEST_FAILED",e[e.CONFIG_FAILED=3]="CONFIG_FAILED",e[e.AUTH_TOKEN_FAILED=4]="AUTH_TOKEN_FAILED",e[e.GCC_USER=5]="GCC_USER",e[e.REQUEST_FACTORY_UNDEFINED=6]="REQUEST_FACTORY_UNDEFINED",e[e.MISSING_REQUIRED_PARAMETER=7]="MISSING_REQUIRED_PARAMETER"}(Un||(Un={}));var zn=function(){function e(e,t){this.config=e,this.getDomain=t,this.initialize(),(0,this.config.logger.registerErrors)("loki-rest-utils",Un)}return e.prototype.initialize=function(){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(e){return[2]}))}))},e.prototype.request=function(e,t,n,r,o,i,a,s,c){return void 0===c&&(c={convertPropertiesToPascalCase:!0,defaultResponseObject:!0}),Object(h.b)(this,void 0,void 0,(function(){var d,l,u,p,f,m,g,b,C,y=this;return Object(h.d)(this,(function(v){switch(v.label){case 0:return this.config.settings.isOfflineMode?[2,Promise.reject({message:"OFFLINE_MODE",isExpected:!0})]:[4,this.getDomainOrLogErrorAndThrow(e)];case 1:d=v.sent(),l=a.requestId,u=a.timeoutOverride,p=a.clientScenario,f=function(){return Object(h.b)(y,void 0,void 0,(function(){var e,a,f,m,g;return Object(h.d)(this,(function(b){switch(b.label){case 0:return[4,this.doRequest({method:t,domain:d.domain,path:n,body:r,headers:o,queryParameters:i,requestId:l,timeoutOverride:u,clientScenario:p,domainRequiredRequest:d.domainRequiredRequest})];case 1:return e=b.sent(),a=e.Headers?Number(e.Headers["x-tokenttl"]):NaN,!isNaN(a)&&this.config.updateAuthTokenTtl(a),f=""===e.Body||"null"===e.Body.toLowerCase(),e.Body=f&&c.defaultResponseObject?"{}":e.Body,m=c.convertPropertiesToPascalCase?Kn:function(e){return e},g=s(!f||c.defaultResponseObject?m(JSON.parse(e.Body)):e.Body),[2,Object(h.a)({parsedResponse:g},e)]}}))}))},v.label=2;case 2:return v.trys.push([2,4,,11]),[4,f()];case 3:return[2,v.sent()];case 4:if(m=v.sent(),!(g=m)||401!==g.statusCode)return[3,9];this.config.forceRefreshAuthToken(a.requestId),v.label=5;case 5:return v.trys.push([5,7,,8]),[4,f()];case 6:return[2,v.sent()];case 7:throw b=v.sent(),$n({qosTagId:e,statusCode:null==(C=b)?void 0:C.statusCode,isExpected:(null==C?void 0:C.isExpected)||!1,headers:null==C?void 0:C.headers,midgardError:C&&he(C.midgardError)?C.midgardError:Wn(Un.REQUEST_FAILED)});case 8:return[3,10];case 9:throw qn({qosTagId:e,statusCode:null==g?void 0:g.statusCode,isExpected:(null==g?void 0:g.isExpected)||!1,headers:null==g?void 0:g.headers,midgardError:g&&he(g.midgardError)?g.midgardError:Wn(Un.REQUEST_FAILED)});case 10:return[3,11];case 11:return[2]}}))}))},e.prototype.configuration=function(){return this.config},e.prototype.getDomainOrLogErrorAndThrow=function(e){return Object(h.b)(this,void 0,void 0,(function(){var t,n,r,o,i,a;return Object(h.d)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.getDomain()];case 1:return[2,s.sent()];case 2:throw t=s.sent(),r=(n=t)&&function(e){return 403===e.statusCode&&Gn(e)}(n),o=Gn(n),i=o?Un.CONFIG_FAILED:r?Un.GCC_USER:Un.UNKNOWN_ERROR,a=void 0,a=o?Wn(i):n&&he(n.midgardError)?n.midgardError:Wn(i),i===Un.UNKNOWN_ERROR&&this.config.logger.logError({eventId:"GetDomainFailure",featureName:"LokiRestProvider"}),qn({qosTagId:e,statusCode:null==n?void 0:n.statusCode,isExpected:o,headers:void 0,midgardError:a});case 3:return[2]}}))}))},e.prototype.doRequest=function(e){var t=e.method,n=e.domain,r=e.path,o=e.body,i=e.headers,a=e.queryParameters,s=e.requestId,c=e.timeoutOverride,d=e.clientScenario,l=e.domainRequiredRequest;return Object(h.b)(this,void 0,void 0,(function(){var e,u,p,f,m,g,b,C,y;return Object(h.d)(this,(function(v){switch(v.label){case 0:return[4,this.initialize()];case 1:return v.sent(),[4,this.getAuthTokenWithRequestInformation(s)];case 2:return e=v.sent(),!0,u=Object(h.a)(Object(h.a)({},{"X-RootCorrelationId":s,"X-CorrelationId":s,"X-ClientCorrelationId":this.config.hostAppConfiguration.consumerCorrelationId}),{"X-ClientType":this.config.hostAppConfiguration.source,"X-ClientFeature":this.config.clientFeature,"X-ClientArchitectureVersion":this.config.clientArchitectureVersion,"X-ClientScenario":d,"X-LPCVersion":this.config.BUILD_VERSION,authorization:"Bearer ".concat(e.token.getValue()),"X-HostAppRing":this.config.hostAppConfiguration.options.hostAppRing,"X-HostAppVersion":this.config.hostAppConfiguration.options.hostAppVersion,"X-MailboxContextAadObjectId":this.config.settings.isSharedMailboxEnabled?this.config.hostAppConfiguration.options.sharedMailboxAadObjectId:void 0,"X-HostAppCapabilities":JSON.stringify((T=this.config,S={isLinkedInEnabledInHostApp:T.hostAppConfiguration.options.isLinkedInEnabledInHostApp},S))}),p=Object(h.a)({},{}),f="/"===n.substring(n.length-1)&&"/"===r.substring(0,1)?"".concat(n).concat(r.substring(1)):"".concat(n).concat(r),m=function(e,t){var n=Object.keys(t);if(n.length<=0)return e;var r=n.filter((function(e){return void 0!==t[e]&&null!==t[e]})).map((function(e){return Array.isArray(t[e])?t[e].map((function(t){return"".concat(e,"=").concat(t)})).join("&"):"".concat(e,"=").concat(encodeURIComponent(t[e]))})).join("&");return"".concat(e,"?").concat(r)}(f,Object(h.a)(Object(h.a)({},a),p)),!1,g=c||4e4,b=o instanceof Blob,C=this.getRequestExecutor(m,t,o&&!b?JSON.stringify(o):o,g,!1,b),Object.keys(i).forEach((function(e){var t=i[e];void 0!==t&&C.setHeader(e,t)})),Object.keys(u).forEach((function(e){var t=u[e];void 0!==t&&C.setHeader(e,t)})),y=[{additionalRequestInformation:{didMakeAuthTokenRequest:!e.request.fromCache,durationWaitingOnAuthToken:e.request.duration,didMakeConfigRequest:Boolean(l)}}],[4,C.go()];case 3:return[2,h.a.apply(void 0,y.concat([v.sent()]))]}var T,S}))}))},e.prototype.getAuthTokenWithRequestInformation=function(e){return Object(h.b)(this,void 0,void 0,(function(){var t,n;return Object(h.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.config.getAuthToken(e)];case 1:return[2,r.sent()];case 2:throw t=r.sent(),qn({qosTagId:"getAuthTokenPromise",statusCode:void 0,isExpected:!(!(n=t)||!he(n.midgardError))&&jn(n.midgardError),headers:void 0,midgardError:n&&he(n.midgardError)?n.midgardError:Wn(Un.AUTH_TOKEN_FAILED)});case 3:return[2]}}))}))},e.prototype.getRequestExecutor=function(e,t,n,r,o,i){return new Vn(e,t,r,o,n,!0)},e}();function Kn(e){return null===e?null:void 0!==e?"number"==typeof e||"string"==typeof e||"boolean"==typeof e?e:Array.isArray(e)?e.map(Kn):Object.keys(e).reduce((function(t,n){var r="".concat(n[0].toUpperCase()).concat(n.slice(1));return"object"==typeof e[n]?t[r]=Kn(e[n]):t[r]=e[n],t}),{}):void 0}function Gn(e){return Boolean(e&&e.qosTagId&&["get_configuration","get_livepersonacardconfiguration","get_livepersonapickerconfiguration","get_officefeedconfiguration","get_searchconfiguration","get_groupsmanagementconfiguration"].indexOf(e.qosTagId)>-1)}var qn=function(e){return e},$n=function(e){return Object(h.a)(Object(h.a)({},e),{retryAttemptedAfterAuthFailure:!0})};function Yn(e){return void 0!==e.UserAadObjectId&&null!==e.UserAadObjectId&&e.UserAadObjectId,void 0!==e.TenantAadObjectId&&null!==e.TenantAadObjectId&&e.TenantAadObjectId,e}function Jn(e){return e}function Qn(e){return void 0!==e.Value&&null!==e.Value&&e.Value.forEach(Jn),e}const Xn=async function(e,t,n){const r={},o={Accept:"text/plain, application/json, text/json"};return void 0!==n.scenarioName&&(r.scenarioName=n.scenarioName),void 0!==n.query&&(r.query=n.query),void 0!==n.top&&(r.top=n.top),void 0!==n.searchDirectory&&(r.searchDirectory=n.searchDirectory),void 0!==n.informationBarrierSegments&&(r.informationBarrierSegments=n.informationBarrierSegments),e.request("get_personasuggestions","GET","/api/v1/personasuggestions",void 0,o,r,t,Qn)};const Zn=async function(e,t,n){const r={Accept:"text/plain, application/json, text/json"};return e.request("get_livepersonapickerconfiguration","GET","/api/v1/livepersonapicker/configuration",void 0,r,{},t,Yn)};const er=nt("ConfigurationStore",dn("PickerConfiguration",Zn)),tr=dn("PickerSuggestions",Xn,{logPropertyExtractors:{success:e=>({responseLength:e.Value?e.Value.length.toString():"0"}),fromParameters:e=>({queryLength:e.query?e.query.length.toString():"0",didSearchDirectory:e.searchDirectory})}}),nr=nt("SuggestionsStore",tr),rr=/<([^>]*)>/;var or=function(e,t,n,r){for(var o=-1,i=null==e?0:e.length;++o<i;){var a=e[o];t(r,a,n(a),e)}return r};var ir=function(e){return function(t,n,r){for(var o=-1,i=Object(t),a=r(t),s=a.length;s--;){var c=a[e?s:++o];if(!1===n(i[c],c,i))break}return t}}();var ar=function(e,t){return e&&ir(e,t,ae.a)};var sr=function(e,t){return function(n,r){if(null==n)return n;if(!Object(ee.a)(n))return e(n,r);for(var o=n.length,i=t?o:-1,a=Object(n);(t?i--:++i<o)&&!1!==r(a[i],i,a););return n}}(ar);var cr=function(e,t,n,r){return sr(e,(function(e,o,i){t(r,e,n(e),i)})),r};var dr=function(e,t){return function(n,r){var o=Object(x.a)(n)?or:cr,i=t?t():{};return o(n,e,Ut(r,2),i)}},lr=dr((function(e,t,n){H(e,n,t)}));var ur=function(e){return function(t){return null==e?void 0:e[t]}}({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),pr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,hr=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");var fr=function(e){return(e=Rt(e))&&e.replace(pr,ur).replace(hr,"")};function mr({EmailAddresses:e,Id:t,Name:n,UserPrincipalName:r,PersonaType:o,PersonaSubtype:i,AadObjectId:a},s){return{Id:t||"",Name:n||"",UserPrincipalName:r||"",EmailAddresses:e||[],SuggestionType:o||"",SuggestionSubtype:i||"",HostAppSuggestion:{},Source:"Loki",SuggestionOrigin:s?"ZeroTerm":"Search",AadObjectId:a||void 0}}function gr(e){return e.UserPrincipalName||(e.EmailAddresses&&e.EmailAddresses.length?e.EmailAddresses[0]:"")}const br=(e,t)=>!t||!e||void 0===e[t];function Cr(e){const t=e.split(";").map(e=>{const t=rr.exec(e);return t&&t.length>1&&t[1]&&(e=t[1]),e.trim()}).filter(e=>e);const n=t&&t[0];var r;return[(r=n,{Id:r,Name:r,UserPrincipalName:"",HostAppSuggestion:{},SuggestionType:"",SuggestionSubtype:"",EmailAddresses:[r],Source:"UserTypedSuggestion",SuggestionOrigin:"UserTyped"})]}const yr=y("PhotoUrisProvidedAction",{featureName:"NoLogging"}),vr=Xe("PhotoUriStore",Ne().handlePayload(yr,(function(e,t){return t})).done({photoUris:{}}),e=>({get photoUris(){return e.photoUris}}));const Tr=Xe("QueryStore",Ne().handleAction(T,(function(e,{payload:t}){return{queryStatuses:Object.assign(Object.assign({},e.queryStatuses),{[t.query]:"InProgress"}),currentQueries:Object.assign(Object.assign({},e.currentQueries),{[t.inputId]:t.query})}})).handleAction(S,(function(e,{payload:t}){return Object.assign(Object.assign({},e),{queryStatuses:Object.assign(Object.assign({},e.queryStatuses),{[t.query]:"Finished"})})})).handleAction(O,(function(e,{payload:t}){return Object.assign(Object.assign({},e),{currentQueries:Object.assign(Object.assign({},e.currentQueries),{[t.inputId]:void 0})})})).handleAction(I,(function(e,{payload:t}){return Object.assign(Object.assign({},e),{currentQueries:Object.assign(Object.assign({},e.currentQueries),{[t.inputId]:void 0})})})).done({queryStatuses:{},currentQueries:{}}),e=>({getCurrentQuery:t=>e.currentQueries[t]||"",getQueryStatus:t=>e.queryStatuses[t]||"Finished"}));function Sr(e,t){return Tr.getSelectors(e).getCurrentQuery(t)}function Ir(e,t){return Tr.getSelectors(e).getQueryStatus(t)}const Or=y("LivePersonaPickerInitializedAction",{featureName:"AppLoadedAction",getLogProperties:e=>{var t,n;return{infoBarrierSegmentsCount:null===(n=null===(t=e.informationBarrierSegments)||void 0===t?void 0:t.length)||void 0===n?void 0:n.toString(),offline:e.offline.toString()}}}),Er={queryType:"loki",top:30,searchDirectory:!0},Pr=Object.assign(Object.assign({},Er),{searchDirectory:!1}),kr={queryType:"host",top:30,searchDirectory:!0},Rr=Object.assign(Object.assign({},kr),{searchDirectory:!1}),xr={startupQueries:new Set([Pr,kr]),queries:new Set([Er,kr])},Dr={startupQueries:new Set,queries:new Set([kr])},wr={startupQueries:new Set([Rr]),queries:new Set([kr,Rr])},Ar={startupQueries:new Set([Pr]),queries:new Set([Er]),fallbackQueries:new Set([kr])},jr={settings:{clearInputOnSuggestionPressed:!1,detectEmailAddresses:!1,dismissPickerAfterWordBreakLimitIsReached:!0,informationBarrierSegments:void 0,loadMoreSuggestionsOnScroll:!1,queryConfig:xr,suggestUseEmailAddress:!1,triggerStringMode:"OneLetter"}},_r=Xe("SettingStore",Ne().handlePayload(Or,(function(e,t){const{informationBarrierSegments:n,offline:r,clientType:o}=t;let i=Object.assign(Object.assign({},e.settings),{informationBarrierSegments:n});switch(o){case"ShareDialog":i=Object.assign(Object.assign({},i),{clearInputOnSuggestionPressed:!0,detectEmailAddresses:!0,dismissPickerAfterWordBreakLimitIsReached:!1,queryConfig:r?Dr:Ar});break;case"UWPStellarCalendar":i=Object.assign(Object.assign({},i),{loadMoreSuggestionsOnScroll:!0,queryConfig:wr,suggestUseEmailAddress:!0,triggerStringMode:"ZeroTerm"});break;case"OneNoteUWP":i=Object.assign(Object.assign({},i),{triggerStringMode:"ZeroTerm"});break;case"OfficeAndroid":case"OfficeiOS":case"MobileTestApp":case"OfficeWin32":i=Object.assign(Object.assign({},i),{triggerStringMode:"AtMention",queryConfig:r?Dr:xr});break;case"OfficeWebApps":case"OwaMail":case"Outlook_Monarch_HUB":case"Outlook_Web_HUB":case"Outlook_Win32_HUB":case"Teams_HUB":case"OrgExplorerTestpage_Web":case"ToDo_UWP":case"ToDo_Android":case"ToDo_iOS":i=Object.assign(Object.assign({},i),{queryConfig:r?Dr:xr})}return{settings:i}})).done(jr),e=>({get settings(){return e.settings}}));function Fr(e,t){const n={key:e},r=nr.getSelectors(t);return(o=r.getLatestSuccess(n),(null==o?void 0:o.Value)||[]).map(t=>mr(t,0===e.length));var o}function Mr(e,t){const n={key:e};return ot.getSelectors(t).getLatestSuccess(n)||[]}function Nr(e,t,n){const r=Lr("",e,n);if(""===t){const n=Br(e,r),o=tn(n,e=>e.Id);return o.length!==n.length&&console.error("Suggestions coming from the host app do not have unique IDs!"),Hr(t,e,o)}const o=function(e,t){const n=fr(e).toLowerCase();return t.filter(e=>e.Name&&0===fr(e.Name.toLowerCase()).indexOf(n))}(t,r),i=Lr(t,e,n);return Hr(t,e,Br(e,function(e,t,n){const r=function(e){return _r.getSelectors(e).settings}(t),o=Ir(t,e);if(r.suggestUseEmailAddress&&"Finished"===o&&0===n.length&&(e=>{const t=e.indexOf("@");return t>0&&t<e.length-1})(e)){return Cr(e)}return n}(t,e,tn([...o,...i],e=>e.Id))))}function Lr(e,t,n){const r=Fr(e,t),o=function(e,t){const n=new Set;return t.forEach(e=>{e.EmailAddresses.forEach(e=>n.add(e.toLowerCase()))}),e.filter(e=>{let t=!0;return e.EmailAddresses.forEach(e=>{n.has(e.toLowerCase())&&(t=!1)}),t})}(Mr(e,t),r);return function(e,t){const n=lr(t,e=>e.Id);let r={};t&&(r=lr(t.filter(e=>e.AadObjectId),e=>e.AadObjectId));const o=lr(t,e=>e.UserPrincipalName);return e.filter(e=>!(!e.Id||!e.EmailAddresses||0===e.EmailAddresses.length)).filter(e=>br(n,e.Id)).filter(e=>br(r,e.AadObjectId)).filter(e=>br(o,e.UserPrincipalName))}(r.concat(o),n)}function Br(e,t){const n=function(e){return vr.getSelectors(e).photoUris}(e);return t.map(e=>(e.ImageSource=e.ImageSource||n[e.Id],e))}function Hr(e,t,n){const r=Ir(t,e),o=function(e,t){const n={key:e};return nr.getSelectors(t).hasError(n)}(e,t)||function(e,t){const n={key:e};return ot.getSelectors(t).hasError(n)}(e,t);return{query:e,queryStatus:r,suggestions:n,completeness:function(e){return 0===e.length?"Empty":e.length%30==0?"Limited":"Full"}(n),hasErrors:o}}function Ur(e,t){return function(e,t){return Promise.all(e.map(e=>function(e,t){return t?t("api/v2/personaphoto?smtp=",gr(e),e.AadObjectId):Promise.resolve(void 0)}(e,t))).then(t=>t.reduce((t,n,r)=>(t[e[r].Id]=n,t),{}))}(e,t.getPhotoUri).then(e=>{t.dispatch(yr({photoUris:e}))}).catch(()=>{t.dispatch(yr({photoUris:{}}))}),Promise.resolve(e)}const Vr=new Set;function Wr(e,t,n=1){const r=e.settings.queryConfig.queries||Vr,o=e.settings.queryConfig.fallbackQueries||Vr;return zr(e,t,r,n).then(r=>r.length>0?Promise.resolve(r):zr(e,t,o,n)).then(n=>(e.dispatch(S({query:t})),Promise.resolve(n))).then(t=>Ur(t,e))}function zr(e,t,n,r=1){return Promise.all([...n].map(n=>function(e,t,n){const{queryType:r}=n;switch(r){case"loki":return function(e,t,n){const r={key:t},o=e.getStoreState();if(o){const e=Fr(t,o);if(e.length>0&&!n||n&&e.length>=n.top)return Promise.resolve(e)}const{informationBarrierSegments:i}=e.settings;return tr.fetch({monitorStarter:e.logger,lokiRestProvider:e.getLokiRestProvider(),dispatch:e.dispatch,timeoutOverride:1e4,clientScenario:"getPersonaSuggestions"},r,{scenarioName:"people",query:t||void 0,top:n.top,searchDirectory:n.searchDirectory,informationBarrierSegments:i}).then(e=>{const{response:{Value:n}}=e;return(n||[]).map(e=>mr(e,0===t.length))}).catch(()=>[])}(e,t,n);case"host":return function(e,t,n){if(!e.getHostAppSuggestions)return Promise.resolve([]);const r={key:t},o=e.getStoreState();if(o){const e=Mr(t,o);if(e.length>0&&!n||n&&e.length>=n.top)return Promise.resolve(e)}return rt.fetch({monitorStarter:e.logger,dispatch:e.dispatch,timeoutOverride:1e4},r,{getHostAppSuggestions:e.getHostAppSuggestions,query:t,options:n}).then(e=>(e.response.map(e=>e.Source="HostApp"),e.response)).catch(()=>[])}(e,t,n);default:return r}}(e,t,Object.assign(Object.assign({},n),{top:n.top*r})))).then(j)}function Kr(e,t,n,r,o){e.dispatch(I({dismissalReason:t,inputId:n,queryLength:r,suggestionsShown:o}))}var Gr=n(162),qr=n(158),$r={labelColor:"#ff00ff",labelColorPressed:"#ff00ff",labelColorHover:"#ff00ff",secondaryLabelColor:"#ff00ff",tertiaryLabelColor:"#ff00ff",quaternaryLabelColor:"#ff00ff",linkColor:"#ff00ff",linkColorPressed:"#ff00ff",linkColorHover:"#ff00ff",placeholderTextColor:"#ff00ff",windowFrameTextColor:"#ff00ff",selectedMenuItemTextColor:"#ff00ff",headerTextColor:"#ff00ff",cardPillButtonTextColor:"#ff00ff",cardButtonSecondaryTextColor:"#ff00ff",gridColor:"#ff00ff",selectedGridColor:"#ff00ff",secondaryGridColor:"#ff00ff",windowBackgroundColor:"#ff00ff",underPageBackgroundColor:"#ff00ff",controlBackgroundColor:"#ff00ff",controlHoveredBackgroundColor:"#ff00ff",controlPressedBackgroundColor:"#ff00ff",cardBackgroundColor:"#ff00ff",cardBackgroundSelectedColor:"#ff00ff",cardHeaderColor:"#ff00ff",cardBorderColor:"#ff00ff",cardHeaderIconBackgroundColor:"#ff00ff",cardPillButtonBackgroundColor:"#ff00ff",windowBackgroundLightColor:"#ff00ff",titleColor:"#ff00ff",textColor:"#ff00ff",textBackgroundColor:"#ff00ff",textSecondaryBackgroundColor:"#ff00ff",selectedTextColor:"#ff00ff",selectedTextBackgroundColor:"#ff00ff",textErrorColor:"#ff00ff",cardSourceTextColor:"#ff00ff",controlColor:"#ff00ff",controlTextColor:"#ff00ff",controlHoveredTextColor:"#ff00ff",controlPressedTextColor:"#ff00ff",controlSecondaryTextColor:"#ff00ff",controlSecondaryHoveredTextColor:"#ff00ff",controlSecondaryPressedTextColor:"#ff00ff",selectedControlColor:"#ff00ff",selectedControlTextColor:"#ff00ff",hoveredControlColor:"#ff00ff",hoveredSelectedControlColor:"#ff00ff",secondaryHoveredControlColor:"#ff00ff",pressedControlColor:"#ff00ff",secondaryPressedControlColor:"#ff00ff",controlBorderColor:"#ff00ff",controlFocusedBorderColor:"#ff00ff",controlButtonBorderColor:"#ff00ff",controlBorderLightColor:"#ff00ff",controlPillBackgroundColor:"#ff00ff",controlPillHoverTextColor:"#ff00ff",controlPillSecondaryHoverTextColor:"#ff00ff",controlPillHoverBackgroundColor:"#ff00ff",controlPillSecondaryHoverBackgroundColor:"#ff00ff",controlPillTertiaryHoverBackgroundColor:"#ff00ff",controlPillPressedBackgroundColor:"#ff00ff",controlPillColor:"#ff00ff",controlPillSecondaryTextColor:"#ff00ff",controlPillPressedTextColor:"#ff00ff",controlPillBorderColor:"#ff00ff",controlPillHoverBorderColor:"#ff00ff",controlPillSecondaryHoverBorderColor:"#ff00ff",controlPillPressedBorderColor:"#ff00ff",calloutSecondaryBackgroundColor:"#ff00ff",cardButtonSecondaryBorderColor:"#ff00ff",disabledControlTextColor:"#ff00ff",keyboardFocusIndicatorColor:"#ff00ff",listViewBackgroundColor:"#ff00ff",listViewItemBackgroundColor:"#ff00ff",sectionListViewBackgroundColor:"#ff00ff",sectionListViewItemBackgroundColor:"#ff00ff",badgePrimaryBackgroundColor:"#ff00ff",badgePrimaryBorderColor:"#ff00ff",badgePrimaryTextColor:"#ff00ff",badgeSecondaryBackgroundColor:"#ff00ff",badgeSecondaryBorderColor:"#ff00ff",badgeSecondaryTextColor:"#ff00ff",folderBadgePrimaryBorderColor:"#ff00ff",primaryButtonBackground:"#ff00ff",primaryButtonBackgroundHovered:"#ff00ff",primaryButtonBackgroundPressed:"#ff00ff",primaryButtonBackgroundDisabled:"#ff00ff",primaryButtonBorder:"#ff00ff",primaryButtonBorderFocused:"#ff00ff",primaryButtonText:"#ff00ff",primaryButtonTextHovered:"#ff00ff",primaryButtonTextPressed:"#ff00ff",primaryButtonTextDisabled:"#ff00ff",buttonBackground:"#ff00ff",buttonBackgroundHovered:"#ff00ff",buttonBackgroundPressed:"#ff00ff",buttonBackgroundDisabled:"#ff00ff",buttonBorder:"#ff00ff",buttonBorderFocused:"#ff00ff",buttonBorderDisabled:"#ff00ff",systemRedColor:"#e63237",systemGreenColor:"#107c10",systemBlueColor:"#0078d7",systemOrangeColor:"#d83b01",systemYellowColor:"#ffb900",systemBrownColor:"#a2845e",systemPinkColor:"#ff2d55",systemPurpleColor:"#5c2d91",systemGrayColor:"#999999",highlightColor:"#ff00ff",shadowColor:"#ff00ff",outlookAlabaster:"#f8f8f8",outlookBlack:"#212121",outlookBlueHighlighted:"#cbe3f5",outlookBlueSelected:"#005b9e",outlookGray:"#8e8e93",outlookLightGray:"#a8a8ac",outlookMercury:"#e1e1e1",outlookRed:"#e63237",outlookSeashell:"#f1f1f1",flaggedNormalBackgroundColor:"rgba(253, 247, 232, 1.0)",flaggedSelectedBackgroundColor:"rgba(253, 245, 224, 1.0)",iconTintColor:"#ff00ff",cardHeaderIconTintColor:"#ff00ff",notificationBackgroundColor:"#c7e0f4",notificationTextColor:"#0078d7",activityIndicatorColor:"#0078d7",dividerColor:"#ff00ff",secondaryDividerColor:"#ff00ff",accentColor:"#ff00ff",secondaryBackgroundColor:"#ff00ff",tertiaryBackgroundColor:"#ff00ff",quaternaryBackgroundColor:"#ff00ff",placeholderBackgroundColor:"#ff00ff",menuBackground:"#ff00ff",menuItemBackgroundHovered:"#ff00ff",menuItemBackgroundChecked:"#ff00ff",menuItemBackgroundPressed:"#ff00ff",menuItemTextHovered:"#ff00ff",buttonTextHovered:"#ff00ff",buttonText:"#ff00ff",buttonTextPressed:"#ff00ff",buttonTextDisabled:"#ff00ff",menuItemText:"#ff00ff",menuItemTextChecked:"#ff00ff",buttonTextChecked:"#ff00ff",menuDivider:"#ff00ff",superAnnotation:"#ff00ff",teamsColor:"#ff00ff",teamsOofMessageColor:"#ff00ff",buttonIconTintColor:"#ff00ff",buttonIconDisableColor:"#ff00ff"};function Yr(){var e=Object(qr.b)(),t=24;return i.useMemo((function(){var n=e.name,r=e.host,o=e.colors,i=r.palette,a=r.colors;if(!r||!i||!a)throw new Error("Host theme is not fully defined.");return{themeName:n,semanticColors:Object(h.a)(Object(h.a)(Object(h.a)(Object(h.a)({},$r),{controlHoveredBackgroundColor:o.menuItemBackgroundHovered,controlPressedBackgroundColor:o.menuItemBackgroundPressed,controlBackgroundColor:"#00000000",controlBorderColor:o.buttonBorder,controlBorderLightColor:i.AccentLight,controlFocusedBorderColor:o.focusBorder,keyboardFocusIndicatorColor:i.AccentOutline,highlightColor:a.App6,controlTextColor:o.buttonText,controlHoveredTextColor:o.buttonTextHovered,controlPressedTextColor:o.buttonTextPressed,titleColor:o.bodyText,textColor:o.bodyText,textSecondaryBackgroundColor:i.Text,labelColor:o.subText,secondaryLabelColor:i.TextSecondary,controlSecondaryTextColor:i.TextSecondary,tertiaryLabelColor:i.TextCtlEmphasis,controlSecondaryHoveredTextColor:i.TextSecondaryHover,controlSecondaryPressedTextColor:i.TextSecondaryPressed,controlButtonBorderColor:i.TextSecondaryHover,windowBackgroundColor:i.Bkg,windowBackgroundLightColor:i.BkgCtlSubtleDisabled,linkColor:i.TextHyperlink,linkColorHover:i.BkgCtlEmphasisHover,hoveredControlColor:i.BkgCtlEmphasisHover,calloutSecondaryBackgroundColor:i.BkgCtlEmphasis,textErrorColor:i.TextError,controlPillColor:i.TextEmphasisHover,controlPillSecondaryTextColor:i.TextEmphasisHover,controlPillBorderColor:i.BkgCtlSubtleHover,controlPillBackgroundColor:i.BkgCtlSubtleHover,controlPillHoverTextColor:i.TextEmphasisHover,controlPillHoverBorderColor:i.BkgCtlSubtlePressed,controlPillHoverBackgroundColor:i.BkgCtlSubtlePressed,controlPillSecondaryHoverTextColor:i.TextEmphasisHover,controlPillSecondaryHoverBorderColor:i.BkgCtlSubtlePressed,controlPillSecondaryHoverBackgroundColor:i.BkgCtlSubtlePressed,controlPillTertiaryHoverBackgroundColor:i.BkgCtlPressed,controlPillPressedTextColor:i.TextCtlEmphasis,controlPillPressedBorderColor:i.BkgCtlEmphasis,controlPillPressedBackgroundColor:i.BkgCtlEmphasis,menuBackground:o.menuBackground,menuItemBackgroundHovered:o.menuItemBackgroundHovered,menuItemBackgroundChecked:o.menuItemBackgroundChecked,menuItemTextHovered:o.menuItemTextHovered,buttonTextHovered:o.buttonTextHovered,buttonText:o.buttonText,buttonTextPressed:o.buttonTextPressed,buttonTextDisabled:o.buttonTextDisabled,menuItemText:o.menuItemText,menuItemTextChecked:o.menuItemTextChecked,buttonTextChecked:o.buttonTextChecked,menuItemBackgroundPressed:o.menuItemBackgroundPressed,menuDivider:o.menuDivider,teamsColor:o.subText,teamsOofMessageColor:o.subText,primaryButtonBackground:o.primaryButtonBackground,primaryButtonBackgroundHovered:o.primaryButtonBackgroundHovered,primaryButtonBackgroundPressed:o.primaryButtonBackgroundPressed,primaryButtonBackgroundDisabled:o.primaryButtonBackgroundDisabled,primaryButtonBorder:o.primaryButtonBorder,primaryButtonBorderFocused:o.primaryButtonBorderFocused,primaryButtonText:o.primaryButtonText,primaryButtonTextHovered:o.primaryButtonTextHovered,primaryButtonTextPressed:o.primaryButtonTextPressed,primaryButtonTextDisabled:o.primaryButtonTextDisabled,buttonBackground:o.buttonBackground,buttonBackgroundHovered:o.buttonBackgroundHovered,buttonBackgroundPressed:o.buttonBackgroundPressed,buttonBackgroundDisabled:o.buttonBackgroundDisabled,buttonBorder:o.buttonBorder,buttonBorderFocused:o.buttonBorderFocused,buttonBorderDisabled:o.buttonBorderDisabled}),Jr(n,i)),Qr(n)),typography:{sizes:{xxxSmall:e.typography.sizes.secondary,xxSmall:e.typography.sizes.secondary,xSmall:e.typography.sizes.secondary,small:e.typography.sizes.secondary,medium:e.typography.sizes.secondary,large:e.typography.sizes.body,xLarge:e.typography.sizes.subheader,xxLarge:e.typography.sizes.subheader,xxxLarge:t},families:e.typography.families,weights:{light:e.typography.weights.regular,semiLight:e.typography.weights.regular,medium:e.typography.weights.regular,semiBold:e.typography.weights.semiBold,bold:e.typography.weights.semiBold}},icons:{},brandIcons:{},illustrations:{}}}),[e])}function Jr(e,t){switch(e){case"Colorful":case"DarkGray":case"Black":case"White":return{};case"HighContrast":return{controlPillColor:t.TextCtlSubtle,controlPillSecondaryTextColor:t.TextHyperlink,controlPillBorderColor:t.TextCtlSubtle,controlPillBackgroundColor:t.BkgCtl,controlPillHoverTextColor:t.TextCtlSubtleHover,controlPillHoverBorderColor:t.BkgCtlHover,controlPillHoverBackgroundColor:t.BkgCtlHover,controlPillSecondaryHoverTextColor:t.TextCtlSubtle,controlPillSecondaryHoverBorderColor:t.BkgCtlHover,controlPillSecondaryHoverBackgroundColor:t.BkgCtl,controlPillTertiaryHoverBackgroundColor:t.BkgCtlHover,controlPillPressedTextColor:t.TextCtlSubtleHover,controlPillPressedBorderColor:t.BkgCtlHover,controlPillPressedBackgroundColor:t.BkgCtlHover,textErrorColor:t.TextHyperlink,hoveredControlColor:t.StrokeCtlPressed,tertiaryLabelColor:t.BkgCtl,calloutSecondaryBackgroundColor:t.BkgCtlHover};default:return E(0,{})}}function Qr(e){switch(e){case"DarkGray":return{textSecondaryBackgroundColor:"#ffffff"};case"HighContrast":return{};case"Colorful":case"White":return t=Gr.c.colors,Object(h.a)({controlPillColor:t.primaryButtonBackgroundPressed,controlPillSecondaryTextColor:t.primaryButtonBackgroundPressed,controlPillHoverTextColor:t.primaryButtonBackgroundPressed,controlPillSecondaryHoverTextColor:t.primaryButtonBackgroundPressed,controlButtonBorderColor:t.primaryButtonTextDisabled,controlPillBorderColor:"#eff6fc",controlPillBackgroundColor:"#eff6fc",controlPillHoverBorderColor:"#deecf9",controlPillHoverBackgroundColor:"#deecf9",controlPillSecondaryHoverBorderColor:"#deecf9",controlPillSecondaryHoverBackgroundColor:"#deecf9",controlPillTertiaryHoverBackgroundColor:"#c7e0f4",teamsColor:"#6264a7",teamsOofMessageColor:"#b4009e"},Xr(t));case"Black":return function(){var e=Gr.b.colors;return Object(h.a)({controlButtonBorderColor:e.bodyDivider,teamsColor:"#7a7fea",teamsOofMessageColor:"#e959d9"},Xr(e))}();default:return E(0,{})}var t}function Xr(e){return{textColor:e.bodyText,labelColor:e.subText,secondaryLabelColor:e.buttonTextHovered,controlTextColor:e.buttonText,controlHoveredTextColor:e.buttonTextHovered,controlPressedTextColor:e.buttonTextPressed,controlSecondaryTextColor:e.subText,controlSecondaryHoveredTextColor:e.subText,controlSecondaryPressedTextColor:e.subText,controlBorderColor:e.bodyDivider,controlBorderLightColor:e.bodyDivider,controlFocusedBorderColor:e.focusBorder,controlButtonBorderColor:e.primaryButtonTextDisabled,controlHoveredBackgroundColor:e.buttonBackgroundHovered,controlPressedBackgroundColor:e.buttonBackgroundPressed,hoveredControlColor:e.themePrimary,linkColor:e.link,linkColorHover:e.linkHovered,calloutSecondaryBackgroundColor:e.primaryButtonBackgroundHovered,keyboardFocusIndicatorColor:e.bodyText,textErrorColor:e.errorText,notificationTextColor:e.neutralPrimaryAlt,textSecondaryBackgroundColor:"#ffffff"}}var Zr=function(){function e(){}return e.select=function(e){return"win32"in e?e.win32:e.default},e.OS="win32",e}(),eo=n(9);const{MSAppTheme:to}=eo.NativeModules;let no=to&&to.initialTheme&&to.initialTheme;const ro=to&&new eo.NativeEventEmitter(to);function oo(e){ro&&ro.addListener(to.APP_DID_CHANGE_THEME,e)}function io(e){ro&&ro.removeListener(to.APP_DID_CHANGE_THEME,e)}oo(e=>no=e||void 0);const ao={12:12,16:16,20:20,24:24,48:48};function so(e){const t=e.replace(/Filled$/,"").replace(/Regular$/,"").replace(/Mono$/,"").substr(-2);return ao[t]||24}var co=function(e,t,n){(void 0!==n&&!Object(U.a)(e[t],n)||void 0===n&&!(t in e))&&H(e,t,n)},lo=n(352),uo=n(228);var po=function(e){var t=new e.constructor(e.byteLength);return new uo.a(t).set(new uo.a(e)),t};var ho=function(e,t){var n=t?po(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var fo=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t},mo=Object.create,go=function(){function e(){}return function(t){if(!Object(ne.a)(t))return{};if(mo)return mo(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),bo=n(285),Co=Object(bo.a)(Object.getPrototypeOf,Object);var yo=function(e){return"function"!=typeof e.constructor||Object(ie.a)(e)?{}:go(Co(e))};var vo=function(e){return Object(ht.a)(e)&&Object(ee.a)(e)},To=n(200),So=n(208),Io=Function.prototype,Oo=Object.prototype,Eo=Io.toString,Po=Oo.hasOwnProperty,ko=Eo.call(Object);var Ro=function(e){if(!Object(ht.a)(e)||"[object Object]"!=Object(pt.a)(e))return!1;var t=Co(e);if(null===t)return!0;var n=Po.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Eo.call(n)==ko},xo=n(226);var Do=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},wo=n(304);var Ao=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},jo=Object.prototype.hasOwnProperty;var _o=function(e){if(!Object(ne.a)(e))return Ao(e);var t=Object(ie.a)(e),n=[];for(var r in e)("constructor"!=r||!t&&jo.call(e,r))&&n.push(r);return n};var Fo=function(e){return Object(ee.a)(e)?Object(wo.a)(e,!0):_o(e)};var Mo=function(e){return z(e,Fo(e))};var No=function(e,t,n,r,o,i,a){var s=Do(e,n),c=Do(t,n),d=a.get(c);if(d)co(e,n,d);else{var l=i?i(s,c,n+"",e,t,a):void 0,u=void 0===l;if(u){var p=Object(x.a)(c),h=!p&&Object(To.a)(c),f=!p&&!h&&Object(xo.a)(c);l=c,p||h||f?Object(x.a)(s)?l=s:vo(s)?l=fo(s):h?(u=!1,l=Object(lo.a)(c,!0)):f?(u=!1,l=ho(c,!0)):l=[]:Ro(c)||Object(R.a)(c)?(l=s,Object(R.a)(s)?l=Mo(s):Object(ne.a)(s)&&!Object(So.a)(s)||(l=yo(c))):u=!1}u&&(a.set(c,l),o(l,c,r,i,a),a.delete(c)),co(e,n,l)}};var Lo=function e(t,n,r,o,i){t!==n&&ir(n,(function(a,s){if(i||(i=new it.a),Object(ne.a)(a))No(t,n,s,r,e,o,i);else{var c=o?o(Do(t,s),a,s+"",t,n,i):void 0;void 0===c&&(c=a),co(t,s,c)}}),Fo)},Bo=oe((function(e,t,n){Lo(e,t,n)})),Ho={semanticColors:Object(h.a)(Object(h.a)({},$r),{hoveredControlColor:"#00000000"}),typography:{families:{primary:"Times New Roman",secondary:"Times New Roman",cursive:"Times New Roman",monospace:"Times New Roman",sansSerif:"Times New Roman",serif:"Times New Roman"},sizes:{xxxSmall:0,xxSmall:0,xSmall:0,small:0,medium:0,large:0,xLarge:0,xxLarge:0,xxxLarge:0},weights:{light:"900",semiLight:"900",medium:"900",semiBold:"900",bold:"900"}},icons:{},brandIcons:{},illustrations:{}},Uo=i.createContext(Ho),Vo=Uo,Wo=Ho;function zo(e){return Bo({},no||Wo,e)}function Ko(e,t,n){return function(r){var o=i.useState(zo(n)),a=o[0],s=o[1];return i.useEffect((function(){var e=function(e){s(zo(n))};return oo(e),null==t||t.addListener(e),function(){io(e),null==t||t.removeListener(e)}}),[t,n]),i.createElement(Uo.Provider,{value:a},i.createElement(e,Object(h.a)({},r)))}}function Go(e){return Ko(e,void 0)}Go((function(e){const{illustrations:t,...n}=e;return i.createElement(eo.Image,{...n,source:{uri:t[e.illustration]}})})),Go(e=>{const{brandIcon:t,brandIcons:n,style:r,...o}=e,a=so(t);return i.createElement(eo.Image,{...o,style:[{width:a,height:a},r],source:{uri:n[t]}})}),Go(e=>{const{semanticColors:t,icon:n,icons:r,...o}=e,a=so(n),s={transform:[{scaleX:eo.I18nManager.isRTL?-1:1}]};return i.createElement(eo.Image,{...o,style:[{tintColor:t.iconTintColor,width:a,height:a},e.style,s],source:{uri:r[n]}})});100..toString(),300..toString(),400..toString(),500..toString(),600..toString();var qo=["#3298db","#50bbc4","#32c270","#f07e21","#e6463c","#f0ce0e","#f069b1","#9e75db","#ac735f","#a5a5ab"];var $o=/\(([^)]*)\)/gi,Yo=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,Jo=/\s+/gi;var Qo=/\([^)]*\)|[\0-\u001F\!-\"$-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g;var Xo=eo.Image,Zo=Ge((function(e,t){var n=e.semanticColors;return eo.StyleSheet.create({container:Object(h.a)({alignItems:"center",flexDirection:"row",overflow:"hidden"},t.specifyContainerBorder?{borderWidth:eo.StyleSheet.hairlineWidth,borderColor:"transparent"}:{}),textBoy:{flex:1,color:t.useWhiteTextBoy?"#ffffff":n.sectionListViewItemBackgroundColor,textAlign:"center",textAlignVertical:"center"},userPhoto:{position:"absolute",left:0,top:0,overflow:"hidden",justifyContent:"center"}})}));function ei(e){var t=e.accessibilityLabel,n=e.accessible,r=e.email,o=e.imageSource,a=e.name,s=e.onError,c=e.onLoad,d=e.overrideUserColor,l=e.overrideUserInitials,u=e.placeholderImageSource,p=e.showPlaceholderImage,f=e.showTextBoy,m=e.size,g=e.style,b=e.acceptsKeyboardFocus,C=e.imageOverflowWorkaround,y=e.textOverflowWorkaround,v=e.specifyContainerBorder,T=e.useWhiteTextBoy,S=e.forceImageComponent,I=e.useOutlookMobileInitials,O=i.useContext(Vo),E=i.useMemo((function(){return{specifyContainerBorder:v,useWhiteTextBoy:T}}),[v,T]),P=Zo(O,E),k=f?d||function(e,t){if(!e&&!t)return"#eaeaea";var n=e+(t||""),r=Math.abs(function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}(n));return qo[r%qo.length]}(a,r):"transparent",R=m/2,x={width:m,height:m},D=p&&u,w={resizeMode:"cover",style:[P.userPhoto,x,C]},A=S?eo.Image:Xo,j=i.useMemo((function(){return l||(I?function(e,t){var n="";return e&&e.length>0?e.split(" ").forEach((function(e){var t=e.trim();if(!(t.length<1)){var r=t.substr(0,1);r.length>0&&-1===r.search(Qo)&&n.length<2&&(n+=r)}})):t.length>0&&(n=t.substr(0,1)),0===n.length&&(n="#"),n.toUpperCase()}(a,r):function(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace($o,"")).replace(Yo,"")).replace(Jo," ")).trim()).split(" ");return n.length>=2?(t+=n[0].charAt(0).toUpperCase(),t+=n[n.length-1].charAt(0).toUpperCase()):0!==n.length&&(t+=n[0].charAt(0).toUpperCase()),t}(a))}),[l,I,a,r]);return i.createElement(eo.View,Object(h.a)({style:[P.container,x,{borderRadius:R},{backgroundColor:k},g],accessible:n,accessibilityLabel:t},{acceptsKeyboardFocus:b}),f&&i.createElement(eo.Text,{style:[P.textBoy,{fontSize:Math.round(.4*m)},y],allowFontScaling:!1},j),D&&i.createElement(eo.Image,Object(h.a)({},w,{source:D,accessibilityIgnoresInvertColors:!0})),o&&i.createElement(A,Object(h.a)({},w,{key:o.uri,source:o,onLoad:c,onError:s,accessibilityIgnoresInvertColors:!0})))}function ti(e){var t=e.accessible&&Zr.select({windows:!0,default:void 0});e.hasOwnProperty("acceptsKeyboardFocus")&&(t=e.acceptsKeyboardFocus);var n=e.size/2,r=Zr.select({android:{borderRadius:n},macos:{borderRadius:n},win32:{borderRadius:n}}),o=Zr.select({macos:{borderRadius:n}}),a=Zr.select({windows:!0,win32:!0}),s=Zr.select({android:!0});return i.createElement(ei,Object(h.a)({},Object(h.a)(Object(h.a)({},e),{acceptsKeyboardFocus:t,imageOverflowWorkaround:r,textOverflowWorkaround:o,useWhiteTextBoy:a,specifyContainerBorder:s})))}var ni=n(430);const ri=Ge(e=>eo.StyleSheet.create({text:oi(e)}));function oi(e){switch(e){default:case"SmallStandard":case"SmallSecondary":return{fontFamily:"SegoeUI",fontSize:12,fontWeight:"normal"};case"MediumBold":return{fontFamily:"SegoeUI",fontSize:14,fontWeight:"normal"}}}var ii=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};function ai(e){const{children:t,style:n,textStyle:r}=e,o=ii(e,["children","style","textStyle"]),a=ri(r);return i.createElement(eo.Text,Object.assign({},o,{style:[a.text,n]}),t)}function si(){const e=Yr();return i.createElement(eo.ActivityIndicator,{color:e.semanticColors.activityIndicatorColor})}const ci="win32",di=e=>eo.Platform.select(e);function li(e){return i.createElement(ni.a,Object.assign({},e,{dismissBehaviors:["preventDismissOnKeyDown"]}))}const ui=40,pi=e=>i.createElement(ti,{accessibilityLabel:"",accessible:!1,acceptsKeyboardFocus:void 0,email:e.email,imageSource:e.source,name:e.displayName,showTextBoy:!0,size:e.size}),hi=e=>{const{onDismiss:t,children:n,calloutPositioningTarget:r,maxHeight:o}=e,a=Yr();return r?i.createElement(li,{onDismiss:t,target:r,maxHeight:o,borderColor:null==a?void 0:a.semanticColors.menuDivider,borderWidth:1,backgroundColor:null==a?void 0:a.semanticColors.menuBackground},n):null};var fi=function(){function e(e,t){this.timestamp=e,this.markName=t,this.privateFieldToPreventCastFromJsPlainObjects=42,this.privateFieldToPreventCastFromJsPlainObjects}return e.create=function(){return new e(Date.now(),me())},e.createStart=function(t){return new e(t,"start")},e.NullInstance=new e(-1,""),e}(),mi=fi.NullInstance,gi=fi.create,bi=(fi.createStart,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stats=void 0,t}return Object(h.c)(t,e),t.prototype.componentDidMount=function(){this.addRenderToStats()},t.prototype.componentDidUpdate=function(){this.addRenderToStats()},t.prototype.componentWillUnmount=function(){this.logStats()},t.prototype.render=function(){switch(i.Children.count(this.props.children)){case 0:return null;case 1:return i.Children.only(this.props.children);default:return i.createElement(i.Fragment,null,this.props.children)}},t.prototype.shouldAddMeasure=function(){return!(!!this.stats&&this.stats.finishedLoading)&&!!this.props.finishedLoading&&!!this.props.navigationStartCheckpoint.markName},t.prototype.addRenderToStats=function(){var e=Date.now(),t=this.props.navigationStartCheckpoint;if(this.stats&&this.stats.navigationStartCheckpoint!==t&&this.logStats(),this.shouldAddMeasure())try{performance.measure("⏳ EUPL : ".concat(this.props.componentName),this.props.navigationStartCheckpoint.markName)}catch(e){}this.stats?this.stats.finishedLoading?this.stats=ue(this.stats,{extraRenderCount:this.stats.extraRenderCount+1}):this.stats=ue(this.stats,{lastRenderTime:e,renderCount:this.stats.renderCount+1,finishedLoading:!!this.props.finishedLoading}):this.stats={navigationStartCheckpoint:t,firstRenderTime:e,lastRenderTime:e,renderCount:1,finishedLoading:!!this.props.finishedLoading,extraRenderCount:0}},t.prototype.logStats=function(){if(this.stats){var e=this.stats.navigationStartCheckpoint!==mi,t=e?this.stats.lastRenderTime-this.stats.navigationStartCheckpoint.timestamp:0,n=e?Object(h.a)(Object(h.a)({},this.props.logProperties||{}),{componentName:this.props.componentName,navigationStartTime:this.stats.navigationStartCheckpoint.timestamp.toString(),firstRenderTime:this.stats.firstRenderTime.toString(),lastRenderTime:this.stats.lastRenderTime.toString(),renderCount:this.stats.renderCount.toString(),finishedLoading:this.stats.finishedLoading?"true":"false",extraRenderCount:this.stats.extraRenderCount.toString()}):Object(h.a)(Object(h.a)({},this.props.logProperties||{}),{componentName:this.props.componentName});this.props.logResult("EUPL_".concat(this.props.componentName),this.props.featureName,t,n),this.stats=void 0}},t}(i.Component));var Ci;!function(e){e[e.ESCAPE=0]="ESCAPE",e[e.ENTER=1]="ENTER",e[e.UP=2]="UP",e[e.DOWN=3]="DOWN",e[e.TAB=4]="TAB"}(Ci||(Ci={}));const yi=e=>class extends i.Component{constructor(e){super(e),this.onQueryChanged=e=>{const{inputId:t,lppAppContext:n,shouldSkipFirstSuggestionFocus:r}=this.props;!function(e,t,n){t.length>=200||(e.dispatch(T({query:t,inputId:n})),Wr(e,t))}(n,e,t);const o=r?-1:0;this.resetSelectedSuggestionIndex(o);const i=gi();this.setState({navigationStartCheckpoint:i,loadSuggestionsAmountMultiplier:1})},this.onCustomKeyPressed=e=>{const{isOpen:t}=this.props;if(t)switch(e){case Ci.DOWN:case Ci.UP:this.onSelectedSuggestionIndexChanged(e);break;case Ci.ESCAPE:this.onDismissed("userDismissed");break;case Ci.TAB:case Ci.ENTER:this.onSelectSuggestionKeyPressed()}},this.onSelectSuggestionKeyPressed=()=>{const{suggestionsSet:{suggestions:e}}=this.props,{selectedSuggestionIndex:t}=this.state;if(0===e.length||t<0||t>=e.length)return;const n=e[t];this.onSuggestionSelected(n)},this.onSuggestionSelected=e=>{const{currentQuery:t,inputId:n,lppAppContext:r,onSuggestionSelected:o,suggestionsSet:i}=this.props,a=i.suggestions.map(t=>e.Id===t.Id).indexOf(!0);!function(e,t,n,r,o,i){e.dispatch(O({suggestionSource:t.Source,suggestionOrigin:t.SuggestionOrigin,inputId:n,queryLength:r,suggestionsShown:o,pickedSuggestionIndex:i}))}(r,e,n,t.length,i.suggestions.length,a),o&&o(e),this.onDismissed("suggestionSelected"),this.resetSelectedSuggestionIndex()},this.onDismissed=e=>{const{currentQuery:t,inputId:n,lppAppContext:r,onDismiss:o,suggestionsSet:i}=this.props;o&&o(),Kr(r,e,n,t.length,i.suggestions.length),this.resetSelectedSuggestionIndex()},this.onScrollEndApproaching=()=>{const{currentQuery:e,lppAppContext:t}=this.props,{loadSuggestionsAmountMultiplier:n}=this.state;if(t.settings.loadMoreSuggestionsOnScroll&&n<3){const r=n+1,{inputId:o}=this.props;!function(e,t,n,r){Wr(e,t,r),e.dispatch(v({query:t,inputId:n}))}(t,e,o,r),this.setState(Object.assign(Object.assign({},this.state),{loadSuggestionsAmountMultiplier:r}))}},this.onSelectedSuggestionIndexChanged=e=>{const{suggestionsSet:{suggestions:t}}=this.props,{selectedSuggestionIndex:n}=this.state;let r=-1;r=e===Ci.DOWN?Math.min(n+1,t.length-1):Math.max(n-1,0),this.resetSelectedSuggestionIndex(r)},this.resetSelectedSuggestionIndex=(e=-1)=>{this.setState({selectedSuggestionIndex:e})},this.state={loadSuggestionsAmountMultiplier:1,navigationStartCheckpoint:mi,selectedSuggestionIndex:-1}}shouldComponentUpdate(e,t){const{lppAppContext:n}=this.props;return this.props.isOpen&&!e.isOpen&&n.generateNewSuggestionListCorrelationId(),!Object(Ue.a)(this.props,e)||!Object(Ue.a)(this.state,t)}componentDidMount(){const{componentRef:e}=this.props;e&&e(this)}componentWillUnmount(){const{componentRef:e}=this.props;e&&e(null)}render(){const{suggestionsSet:t,lppAppContext:n}=this.props,{navigationStartCheckpoint:r,selectedSuggestionIndex:o}=this.state,a=Object.assign(Object.assign({},this.props),{selectedSuggestionIndex:o});return i.createElement(bi,{componentName:"SuggestionListCallout",featureName:"Performance",navigationStartCheckpoint:r,finishedLoading:t.suggestions.length>0||"Finished"===t.queryStatus,logResult:n.createEUPLLogFunction()},i.createElement(e,Object.assign({},a,{onSuggestionSelected:this.onSuggestionSelected,onScrollEndApproaching:this.onScrollEndApproaching})))}};var vi=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Ti=e=>i.createElement(eo.View,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center",paddingTop:10}},i.createElement(si,null),i.createElement(ai,{style:eo.StyleSheet.flatten([{paddingLeft:6},e.textStyle]),textStyle:"SmallSecondary"},e.text)),Si={centeredText:{flexDirection:"row",justifyContent:"center",alignItems:"center",paddingTop:10}},Ii=Ge(e=>eo.StyleSheet.create({centeredText:Si.centeredText,secondaryLabelColor:{color:null==e?void 0:e.semanticColors.labelColor}})),Oi=e=>{const t=Ii(e.theme);switch(e.queryStatus){case"InProgress":return i.createElement(Ti,{text:e.strings.loading,textStyle:t.secondaryLabelColor});case"Finished":return Ei(e,t);default:return null}},Ei=(e,t)=>{const n=(e=>{const{strings:t}=e;if(e.suggestionsSetHasErrors)return t.error;switch(e.suggestionsSetCompleteness){case"Empty":return t.emptyResults;case"Limited":return t.limitedResults;case"Full":return t.allResults;default:return E(e.suggestionsSetCompleteness,"")}})(e);return i.createElement(eo.View,{style:t.centeredText},i.createElement(ai,{style:t.secondaryLabelColor,textStyle:"SmallSecondary"},n))};const Pi={suggestionInfoContainer:{flexDirection:"row",alignItems:"center"},contentContainer:{overflow:"hidden",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},image:{alignSelf:"center",marginVertical:12},descriptionContainer:{alignItems:"center",flex:1,flexDirection:"row",justifyContent:"space-between",paddingRight:12,paddingVertical:12}},ki=Ge(({semanticColors:e},t,n)=>t?{backgroundColor:n?e.menuItemBackgroundHovered:e.menuItemBackgroundPressed,borderWidth:1,borderColor:e.controlFocusedBorderColor,borderStyle:"solid"}:{backgroundColor:n?e.menuItemBackgroundHovered:e.menuBackground}),Ri=Ge(({semanticColors:e},t,n)=>t?{color:n?e.menuItemTextHovered:e.buttonTextPressed}:{color:n?e.menuItemTextHovered:e.buttonText}),xi=Ge(({semanticColors:e},t,n)=>t?{color:n?e.menuItemTextHovered:e.buttonTextPressed}:{color:n?e.menuItemTextHovered:e.menuItemText}),Di=Ge(({semanticColors:e})=>eo.StyleSheet.create({contentContainer:Object.assign(Object.assign({},Pi.contentContainer),{backgroundColor:e.menuBackground,paddingHorizontal:16,minHeight:52}),image:Pi.image,descriptionContainer:Object.assign(Object.assign({},Pi.descriptionContainer),{marginLeft:16})}));function wi(e){const[t,n]=i.useState(!1),r=Yr(),{onSuggestionPressed:o,isSelected:a}=e;return i.createElement(eo.TouchableHighlight,Object.assign({},{onPress:o},{accessibilityLabel:`${e.name} ${e.email}`,accessibilityActions:[{name:"Select"}],accessibilityRole:"tab",accessibilityState:{selected:a}}),i.createElement(eo.View,Object.assign({style:[Di(r).contentContainer,ki(r,a,t)]},{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)},{accessibilityState:{selected:a},accessibilityActions:[{name:"Select"}]}),i.createElement(Ai,Object.assign({},e,{isHovered:t,isSelected:a}))))}function Ai(e){const{email:t,name:n,imageSource:r,isSelected:o,onSuggestionInFocus:a,itemPosition:s,totalCount:c,strings:d,isHovered:l=!1}=e,u=Yr(),p=Di(u),h="UserTypedSuggestion"===e.source?d.useThisAddress:t;return i.useEffect(()=>{o&&a&&a(`${n} ${t} `+d.selectedSuggestionAccessibilityLabel+" "+s+" "+d.selectedSuggestionNumberAccessibilityLabel+" "+c+".")},[o]),i.createElement(i.Fragment,null,i.createElement(pi,{accessibilityLabel:t,displayName:n,email:t,size:ui,source:r}),i.createElement(eo.View,{style:p.descriptionContainer},i.createElement(eo.View,null,i.createElement(ai,{style:xi(u,o,l),textStyle:"MediumBold",numberOfLines:1},n),i.createElement(ai,{style:Ri(u,o,l),textStyle:"SmallStandard",numberOfLines:1},h))))}class ji extends i.Component{componentDidMount(){null!=this.props.suggestionCount&&this.accessAnnouncement()}componentDidUpdate(e){null!=this.props.suggestionCount&&"Finished"===this.props.queryStatus&&"Finished"!==e.queryStatus&&this.accessAnnouncement()}accessAnnouncement(){eo.AccessibilityInfo.announceForAccessibility(0===this.props.suggestionCount?this.props.strings.emptyResults:this.props.strings.suggestionsAnnouncement+String(this.props.suggestionCount))}render(){return null}}function _i(e){const{data:t,renderItem:n,onEndReached:r,onEndReachedThreshold:o,ListFooterComponent:a,listItemHeight:s,listRef:c,keyboardShouldPersistTaps:d,scrollListStyle:l,onContentSizeChange:u}=e;return i.createElement(eo.ScrollView,{scrollEventThrottle:48,ref:c,style:l,onScroll:e=>{const t=e.nativeEvent.contentSize.height;e.nativeEvent.contentOffset.y>=t-s*o-e.nativeEvent.layoutMeasurement.height&&r()},keyboardShouldPersistTaps:d,onContentSizeChange:u,accessibilityRole:"win32"===ci?"tablist":void 0},t.map(n),i.createElement(a,null))}const Fi=Ge((e,t,n)=>Object.assign({width:e},di({win32:{height:Math.min(t,208)}}))),Mi=Ge(e=>eo.StyleSheet.create({container:{flex:0,alignItems:"stretch",flexDirection:"column",minHeight:52},informationMessage:{paddingVertical:12,height:52},content:{backgroundColor:null==e?void 0:e.semanticColors.menuBackground}}));function Ni(e){const t=i.useRef(null),n=i.useRef(null),{maxHeight:r,maxWidth:o,onSuggestionInFocus:a,onSuggestionPressed:s,suggestionsSet:c,selectedSuggestionIndex:d,strings:l,theme:u}=e,p=di({default:()=>eo.Dimensions.get("window"),win32:()=>({width:o||300})}),[h,f]=i.useState(p()),[m,g]=i.useState(52),{width:b}=h,C=Math.min(o||b,b),{completeness:y,hasErrors:v,queryStatus:T,suggestions:S}=c,I=S.length,O="win32"===ci?Yr():u,E=Mi(O),P=({window:e})=>{f(e)};i.useEffect(()=>{di({default:()=>(eo.Dimensions.addEventListener("change",P),()=>{eo.Dimensions.removeEventListener("change",P)}),win32:()=>{}})()},[]);const k=e=>{if(t&&t.current)try{const n=m*e;eo.InteractionManager.runAfterInteractions(()=>{var e;null===(e=null==t?void 0:t.current)||void 0===e||e.scrollTo({x:0,y:n,animated:!0})})}catch(e){}};return i.useEffect(()=>{var n;S&&S.length&&k(Math.max(0,d)),null===(n=e.accessibilityRef)||void 0===n||n.call(e,t)},[]),i.useEffect(()=>{S&&d>-1&&d<S.length&&k(d)},[d]),i.useEffect(()=>{S&&0===S.length&&a&&a("")},[S&&S.length>0]),i.useEffect(()=>{(function(){return vi(this,void 0,void 0,(function*(){return Promise.resolve(!1)}))})().then(e=>{e&&n.current})}),i.createElement(eo.SafeAreaView,{style:[Fi(C,r,I),E.container]},i.createElement(ji,{queryStatus:c.queryStatus,suggestionCount:I,strings:l}),i.createElement(_i,{listRef:t,scrollListStyle:E.content,listItemHeight:Math.max(52,m),keyboardShouldPersistTaps:"always",onEndReached:()=>{const{onScrollEndApproaching:t}=e;t&&t()},onEndReachedThreshold:.5,onContentSizeChange:(e,t)=>{g((t-52)/I)},ListFooterComponent:()=>i.createElement(eo.View,{style:E.informationMessage},i.createElement(Oi,{key:"information",queryStatus:T,suggestionsSetHasErrors:v,suggestionsSetCompleteness:y,strings:l,theme:u})),data:S,renderItem:(e,t)=>i.createElement(wi,{id:"SuggestionInfo_"+e.Id,suggestionRef:t===d?n:void 0,key:e.Id,theme:O,email:gr(e),isSelected:t===d,name:e.Name,onSuggestionInFocus:a,onSuggestionPressed:()=>s(e),imageSource:e.ImageSource,source:e.Source,itemPosition:t+1,totalCount:I,strings:l})}))}class Li extends i.Component{constructor(){super(...arguments),this.id=void 0}componentDidMount(){const{isOpen:e,onShow:t}=this.props;e&&t&&t();const{lppAppContext:n}=this.props,r=n.clientType;"OfficeiOS"!==r&&"OfficeAndroid"!==r&&"OfficeWin32"!==r||(this.id=setInterval(()=>null,500))}componentWillUnmount(){this.id&&clearInterval(this.id)}render(){const{isOpen:e}=this.props;if(!e)return null;const{maxHeight:t,maxWidth:n,selectedSuggestionIndex:r,onSuggestionInFocus:o,strings:a,suggestionsSet:s,onSuggestionSelected:c,onScrollEndApproaching:d,theme:l,onSuggestionHighlighted:u,suggestionListId:p,accessibilitySelectionRef:h}=this.props;return i.createElement(Ni,{maxHeight:t,maxWidth:n,selectedSuggestionIndex:r,onSuggestionPressed:c,onSuggestionInFocus:o,suggestionsSet:s,strings:a,onScrollEndApproaching:d,theme:l,suggestionListId:p,onSuggestionHighlighted:u,accessibilityRef:h})}}Object(a.connect)((e,t)=>{const{selectedSuggestions:n,inputId:r}=t,o=Sr(e,r),i=Nr(e,o,n);return Object.assign(Object.assign({},t),{currentQuery:o,suggestionsSet:i})})(yi(Li));class Bi extends i.Component{constructor(){super(...arguments),this.onCalloutDismissed=()=>{const{currentQuery:e,inputId:t,lppAppContext:n,onDismiss:r,suggestionsSet:o}=this.props;r&&r(),Kr(n,"userDismissed",t,e.length,o.suggestions.length)}}render(){const{isOpen:e}=this.props;if(!e)return null;const{currentQuery:t,maxHeight:n,maxWidth:r,strings:o,calloutPositioningTarget:a,inputId:s,onShow:c,onDismiss:d,calloutAnchorRectangle:l,onSuggestionInFocus:u,onSuggestionSelected:p,selectedSuggestions:h,lppAppContext:f,suggestionsSet:m,selectedSuggestionIndex:g,onScrollEndApproaching:b,theme:C,onSuggestionHighlighted:y,suggestionListId:v,preventDismissOnScroll:T,accessibilitySelectionRef:S}=this.props;return i.createElement(hi,{maxHeight:n,maxWidth:r,onDismiss:this.onCalloutDismissed,calloutAnchorRectangle:l,calloutPositioningTarget:a,inputId:s,preventDismissOnScroll:T},i.createElement(Li,{currentQuery:t,isOpen:e,inputId:s,maxHeight:n,maxWidth:r,onScrollEndApproaching:b,onSuggestionInFocus:u,onSuggestionSelected:p,onShow:c,onDismiss:d,selectedSuggestions:h,strings:o,lppAppContext:f,suggestionsSet:m,selectedSuggestionIndex:g,theme:C,suggestionListId:v,onSuggestionHighlighted:y,accessibilitySelectionRef:S}))}}const Hi=Object(a.connect)((e,t)=>{const{selectedSuggestions:n,inputId:r}=t,o=Sr(e,r),i=Nr(e,o,n);return Object.assign(Object.assign({},t),{currentQuery:o,suggestionsSet:i})})(yi(Bi));var Ui="ClientTimeStamp",Vi="QoSTransactionId",Wi="SourceCorrelationId",zi="Success",Ki="ExpectedFailure",Gi="UnexpectedFailure",qi="MonitorInInvalidState",$i=["Network","RESTAuthToken","TTLCacheUtils","BundleDownload","OfficeFeedIsReadyStatus","OfficeFeedVerbose"],Yi=["Stikkontakt","DataLoadStartAction","NoLogging","None"];function Ji(e){return $i.indexOf(e)>-1}function Qi(e){return-1===Yi.indexOf(e)}var Xi,Zi,ea=function(){function e(e,t,n,r,o,i,a){this.eventHubPromise=e,this.monitoringData=t,this.scenarioName=n,this.featureName=r,this.staticProperties=o,this.lookupError=i,this.isVerboseLoggingEnabled=a,this.isFinished=!1,this.isInvalid=!1,this.lastScenarioState=qi,this.transactionId=F(),this.start()}return e.prototype.flush=function(){return this.eventHubPromise.then((function(e){return e.broadcastFlush()}))},e.prototype.success=function(e,t){this.endEvent(e,zi,t)},e.prototype.expectedFailure=function(e,t){this.endEvent(e,Ki,t)},e.prototype.unexpectedFailure=function(e,t){this.endEvent(e,Gi,t)},e.prototype.dispose=function(){this.isInvalid||!this.isFinished?this.broadcastEvent(void 0,qi):this.broadcastEvent(this.lastTag,this.lastScenarioState,this.lastProperties)},e.prototype.start=function(){this.startTime=(new Date).getTime()},e.prototype.endEvent=function(e,t,n){this.isFinished&&(this.isInvalid=!0),this.startTime?(this.duration=(new Date).getTime()-this.startTime,this.lastScenarioState=t):this.lastScenarioState=qi,this.lastTag=e,this.lastProperties=n,this.isFinished=!0,this.dispose()},e.prototype.broadcastEvent=function(e,t,n){return Object(h.b)(this,void 0,void 0,(function(){var r,o,i,a,s,c;return Object(h.d)(this,(function(d){switch(d.label){case 0:return!Qi(this.featureName)||Ji(this.featureName)&&!this.isVerboseLoggingEnabled?[2]:this.scenarioName&&this.monitoringData.source&&this.monitoringData.clientCorrelationId?(r=e?"".concat(this.scenarioName,"_").concat(t,"_").concat(e):"".concat(this.scenarioName,"_").concat(t),[4,this.eventHubPromise]):[3,5];case 1:return o=d.sent(),a=(i=o).broadcastEvent,c={eventId:r,version:this.monitoringData.version?this.monitoringData.version:"Unknown",type:"QoS"},n&&he(n.midgardError)?[4,this.lookupError(n.midgardError)]:[3,3];case 2:return s=d.sent(),[3,4];case 3:s=void 0,d.label=4;case 4:a.apply(i,[(c.midgardError=s,c.source=this.monitoringData.source,c.featureName=this.featureName,c.clientCorrelationid=this.monitoringData.clientCorrelationId,c.qosScenarioName=this.scenarioName,c.qosEventType=t,c.qosTagId=null===e?void 0:e,c.duration=this.duration,c.properties=this.getProperties(n),c)]),d.label=5;case 5:return[2]}}))}))},e.prototype.getProperties=function(e){var t;return Object(h.a)(Object(h.a)(Object(h.a)(Object(h.a)({},e),((t={})[Ui]=(new Date).getTime().toString(),t[Vi]=this.transactionId,t)),this.monitoringData.properties),this.staticProperties())},e}(),ta=function(){function e(e,t,n,r){var o=this;this.eventHubPromise=e,this.monitoringData=t,this.logVerbose=n,this.staticProperties=r,this.errorMap={},this.registerErrors=function(e,t){o.errorMap[e]=Object(h.a)({},t)},this.logEUPL=function(e,t,n,r){var i=zi,a="".concat(e,"_").concat(i);o.eventHubPromise.then((function(s){return s.broadcastEvent({eventId:a,version:o.monitoringData.version?o.monitoringData.version:"Unknown",type:"EUPL",source:o.monitoringData.source,featureName:t,clientCorrelationid:o.monitoringData.clientCorrelationId,qosScenarioName:e,qosEventType:i,qosTagId:void 0,duration:n,properties:o.getProperties(r)})}))},this.logQoS=function(e,t,n,r,i,a,s,c){if(Qi(r)&&(!Ji(r)||o.logVerbose())){var d=a?"".concat(e,"_").concat(t,"_").concat(a):"".concat(e,"_").concat(t);o.eventHubPromise.then((function(l){return l.broadcastEvent({eventId:d,version:o.monitoringData.version?o.monitoringData.version:"Unknown",type:"QoS",midgardError:c&&he(c.midgardError)?o.lookupError(c.midgardError):void 0,source:o.monitoringData.source,featureName:r,clientCorrelationid:o.monitoringData.clientCorrelationId,qosScenarioName:e,qosEventType:t,qosTagId:null===a?void 0:a,duration:i,properties:o.getProperties(Object(h.a)(Object(h.a)({},c),{result:n,RequestId:s}))})}))}}}return e.prototype.startMonitor=function(e,t){var n=this;return new ea(this.eventHubPromise,this.monitoringData,e,t,(function(){return n.staticProperties()}),(function(e){return Promise.resolve(n.lookupError(e))}),this.logVerbose())},e.prototype.logEvent=function(e){this.log(e,"Event")},e.prototype.logUserInteractionEvent=function(e){var t={exportType:"UserInteraction",exportName:e.eventId};e=Object(h.a)({exportOptions:t},e),this.log(e,"Event")},e.prototype.logError=function(e){this.log(e,"Error")},e.prototype.logTrace=function(e){this.log(e,"Trace")},e.prototype.flush=function(){return this.eventHubPromise.then((function(e){return e.broadcastFlush()}))},e.prototype.destroy=function(){return this.eventHubPromise.then((function(e){return e.broadcastDestroy()}))},e.prototype.setEventHub=function(e){this.eventHubPromise=Promise.resolve(e)},e.prototype.getEventHub=function(){return this.eventHubPromise},e.prototype.getStaticProperties=function(){return this.staticProperties},e.prototype.setStaticProperties=function(e){this.staticProperties=e},e.prototype.lookupError=function(e){if(!he(e))return"Invalid midgardError";var t=this.errorMap[e.family];if(!t)return"Unknown family ".concat(e.family,": ").concat(e.code);var n=t[e.code];return n?"".concat(e.family,": ").concat(n):"Unknown code: ".concat(e.family,": ").concat(e.code)},e.prototype.log=function(e,t){!Qi(e.featureName)||Ji(e.featureName)&&!this.logVerbose()||this.broadcastEvent(e.eventId,e.featureName,t,e.exportOptions,e.properties)},e.prototype.broadcastEvent=function(e,t,n,r,o){var i=this;e&&this.monitoringData.source&&this.monitoringData.clientCorrelationId&&this.eventHubPromise.then((function(a){return a.broadcastEvent({eventId:e,version:i.monitoringData.version?i.monitoringData.version:"Unknown",type:n,midgardError:o&&he(o.midgardError)?i.lookupError(o.midgardError):void 0,source:i.monitoringData.source,featureName:t,clientCorrelationid:i.monitoringData.clientCorrelationId,qosScenarioName:void 0,qosEventType:void 0,qosTagId:void 0,duration:void 0,exportOptions:r,properties:i.getProperties(o)})}))},e.prototype.getProperties=function(e){var t;return Object(h.a)(Object(h.a)(Object(h.a)(((t={})[Ui]=(new Date).getTime().toString(),t),this.monitoringData.properties),this.staticProperties()),e)},e}(),na=function(){function e(e,t,n,r){this._source=e,this._version=t,this._properties=r||{},this._clientCorrelationId=n&&n.trim()||"",(this._clientCorrelationId.length<32||this._clientCorrelationId.length>100)&&(this._clientCorrelationId=F(),n&&(this._properties[Wi]=n))}return Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientCorrelationId",{get:function(){return this._clientCorrelationId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),e}(),ra=function(){function e(e){this.consumers=e||[]}return e.prototype.broadcastEvent=function(e){e&&this.consumers.forEach((function(t){t.canConsumeEvent(e)&&t.consume(e)}))},e.prototype.broadcastFlush=function(){return Promise.all(this.consumers.map((function(e){return e.flush()}))).then()},e.prototype.broadcastDestroy=function(){this.consumers.forEach((function(e){e.destroy()}))},e.prototype.registerConsumer=function(e){this.consumers.push(e)},e}();(Zi=Xi||(Xi={})).TopLevel="https://loki.delve.office.com",Zi.Blackforest="https://loki.delve.office.de",Zi.GccModerate="https://gcc.loki.delve.office.com",Zi.GccHigh="https://gcchigh.loki.office365.us",Zi.DOD="https://dod.loki.office365.us",Zi.Gallatin="https://loki.office365.cn",Zi.Dogfood="https://df.loki.delve.office.com",Zi.MSIT="https://msit.loki.delve.office.com",Zi.AG08="https://loki.officenet.eaglex.ic.gov",Zi.AG09="https://loki.officenet.microsoft.scloud";var oa=function(e,t){var n={};return t=Ut(t,3),ar(e,(function(e,r,o){H(n,r,t(e,r,o))})),n},ia=Object.prototype.hasOwnProperty,aa=dr((function(e,t,n){ia.call(e,n)?e[n].push(t):H(e,n,[t])})),sa=y("LOAD_STATE",{featureName:"NoLogging"});function ca(e,t){var n,r;if(t&&t.stores)throw new Error("The '".concat("stores","' key of the state tree is reserved for functional stores."));if(t&&t.selectors)throw new Error("The '".concat("selectors","' key of the state tree is reserved for debug output from selectors."));var i,a,s,c,d=oa(aa(e,(function(e){return e.name})),(function(e){return e[0].reducer})),l=Object(o.combineReducers)((a=function(e){return e},s=de(i=d).sort((function(e,t){return a(e.toString()).localeCompare(a(t.toString()))})),c={},s.forEach((function(e){c[e]=i[e]})),c)),u=Object(o.combineReducers)(Object(h.a)(((n={}).stores=l,n),t||{})),p=((r={}).stores={},r);return function(e,t){return t.type===sa.toString()?t.payload:u(e||p,t)}}var da=n(315),la={exportCss:function(){}};function ua(e,t){console.error("Exception in ".concat(e)),console.error(t)}function pa(e){if(!e||!e.handleException)return{handleException:ua};var t=!1;return{handleException:function(n,r){if(t)ua(n,r);else{t=!0;try{e.handleException(n,r)}finally{t=!1}}}}}var ha=pa(void 0),fa=1;function ma(e){return e._Name||e.name||"Unknown"}var ga,ba,Ca,ya=function(){function e(e){this.singletonsByIndex={},this._exceptionHandler=ha,this._cssExtractor=la,this.reduxStore=e&&e.reduxStore}return Object.defineProperty(e.prototype,"exceptionHandler",{get:function(){return this._exceptionHandler},set:function(e){this._exceptionHandler=pa(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cssExtractor",{get:function(){return this._cssExtractor},set:function(e){this._cssExtractor=e},enumerable:!1,configurable:!0}),e.prototype.addSingleton=function(e){if(this.findSingleton(e.constructor))throw new Error("Singleton ".concat(ma(e.constructor)," already exists."));var t,n=("number"!=typeof(t=e.constructor)._singleton_index&&(t._singleton_index=fa,fa+=1),t._singleton_index);if(void 0!==this.singletonsByIndex[n])throw new Error("Singleton with index ".concat(n," already exists."));this.singletonsByIndex[n]=e},e.prototype.getSingleton=function(e){var t=this.findSingleton(e);if(void 0===t)throw new Error("Singleton ".concat(ma(e)," not found."));return t},e.prototype.findSingleton=function(e){if("number"==typeof e._singleton_index){var t=this.singletonsByIndex[e._singleton_index];return t&&t.constructor===e?t:void 0}},e}(),va={appContext:da.instanceOf(ya).isRequired},Ta=n(353);function Sa(e){return"exportOptions"in e&&Boolean(e.exportOptions&&"UserInteraction"===e.exportOptions.exportType)}!function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(ga||(ga={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.RequiredDiagnosticData=10]="RequiredDiagnosticData",e[e.OptionalDiagnosticData=100]="OptionalDiagnosticData",e[e.RequiredServiceData=110]="RequiredServiceData",e[e.AlwaysOnRequiredServiceData=120]="AlwaysOnRequiredServiceData"}(ba||(ba={})),function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(Ca||(Ca={}));var Ia=console.log,Oa=function(){function e(e,t,n,r,o,i){void 0===t&&(t="NO_USER"),void 0===n&&(n="NO_USER"),void 0===r&&(r="NO_TENANT"),void 0===o&&(o="NO_REGION"),void 0===i&&(i=Ia),this.eventMapper=e,this._userAadObjectId=t,this._userPuid=n,this._tenantAadObjectId=r,this._lokiRegion=o,this.consoleLog=i}return e.prototype.getCommonProperties=function(e){return{userAadObjectId:this._userAadObjectId,userPuid:this._userPuid,tenantAadObjectId:this._tenantAadObjectId,lokiRegion:this._lokiRegion,isGDPREvent:Sa(e),isConsoleLogger:!0}},e.prototype.canConsumeEvent=function(e){return!0},e.prototype.consume=function(e){var t=this;if(e){var n=this.getCommonProperties(e),r=this.eventMapper({event:e,additionalProperties:n});r?(Array.isArray(r)||(r=[r]),r.forEach((function(e){var n,r=null===(n=e.awtEventData.properties)||void 0===n?void 0:n.eventId;try{var o=e.awtEventData.properties.properties&&JSON.parse(e.awtEventData.properties.properties);o&&(e.awtEventData.properties.properties=o)}catch(e){}t.consoleLog("%cLog: ".concat(e.awtEventData.name||e.awtEventData.Name," ").concat(r?"| ".concat(r):""," | Level: ").concat(ba[e.diagnosticLevel]," | Category: ").concat(ga[e.dataCategories]||e.dataCategories,"\n"),"font-weight: bold",e)}))):this.consoleLog(JSON.parse(JSON.stringify(e)))}},e.prototype.flush=function(){return Promise.resolve()},e.prototype.destroy=function(){},e}(),Ea={Generic:"",GDPR:""},Pa={Prod:{Generic:"67199ce661b3472494bbec0bf2e06c27-c34071ab-96bc-40d9-9162-7a83b521b4dd-7282",GDPR:"30b97846c6c640ed90e3b4e06d98a986-b6251ed6-9d7f-4e24-8ace-044e9613d08b-7662"},Dev:Ea,Blackforest:Ea,GccHigh:Ea,DoD:Ea,Gallatin:Ea,AG08:Ea,AG09:Ea,EUDB:Ea},ka=function(){function e(e,t,n,r,o,i){var a=this;this.sendTelemetryEvent=e,this.eventMapper=t,this.getEventName=n,this.makeDoubleDataField=r,this.makeStringDataField=o,this.makeBooleanDataField=i,this._userAadObjectId="NO_USER",this._userPuid="NO_USER",this._tenantAadObjectId="NO_TENANT",this._lokiRegion="NO_REGION",this.getEventDataFields=function(e){for(var t=[],n=e.properties||{},r=0,o=Object.keys(n);r<o.length;r++){var i=o[r];if(i){var s=n[i];switch(typeof s){case"number":t.push(a.makeDoubleDataField(i,s));break;case"string":t.push(a.makeStringDataField(i,s));break;case"boolean":t.push(a.makeBooleanDataField(i,s))}}}return t}}return e.prototype.canConsumeEvent=function(e){return Boolean(e)},e.prototype.consume=function(e){var t,n=this.getCommonProperties(e),r=Sa(e);if(r){var o=this.eventMapper({event:e,additionalProperties:n,eventNameOverride:null===(t=e.exportOptions)||void 0===t?void 0:t.exportName});this.log(o,r)}var i=this.eventMapper({event:e,additionalProperties:n});this.log(i,r)},e.prototype.log=function(e,t){var n=this;if(e)if(Array.isArray(e))e.forEach((function(e){var r=e.awtEventData,o=Object(h.f)(e,["awtEventData"]);n.sendTelemetryEvent(n.getEventName(r,t),n.getEventDataFields(r),o)}));else{var r=e.awtEventData,o=Object(h.f)(e,["awtEventData"]);this.sendTelemetryEvent(this.getEventName(r,t),this.getEventDataFields(r),o)}},e.prototype.flush=function(){return Promise.resolve()},e.prototype.destroy=function(){},Object.defineProperty(e.prototype,"userAadObjectId",{set:function(e){e&&(this._userAadObjectId=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userPuid",{set:function(e){e&&(this._userPuid=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenantAadObjectId",{set:function(e){e&&(this._tenantAadObjectId=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lokiRegion",{set:function(e){e&&(this._lokiRegion=e)},enumerable:!1,configurable:!0}),e.prototype.getCommonProperties=function(e){return{userAadObjectId:this._userAadObjectId,userPuid:this._userPuid,tenantAadObjectId:this._tenantAadObjectId,lokiRegion:this._lokiRegion,isGDPREvent:Sa(e)}},e}(),Ra={userAadObjectId:"",tenantAadObjectId:"",userPuid:""};function xa(e){switch(e){case"https://df.loki.delve.office.com/":return"df";case"https://msit.loki.delve.office.com/":return"msit";case"NO_REGION":return"NO_RING";default:return"prod"}}var Da=n(73);function wa(e){switch(e){case ba.RequiredDiagnosticData:return Da.DiagnosticLevel.BasicEvent;case ba.OptionalDiagnosticData:return Da.DiagnosticLevel.FullEvent;case ba.RequiredServiceData:return Da.DiagnosticLevel.NecessaryServiceDataEvent;case ba.AlwaysOnRequiredServiceData:return Da.DiagnosticLevel.AlwaysOnNecessaryServiceDataEvent;case ba.ReservedDoNotUse:throw new Error("Reserved Diagnostic Level not expected. Please change level immediately.");default:return E(0,Da.DiagnosticLevel.FullEvent)}}function Aa(e){switch(e){case Ca.NotSet:return Da.SamplingPolicy.NotSet;case Ca.Measure:return Da.SamplingPolicy.Measure;case Ca.Diagnostics:return Da.SamplingPolicy.Diagnostics;case Ca.CriticalBusinessImpact:return Da.SamplingPolicy.CriticalBusinessImpact;case Ca.CriticalCensus:return Da.SamplingPolicy.CriticalCensus;case Ca.CriticalExperimentation:return Da.SamplingPolicy.CriticalExperimentation;case Ca.CriticalUsage:return Da.SamplingPolicy.CriticalUsage;default:return E(0,Da.SamplingPolicy.NotSet)}}var ja=n(354);var _a=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}};var Fa=function(e,t,n,r){if(!Object(ne.a)(e))return e;for(var o=-1,i=(t=xt(t,e)).length,a=i-1,s=e;null!=s&&++o<i;){var c=Dt(t[o]),d=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=a){var l=s[c];void 0===(d=r?r(l,c,s):void 0)&&(d=Object(ne.a)(l)?l:Object(te.a)(t[o+1])?[]:{})}W(s,c,d),s=s[c]}return e};var Ma=function(e,t,n){for(var r=-1,o=t.length,i={};++r<o;){var a=t[r],s=wt(e,a);n(s,a)&&Fa(i,xt(a,e),s)}return i},Na=n(284),La=n(305),Ba=n(286),Ha=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Object(P.a)(t,Object(La.a)(e)),e=Co(e);return t}:Ba.a;var Ua=function(e){return Object(Na.a)(e,Fo,Ha)};var Va=function(e,t){if(null==e)return{};var n=Ot(Ua(e),(function(e){return[e]}));return t=Ut(t),Ma(e,n,(function(e,n){return t(e,n[0])}))};var Wa=function(e,t){return Va(e,_a(Ut(t)))},za=n(426);function Ka(e){return"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"===e}function Ga(e,t){var n=e[t];return Array.isArray(n)||"object"==typeof n?JSON.stringify(n):!1===n||0===n?n:n||""}var qa=function(e,t){var n=-1,r=Object(ee.a)(e)?Array(e.length):[];return sr(e,(function(e,o,i){r[++n]=t(e,o,i)})),r};var $a=function(e,t){return(Object(x.a)(e)?Ot:qa)(e,Ut(t,3))};var Ya=function(e,t){return A($a(e,t),1)};const Ja=["AppInfo.Name","clientCorrelationId","ClientTimeStamp","clientType","eventId","eventType","exportName","exportType","hostAppName","hostAppPlatform","region","ring","suggestionListCorrelationId","UserInfo.Id","UserInfo.IdType","UserInfo.MsaId","UserInfo.OMSTenantId","version"],Qa={ConfigurationSetAction:{properties:Ja},QueryChangedAction:{properties:Ja},PickerDismissedAction:{properties:Ja},SuggestionPressedAction:{properties:Ja},InitializationSuccessful:{properties:Ja},InitializationFailed:{properties:Ja},AdditionalSuggestionsRequestedAction:{properties:Ja}},Xa={QoSEvent:{properties:Object.assign(Object.assign(Object.assign(Object.assign({},Ja),["Feature","QoSTransactionId","RequestId","duration","qosEventType","qosScenarioName","rootCorrelationId"]),["didSearchDirectory","queryLength","responseLength"]),["RequestId","didMakeAuthTokenRequest","didMakeConfigRequest","durationWaitingOnAuthToken","isWebSocketRequest","iswebsocketrequest","lokiVersion","rootCorrelationId:","serverCorrelationId:","serverDatacenter:","serverInboundDuration:","x-beserver","x-correlationid","x-datacenter","x-inboundduration","x-serverversion"])},EUPLEvent:{properties:Object.assign(Object.assign({},Ja),["duration","componentName"])}};const Za=(es=function(e,t,n){const{userAadObjectId:r,userPuid:o,tenantAadObjectId:i,lokiRegion:a}=t,s=Object.assign({},e.properties);let c="",d="";if(e.exportOptions&&(c=e.exportOptions.exportType,d=e.exportOptions.exportName),"TTLCacheUtils"===e.featureName)return;const l={event:e,exportType:c,exportName:d,lokiRegion:a};let u;const p=function(e){return"EUPL"===e.type?"PerceivedLatency":"QoS"===e.type?"QoSEvent":"Generic"}(e);switch(p){case"QoSEvent":u=function(e){var t=e.event,n=e.properties;return{name:"QoSEvent",properties:{rootCorrelationId:Ga(n,"RequestId"),qosScenarioName:t.qosScenarioName||"",qosEventType:t.qosEventType||"",qosTagId:t.qosTagId||"",duration:void 0!==t.duration&&null!==t.duration?t.duration.toString():"",statusCode:Ga(n,"StatusCode"),midgardError:t.midgardError||"",retryAttemptedAfterAuthFailure:Ga(n,"RetryAttemptedAfterAuthFailure"),lokiVersion:Ga(n,"x-serverversion"),serverInboundDuration:Ga(n,"x-inboundduration"),serverCorrelationId:Ga(n,"x-correlationid"),serverDatacenter:Ga(n,"x-datacenter"),hostAppRing:Ga(n,"hostAppRing"),isWebSocketRequest:Ga(n,"iswebsocketrequest")}}}(Object.assign(Object.assign({},l),{properties:s}));break;case"PerceivedLatency":u=function(e,t){return{name:"PerceivedLatency",properties:{componentName:Ga(t,"componentName"),duration:void 0!==e.duration?e.duration.toString():"",renderCount:Ga(t,"renderCount"),finishedLoading:Ga(t,"finishedLoading"),sourceCorrelationId:Ga(t,"SourceCorrelationId")}}}(l.event,s);break;case"Generic":h=e.eventId,f={name:"Event"},h&&(f.properties={eventId:h}),u=f}var h,f;n&&(u.name=n);const m=Object.assign(Object.assign({},function(e){const{event:t,exportType:n,exportName:r,lokiRegion:o}=e,i=t.properties;return{clientCorrelationId:t.clientCorrelationid,suggestionListCorrelationId:i&&Ga(i,"suggestionListCorrelationId").toString()||"",clientType:t.source,version:t.version,eventId:t.eventId,hostAppVersion:i&&Ga(i,"hostAppVersion").toString()||"",hostAppRing:i&&Ga(i,"hostAppRing").toString()||"",hostAppName:i&&Ga(i,"hostAppName").toString()||"",hostAppPlatform:i&&Ga(i,"hostAppPlatform").toString()||"",hostAppCorrelationId:i&&Ga(i,"SourceCorrelationId").toString()||"",queryLength:i&&Ga(i,"queryLength").toString()||"",responseLength:i&&Ga(i,"responseLength").toString()||"",didSearchDirectory:i&&Ga(i,"didSearchDirectory").toString()||"",infoBarrierSegmentsCount:i&&Ga(i,"infoBarrierSegmentsCount").toString()||"",exportType:n,exportName:r,eventType:t.type,region:o,ring:xa(o)}}(l)),function(e){var t=e.appName,n=e.tenantAadObjectId,r=e.userPuid,o=e.userAadObjectId;return{"UserInfo.Id":Ka(n)?r:o,"UserInfo.MsaId":r,"UserInfo.IdType":Ka(n)?za.AWTUserIdType.MSAPUID:za.AWTUserIdType.UserObjectId,"UserInfo.OMSTenantId":n,"AppInfo.Name":t}}({appName:"Live Persona Picker",tenantAadObjectId:i,userAadObjectId:r,userPuid:o})),g=JSON.parse(JSON.stringify(e.properties));return u.properties=ue(u.properties||{},g),u.properties=ue(u.properties||{},Object.assign({},m)),function(e){e.properties=Wa(e.properties,(function(e){return null==e||""===e}))}(u),u},void 0===(ts=[(ns=r,function(e,t){var n=t.awtEventData.name;return n?ns.requiredEvents[n]?[Object(h.a)(Object(h.a)({},t),{diagnosticLevel:ba.RequiredDiagnosticData})]:ns.rsdEvents[n]?[Object(h.a)(Object(h.a)({},t),{diagnosticLevel:ba.RequiredServiceData})]:[Object(h.a)(Object(h.a)({},t),{diagnosticLevel:ba.OptionalDiagnosticData})]:[Object(h.a)(Object(h.a)({},t),{diagnosticLevel:ba.OptionalDiagnosticData})]}),(e,t)=>[Object.assign(Object.assign({},t),{dataCategories:ga.ProductServiceUsage|ga.ProductServicePerformance})],(e,t)=>[Object.assign(Object.assign({},t),{samplingPolicy:Ca.Measure})],function(e){var t={};return Object(ae.a)(e.requiredEvents).forEach((function(n){e.requiredEvents[n],t[n]=new Set(e.requiredEvents[n].properties||[])})),function(e,n){var r=n.awtEventData.name;if(!r)return[n];if(n.diagnosticLevel!==ba.RequiredDiagnosticData||!n.awtEventData.properties)return[n];var o=Va(n.awtEventData.properties,(function(e,n){return t[r].has(n)}));return[Object(h.a)(Object(h.a)({},n),{awtEventData:Object(h.a)(Object(h.a)({},n.awtEventData),{properties:o})})]}}(r)])&&(ts=[]),function(e){var t=es(e.event,e.additionalProperties,e.eventNameOverride);if(t){var n=Array.isArray(t)?t.map((function(e){return{awtEventData:e,dataCategories:ga.NotSet,diagnosticLevel:ba.OptionalDiagnosticData}})):[{awtEventData:t,dataCategories:ga.NotSet,diagnosticLevel:ba.OptionalDiagnosticData}];return ts.forEach((function(t){n=Ya(n,(function(n){return t(e.event,n)}))})),n}});var es,ts,ns;let rs=void 0;const os=()=>{rs=rs||as()},is=(e,t=!1)=>{if(t)return new Oa(Za);const n=new ka(ss,Za,cs,Da.makeDoubleDataField,Da.makeStringDataField,Da.makeBooleanDataField);if(e){const{UserAadObjectId:t,TenantAadObjectId:a,UserPuid:s,LokiUrl:c}=e,d=(r=null==t?void 0:t.Value,o=null==a?void 0:a.Value,function(e,t,n){return!!t&&!!e&&!!n}(r,o,i=s)?{userAadObjectId:r||"",tenantAadObjectId:o||"",userPuid:i||""}:Ra);n.userAadObjectId=d.userAadObjectId,n.userPuid=d.userPuid,n.tenantAadObjectId=d.tenantAadObjectId,c&&(n.lokiRegion=c)}var r,o,i;return n};function as(){const e=new Da.TelemetryLogger;return e.addSink(Object(ja.createOTelSink)()),e.setTenantTokens({Office:{LivePersonaPicker:{ariaTenantToken:Pa.Prod.Generic,nexusTenantToken:1791,UserActions:{ariaTenantToken:Pa.Prod.GDPR,nexusTenantToken:1792}}}}),e}const ss=(e,t,n)=>{rs||(rs=as(),console.error(`${os.name} call required before ${ss.name} calls`)),rs.sendTelemetryEvent({eventName:e,dataFields:t,eventFlags:{diagnosticLevel:wa(n.diagnosticLevel),samplingPolicy:n.samplingPolicy?Aa(n.samplingPolicy):Da.SamplingPolicy.NotSet,dataCategories:Da.DataCategories.ProductServiceUsage|Da.DataCategories.ProductServicePerformance}})},cs=(e,t)=>{var n;return t?"Office.LivePersonaPicker.UserActions."+((null===(n=e.properties)||void 0===n?void 0:n.exportName)||"UserActionsExported"):function(e){var t;return Boolean("UserInteraction"===(null===(t=e.properties)||void 0===t?void 0:t.exportType))}(e)?"Office.LivePersonaPicker.Events.UserActionsExported":e.name?"Office.LivePersonaPicker."+e.name.replace(/_/g,"."):"Office.LivePersonaPicker.Events"};const ds="LivePersonaPicker";var ls=n(320),us=n.n(ls);function ps(e){if(e)try{var t=function(e){const t=e.length%4;return us.a.decode(3===t?e+"=":2===t?e+"==":e)}(e.split(".")[1]),n=JSON.parse(t).exp;return n?1e3*n:void 0}catch(e){return}}var hs=Number.MAX_SAFE_INTEGER-1,fs=function(){function e(e,t,n,r){var o;this.value=e,this.featureName=t,this.logger=n,this.expirationTimeEpoch=null!==(o=null!=r?r:ps(e))&&void 0!==o?o:hs}return e.prototype.isApproachingExpiration=function(){return!!this.isValid()&&Date.now()>this.expirationTimeEpoch-24e4},e.prototype.isValid=function(){return!!this.value&&(this.expirationTimeEpoch,!(Date.now()>this.expirationTimeEpoch-12e4))},e.prototype.getValue=function(){return this.value},e.prototype.getExpirationTimeEpoch=function(){return this.expirationTimeEpoch},e}(),ms=n(229),gs=function(){function e(e){this.authTokenProviderState="Initial";var t=e.getAppId,n=e.refreshAuthToken,r=e.logger,o=e.runWithLogMonitor,i=e.authTokenType,a=e.featureName,s=e.storageKeySuffix,c=e.rateLimiter,d=void 0===c?new In(10,3e5):c,l=e.logUnknownErrorsForDogfoodUserOnlyFlightEnabled;r&&function(e){e("loki-auth-token",Cn)}(r.registerErrors),this.getAppId=t,this.refreshAuthToken=n,this.logger=r,this.runWithLogMonitor=o,this.authTokenType=i||fs,this.featureName=a||"RESTAuthToken",this.storageKeySuffix=s,this.rateLimiter=d,this.logUnknownErrorsForDogfoodUserOnlyFlightEnabled=l;var u=function(e,t){var n,r=gn(Pn(null!=t?t:""),e||"")||"",o=null!==(n=gn(kn(null!=t?t:""),e||""))&&void 0!==n?n:"",i=parseInt(o,10);return{value:r,expiration:isFinite(i)?i:void 0}}(this.getAppId(),this.storageKeySuffix);u&&(this.authToken=new this.authTokenType(u.value,this.featureName,this.logger,u.expiration)),this.getAuthToken(void 0).catch((function(e){}))}return e.prototype.getAuthToken=function(e){return Object(h.b)(this,void 0,void 0,(function(){var t;return Object(h.d)(this,(function(n){switch(n.label){case 0:if(t=this.checkAndGetAuthTokenIfValid())return[2,{token:t,request:{fromCache:!0,duration:0}}];if("DisabledConditionalAccess"===this.authTokenProviderState)throw{midgardError:En(Cn.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS)};return[4,this.getAuthTokenPromise({relatedRootCorrelationId:e,isForced:!1})];case 1:return[2,n.sent()]}}))}))},e.prototype.invalidateAuthToken=function(){var e,t;this.authTokenProviderState="Initial",this.authPromise=void 0,this.authToken=void 0,e=this.getAppId(),t=this.storageKeySuffix,bn(Pn(null!=t?t:""),e||""),bn(kn(null!=t?t:""),e||"")},e.prototype.hasAuthToken=function(){return Boolean(this.authToken)},e.prototype.isTokenInvalidated=function(e){return e!==this.authPromise},e.prototype.forceRefreshAuthToken=function(e){return Object(h.b)(this,void 0,void 0,(function(){var t;return Object(h.d)(this,(function(n){switch(n.label){case 0:if("DisabledConditionalAccess"===this.authTokenProviderState)throw{midgardError:En(Cn.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS)};n.label=1;case 1:return n.trys.push([1,4,,5]),"RequestPending"===this.authTokenProviderState?[3,3]:(t=this.authToken&&ue(this.authToken,{}),this.authToken=void 0,[4,this.getAuthTokenPromise({relatedRootCorrelationId:e,isForced:!0,existingToken:t})]);case 2:n.sent(),n.label=3;case 3:return[3,5];case 4:return n.sent(),[3,5];case 5:return[2]}}))}))},e.prototype.updateAuthTokenTtl=function(e){this.authToken&&(this.authToken=new this.authTokenType(this.authToken.getValue(),this.featureName,this.logger,Date.now()+1e3*e),this.updateTokenCacheWithCurrentToken())},e.prototype.checkAndGetAuthTokenIfValid=function(){var e=this.authToken;if(e&&e.isValid())return e.isApproachingExpiration()&&this.getAuthTokenPromise({relatedRootCorrelationId:void 0,isForced:!1}).catch((function(){})),e},e.prototype.requestNewAuthToken=function(e){var t=this;return new Promise((function(n,r){var o=void 0,i=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,Object(h.g)([e,t],n,!1))}((function(){o=Date.now(),r({midgardError:En(Cn.GET_AUTH_TOKEN_TIMEOUT)})}),3e4);t.refreshAuthToken((function(a,s,c,d){var l,u,p=function(e,t){var n=void 0;if(t&&(n={authRequestCorrelationId:t}),e&&"object"==typeof e){var r=parseInt(e.statusCode||"",10),o=parseInt(e.statusCode||"",10),i=parseInt(e.statusCode||"",10);n=Object(h.a)(Object(h.a)(Object(h.a)(Object(h.a)(Object(h.a)({},n),!isNaN(r)&&{statusCode:e.statusCode}||{}),!isNaN(o)&&{errorCode:e.errorCode}||{}),!isNaN(i)&&{protocolCode:e.protocolCode}||{}),e.headers&&e.headers["x-msedge-ref"]&&{traceId:_n(e)}||{})}return n}(s,c),f=s&&Rn(s)?function(e){var t,n;return"string"==typeof e?e.indexOf("AuthTokenInternetConnectionNotAvailable")>=0?En(Cn.DEVICE_CONNECTION_IS_NOT_AVAILABLE):e.indexOf("AuthTokenDisabledConditionalAccess")>=0?En(Cn.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS):En("AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED"===e?Cn.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED:"BAD_REFRESH_TOKEN"===e?Cn.BAD_REFRESH_TOKEN:"CONDITIONAL_ACCESS_BLOCKED"===e?Cn.CONDITIONAL_ACCESS_BLOCKED:"NO_RESPONSE_FROM_SERVICE"===e?Cn.NO_RESPONSE_FROM_SERVICE:"PRECONDITION_VIOLATED"===e?Cn.PRECONDITION_VIOLATED:Cn.UNKNOWN_STRING_ERROR):null!==(n=null!==(t=Fn(e.errorCode,e.statusCode,e.protocolCode))&&void 0!==t?t:Fn(e.protocolCode,e.statusCode,e.errorCode))&&void 0!==n?n:En(Cn.UNKNOWN_ERROR)}(s):void 0;if(o)null===(l=t.logger)||void 0===l||l.logTrace({eventId:ms.a,featureName:t.featureName,properties:Object(h.a)({hasToken:Boolean(a),msAfterTimeout:String(Date.now()-o),midgardError:f},f?{error:JSON.stringify(Object(h.a)({midgardError:f,authTokenDisabled:"DisabledConditionalAccess"===t.authTokenProviderState},p))}:{})});else if(clearTimeout(i),f)An(f)?r({midgardError:f,extraLogProps:Object(h.a)(Object(h.a)({},p),{authTokenDisabledForThisSession:"true"})}):r({midgardError:f,extraLogProps:p});else if(a){var m=d&&Date.now()+1e3*d;e&&(null===(u=e.getValue)||void 0===u?void 0:u.call(e))===a&&void 0===m&&(m=e.getExpirationTimeEpoch());var g=new t.authTokenType(a,t.featureName,t.logger,m);n(g)}else r({midgardError:En(Cn.EXPECTED_ERROR),extraLogProps:p})}))}))},e.prototype.getAuthTokenPromise=function(e){return Object(h.b)(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,c=this;return Object(h.d)(this,(function(d){switch(d.label){case 0:if(t=e.existingToken,n=e.isForced,r=e.relatedRootCorrelationId,"DisabledConditionalAccess"===this.authTokenProviderState)throw{midgardError:En(Cn.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS)};return o=(new Date).valueOf(),this.authPromise&&"RequestPending"===this.authTokenProviderState||(this.authTokenProviderState="RequestPending",i=new Promise((function(e,o){try{c.rateLimiter.execute((function(){var a;if(c.runWithLogMonitor){var s=void 0;r&&((a={}).relatedRootCorrelationId=r,a.isForced=n.toString(),s=a),c.runWithLogMonitor({scenarioName:ms.c,featureName:c.featureName,operation:function(){return c.requestNewAuthToken(t)},extraLogPropsOnFinish:{success:function(){return{}},failure:function(e){return e.extraLogProps||{}}},successAction:function(t){c.isTokenInvalidated(i)&&o({midgardError:En(Cn.EXPECTED_TOKEN_INVALIDATED_ERROR)}),t?e({token:t,request:{fromCache:!1,duration:0}}):o({midgardError:En(Cn.INVALID_AUTH_TOKEN)})},errorAction:function(e){return o(e)},treatAsExpectedError:function(e){return jn(e.midgardError)||!!navigator&&!1===navigator.onLine},extraProps:s})}else c.requestNewAuthToken(t).then((function(t){c.isTokenInvalidated(i)&&o({midgardError:En(Cn.EXPECTED_TOKEN_INVALIDATED_ERROR)}),e({token:t,request:{fromCache:!1,duration:0}})})).catch((function(e){return o(e)}))}))}catch(e){e instanceof Error&&"Rate limit reached"===e.message?o({midgardError:En(Cn.AUTH_RATE_LIMIT_EXCEEDED)}):o(e)}})).then((function(e){return c.onRefreshAuthTokenSuccess(e),e})).catch((function(e){if(c.logUnknownErrorsForDogfoodUserOnlyFlightEnabled&&"object"==typeof e&&e){var t=void 0,n=JSON.stringify(e,(function(e,t){if(t instanceof Error){var n={};return Object.getOwnPropertyNames(t).forEach((function(e){n[e]=t[e]})),n}return t})).substring(0,50);t=pe(e,"extraLogProps")?Object(h.a)(Object(h.a)({},e.extraLogProps),{unknownErrorForDogfoodUserOnly:n}):{unknownErrorForDogfoodUserOnly:n},e.extraLogProps=t}throw c.onRefreshAuthTokenError("object"==typeof e&&e&&pe(e,"midgardError")&&he(e.midgardError)?e.midgardError:En(Cn.UNKNOWN_ERROR_CAUGHT_IN_PROMISE),"object"==typeof e&&e&&pe(e,"extraLogProps")?e.extraLogProps:void 0),e})),this.authPromise=i),[4,this.authPromise];case 1:return a=d.sent(),s=Date.now(),[2,ue(a,{request:ue(a.request,{duration:s-o})})]}}))}))},e.prototype.updateTokenCacheWithCurrentToken=function(){var e,t,n,r;this.authToken&&(e=this.getAppId(),t=this.authToken.getValue()||"",n=this.authToken.getExpirationTimeEpoch(),r=this.storageKeySuffix,t&&(mn(Pn(null!=r?r:""),t,e||""),n&&mn(kn(null!=r?r:""),n.toString(),e||"")))},e.prototype.onRefreshAuthTokenSuccess=function(e){this.authTokenProviderState="Initial",this.authPromise=void 0,this.authToken=e.token,this.updateTokenCacheWithCurrentToken()},e.prototype.onRefreshAuthTokenError=function(e,t){var n;this.authTokenProviderState=An(e)?"DisabledConditionalAccess":"Initial",this.authPromise=void 0;var r=JSON.stringify(Object(h.a)({midgardError:e,authTokenDisabled:"DisabledConditionalAccess"===this.authTokenProviderState},t)).replace(/\\n/g,"(LF)").replace(/\\r/g,"(CR)");null===(n=this.logger)||void 0===n||n.logError({eventId:ms.b,featureName:this.featureName,properties:{midgardError:e,error:r}})},e}();var bs;function Cs(e){return{family:"caching-request",code:e}}!function(e){e[e.CACHE_MISS=0]="CACHE_MISS",e[e.EXPIRED=1]="EXPIRED",e[e.VERSION_MISMATCH=2]="VERSION_MISMATCH",e[e.UNKNOWN_ERROR=3]="UNKNOWN_ERROR"}(bs||(bs={}));var ys=n(233),vs=n.n(ys),Ts=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ss=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function Is(e,t){return Ts(this,void 0,void 0,(function(){var n,r;return Ss(this,(function(o){switch(o.label){case 0:return n=Os(e,t),[4,vs.a.getItem(n)];case 1:return r=o.sent(),[2,(i=r,null===i?void 0:i)]}var i}))}))}function Os(e,t){return"".concat(t,"_").concat(e)}var Es=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ps=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},ks={isExpected:!0,qosTagId:"TTLCacheUtils",midgardError:Cs(bs.CACHE_MISS)},Rs={isExpected:!1,qosTagId:"TTLCacheUtils",midgardError:Cs(bs.UNKNOWN_ERROR)};function xs(e,t){return Es(this,void 0,void 0,(function(){var n,r,o;return Ps(this,(function(i){switch(i.label){case 0:return(n=hn(t,e))?[2,JSON.parse(n)]:[3,1];case 1:return i.trys.push([1,3,,4]),[4,Is(t,e)];case 2:return(r=i.sent())?[2,JSON.parse(r)]:[3,4];case 3:throw he(o=i.sent())?o:Rs;case 4:throw ks}}))}))}function Ds(e,t,n,r){var o={version:n,data:r,dateAdded:Date.now()},i=JSON.stringify(o);pn(t,i,e),function(e,t,n){Ts(this,void 0,void 0,(function(){var r;return Ss(this,(function(o){return r=Os(e,n),[2,vs.a.setItem(r,t)]}))}))}(t,i,e)}var ws=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},As=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Cs(bs.VERSION_MISMATCH),Cs(bs.EXPIRED);var js=new Map;function _s(e,t,n,r){var o="pending_".concat(n,"_").concat(e,"_").concat(t),i=js.get(o);return i||new Promise((function(e,t){var n=r();js.set(o,n),n.then((function(t){js.delete(o),e(t)})).catch((function(e){js.delete(o),t(e)}))}))}function Fs(e){return ws(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,c,d,l,u,p,h,f,m,g=this;return As(this,(function(b){switch(b.label){case 0:t=e.id,n=e.logger,r=e.cacheKey,o=e.version,i=e.ttlMs,a=e.fallbackCallback,s=e.rateLimiter,c=e.ttrMs,d=function(){return _s(t,r,"getItem",(function(){return xs(t,r)}))},l=function(){return _s(t,r,"fallback",(function(){return ws(g,void 0,void 0,(function(){var e,i;return As(this,(function(c){switch(c.label){case 0:return c.trys.push([0,5,,6]),e=void 0,s?[4,s.executeWithThrottling(a,"".concat(t,"_").concat(r))]:[3,2];case 1:return e=c.sent(),[3,4];case 2:return[4,a()];case 3:e=c.sent(),c.label=4;case 4:return Ds(t,r,o,e),n.logEvent({eventId:"Fallback success and setting value"}),[2,e];case 5:throw i=c.sent(),n.logError({eventId:"Fallback failure, skipping cache update."}),i;case 6:return[2]}}))}))}))},u=void 0,p=!1,b.label=1;case 1:return b.trys.push([1,3,,4]),n.logEvent({eventId:"Cache access start"}),[4,d()];case 2:return(h=b.sent()).version===o?(f=Date.now())<=h.dateAdded+i?(void 0!==c&&f>=h.dateAdded+c&&function(e,t){ws(this,void 0,void 0,(function(){return As(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e];case 1:return n.sent(),t.logEvent({eventId:"Cache TTR updated successfully"}),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))}))}(l(),n),n.logEvent({eventId:"Obtained from cache"}),u=h.data):(p=!0,n.logEvent({eventId:"Cache has expired"})):n.logEvent({eventId:"Cache has mismatching version"}),[3,4];case 3:return b.sent(),n.logEvent({eventId:"Cache miss or failure"}),[3,4];case 4:if(u)return[3,9];b.label=5;case 5:return b.trys.push([5,7,,8]),[4,l()];case 6:return[2,{value:b.sent(),fetchedFromCache:!1,fetchedFromFallback:!0}];case 7:if(he(null==(m=b.sent())?void 0:m.midgardError))throw m;throw{isExpected:!1,qosTagId:"TTLCacheUtils",midgardError:Cs(bs.UNKNOWN_ERROR),cacheExpired:p,innerException:m};case 8:return[3,10];case 9:return[2,{value:u,fetchedFromCache:!0,fetchedFromFallback:!1}];case 10:return[2]}}))}))}var Ms=new In(20,1e4);function Ns(e,t){if(Boolean(e)&&Boolean(t))throw new Error("bypassCache and bypassTTL must not both be true at the same time");return Boolean(e)?0:Boolean(t)?Number.MAX_VALUE:6048e5}const Ls=(e,t,n)=>function(e,t,n,r,o){var i;return nn({monitorStarter:e.providerConfig.logger,scenarioName:n,featureName:"RestActionCreators",requestId:t,operation:r,extraProps:o?(i={},i[ge]=o,i):void 0,treatAsExpectedError:function(e){return!(!e||!he(e.midgardError))&&An(e.midgardError)}})}(e,t,"GetLivePersonaPickerConfiguration",()=>Zn(n,{requestId:t,clientScenario:"getLPPConfiguration"},{}));async function Bs(e){return function(e,t){return Object(h.b)(this,void 0,void 0,(function(){var n,r,o=this;return Object(h.d)(this,(function(i){return n="".concat("LokiConfig_").concat(e.providerConfig.clientFeature).concat(e.providerConfig.hostAppConfiguration.source),r={logEvent:function(t){return e.providerConfig.logger.logEvent({featureName:"TTLCacheUtils",eventId:t.eventId})},logError:function(t){return e.providerConfig.logger.logError({featureName:"TTLCacheUtils",eventId:t.eventId})}},[2,Fs({id:e.id,logger:r,cacheKey:n,version:e.version,ttlMs:Ns(e.bypassCache,e.bypassTTL),fallbackCallback:Boolean(e.bypassFallback)?function(){return Promise.reject("fallback failing because bypassFallback is true")}:function(){var n=new zn(e.providerConfig,(function(){return Object(h.b)(o,void 0,void 0,(function(){var t,n;return Object(h.d)(this,(function(r){switch(r.label){case 0:return n={},(t=e.lokiUrlOverride)?[3,2]:[4,e.getLokiDomain()];case 1:t=r.sent(),r.label=2;case 2:return[2,(n.domain=t,n.domainRequiredRequest=!1,n)]}}))}))})),r=F();return t(e,r,n)},ttrMs:Boolean(e.bypassCache)?void 0:9e7,rateLimiter:Ms})]}))}))}(e,Ls)}var Hs,Us=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};function Vs(e,t,n){return Us(this,void 0,void 0,(function*(){return yield Bs({providerConfig:t,id:(r=e,`${ds}-${r}`),version:"1.20220329.4.0",getLokiDomain:n});var r}))}function Ws(e,t,n){return Us(this,void 0,void 0,(function*(){const r=yield Vs(e,t,n),{fetchedFromFallback:o,value:i}=r;return{domain:i.LokiUrl||"",domainRequiredRequest:o}}))}const zs=e=>new Promise((t,n)=>{var r;return null===(r=eo.NativeModules.LPPHostAppData)||void 0===r?void 0:r.refreshAuthToken(e,(e,r,o,i)=>r?t(r):n(o))}),Ks=(null===(Hs=eo.NativeModules.LPPHostAppData)||void 0===Hs?void 0:Hs.getHostAppSuggestions)?(e,t)=>new Promise(n=>{var r;return null===(r=eo.NativeModules.LPPHostAppData)||void 0===r?void 0:r.getHostAppSuggestions(e,null==t?void 0:t.searchDirectory,null==t?void 0:t.top,e=>n(e))}):void 0;var Gs=n(355);function qs(e){return new Gs.URL(e)}var $s=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Ys=[er,nr,ot,Tr,_r,vr];function Js(e){return e.getSingleton(Qs)}class Qs{constructor(e,t,n,r,o,i,a){this.appContext=e,this.dispatch=t,this.accountUpn=n,this.logger=r,this.refreshLokiToken=o,this.options=i,this.onInit=a,this.initializedInOnlineMode=!1,this.createEUPLLogFunction=()=>{const e=this.suggestionListCorrelationId;return(t,n,r,o)=>{const i=Object.assign(Object.assign({},o),{suggestionListCorrelationId:e});this.logger.logEUPL(t,n,r,i)}},this.reInitializeWithOnlineMode=()=>{this.initializeContextWithLoki(this.refreshLokiToken,this.options)},this.debugReInitializeWithOfflineMode=()=>{this.initializedInOnlineMode=!1,this.initializeContextWithoutLoki()};const{clientType:s,hostAppName:c,hostAppPlatform:d,informationBarrierSegments:l,offline:u,enableVerboseLogging:p}=i;if(!s)throw r.logEvent({eventId:"ClientTypeUndefined",featureName:ds}),console.error("LivePersonaPicker client type not defined"),"Client type not defined";this.hostAppName=c,this.clientType=s,this.correlationId=F(),this.getHostAppSuggestions=i.getHostAppSuggestions||Ks,this.hostAppPlatform=d,this.informationBarrierSegments=l,this.offline=Boolean(u),this.suggestionListCorrelationId=F(),this.getLokiRestProvider=()=>{throw r.logEvent({eventId:"LokiRestProviderUnavailableWhenOffline",featureName:ds}),new Error("LokiRestProvider not available in offline mode")},u?this.initializeContextWithoutLoki():this.initializeContextWithLoki(o,i),this.enableVerboseLogging=p}get settings(){if(!this.appContext.reduxStore)throw this.logger.logEvent({eventId:"Cannot get settings,Redux Store undefined",featureName:ds}),new Error("Can't get settings: Redux store is not defined.");return _r.getSelectors(this.appContext.reduxStore.getState()).settings}generateNewSuggestionListCorrelationId(){this.suggestionListCorrelationId=F()}getLoggableProps(){return{suggestionListCorrelationId:this.suggestionListCorrelationId||""}}getStoreState(){if(this.appContext.reduxStore)return this.appContext.reduxStore.getState();throw this.logger.logEvent({eventId:"Cannot get store state, Redux Store undefined",featureName:ds}),new Error("Redux store is not defined.")}initializeContextWithLoki(e,t){const{getPhotoUri:n,hostAppRing:r,hostAppVersion:o,complianceEnvironment:i,getLokiEndpoint:a}=t;this.offline=!1;const s=()=>function(e,t,n){return $s(this,void 0,void 0,(function*(){if(void 0!==t){const e=yield function(e){return $s(this,void 0,void 0,(function*(){let t="";const n=yield e(),r=function(e){const t=qs(e);return null==t?void 0:t.protocol}(n),o=function(e){const t=qs(e);return null==t?void 0:t.hostname}(n);return t=void 0!==r&&void 0!==o?`${r}//${o}`:"",t}))}(t);return Promise.resolve(e)}if(void 0!==e){const t=function(e){switch(e){case"Df":return Xi.Dogfood;case"Msit":return Xi.MSIT;case"Blackforest":return Xi.Blackforest;case"GccModerate":return Xi.GccModerate;case"GccHigh":return Xi.GccHigh;case"DoD":return Xi.DOD;case"Gallatin":return Xi.Gallatin;case"Prod":return Xi.TopLevel;case"AG08":return Xi.AG08;case"AG09":return Xi.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return e}}(e||"Unknown");return Promise.resolve(t)}return n.logEvent({eventId:"Neither GetLokiEndpoint callback nor Compliance environment passed from the hostapp",featureName:"LivePersonaPicker"}),Promise.reject("Neither compliance environment nor Loki URL from the hostapp is set")}))}(i,a,this.logger),c=function(e,t,n,r,o,i){return{logger:t,getAuthToken:()=>e.getAuthToken(n),forceRefreshAuthToken:()=>e.forceRefreshAuthToken(n),updateAuthTokenTtl:t=>e.updateAuthTokenTtl(t),settings:{isSharedMailboxEnabled:!1,useLocalLokiOnCloudService:!1,isOfflineMode:!1,isGetPostConversionDisabled:!0},clientFeature:ds,hostAppConfiguration:{consumerCorrelationId:n,contextType:"",source:r,options:{hostAppRing:o,hostAppVersion:i}},BUILD_VERSION:"1.20220329.4.0"}}(function(e,t,n,r){const o=e=>Us(this,void 0,void 0,(function*(){try{return n(e)}catch(e){throw t.logError({eventId:"HostAppTokenCallbackFailure",featureName:ds}),e}}));return new gs({getAppId:()=>r,refreshAuthToken:t=>Us(this,void 0,void 0,(function*(){try{const n=yield o(e);t(n,void 0,void 0,void 0)}catch(e){t(void 0,e,void 0,void 0)}})),logger:t,authTokenType:fs,runWithLogMonitor:e=>Ie(Object.assign(Object.assign({},e),{monitorStarter:t,requestId:F()}))})}(this.accountUpn,this.logger,e,this.id),this.logger,F(),this.clientType,r,o);let d;this.getPhotoUri=n||((e,t)=>this.getPhotoUriInternal(c,e,t,s)),this.getLokiRestProvider=()=>(d||(d=new zn(c,()=>Ws(this.accountUpn,c,s))),d),Vs(this.accountUpn,c,s).then(e=>this.onInitialized("OnlineInitializationSuccessful",e.value)).catch(()=>this.onInitialized("OnlineInitializationFailed"))}initializeContextWithoutLoki(){this.offline=!0,this.getLokiRestProvider=()=>{throw this.logger.logEvent({eventId:"LokiRestProviderUnavailableWhenOffline",featureName:ds}),new Error("LokiRestProvider not available in offline mode")},this.onInitialized("OfflineInitializationSuccessful")}getPhotoUriInternal(e,t,n,r){return $s(this,void 0,void 0,(function*(){const o=(yield e.getAuthToken(this.correlationId)).token.getValue(),i=`${t}${n}`;return{uri:0===i.lastIndexOf("https:",0)?i:`${(yield Ws(this.accountUpn,e,r)).domain}/${i}`,headers:{"X-ClientType":this.clientType,Authorization:"Bearer "+o}}}))}onInitialized(e,t){this.initializedInOnlineMode||(this.logger.setEventHub(Xs(t)),this.logger.logEvent({eventId:e,featureName:ds}),this.dispatch(Or({clientType:this.clientType,offline:this.offline,informationBarrierSegments:this.informationBarrierSegments})),this.offline||(this.initializedInOnlineMode=!0),this.onInit())}get id(){return this.accountUpn?`${ds}_${this.accountUpn}`:this.correlationId?this.correlationId:(this.logger.logEvent({eventId:"LivePersonaPickerContext.id is null",featureName:ds}),"_")}}function Xs(e){const t=new ra;return t.registerConsumer(is(e,!1)),t}var Zs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(h.c)(t,e),t.prototype.getChildContext=function(){return{appContext:this.props.context}},t.prototype.componentDidCatch=function(e,t){this.props.context.exceptionHandler.handleException("App.componentDidCatch:".concat(t.componentStack),e)},t.prototype.render=function(){return this.props.context.reduxStore?i.createElement(a.Provider,{store:this.props.context.reduxStore},this.props.children):i.createElement(i.Fragment,null,this.props.children)},t.childContextTypes=Object(h.a)({},va),t}(i.Component);const ec=new ta(Promise.resolve(function(){const e=new ra;return e.registerConsumer(is(void 0,!1)),e}()),new na("","1.20220329.4.0"),()=>!0,()=>({}));const tc=new class{constructor(){this._applicationContextMap={}}getApplicationContext(e){const t=this._applicationContextMap[e];if(!t)throw ec.logEvent({eventId:"Undefined AppContext",featureName:ds}),"Undefined app context, should call start for "+e;return t}start(e,t){if(e in this._applicationContextMap)return void ec.logEvent({eventId:"UPN already in applicationContextMap",featureName:ds});const n=function(e,t,n){let r;const{clientCorrelationId:i,clientType:a,hostAppName:s,hostAppPlatform:c,hostAppRing:d,hostAppSupportsLogging:l,hostAppVersion:u}=t,p=i||F();l&&os();const h=new ta(Promise.resolve(Xs()),new na(a||"","1.20220329.4.0",p,{hostAppVersion:u||"",hostAppRing:d||"",hostAppName:s||"",hostAppPlatform:c||""}),()=>!0,()=>(null==r?void 0:r.getLoggableProps())||{}),f=Object(Ta.composeWithDevTools)(Object(o.applyMiddleware)(C(h,{logDataScenarioActions:!1})))(o.createStore)(ca(Ys)),m=new ya({reduxStore:f});return r=new Qs(m,f.dispatch,e,h,t.refreshAuthToken||zs,t,()=>setTimeout(n,0)),m.addSingleton(r),m}(e,t,()=>{!function(e){const t=e.settings.queryConfig.startupQueries;zr(e,"",t).then(t=>Ur(t,e))}(Js(n))});this._applicationContextMap[e]=n}switchToOnlineMode(e){const t=this._applicationContextMap[e];if(!t)throw ec.logEvent({eventId:"Uninitialized AppContext for the UPN",featureName:ds}),"App context not initialized for "+e;t.getSingleton(Qs).reInitializeWithOnlineMode()}},nc=(e,t)=>{return Object(o.compose)((r=n=>{const r=Js(e.getApplicationContext(t));return Object.assign(Object.assign({},n),{lppAppContext:r})},e=>class extends i.Component{render(){return i.createElement(e,Object.assign({},r(this.props)))}}),(n=n=>e.getApplicationContext(t),e=>class extends i.Component{render(){return i.createElement(Zs,{context:n(this.props)},i.createElement(e,Object.assign({},this.props)))}}))(Hi);var n,r},rc=(e,t)=>nc(e,t)},function(e,t,n){"use strict";var r=Function.prototype.toString;t.a=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return d}));var r=n(3);var o=n(30),i=n(31);function a(e,t,n,i){var a;return function(e,t){const n={};return e.filter(e=>{const r=Object(o.j)(e);return!(!r||n[r]||d(t,e))&&(n[r]=!0)})}(function e(t){return t.reduce((function(t,n){return Array.isArray(n)?t.push.apply(t,Object(r.g)([],Object(r.e)(e(n)),!1)):t.push(n),t}),[])}([e.map(e=>e.author),null!==(a=null==t?void 0:t.map(e=>e.history.map(e=>e.records[0].user)))&&void 0!==a?a:[],null!=i?i:[]]),n)}function s(e){return e.reduce((e,t)=>{const n=function(e){if(!e.authorID&&!e.authorName)return;return e.authorID||e.authorName}(t);return n?(e[n]=t,e):e},{})}function c(e){const t=[];return e.forEach(e=>{t.push({authorName:e.DisplayName||"",authorID:e.UserId,authorColor:i.a.COMMENTS_PURPLE,authorImageURL:""})}),t}function d(e,t){const n=Object(o.j)(t);if(!n)return;const r=e[n];return void 0!==r?r:t.DisplayName&&e[t.DisplayName]?e[t.DisplayName]:void 0}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(67);function o(e){return e.containerType===r.b.HalfPane}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t){return Object(r.b)("DISPLAY_DRAFT_WARNING",e,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(37);function o(e){return!e.pendingCommentLoad||e.pendingCommentLoad.numberOfComments===e.commentData.length||!!e.virtualized&&(0!==e.commentData.length&&(void 0===e.pendingCommentLoad.selectedThreadIndex||e.pendingCommentLoad.selectedThreadIndex>=e.pendingCommentLoad.numberOfThreads||e.pendingCommentLoad.selectedThreadIndex<e.commentData.filter(r.a).length))}},function(e,t,n){"use strict";var r=/^(?:0|[1-9]\d*)$/;t.a=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&r.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,n){"use strict";var r=Object.prototype;t.a=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Post=0]="Post",e[e.Card=1]="Card"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l}));var r=n(8),o=n(11),i=n(212),a=n(9),s=n(82),c=n(39);function d(e){const t=Object(a.findNodeHandle)(e);"number"==typeof t?(s.a&&Object(r.i)("Comments programmatic keyboard focus set via UIManager: "+Object(c.f)(e)),a.UIManager.dispatchViewManagerCommand(t,a.UIManager.getViewManagerConfig("RCTView").Commands.focus,[])):Object(o.n)(e)?(s.a&&Object(r.i)("Comments programmatic keyboard focus set: "+Object(c.f)(e)),e.focus()):s.a&&Object(r.j)("Comments programmatic keyboard focus skipped - ref not focusable")}function l(e){var t;null!==(t=e.current)&&void 0!==t||i.FocusManager.focus(e.current,!1)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=()=>!0},function(e,t,n){"use strict";var r=n(276);n.d(t,"a",(function(){return r.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));n(8);var r=n(0),o=n(13),i=n(68),a=n(46),s=n(7),c=n(19),d=n(17),l=n(5),u=n(10),p=n(260),h=n(262);function f(e,t,n,f){return(m,g)=>{var b,C;const y=g(),v=Object(r.i)().createActivityObject("DiscardDraftAsync",e.telemetryVisitor,r.a.None,r.b.NecessaryServiceDataEvent),T=l.h(y),S=l.r(y),I=Object(c.i)(T);v.addDataField("Trackback",e.trackback,r.d.SystemMetadata),v.addDataField("RenderContextType",e.renderContextType,r.d.SystemMetadata),v.addDataField("CommitPendingAttemptedCancel",I,r.d.SystemMetadata),v.addDataField("ActionSource",t,r.d.SystemMetadata);const O=function(e,t,n){const a=l.t(e),s=l.r(e);if(!a)return s&&Object(d.j)(s.selectionDetails)&&Object(d.h)(s)?{cancelAction:o.f(Object(u.a)(n,593278744),s.selectionDetails.selectedPostId,t),sessionType:i.b}:-2130957522;const{sessionType:c}=a.commentDraft.sessionConfiguration;switch(a.commentDraft.sessionConfiguration.sessionType){case"CREATE":return{cancelAction:o.e(Object(u.a)(n,593278745),t),sessionType:c};case"REPLY":return{cancelAction:o.g(Object(u.a)(n,593278746),a.commentDraft.sessionConfiguration.threadId,t),sessionType:c};case"EDIT":return{cancelAction:o.f(Object(u.a)(n,593278747),a.commentDraft.sessionConfiguration.commentId,t),sessionType:c};default:return Object(r.i)().assertConditionTag(!1,"Unexpected draft type",593278748),-2130957551}}(y,n,e);if("number"==typeof O)return v.failTag(593278749,O),Promise.resolve(a.a.Handled);const{sessionType:E,cancelAction:P}=O;v.addDataField("ActiveSessionType",E,r.d.SystemMetadata);const k=Object(s.K)(T),R=(null==k?void 0:k.currentMentionees)?Object.keys(k.currentMentionees).length:0;return v.addDataField("NumberOfMentionsAdded",R,r.d.SystemMetadata),I||!Object(c.b)(T)&&!Object(d.g)(S)?(v.addDataField("DraftId","NoActiveDraft",r.d.SystemMetadata),v.addDataField("DiscardUnnecessary",!0,r.d.SystemMetadata),v.successTag(593278755),Promise.resolve(a.a.Unhandled)):(v.addDataField("DiscardUnnecessary",!1,r.d.SystemMetadata),v.addDataField("DraftId",null!==(C=null===(b=Object(s.K)(T))||void 0===b?void 0:b.commentDraft.sessionConfiguration.draftId)&&void 0!==C?C:"InvalidDraftState",r.d.SystemMetadata),m(Object(p.a)(Object(u.a)(e,593278750))),f?f(()=>(m(P),v.addDataField("CancelledByUser",!1,r.d.SystemMetadata),v.successTag(593278751),a.a.Handled),()=>(v.addDataField("CancelledByUser",!0,r.d.SystemMetadata),v.successTag(593278752),m(Object(h.a)(Object(u.a)(e,593278753))),a.a.Canceled)):(m(P),v.successTag(593278754),Promise.resolve(a.a.Handled)))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n(8);var r=n(25),o=n(169),i=n(5),a=n(236);function s(e,t,n,s,c){return(d,l)=>{const u=Object(o.c)(t,n,i.p(l()),c);if(0===u.length)return Promise.resolve();if(s.getPersonaIconPropertiesArray)s.getPersonaIconPropertiesArray(u).then(t=>{d(Object(a.a)(e,Object(o.b)(t)))}).catch(Object(r.a)(595645964));else{const t=Object(o.a)(u);d(Object(a.a)(e,Object(o.b)(t)))}return Promise.resolve()}}},function(e,t,n){var r=n(402).default,o=n(118);e.exports=function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";var r=function(){this.__data__=[],this.size=0},o=n(149);var i=function(e,t){for(var n=e.length;n--;)if(Object(o.a)(e[n][0],t))return n;return-1},a=Array.prototype.splice;var s=function(e){var t=this.__data__,n=i(t,e);return!(n<0)&&(n==t.length-1?t.pop():a.call(t,n,1),--this.size,!0)};var c=function(e){var t=this.__data__,n=i(t,e);return n<0?void 0:t[n][1]};var d=function(e){return i(this.__data__,e)>-1};var l=function(e,t){var n=this.__data__,r=i(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=s,u.prototype.get=c,u.prototype.has=d,u.prototype.set=l;t.a=u},function(e,t,n){"use strict";var r=n(304),o=n(175),i=n(285),a=Object(i.a)(Object.keys,Object),s=Object.prototype.hasOwnProperty;var c=function(e){if(!Object(o.a)(e))return a(e);var t=[];for(var n in Object(e))s.call(e,n)&&"constructor"!=n&&t.push(n);return t},d=n(121);t.a=function(e){return Object(d.a)(e)?Object(r.a)(e):c(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s}));var r=n(8),o=n(14);const i=e=>e.contentExtensions.extensions,a=(e,t)=>{const n=i(e)[t];return void 0!==n&&n.priority!==o.c.Disabled},s=(e,t)=>{if(!t)return!1;switch(t.renderMode){case o.d.Integrated:case o.d.TaskPaneItem:{const n=i(e)[t.renderMode];return void 0!==n&&n.priority!==o.c.Disabled}case o.d.Isolated:{const n=i(e)[t.renderMode];return void 0!==n&&n.controller.provider.getExtension(t.threadId).priority!==o.c.Disabled}default:Object(r.m)(t)}}},function(e,t,n){"use strict";var r=n(123),o=n(94),i=Object(r.a)(o.a,"Map");t.a=i},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(0),o=n(1);const i={dataFieldVisitor:Object(r.j)(r.g.GlobalAPI)};function a(e){return{dataFieldVisitor:e}}const s=o.createContext(i)},function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(24);function o(e,t,n,r,o,...a){const s=a.reduce((e,n)=>n>e.max?{min:e.min,max:Math.min(e.min+t,n)}:n<e.min?{min:Math.max(e.max-t,n),max:e.max}:e,{min:o,max:o});let c;return c=e?s.max>=r+t?s.max-t:s.min<r?s.min:r:s.min,i(c,t,n)}function i(e,t,n){const r=Math.max(n-t,0);return Math.min(r,Math.max(e,0))}function a(e,t){let n=void 0;return e&&(n=t.findIndex(t=>r.i(t).commentId===e.selectedCardId),-1===n&&(n=void 0)),n}},function(e,t,n){"use strict";var r=n(183);var o=function(){this.__data__=new r.a,this.size=0};var i=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var a=function(e){return this.__data__.get(e)};var s=function(e){return this.__data__.has(e)},c=n(186),d=n(203);var l=function(e,t){var n=this.__data__;if(n instanceof r.a){var o=n.__data__;if(!c.a||o.length<199)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new d.a(o)}return n.set(e,t),this.size=n.size,this};function u(e){var t=this.__data__=new r.a(e);this.size=t.size}u.prototype.clear=o,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=s,u.prototype.set=l;t.a=u},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i}));var r=n(41),o=n(135);function i(e){return{neutralForeground1:e.neutralForeground1.fillColorRest,neutralForeground1Hover:e.neutralForeground1.fillColorHover,neutralForeground1Pressed:e.neutralForeground1.fillColorPressed,neutralForeground1Selected:e.neutralForeground1.fillColorSelected,neutralForeground2:e.neutralForeground2.fillColorRest,neutralForeground2Hover:e.neutralForeground2.fillColorHover,neutralForeground2Pressed:e.neutralForeground2.fillColorPressed,neutralForeground2Selected:e.neutralForeground2.fillColorSelected,neutralForeground2BrandHover:e.neutralForeground2.fillColorBrandHover,neutralForeground2BrandPressed:e.neutralForeground2.fillColorBrandPressed,neutralForeground2BrandSelected:e.neutralForeground2.fillColorBrandSelected,neutralForeground3:e.neutralForeground3.fillColorRest,neutralForeground3Hover:e.neutralForeground3.fillColorHover,neutralForeground3Pressed:e.neutralForeground3.fillColorPressed,neutralForeground3Selected:e.neutralForeground3.fillColorSelected,neutralForeground3BrandHover:e.neutralForeground3.fillColorBrandHover,neutralForeground3BrandPressed:e.neutralForeground3.fillColorBrandPressed,neutralForeground3BrandSelected:e.neutralForeground3.fillColorBrandSelected,neutralForeground4:e.neutralForeground4.fillColorRest,neutralForegroundDisabled:e.neutralForegroundDisabled.fillColorRest,brandForegroundLink:e.brandForegroundLink.fillColorRest,brandForegroundLinkHover:e.brandForegroundLink.fillColorHover,brandForegroundLinkPressed:e.brandForegroundLink.fillColorPressed,brandForegroundLinkSelected:e.brandForegroundLink.fillColorSelected,compoundBrandForeground1:e.compoundBrandForeground1.fillColorRest,compoundBrandForeground1Hover:e.compoundBrandForeground1.fillColorHover,compoundBrandForeground1Pressed:e.compoundBrandForeground1.fillColorPressed,brandForeground1:e.brandForeground1.fillColorRest,brandForeground1Disabled:e.brandForeground1.fillColorDisabled,brandForeground1Pressed:e.brandForeground1.fillColorPressed,brandForeground2:e.brandForeground2.fillColorRest,neutralForegroundInverted:e.neutralForegroundInverted.fillColorRest,neutralForegroundOnBrand:e.neutralForegroundOnBrand.fillColorRest,neutralForegroundOnBrandHover:e.neutralForegroundOnBrand.fillColorHover,neutralForegroundOnBrandPressed:e.neutralForegroundOnBrand.fillColorPressed,neutralForegroundOnBrandSelected:e.neutralForegroundOnBrand.fillColorSelected,neutralForegroundInvertedLink:e.neutralForegroundInvertedLink.fillColorRest,neutralForegroundInvertedLinkHover:e.neutralForegroundInvertedLink.fillColorHover,neutralForegroundInvertedLinkPressed:e.neutralForegroundInvertedLink.fillColorPressed,neutralForegroundInvertedLinkSelected:e.neutralForegroundInvertedLink.fillColorSelected,neutralBackground1:e.neutralBackground1.fillColorRest,neutralBackground1Hover:e.neutralBackground1.fillColorHover,neutralBackground1Pressed:e.neutralBackground1.fillColorPressed,neutralBackground1Selected:e.neutralBackground1.fillColorSelected,neutralBackground2:e.neutralBackground2.fillColorRest,neutralBackground2Hover:e.neutralBackground2.fillColorHover,neutralBackground2Pressed:e.neutralBackground2.fillColorPressed,neutralBackground2Selected:e.neutralBackground2.fillColorSelected,neutralBackground3:e.neutralBackground3.fillColorRest,neutralBackground3Hover:e.neutralBackground3.fillColorHover,neutralBackground3Pressed:e.neutralBackground3.fillColorPressed,neutralBackground3Selected:e.neutralBackground3.fillColorSelected,neutralBackground4:e.neutralBackground4.fillColorRest,neutralBackground4Hover:e.neutralBackground4.fillColorHover,neutralBackground4Pressed:e.neutralBackground4.fillColorPressed,neutralBackground4Selected:e.neutralBackground4.fillColorSelected,neutralBackground5:e.neutralBackground5.fillColorRest,neutralBackground5Hover:e.neutralBackground5.fillColorHover,neutralBackground5Pressed:e.neutralBackground5.fillColorPressed,neutralBackground5Selected:e.neutralBackground5.fillColorSelected,neutralBackground6:e.neutralBackground6.fillColorRest,neutralBackgroundInverted:e.neutralBackgroundInverted.fillColorRest,subtleBackground:e.subtleBackground.fillColorRest,subtleBackgroundHover:e.subtleBackground.fillColorHover,subtleBackgroundPressed:e.subtleBackground.fillColorPressed,subtleBackgroundSelected:e.subtleBackground.fillColorSelected,transparentBackground:e.transparentBackground.fillColorRest,transparentBackgroundHover:e.transparentBackground.fillColorHover,transparentBackgroundPressed:e.transparentBackground.fillColorPressed,transparentBackgroundSelected:e.transparentBackground.fillColorSelected,neutralBackgroundDisabled:e.neutralBackgroundDisabled.fillColorRest,neutralStencil1:e.neutralStencil1.fillColorRest,neutralStencil2:e.neutralStencil2.fillColorRest,brandBackground:e.brandBackground.fillColorRest,brandBackgroundHover:e.brandBackground.fillColorHover,brandBackgroundPressed:e.brandBackground.fillColorPressed,brandBackgroundDisabled:e.brandBackground.fillColorDisabled,brandBackgroundSelected:e.brandBackground.fillColorSelected,compoundBrandBackground1:e.compoundBrandBackground1.fillColorRest,compoundBrandBackground1Hover:e.compoundBrandBackground1.fillColorHover,compoundBrandBackground1Pressed:e.compoundBrandBackground1.fillColorPressed,brandBackgroundStatic:e.brandBackgroundStatic.fillColorRest,brandBackground2:e.brandBackground2.fillColorRest,neutralStrokeAccessible:e.neutralStrokeAccessible.strokeColorRest,neutralStrokeAccessibleHover:e.neutralStrokeAccessible.strokeColorHover,neutralStrokeAccessiblePressed:e.neutralStrokeAccessible.strokeColorPressed,neutralStrokeAccessibleSelected:e.neutralStrokeAccessible.strokeColorSelected,neutralStroke1:e.neutralStroke1.strokeColorRest,neutralStroke1Hover:e.neutralStroke1.strokeColorHover,neutralStroke1Pressed:e.neutralStroke1.strokeColorPressed,neutralStroke1Selected:e.neutralStroke1.strokeColorSelected,neutralStroke2:e.neutralStroke2.strokeColorRest,neutralStroke3:e.neutralStroke3.strokeColorRest,brandStroke1:e.brandStroke1.strokeColorRest,brandStroke2:e.brandStroke2.strokeColorRest,compoundBrandStroke1:e.compoundBrandStroke1.strokeColorRest,compoundBrandStroke1Hover:e.compoundBrandStroke1.strokeColorHover,compoundBrandStroke1Pressed:e.compoundBrandStroke1.strokeColorPressed,neutralStrokeDisabled:e.neutralStrokeDisabled.strokeColorRest,transparentStroke:e.transparentStroke.strokeColorRest,transparentStrokeInteractive:e.transparentStroke.strokeColorHover,transparentStrokeDisabled:e.transparentStroke.strokeColorDisabled,strokeFocus1:e.strokeFocus1.strokeColorRest,strokeFocus2:e.strokeFocus2.strokeColorRest,redBackground1:e.redBackground1.fillColorRest,redBackground2:e.redBackground2.fillColorRest,redBackground3:e.redBackground3.fillColorRest,redForeground1:e.redForeground1.fillColorRest,redForeground2:e.redBackground2.fillColorRest,redForeground3:e.redBackground3.fillColorRest,redBorderActive:e.redBorderActive.strokeColorRest,redBorder1:e.redBorder1.strokeColorRest,redBorder2:e.redBorder2.strokeColorRest}}var a=Object(o.b)((function(e){return i(Object(r.a)(e))})),s=n(9);function c(e,t){return void 0===e?t:"dynamic"===e?s.Appearance&&s.Appearance.getColorScheme()||t:e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(3),o=n(125),i=n(135);function a(e){return Array.isArray(e)?o.a.apply(void 0,e.map((function(e){return a(e)}))):e||{}}function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.a.apply(void 0,e.map((function(e){return a(e)})))}var c=Object(i.a)();var d={className:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter((function(e){return e&&"string"==typeof e})).join(" ")},style:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.filter((function(e){return"object"==typeof e}));return n.length>1||1===n.length&&Array.isArray(n[0])?c((function(){return s.apply(void 0,Object(r.g)([void 0],n,!1))}),n)[0]:n[0]||{}}};function l(e){return e.filter((function(e){return"object"==typeof e}))}function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.b.apply(void 0,Object(r.g)([d],l(e),!1))}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return m}));n(8);var r=n(414),o=n(0),i=n(14),a=n(145),s=n(37),c=n(7),d=n(19),l=n(23),u=n(76),p=n(6);function h(e,t,n){var r;if(Object(l.f)(t))return t.find(t=>{var r;return t===e||(null===(r=n[t])||void 0===r?void 0:r.alternateId)===e});const o=new a.b(t,-1);let i;for(;!(i=o.next()).done;){const t=i.value.commentId,r=n[t];if((null==r?void 0:r.alternateId)===e||t===e)break}return null===(r=i.value)||void 0===r?void 0:r.commentId}function f(e,t,n,i,a,d,l){var u,p;if(a&&l===e)return{thread:[a.newComment],isDraftThread:!0,draftThreadState:d};Object(o.i)().assertConditionTag(!d||!d.isInCurrentContext||"CREATE"!==d.commentDraft.sessionConfiguration.sessionType,"Bad Store State, missing lie for new draft requested.",579372370);const h=i||e;let f=Object(c.z)(t,n,h);return f.length>0&&void 0===Object(s.a)(f[0])&&(null===(p=(u=Object(o.i)()).logDiagnosticTrace)||void 0===p||p.call(u,r.a`Possible comment corruption. Could indicate comment persistence issue or intermediate change state.`,540575834,o.h.Info,o.c.ProductServiceUsage,Object(o.j)(o.g.ReviewedAsNotNecessary)),f=[]),{thread:f,isDraftThread:!1,draftThreadState:void 0}}function m(e,t,n,r,o){if(t.draftThreadState)return t.draftThreadState.renderContextType===p.a.None||t.draftThreadState.renderContextType===r?i.a.Enabled_ForcePrimary:i.a.Disabled;if(t.isDraftThread||t.thread.length>0)return o===u.a.InCard||o===u.a.InChildPost?i.a.Enabled_ForcePrimary:i.a.Enabled_Default;if(Object(d.k)(n))return i.a.Disabled;const a=Object(c.K)(n);return a&&a.threadId===e?i.a.Disabled:i.a.Invalid}},function(e,t,n){"use strict";var r=n(123),o=n(94),i=Object(r.a)(o.a,"Set");t.a=i},function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"e",(function(){return R})),n.d(t,"b",(function(){return x})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return _}));var r=n(3),o=n(1),i=n(47),a=n.n(i),s=n(9),c=!1;if("web"===s.Platform.OS){if(Boolean("undefined"!=typeof window&&window.document&&window.document.createElement)){var d=0,l=function(){d=Date.now(),c&&(c=!1)};document.addEventListener("touchstart",l,!0),document.addEventListener("touchmove",l,!0),document.addEventListener("mousemove",(function(){c||Date.now()-d<1e3||(c=!0)}),!0)}}else"windows"!==s.Platform.OS&&"win32"!==s.Platform.OS&&"macos"!==s.Platform.OS||(c=!0);function u(e){return"number"==typeof e?{bottom:e,left:e,right:e,top:e}:e}var p={NOT_RESPONDER:{DELAY:"ERROR",RESPONDER_GRANT:"RESPONDER_INACTIVE_PRESS_IN",RESPONDER_RELEASE:"ERROR",RESPONDER_TERMINATED:"ERROR",ENTER_PRESS_RECT:"ERROR",LEAVE_PRESS_RECT:"ERROR",LONG_PRESS_DETECTED:"ERROR"},RESPONDER_INACTIVE_PRESS_IN:{DELAY:"RESPONDER_ACTIVE_PRESS_IN",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_INACTIVE_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_INACTIVE_PRESS_OUT",LONG_PRESS_DETECTED:"ERROR"},RESPONDER_INACTIVE_PRESS_OUT:{DELAY:"RESPONDER_ACTIVE_PRESS_OUT",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_INACTIVE_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_INACTIVE_PRESS_OUT",LONG_PRESS_DETECTED:"ERROR"},RESPONDER_ACTIVE_PRESS_IN:{DELAY:"ERROR",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_ACTIVE_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_ACTIVE_PRESS_OUT",LONG_PRESS_DETECTED:"RESPONDER_ACTIVE_LONG_PRESS_IN"},RESPONDER_ACTIVE_PRESS_OUT:{DELAY:"ERROR",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_ACTIVE_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_ACTIVE_PRESS_OUT",LONG_PRESS_DETECTED:"ERROR"},RESPONDER_ACTIVE_LONG_PRESS_IN:{DELAY:"ERROR",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_ACTIVE_LONG_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_ACTIVE_LONG_PRESS_OUT",LONG_PRESS_DETECTED:"RESPONDER_ACTIVE_LONG_PRESS_IN"},RESPONDER_ACTIVE_LONG_PRESS_OUT:{DELAY:"ERROR",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_ACTIVE_LONG_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_ACTIVE_LONG_PRESS_OUT",LONG_PRESS_DETECTED:"ERROR"},ERROR:{DELAY:"NOT_RESPONDER",RESPONDER_GRANT:"RESPONDER_INACTIVE_PRESS_IN",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"NOT_RESPONDER",LEAVE_PRESS_RECT:"NOT_RESPONDER",LONG_PRESS_DETECTED:"NOT_RESPONDER"}},h=function(e){return"RESPONDER_ACTIVE_PRESS_IN"===e||"RESPONDER_ACTIVE_LONG_PRESS_IN"===e},f=function(e){return"RESPONDER_ACTIVE_PRESS_OUT"===e||"RESPONDER_ACTIVE_PRESS_IN"===e},m=function(e){return"RESPONDER_INACTIVE_PRESS_IN"===e||"RESPONDER_ACTIVE_PRESS_IN"===e||"RESPONDER_ACTIVE_LONG_PRESS_IN"===e},g=30,b=20,C=20,y=20;function v(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),Math.max(t,null!=e?e:n)}var T=function(e){var t=e.nativeEvent,n=t.changedTouches,r=t.touches;return null!=r&&r.length>0?r[0]:null!=n&&n.length>0?n[0]:e.nativeEvent},S=function(){function e(e){var t=this;this._eventHandlers=null,this._hoverInDelayTimeout=null,this._hoverOutDelayTimeout=null,this._isHovered=!1,this._longPressDelayTimeout=null,this._pressDelayTimeout=null,this._pressOutDelayTimeout=null,this._responderID=null,this._responderRegion=null,this._touchState="NOT_RESPONDER",this._measureCallback=function(e,n,r,o,i,a){(e||n||r||o||i||a)&&(t._responderRegion={bottom:a+o,left:i,right:i+r,top:a})},this.configure(e)}return e.prototype.configure=function(e){this._config=e},e.prototype.reset=function(){this._cancelHoverInDelayTimeout(),this._cancelHoverOutDelayTimeout(),this._cancelLongPressDelayTimeout(),this._cancelPressDelayTimeout(),this._cancelPressOutDelayTimeout()},e.prototype.getEventHandlers=function(){return null==this._eventHandlers&&(this._eventHandlers=this._createEventHandlers()),this._eventHandlers},e.prototype._createEventHandlers=function(){var e=this,t={onBlur:function(t){var n=e._config.onBlur;null!=n&&n(t)},onFocus:function(t){var n=e._config.onFocus;null!=n&&n(t)}},n={onStartShouldSetResponder:function(){var t=e._config.disabled;return null==t||!t},onResponderGrant:function(t){t.persist(),e._cancelPressOutDelayTimeout(),e._responderID=t.currentTarget,e._touchState="NOT_RESPONDER",e._receiveSignal("RESPONDER_GRANT",t);var n=v(e._config.delayPressIn,0,130);n>0?e._pressDelayTimeout=setTimeout((function(){e._receiveSignal("DELAY",t)}),n):e._receiveSignal("DELAY",t);var r=v(e._config.delayLongPress,10,370);e._longPressDelayTimeout=setTimeout((function(){e._handleLongPress(t)}),r+n)},onResponderMove:function(t){null!=e._config.onPressMove&&e._config.onPressMove(t);var n=e._responderRegion;if(null!=n){var r=T(t);if(null==r)return e._cancelLongPressDelayTimeout(),void e._receiveSignal("LEAVE_PRESS_RECT",t);if(null!=e._touchActivatePosition){var o=e._touchActivatePosition.pageX-r.pageX,i=e._touchActivatePosition.pageY-r.pageY;Math.hypot(o,i)>10&&e._cancelLongPressDelayTimeout()}e._isTouchWithinResponderRegion(r,n)?e._receiveSignal("ENTER_PRESS_RECT",t):(e._cancelLongPressDelayTimeout(),e._receiveSignal("LEAVE_PRESS_RECT",t))}},onResponderRelease:function(t){e._receiveSignal("RESPONDER_RELEASE",t)},onResponderTerminate:function(t){e._receiveSignal("RESPONDER_TERMINATED",t)},onResponderTerminationRequest:function(){return e._config.cancelable||!0},onClick:function(t){var n=e._config.onPress;null!=n&&n(t)}},o="ios"===s.Platform.OS||"android"===s.Platform.OS?null:{onMouseEnter:function(t){if(c){e._isHovered=!0,e._cancelHoverOutDelayTimeout();var n=e._config.onHoverIn;if(null!=n){var r=v(e._config.delayHoverIn);r>0?e._hoverInDelayTimeout=setTimeout((function(){n(t)}),r):n(t)}}},onMouseLeave:function(t){if(e._isHovered){e._isHovered=!1,e._cancelHoverInDelayTimeout();var n=e._config.onHoverOut;if(null!=n){var r=v(e._config.delayHoverOut);r>0?e._hoverInDelayTimeout=setTimeout((function(){n(t)}),r):n(t)}}}};return Object(r.a)(Object(r.a)(Object(r.a)({},t),n),o)},e.prototype._receiveSignal=function(e,t){var n=this._touchState,r=p[n][e];null==this._responderID&&"RESPONDER_RELEASE"===e||(a()(null!=r&&"ERROR"!==r,"Pressability: Invalid signal `%s` for state `%s` on responder: %s",e,n,"number"==typeof this._responderID?this._responderID:"<<host component>>"),n!==r&&(this._performTransitionSideEffects(n,r,e,t),this._touchState=r))},e.prototype._performTransitionSideEffects=function(e,t,n,r){(function(e){return"RESPONDER_TERMINATED"===e||"RESPONDER_RELEASE"===e})(n)&&(this._touchActivatePosition=null,this._cancelLongPressDelayTimeout());var o="NOT_RESPONDER"===e&&"RESPONDER_INACTIVE_PRESS_IN"===t,i=!f(e)&&f(t);((o||i)&&this._measureResponderRegion(),m(e)&&"LONG_PRESS_DETECTED"===n)&&(null!=(d=this._config.onLongPress)&&d(r));var a=h(e),s=h(t);if(!a&&s?this._activate(r):a&&!s&&this._deactivate(r),m(e)&&"RESPONDER_RELEASE"===n){var c=this._config,d=c.onLongPress,l=c.onPress;if(null!=l)null!=d&&"RESPONDER_ACTIVE_LONG_PRESS_IN"===e&&this._shouldLongPressCancelPress()||(s||a||(this._activate(r),this._deactivate(r)),l(r))}this._cancelPressDelayTimeout()},e.prototype._activate=function(e){var t=this._config.onPressIn,n=T(e);this._touchActivatePosition={pageX:n.pageX,pageY:n.pageY},null!=t&&t(e)},e.prototype._deactivate=function(e){var t=this._config.onPressOut;if(null!=t){var n=v(this._config.delayPressOut);n>0?this._pressOutDelayTimeout=setTimeout((function(){t(e)}),n):t(e)}},e.prototype._measureResponderRegion=function(){var e,t;null!=this._responderID&&("number"==typeof this._responderID?s.UIManager.measure(this._responderID,this._measureCallback):"function"==typeof(null===(e=null===this||void 0===this?void 0:this._responderID)||void 0===e?void 0:e.measure)&&this._measureCallback&&(null===(t=null===this||void 0===this?void 0:this._responderID)||void 0===t||t.measure(this._measureCallback)))},e.prototype._isTouchWithinResponderRegion=function(e,t){var n,r,o,i,a=u(this._config.hitSlop),s=u(this._config.pressRectOffset),c=t.bottom,d=t.left,l=t.right,p=t.top;return null!=a&&(null!=a.bottom&&(c+=a.bottom),null!=a.left&&(d-=a.left),null!=a.right&&(l+=a.right),null!=a.top&&(p-=a.top)),c+=null!==(n=null==s?void 0:s.bottom)&&void 0!==n?n:g,d-=null!==(r=null==s?void 0:s.left)&&void 0!==r?r:b,l+=null!==(o=null==s?void 0:s.right)&&void 0!==o?o:C,p-=null!==(i=null==s?void 0:s.top)&&void 0!==i?i:y,e.pageX>d&&e.pageX<l&&e.pageY>p&&e.pageY<c},e.prototype._handleLongPress=function(e){"RESPONDER_ACTIVE_PRESS_IN"!==this._touchState&&"RESPONDER_ACTIVE_LONG_PRESS_IN"!==this._touchState||this._receiveSignal("LONG_PRESS_DETECTED",e)},e.prototype._shouldLongPressCancelPress=function(){return!0},e.prototype._cancelHoverInDelayTimeout=function(){null!=this._hoverInDelayTimeout&&(clearTimeout(this._hoverInDelayTimeout),this._hoverInDelayTimeout=null)},e.prototype._cancelHoverOutDelayTimeout=function(){null!=this._hoverOutDelayTimeout&&(clearTimeout(this._hoverOutDelayTimeout),this._hoverOutDelayTimeout=null)},e.prototype._cancelLongPressDelayTimeout=function(){null!=this._longPressDelayTimeout&&(clearTimeout(this._longPressDelayTimeout),this._longPressDelayTimeout=null)},e.prototype._cancelPressDelayTimeout=function(){null!=this._pressDelayTimeout&&(clearTimeout(this._pressDelayTimeout),this._pressDelayTimeout=null)},e.prototype._cancelPressOutDelayTimeout=function(){null!=this._pressOutDelayTimeout&&(clearTimeout(this._pressOutDelayTimeout),this._pressOutDelayTimeout=null)},e}();function I(e){var t=Object(o.useRef)(null);null==t.current&&(t.current=new S(e));var n=t.current;return Object(o.useEffect)((function(){n.configure(e)}),[e,n]),Object(o.useEffect)((function(){return function(){n.reset()}}),[n]),n.getEventHandlers()}function O(e){var t=o.useState({hovered:!1}),n=t[0],r=t[1];return[{onHoverIn:o.useCallback((function(t){r({hovered:!0}),e.onHoverIn&&e.onHoverIn(t)}),[r,e.onHoverIn]),onHoverOut:o.useCallback((function(t){r({hovered:!1}),e.onHoverOut&&e.onHoverOut(t)}),[r,e.onHoverOut])},n]}function E(e){var t=o.useState({focused:!1}),n=t[0],r=t[1];return[{onFocus:o.useCallback((function(t){r({focused:!0}),e.onFocus&&e.onFocus(t)}),[r,e.onFocus]),onBlur:o.useCallback((function(t){r({focused:!1}),e.onBlur&&e.onBlur(t)}),[r,e.onBlur])},n]}function P(e){var t=o.useState({pressed:!1}),n=t[0],r=t[1];return[{onPressIn:o.useCallback((function(t){r({pressed:!0}),e.onPressIn&&e.onPressIn(t)}),[r,e.onPressIn]),onPressOut:o.useCallback((function(t){r({pressed:!1}),e.onPressOut&&e.onPressOut(t)}),[r,e.onPressOut])},n]}function k(e){var t=O(e),n=t[0],o=t[1],i=E(e),a=i[0],s=i[1],c=P(e),d=c[0],l=c[1],u=I(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)({},e),n),a),d));return{props:Object(r.a)(Object(r.a)({},e),u),state:Object(r.a)(Object(r.a)(Object(r.a)({},o),s),l)}}function R(e){var t,n,r,i=o.useRef();return n=(t={getForwardedRef:function(){return e},setLocalRef:function(e){i.current=e,e&&(e.focus=function(){s.UIManager.dispatchViewManagerCommand(Object(s.findNodeHandle)(e),s.UIManager.getViewManagerConfig("RCTView").Commands.focus,null)})}}).getForwardedRef,r=t.setLocalRef,function(e){var t=n();r(e),"function"==typeof t?t(e):"object"==typeof t&&null!=t&&(t.current=e)}}function x(e,t,n){var r=o.useState(null!=e?e:t),i=r[0],a=r[1],s=o.useCallback((function(){n&&n(!i),a(!i)}),[i,a]);return[null!=t?t:i,s]}var D=n(135);function w(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=function(n){void 0===e||void 0!==t&&!t.includes(n.nativeEvent.key)||(e(n),n.stopPropagation())};return r}function A(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return{onKeyUp:w.apply(void 0,Object(r.g)([e],t,!1)),keyUpEvents:t.map((function(e){return{key:e}}))}}Object(D.b)(A),Object(D.b)((function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return{onKeyDown:w.apply(void 0,Object(r.g)([e],t,!1)),keyDownEvents:t.map((function(e){return{key:e}}))}}));var j=Object(D.b)(A);function _(e,t){return o.useCallback((function(n){var r;t&&t(n),null===(r=null==e?void 0:e.current)||void 0===r||r.focus()}),[t,e])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return p}));var r=n(1),o=n(124),i=n(191),a=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function s(e,t,n){var r=Object(i.a)(e,t);if(n&&r){var o={};Object.getOwnPropertyNames(r).forEach((function(e){n(e)||(o[e]=void 0)})),r=Object(i.a)(r,o)}return r}function c(e){return e._canCompose=!0,e}function d(e,t){return function e(t,n){if(n.composable){var r=n.composable,o=r.usePrepareProps,i=r.useStyling;n.renderData=o(t,i)||{}}else n.renderData={slotProps:{root:t}};var a=n.childInfo;if(a){var s=n.renderData.slotProps||{};Object.getOwnPropertyNames(a).forEach((function(t){e(s[t],a[t])}))}return{renderData:n.renderData,Slots:n.Slots}}(e,r.useMemo((function(){return function e(t,n){var i={composable:t,slotInfo:n},d=t&&t.slots;if(d){var l=i.Slots={},u=i.childInfo={};Object.getOwnPropertyNames(d).forEach((function(t){var n=d[t],i=n.slotType,p=n.filter,h="string"!=typeof i&&i.__composable||void 0,f=u[t]=e(h,d[t]);l[t]=c(h?function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=f.renderData,i=f.Slots;if(p||e){var c={root:s(r.slotProps.root,e,p)};r.slotProps=Object(o.b)(r.slotProps,c)}return h.render.apply(h,a([i,r],t,!1))}:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=s(f.renderData.slotProps.root,e,p);return r.createElement.apply(r,a([i,o],t,!1))})}))}return i}(t)}),[]))}var l=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function u(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return"function"==typeof e&&e._canCompose?e.apply(void 0,l([t],n,!1)):r.createElement.apply(r,l([e,t],n,!1))}function p(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return u.apply(void 0,l([e,t],n,!1))}var h=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},f=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function m(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return u.apply(void 0,f([e.root,void 0],n,!1))}function g(e,t){return{slotProps:Object(o.b)(t(e),{root:e})}}function b(e){var t=function(e){var t=e.slots&&Object.getOwnPropertyNames(e.slots).length||0;if(!t)throw"A composable component must have at least one slot specified";if(t>1&&!e.render)throw"A composable component with multiple slots cannot use the default render implementation";for(var n in e.slots){var r=e.slots[n];!r||"object"==typeof r&&r.slotType||(e.slots[n]={slotType:r})}return e.useStyling||(e.useStyling=function(){return{}}),e.render=e.render||m,e.usePrepareProps=e.usePrepareProps||g,e}(e),n=function(e){var n=e,r=n.children,o=d(h(n,["children"]),t),i=o.renderData,a=o.Slots;return t.render(a,i,r)};return n.displayName=t.displayName,n.__composable=t,n}},function(e,t,n){var r=n(120);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ReactReduxContext=void 0;var o=r(n(1)).default.createContext(null);t.ReactReduxContext=o;var i=o;t.default=i},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t){return Object(r.b)("COMMIT_FAILURE",{commitText:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),o=n(7),i=n(76);function a(e,t,n){const a=Object(o.K)(n);if(a)return a.threadId!==e?i.a.InOtherCard:r.m()&&a.renderContextType!==t?i.a.InOtherContextOfThisCard:"EDIT"===a.commentDraft.sessionConfiguration.sessionType?i.a.InChildPost:i.a.InCard}},function(e,t,n){"use strict";(function(e){var r=n(94),o=n(350),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===i?r.a.Buffer:void 0,c=(s?s.isBuffer:void 0)||o.a;t.a=c}).call(this,n(314)(e))},function(e,t,n){"use strict";function r(e){return!!e&&void 0!==e.setContents&&void 0!==e.getContentsAsync&&void 0!==e.isEditorEmpty&&void 0!==e.clear&&void 0!==e.blur&&void 0!==e.focus&&void 0!==e.setSelection&&void 0!==e.getDisplayMode}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));n(8);var r=n(0),o=n(46),i=n(80),a=n(141),s=n(19),c=n(91),d=n(5),l=n(10),u=n(172),p=n(180);function h(e,t,n){return(h,f)=>{const m=f(),g=d.h(m),b=Object(r.i)().createActivityObject("DiscardDraftIfEmpty",e.telemetryVisitor,r.a.None,r.b.NecessaryServiceDataEvent),C=Object(s.i)(g);b.addDataField("Trackback",e.trackback,r.d.SystemMetadata),b.addDataField("RenderContextType",e.renderContextType,r.d.SystemMetadata),b.addDataField("CommitPendingAttemptedCancel",C,r.d.SystemMetadata),b.addDataField("ActionSource",t,r.d.SystemMetadata);const y=Object(a.a)(g);return b.addDataField("DraftDiscardBehavior",y,r.d.SystemMetadata),y===i.a.CanAutoDiscard?h(Object(p.a)(e,t,!1)).then(e=>(b.successTag(539754957),{draftDiscardResult:e,draftDiscardBehavior:y})):(void 0!==n&&y===i.a.CannotAutoDiscard&&(b.addDataField("DraftWarningReason",n,r.d.SystemMetadata),h(Object(u.a)({draftWarningType:c.a.ReturnToDraft,draftWarningReason:n},Object(l.a)(e,591728722)))),b.successTag(539754958),Promise.resolve({draftDiscardResult:o.a.Canceled,draftDiscardBehavior:y}))}}},function(e,t,n){"use strict";var r=n(123),o=Object(r.a)(Object,"create");var i=function(){this.__data__=o?o(null):{},this.size=0};var a=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},s=Object.prototype.hasOwnProperty;var c=function(e){var t=this.__data__;if(o){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return s.call(t,e)?t[e]:void 0},d=Object.prototype.hasOwnProperty;var l=function(e){var t=this.__data__;return o?void 0!==t[e]:d.call(t,e)};var u=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=o&&void 0===t?"__lodash_hash_undefined__":t,this};function p(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}p.prototype.clear=i,p.prototype.delete=a,p.prototype.get=c,p.prototype.has=l,p.prototype.set=u;var h=p,f=n(183),m=n(186);var g=function(){this.size=0,this.__data__={hash:new h,map:new(m.a||f.a),string:new h}};var b=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var C=function(e,t){var n=e.__data__;return b(t)?n["string"==typeof t?"string":"hash"]:n.map};var y=function(e){var t=C(this,e).delete(e);return this.size-=t?1:0,t};var v=function(e){return C(this,e).get(e)};var T=function(e){return C(this,e).has(e)};var S=function(e,t){var n=C(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function I(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}I.prototype.clear=g,I.prototype.delete=y,I.prototype.get=v,I.prototype.has=T,I.prototype.set=S;t.a=I},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));n(8);var r=n(84),o=n(171),i=n(25),a=n(21),s=n(33),c=n(10);function d(e,t){return(n,d)=>{const l=s.d(d());return Object(o.a)(l)&&Object(r.c)(t)?l.setDisplayConfiguration(t).then(t=>(n(function(e,t){return Object(c.b)("VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED",{displayConfiguration:t},e)}(e,t)),Promise.resolve(t))).catch(e=>function(e){return Object(i.a)(578426816)(e),Promise.resolve(void 0)}(e)):Promise.reject(new a.a("Not half pane or half pane configuration",577610273,-2130957557))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c}));var r=n(4),o=n(12);const i=Object(o.e)({alignItems:"center",justifyContent:"center"}),a=Object(o.e)({alignItems:"stretch"}),s=Object(o.e)({transform:[{scaleX:-1}]}),c=(new r.b([r.b.always(e=>({tintColor:e.palette.IconButtonDisabledTint}))]),new r.b([r.b.always(e=>({tintColor:e.palette.IconButtonFocusedTint}))]),Object(o.e)({opacity:0}))},function(e,t,n){"use strict";t.a={get:e=>({width:100,height:100,scale:1,fontScale:1})}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Like=1]="Like"}(r||(r={}))},function(e,t,n){"use strict";var r=n(132),o=n(97);t.a=function(e){if(!Object(o.a)(e))return!1;var t=Object(r.a)(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){"use strict";t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t,n){"use strict";t.a=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},function(e,t){e.exports=OfficePlatformGlobal.RNWin32.Components},function(e,t,n){"use strict";function r(e){return e.map(e=>({name:e}))}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));const o=(e,t)=>e},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(11),o=n(32),i=n(1),a=n(9),s=n(98),c=n(178),d=n(42),l=n(111),u=n(12),p=n(38),h=n(20),f=n(205);class m extends i.PureComponent{constructor(){super(...arguments),this.refManager=new r.g,this.focus=this.refManager.focus,this.blur=this.refManager.blur,this.getFocusState=this.refManager.getFocusState,this.getChildNodes=this.refManager.getChildNodes,this.addChildNode=this.refManager.addChildNode,this.getDescendantById=this.refManager.getDescendantById,this.getId=this.refManager.getId,this.getData=this.refManager.getData,this.isTabbable=this.refManager.isTabbable,this.getNextTabTarget=this.refManager.getNextTabTarget,this.getIterator=this.refManager.getIterator,this.renderWithTheme=e=>{const t=Object(l.b)({icon:this.props.icon,disabled:this.disabled,renderTarget:"Pane",themeId:e.themeId}),n=t.directional&&a.I18nManager.isRTL?f.c:void 0,{onClick:o}=this.props;let s;s="hidden"!==this.props.visibility?{["function"==typeof o?"onClick":"menuProps"]:o}:{onClick:m.doNothing};const d=Object(r.s)(this.props.preventDefaultKeyDownBehavior,r.a.Capturing),p=this.props.useAppColor?b:g,C={onMenuOpened:this.props.onMenuOpened};return i.createElement(h.a,{style:[f.b,this.props.style,n,"hidden"===this.props.visibility?f.d:void 0],accessible:!1,focusable:!1,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,keyDownEvents:d,onStartShouldSetResponder:c.a},i.createElement(p,Object.assign({accessibilityLabel:this.props.accessibilityLabel,icon:t.source,disabled:this.disabled,tooltip:"hidden"!==this.props.visibility?this.props.tooltipText:void 0,focusable:this.props.isTabbable&&"hidden"!==this.props.visibility,ref:this.refManager.ref,testID:this.props.testID,style:[this.props.text?u.i:u.d],text:this.props.text,onFocus:this.props.onFocus,onBlur:this.props.onBlur,onFocusStateChange:this.props.onFocusStateChange,nodeId:this.props.nodeId,nodeData:this.props.nodeData,isTabbable:this.props.isTabbable&&!this.disabled&&"hidden"!==this.props.visibility,accessible:"hidden"!==this.props.visibility,preventDefaultKeyDownBehavior:void 0},s,C)))},this.render=()=>Object(d.a)(this.renderWithTheme,p.a)}get disabled(){return!!this.props.disabled}}m.doNothing=()=>{};const g=Object(s.c)(o.CommandButton),b=Object(s.c)(o.PrimaryButton)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(26);n(72);class o{constructor(){this._event=new r.EventImpl(()=>{}),this.isHovered=!1,this.hoverChangeEvent=this._event,this.onMouseEnter=()=>this.debounce(()=>{this.onHoverChange(!0)}),this.onMouseLeave=()=>this.debounce(()=>{this.onHoverChange(!1)}),this.viewProps={onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave}}debounce(e){this.action?this.action=e:(this.action=e,setTimeout(()=>{this.action&&this.action(),this.action=void 0},o.DebounceDelay))}onHoverChange(e){e!==this.isHovered&&(this.isHovered=e,this._event.trigger(e))}}o.DebounceDelay=50},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);const o=r.createContext(new Proxy({},{get:()=>{throw new Error("LPPManagerContext undefined. Did you forget to render a LPPManagerContext context provider?")}}))},function(e,t,n){"use strict";function r(e){return"object"==typeof e&&void 0!==e.message&&void 0!==e.SDXHostAPIErrorCode}n.d(t,"a",(function(){return r}))},function(e,t,n){var r=n(400);e.exports=function(e,t){if(null==e)return{};var n,o,i=r(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";n.d(t,"c",(function(){return Qe})),n.d(t,"a",(function(){return Xe}));var r=n(89),o=n(37),i=n(5),a=n(87),s=n(33),c=n(103),d=n(23),l=n(144),u=n(8),p=n(413),h=n(425),f=n(0),m=n(431),g=n(52),b=n(356),C=n(11),y=n(32),v=n(1),T=n(9),S=n(70),I=n(45),O=n(69),E=n(25),P=n(2),k=n(13),R=n(22),x=n(7),D=n(19),w=n(17),A=n(143),j=n(99),_=n(53),F=(n(83),n(6)),M=n(232),N=n(50),L=n(278),B=n(137),H=n(223),U=n(98),V=n(42),W=n(24),z=n(29),K=n(12),G=n(38),q=n(298),$=n(292),Y=n(105);function J(e,t){return()=>e(t)}function Q(e){H.c(J,e.onWillUnmount,e.threadId);const t=v.useCallback(t=>function(e,t,n,r){t(e,n,r)}(t,e.onLayout,e.index,e.threadId),[e.onLayout,e.index,e.threadId]);return v.createElement(U.a.Provider,{value:e.index},Object(V.a)(n=>{if(P.i())return e.children;let r;return r=e.renderContextType===F.a.HalfPane?[X(N.h,e.renderContextType,n),{width:e.halfPaneWidth}]:[X(N.f,e.renderContextType,n)],v.createElement(Y.a,{style:r,onLayout:t},v.createElement(q.a,Object.assign({},function(e){if(0===e.renderMode)return{children:e.children,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior};return{renderContextType:e.renderContextType,cancelLabel:e.cancelLabel,confirmLabel:e.confirmLabel,cancelAccessibilityLabel:e.cancelAccessibilityLabel,confirmAccessibilityLabel:e.confirmAccessibilityLabel,warningLabel:e.warningLabel,onCancel:e.onCancel,onConfirm:e.onConfirm,children:2===e.renderMode?void 0:e.children,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior}}(e),{preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior})))},G.a))}function X(e,t,n){return Object(K.g)(e,n,t)}var Z=n(224),ee=n(15),te=n(95),ne=n(20),re=n(34),oe=n(40),ie=n(27),ae=n(4);const se=new ae.b([ae.b.always({justifyContent:"flex-end",height:86,paddingLeft:N.c,paddingRight:N.d,borderWidth:1,borderColor:"transparent"}),ae.b.rule({platform:"win32"},{marginLeft:13,marginRight:1,marginBottom:1,paddingLeft:0,paddingRight:0})]),ce=new ae.b([ae.b.rule({platform:"win32"},e=>({borderColor:e.palette.FocusBorderColor,borderStyle:"dashed"}))]),de=y.StyleSheet.createViewStyle({marginBottom:ie.g,flex:0,textAlign:"center"}),le=new ae.b([ae.b.always(e=>({height:52,backgroundColor:e.palette.CardBackground,flexDirection:"row",alignItems:"stretch",elevation:2,flex:0,borderLeftWidth:oe.a,borderTopWidth:oe.a,borderRightWidth:oe.a,borderColor:e.palette.CardAccent})),ae.b.rule({platform:"ios"},e=>Object.assign({borderLeftWidth:N.b,borderTopWidth:N.b,borderRightWidth:N.b,borderTopLeftRadius:N.a,borderTopRightRadius:N.a},N.l(e)))]),ue=Object(K.e)({width:ie.g+30+ie.e,flex:0}),pe=new ae.b([ae.b.always({width:30,height:30,borderRadius:15,position:"absolute",left:ie.g,marginTop:12}),...ie.l,ae.b.rule({platform:"win32"},e=>({backgroundColor:e.palette.CardAccent}))]),he=Object(K.e)({flex:1,alignItems:"stretch"}),fe=Object(K.e)({paddingRight:70,marginTop:12,alignItems:"stretch"}),me=Object(K.e)({paddingRight:12,marginTop:6,alignItems:"stretch"}),ge=new ae.b([ae.b.always({height:11,borderRadius:5.5}),...ie.l,ae.b.rule({platform:"win32"},e=>({backgroundColor:e.palette.CardAccent}))]);class be extends v.PureComponent{constructor(){super(...arguments),this.onFocusStateChange=e=>{var t,n;e===C.b.FocusOn&&(null===(n=(t=this.props).onFocus)||void 0===n||n.call(t))},this.renderWithTheme=e=>v.createElement(te.a,{onPress:this.props.onClick,accessibilityRole:"button",accessibilityLabel:this.props.accessibilityLabel,accessible:!0,style:this.renderStyle(se,e),isTabbable:!0,nodeId:Object(ee.v)(),testID:Object(ee.v)(),onFocusStateChange:this.onFocusStateChange,focusedStyle:this.renderStyle(ce,e),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior},v.createElement(re.a,{style:de,textStylePolyester:"MediumStandard",variantFluent:"secondaryStandard"},this.props.ghostCommentString),v.createElement(ne.a,{style:this.renderStyle(le,e)},v.createElement(ne.a,{style:ue},v.createElement(ne.a,{style:this.renderStyle(pe,e)})),v.createElement(ne.a,{style:he},v.createElement(ne.a,{style:fe},v.createElement(ne.a,{style:this.renderStyle(ge,e)})),v.createElement(ne.a,{style:me},v.createElement(ne.a,{style:this.renderStyle(ge,e)}))))),this.render=()=>Object(V.a)(this.renderWithTheme,G.a)}renderStyle(e,t){return Object(K.g)(e,t,F.a.FullPane)}}var Ce=n(246),ye=n(230);class ve extends v.Component{render(){return null}}var Te=n(213);const Se=new ae.b([ae.b.rule({renderContextType:F.a.HalfPane},{flex:1,alignSelf:"stretch",justifyContent:"center"}),ae.b.rule({renderContextType:F.a.FullPane},{margin:12})]),Ie=y.StyleSheet.createViewStyle({textAlign:"center"}),Oe=v.memo((function(e){const t=[Se.render(Object(z.c)(e.renderContextType)),e.containerWidth?{width:e.containerWidth}:void 0];return v.createElement(ne.a,{style:t},v.createElement(re.a,{textStylePolyester:"MediumStandard",variantFluent:"secondaryStandard",style:Ie},e.message))}));var Ee=n(39);class Pe extends v.PureComponent{render(){return v.createElement(v.Fragment,null,this.props.children)}}Pe.displayName="Fragment";const ke=Object(U.c)(Pe);var Re=n(90),xe=n(18),De=n(96),we=n(134),Ae=n(54),je=n(146),_e=n(291),Fe=n(206);const Me=e=>e&-e;class Ne{constructor(e,t){const n=null!=t?t:e.length;this.tree=[];for(let e=0;e<n;e++)this.tree.push(0);e.forEach((e,t)=>t<this.tree.length&&this.add(e,t))}getSum(e){if(e<0||e>=this.tree.length){const t=`getSum index out of bounds: ${e}, length ${this.tree.length}`;throw Object(f.i)().assertConditionTag(!1,t,595857548),new Error(t)}let t=0;for(let n=e+1;n>0;n-=Me(n))t+=this.tree[n-1];return t}add(e,t){if(t<0||t>=this.tree.length){const e=`getSum index out of bounds: ${t}, length ${this.tree.length}`;throw Object(f.i)().assertConditionTag(!1,e,595857549),new Error(e)}for(let n=t+1;n<=this.tree.length;n+=Me(n))this.tree[n-1]+=e}set(e,t){this.add(e-this.getValue(t),t)}getValue(e){return this.getSum(e)-(e&&this.getSum(e-1))}getCapacity(){return this.tree.length}}n(72);var Le,Be=n(188);!function(e){e[e.None=0]="None",e[e.NewScroll=1]="NewScroll",e[e.ReasonUnknown=2]="ReasonUnknown",e[e.CoauthChange=3]="CoauthChange",e[e.UserInteraction=4]="UserInteraction",e[e.UserScroll=5]="UserScroll",e[e.DirectionChange=6]="DirectionChange"}(Le||(Le={}));class He{constructor(e){this.dataFieldVisitor=e}startStickyScroll(e){var t;this.session&&this.end(Le.NewScroll,595138519);const n=Object(f.i)().createActivityObject("StickyScrollPerf",this.dataFieldVisitor,f.a.None,f.b.NecessaryServiceDataEvent);this.session={activity:n,activityStart:He.now(),numRescrolls:0},n.addDataField("ScrollOffset",e.scrollOffset,f.d.SystemMetadata),n.addDataField("ContentHeight",null!==(t=e.contentHeight)&&void 0!==t?t:-1,f.d.SystemMetadata),n.addDataField("IsHorizontal",e.isHorizontal,f.d.SystemMetadata)}end(e,t){var n;this.session&&(this.session.activity.addDataField("Duration",(null!==(n=this.session.lastRescrollTime)&&void 0!==n?n:this.session.activityStart)-this.session.activityStart,f.d.SystemMetadata),this.session.activity.addDataField("NumberOfRescrolls",this.session.numRescrolls,f.d.SystemMetadata),this.session.activity.addDataField("EndReason",e,f.d.SystemMetadata),this.session.activity.successTag(t),this.session=void 0)}onRescroll(){this.session&&(this.session.lastRescrollTime=He.now(),this.session.numRescrolls++)}static now(){if("undefined"!=typeof performance&&performance.now){const e=performance.now();return Math.floor(1e3*e)}return 1e3*Date.now()}}var Ue,Ve;!function(e){e[e.None=0]="None",e[e.ScrollOffset=1]="ScrollOffset",e[e.ContentHeight=2]="ContentHeight",e[e.ContentWidth=4]="ContentWidth",e[e.OuterHeight=8]="OuterHeight",e[e.OuterWidth=16]="OuterWidth",e[e.ProgrammaticScrollEnd=32]="ProgrammaticScrollEnd"}(Ue||(Ue={})),function(e){e[e.Refresh=0]="Refresh",e[e.Start=1]="Start",e[e.End=2]="End",e[e.Index=3]="Index",e[e.Offset=4]="Offset"}(Ve||(Ve={}));class We{constructor(){this.isCurrentlyAnimating=!1}setTargetOffset(e,t,n){this.targetScrollToOffset=e,this.prevScrollToOffset=t,this.isCurrentlyAnimating=n}getTargetOffset(){return this.targetScrollToOffset}getPreviousScrollToOffset(){return this.prevScrollToOffset}isAnimating(){return this.isCurrentlyAnimating}}class ze{constructor(e,t,n){this.scrollOffset=0,this.contentHeight=void 0,this.contentWidth=void 0,this.outerHeight=0,this.outerWidth=0,this.listRef=null,this.userIsScrolling=!1,this.targetScrollToOffset=new We,this.changeListeners=[],this.onUserScrollEndListeners=[],this.pendingOnContentSizeChanged=!1,this.debouncedWidth=0,this.debouncedHeight=0,this.PROGRAMMATIC_END_OFFSET_THRESHOLD=3,this.shouldFireProgrammaticEndOnScroll=()=>{if(this.userIsScrolling)return!1;const e=this.targetScrollToOffset.getTargetOffset();if(void 0===e){const e=this.getOuterLength();let t=this.targetScrollToOffset.getPreviousScrollToOffset();return t||(t=0),void 0===e?(Object(f.i)().assertConditionTag(!this.isHorizontal,"Half pane needs better info since it can't handle multiple end events for the same position",590717702),Math.floor(this.scrollOffset)!==Math.floor(t)):Math.abs(this.scrollOffset-t)>e-this.PROGRAMMATIC_END_OFFSET_THRESHOLD}return Math.floor(e)===Math.floor(this.scrollOffset)},this.onContentSizeChange=this.onContentSizeChange.bind(this),this.onListLayout=this.onListLayout.bind(this),this.onMomentumScrollBegin=this.onMomentumScrollBegin.bind(this),this.onMomentumScrollEnd=this.onMomentumScrollEnd.bind(this),this.onScroll=this.onScroll.bind(this),this.onScrollBeginDrag=this.onScrollBeginDrag.bind(this),this.onScrollEndDrag=this.onScrollEndDrag.bind(this),this.scrollToQueuedTarget=this.scrollToQueuedTarget.bind(this),this.setListRef=this.setListRef.bind(this),this.getItemLayout=e,this.isHorizontal=t,this.stickyScrollTracker=new He(n)}getOuterViewProps(){return{onLayout:this.onListLayout}}getScrollProps(){return{onContentSizeChange:this.onContentSizeChange,onMomentumScrollBegin:this.onMomentumScrollBegin,onMomentumScrollEnd:this.onMomentumScrollEnd,onScroll:this.onScroll,onScrollBeginDrag:this.onScrollBeginDrag,onScrollEndDrag:this.onScrollEndDrag,ref:this.setListRef}}getScrollOffset(){return this.scrollOffset}getContentHeight(){return this.contentHeight}getContentWidth(){return this.contentWidth}getOuterHeight(){return this.outerHeight}getOuterWidth(){return this.outerWidth}getListRef(){return this.listRef}debounceContentSizeChange(e,t){this.debouncedWidth=e,this.debouncedHeight=t,this.pendingOnContentSizeChanged||(this.pendingOnContentSizeChanged=!0,setTimeout(()=>{this.onContentSizeChangeImpl(this.debouncedWidth,this.debouncedHeight),this.pendingOnContentSizeChanged=!1},ze.DebounceDelay))}onContentSizeChange(e,t){Object(P.D)()?this.debounceContentSizeChange(e,t):this.onContentSizeChangeImpl(e,t)}onContentSizeChangeImpl(e,t){let n=Ue.None;e!==this.contentWidth&&(n|=Ue.ContentWidth),t!==this.contentHeight&&(n|=Ue.ContentHeight);let r=this.scrollOffset;const o=this.getContentLength(),i=this.isHorizontal?e:t;void 0!==o&&i<o&&(r=Object(Be.a)(this.scrollOffset,this.getOuterLength(),i)),r!==this.scrollOffset&&(n|=Ue.ScrollOffset,this.scrollOffset=r),this.contentHeight=t,this.contentWidth=e,this.fireChangeListenerNotification(n),this.scrollToStickyTarget(595940952)}onScroll(e){e&&(e.nativeEvent.isUserTriggered&&this.clearStickyState(Le.UserScroll,595138520),this.scrollOffset=this.isHorizontal?e.nativeEvent.contentOffset.x:e.nativeEvent.contentOffset.y,this.shouldFireProgrammaticEndOnScroll()?(this.targetScrollToOffset.setTargetOffset(void 0,this.scrollOffset,!1),this.fireChangeListenerNotification(Ue.ScrollOffset|Ue.ProgrammaticScrollEnd)):this.fireChangeListenerNotification(Ue.ScrollOffset))}onScrollBeginDrag(e){this.clearStickyState(Le.UserScroll,595138521),this.userIsScrolling=!0}onScrollEndDrag(e){}onMomentumScrollBegin(e){this.userIsScrolling=!0}onMomentumScrollEnd(e){this.userIsScrolling&&this.onUserScrollEndListeners.forEach(e=>e());this.targetScrollToOffset.isAnimating();this.userIsScrolling=!1,this.targetScrollToOffset.setTargetOffset(void 0,this.scrollOffset,!1)}setListRef(e){this.listRef=e}onListLayout(e){const t=e.nativeEvent.layout.height,n=e.nativeEvent.layout.width;let r=Ue.None;this.outerHeight!==t&&(r|=Ue.OuterHeight,this.outerHeight=t),this.outerWidth!==n&&(r|=Ue.OuterWidth,this.outerWidth=n),this.fireChangeListenerNotification(r),this.isHorizontal?Ue.OuterWidth:Ue.OuterHeight}scrollToIndex(e,t,n=!1,r=!1){this.clearStickyState(Le.NewScroll,595138522),n&&(this.stickyState={type:Ve.Index,index:e,lazy:r},this.stickyScrollTracker.startStickyScroll({contentHeight:this.contentHeight,isHorizontal:this.isHorizontal,scrollOffset:this.scrollOffset})),this.queueScrollTarget({type:Ve.Index,lazy:r,animate:t,index:e,origin:595940959,isStickyRescroll:!1})}scrollToOffsets(e,t,n,...r){this.clearStickyState(Le.NewScroll,595138523),this.queueScrollTarget({type:Ve.Offset,lazy:t,animate:e,offset:n,additionalOffsets:r,origin:595940960})}scrollToStart(e){this.clearStickyState(Le.NewScroll,595138524),this.queueScrollTarget({type:Ve.Start,animate:e,origin:595940961})}scrollToEnd(e,t=!1){this.clearStickyState(Le.NewScroll,595138525),t&&(this.stickyState={type:Ve.End},this.stickyScrollTracker.startStickyScroll({contentHeight:this.contentHeight,isHorizontal:this.isHorizontal,scrollOffset:this.scrollOffset})),this.queueScrollTarget({type:Ve.End,animate:e,origin:595940962,isStickyRescroll:!1})}registerChangeListener(e){this.changeListeners.push(e)}unregisterChangeListener(e){const t=this.changeListeners.indexOf(e);return!(t<0)&&(this.changeListeners.splice(t,1),!0)}registerUserScrollEndListener(e){this.onUserScrollEndListeners.push(e)}unregisterUserScrollEndListener(e){const t=this.onUserScrollEndListeners.indexOf(e);return!(t<0)&&(this.onUserScrollEndListeners.splice(t,1),!0)}clearStickyState(e,t){this.stickyState=void 0,this.queuedScrollTarget&&this.queuedScrollTarget.type===Ve.Index&&this.queuedScrollTarget.isStickyRescroll&&(this.queuedScrollTarget=void 0),this.stickyScrollTracker.end(e,t)}onItemLayoutChange(){this.scrollToStickyTarget(595940963)}setIsHorizontal(e){const t=this.isHorizontal;this.isHorizontal=e,this.isHorizontal!==t&&(this.scrollOffset=0,this.clearStickyState(Le.DirectionChange,595138526))}currentOffsetInvalidated(){this.scrollOffset=0,this.clearStickyState(Le.NewScroll,556323672)}getIsHorizontal(){return this.isHorizontal}fireChangeListenerNotification(e){e!==Ue.None&&this.changeListeners.forEach(t=>t(e))}queueScrollTarget(e){if(this.queuedScrollTarget){if(e.type===Ve.Refresh)return;this.queuedScrollTarget=e}else this.queuedScrollTarget=e,setTimeout(this.scrollToQueuedTarget,this.getScrollTimeout())}getScrollTimeout(){return 250}scrollToStickyTarget(e){this.stickyState&&this.queueScrollTarget(Object.assign(Object.assign({},this.stickyState),{animate:!1,isStickyRescroll:!0,origin:e}))}scrollToQueuedTarget(){try{const e=this.queuedScrollTarget;if(this.listRef&&e){let t,n=!0,r=[],o=e.type;switch(e.type){case Ve.Start:t=0;break;case Ve.End:t=this.getContentLength()||0;break;case Ve.Index:e.isStickyRescroll&&this.stickyScrollTracker.onRescroll();const i=this.getItemLayout(e.index);i?(t=i.offset,r=[i.offset+i.length],n=e.lazy):(t=this.scrollOffset,o=Ve.Refresh);break;case Ve.Offset:t=e.offset,n=e.lazy,r=e.additionalOffsets;break;case Ve.Refresh:t=this.scrollOffset,o=Ve.Refresh;break;default:Object(u.m)(e)}const i=e.type!==Ve.Refresh&&e.animate,a=Object(Be.c)(n,this.getOuterLength(),this.getContentLength()||0,this.scrollOffset,t,...r);(a!==this.scrollOffset||o===Ve.Refresh)&&(this.listRef.scrollToOffset({animated:i,offset:a}),a!==this.scrollOffset?this.targetScrollToOffset.setTargetOffset(a,this.targetScrollToOffset.getTargetOffset()?this.targetScrollToOffset.getTargetOffset():0,i):this.targetScrollToOffset.setTargetOffset(void 0,this.scrollOffset,!1))}}catch(e){Object(E.a)(574433048)(e)}finally{this.queuedScrollTarget=void 0}}getContentLength(){return this.isHorizontal?this.contentWidth:this.contentHeight}getOuterLength(){return this.isHorizontal?this.outerWidth:this.outerHeight}}ze.DebounceDelay=200;var Ke,Ge,qe,$e=n(152);n(201);!function(e){e[e.None=0]="None",e[e.HalfPaneContextChangePlaceholder=1]="HalfPaneContextChangePlaceholder"}(Ke||(Ke={})),function(e){e[e.None=0]="None",e[e.FullPaneGhostCard=1]="FullPaneGhostCard",e[e.FullPaneGhostCardPlaceholder=2]="FullPaneGhostCardPlaceholder",e[e.HalfPaneContextChangePlaceholder=3]="HalfPaneContextChangePlaceholder"}(Ge||(Ge={})),function(e){e[e.InList=0]="InList",e[e.BelowList=1]="BelowList"}(qe||(qe={}));const Ye={cardTabbingMode:De.a.ExpandedCardOrFirstCardTabbable,postTabbingMode:De.b.ExpandedCardRootPostTabbable};De.a.AllCardsTabbable,De.b.AllPostsTabbable;class Je extends M.a{constructor(e){super(e),this.forceScroll=!1,this.forceScrollAfterReadyToRender=!1,this.onListItemWillUnmount=e=>{if(this.props.componentTree.isFocusOnOrWithin({renderContextType:this.props.componentTree.componentTreeId.renderContextType,componentType:xe.a.Card,id:e})){const e=this.props.componentTree.getComponent(xe.a.CommentsList);e&&e.focus()}},this.onListItemLayout=(e,t,n)=>{this.setFullPaneListItemHeight(t,n,e.nativeEvent.layout.height)},this.onGhostCommentFocused=()=>{this.state.ghostCommentLocation===qe.InList&&setTimeout(()=>this.scrollManager.scrollToEnd(!1,!0))},this.updateContentSizeState=()=>{const e=this.scrollManager.getContentHeight();void 0!==e&&this.setState({isContentLargerThanList:e>this.scrollManager.getOuterHeight()})},this.getMentionableCommentEditorProps=Object(p.a)((e,t)=>{if(e===I.b.Enabled)return{onMentionCreated:this.onMentionCreated,onMentioneesStillInDraftUpdated:this.onMentioneesStillInDraftUpdated,correlationId:this.props.correlationId,suggestionsDetails:t}}),this.clearStickyScrollStateFromChild=()=>{this.scrollManager.clearStickyState(Le.ReasonUnknown,595138528)},this.assertStaleHeightData=Object(h.a)(()=>{Object(f.i)().assertConditionTag(!1,`commentThreadHeights size: ${this.commentThreadHeights.size}, num threads: ${this.state.allRenderableItemThreads.length}`,595961856)}),this.getItemLayoutForFlatlist=(e,t)=>this.getItemLayout(e,t,!0),this.ViewabilityConfig={minimumViewTime:150,viewAreaCoveragePercentThreshold:0,waitForInteraction:!1},this.onSafeAreaInsetsChange=e=>{this.setState({paneContentSafeAreaInsets:e})},this.onFocusedNodeChanged=()=>{this.props.componentTree.componentTreeId.renderContextType,F.a.FullPane,0},this.onRootViewKeyDown=e=>{this.scrollManager.clearStickyState(Le.UserInteraction,595138530),this.props.selectedComment&&this.isTabIntoCard(e)&&!this.props.componentTree.getComponentById({componentType:Object(Ee.c)(this.props.selectedComment.selectedCardId,this.props.draftState),id:this.props.selectedComment.selectedCardId,renderContextType:this.props.componentTree.componentTreeId.renderContextType})?(this.scrollToCurrentIndex(!1,!1,!1),e.persist(),setTimeout(()=>this.props.componentTree.onKeyDownTabHandlerHelper(this.getResourceId(),e),300)):(this.props.componentTree.onKeyDownTabHandlerHelper(this.getResourceId(),e),this.commentContentsKeyDownHandler.onKeyDown(e))},this.getRootViewKeyDownEvents=Object(p.a)(()=>Object(C.j)({useJSTabLoop:!0,handleKeysDuringBubbling:!0})),this.setViewTreeRoot=e=>{this.props.componentTree.setViewTreeRootHelper(e,this.getResourceId())},this.getContentsPreventDefaultKeyDownBehavior=Object(p.b)(C.i,()=>[this.commentContentsKeyDownHandler.getKeyDownEvents(),!0]),this.getThreadIdToListIndexMap=Object(p.b)(e=>new Map(e.map((e,t)=>[W.i(e).commentId,t])),()=>[this.state.allRenderableItemThreads]),this.onCardLayout=(e,t)=>{const n=this.getThreadIdToListIndexMap().get(e);void 0!==n?this.setFullPaneListItemHeight(n,e,t.nativeEvent.layout.height):Object(f.i)().assertConditionTag(!1,"Unexpected threadId",592570563)},this.onListFocusStateChange=e=>{this.setState({listFocusState:e})},this.renderWithTheme=e=>{if(this.props.initializationStatus!==j.a.Initialized&&this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane&&this.props.initializationReason===A.a.NewThread)return v.createElement(ne.a,null);const t=[this.renderStyle(N.i,e),this.state.showListDividingLine&&this.renderStyle(N.j,e)],n=Object(D.c)(this.props.draftState),r=this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane&&!n,o=!r&&this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane&&n&&this.props.createdCommentLie&&this.props.foldableLayoutState===S.e.DoublePortrait,i=P.x()&&this.props.componentTree.componentTreeId.renderContextType===F.a.FullPane,a=Je.shouldShowLoadingUI({length:this.state.allRenderableItemThreads.length,isReadyToRender:this.isReadyToRender(),renderContextType:this.props.componentTree.componentTreeId.renderContextType,selectedComment:this.props.selectedComment,listViewWidthForHalfPane:this.state.listViewWidthForHalfPane,initializationStatus:this.props.initializationStatus,createdCommentLie:this.props.createdCommentLie});a||0!==this.props.dataItems.length||this.notifyRenderedOnce();const s=this.scrollManager.getOuterViewProps(),c=P.J()?b.FlatList:T.FlatList,d=v.createElement(Re.a,{style:t,onLayout:this.onPaneViewLayout,focusable:!1,nodeId:Object(Ee.e)(xe.a.PaneRoot),accessibilityLabel:this.props.localizationAPI.getString(31),accessible:!0,ref:this.setViewTreeRoot,preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),onFocus:this.onFocusedNodeChanged,onKeyDown:this.onRootViewKeyDown,keyDownEvents:this.getRootViewKeyDownEvents()},r&&this.renderNavigationBarForExistingComments(e),o&&this.renderNavigationBarForNewComment(e),this.renderPaneHeader(),i&&this.renderNewCommentButton(e,this.isNewCommentButtonDisabled()),v.createElement(Z.a,{shouldRenderView:!1,onLayout:s.onLayout,style:K.d,onSafeAreaInsetsChange:this.onSafeAreaInsetsChange},v.createElement(ke,{preventDefaultKeyDownBehavior:void 0},a?v.createElement(ne.a,{style:N.u},v.createElement(m.a,{delay:K.a},v.createElement(y.Spinner,{size:"large"}))):[v.createElement(Re.a,{key:"list",onFocusStateChange:this.onListFocusStateChange,accessible:!0,accessibilityLabel:this.props.localizationAPI.getString(32),focusable:!0,style:[K.d,this.renderStyle(N.o,e),this.state.listFocusState===C.b.FocusOn&&this.renderStyle(N.p,e)],nodeId:Object(Ee.e)(xe.a.CommentsList),accessibilityRole:Object(Te.b)("tree",void 0),preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior()},v.createElement(c,Object.assign({onLayout:s.onLayout},this.getListProps(e)))),this.shouldShowGhostComment()&&this.state.ghostCommentLocation===qe.BelowList&&this.renderGhostCardOverlay(e)])));let l=d;return P.i()&&(l=v.createElement(we.b,{expandedComments:this.props.expandedComments},d)),l},this.keyboardDidHide=this.keyboardDidHide.bind(this),this.keyboardDidShow=this.keyboardDidShow.bind(this),this.onUserScrollEnd=this.onUserScrollEnd.bind(this),this.onNextThread=this.onNextThread.bind(this),this.onPaneViewLayout=this.onPaneViewLayout.bind(this),this.onPreviousThread=this.onPreviousThread.bind(this),this.renderListItem=this.renderListItem.bind(this),this.invokeModalDialog=this.invokeModalDialog.bind(this),this.handleScrollToCommand=this.handleScrollToCommand.bind(this),this.onSafeAreaInsetsChange=this.onSafeAreaInsetsChange.bind(this),this.onScrollManagerChange=this.onScrollManagerChange.bind(this),this.getItemLayoutForScrollManager=this.getItemLayoutForScrollManager.bind(this);const t=this.getInitialState(e);this.commentThreadHeights=new Map;const n={listViewWidthForHalfPane:0,currThreadIndex:Object(Be.b)(this.props.selectedComment,t.allRenderableItemThreads),ghostCommentLocation:qe.InList,maxDraftHeight:this.calculateMaxDraftHeight(0),displayLossyWarningAsOverlay:!1,availableScreenHeight:Fe.a.get("window").height,paneContentSafeAreaInsets:{top:0,right:0,bottom:0,left:0},showListDividingLine:!1,commentThreadHeightSums:this.getRenderableItemThreadHeightSums(e,t.allRenderableItemThreads),isContentLargerThanList:!1,listFocusState:C.b.Unfocused};this.state=Object.assign(Object.assign({},t),n),this.scrollListener={invokeScrollToCommand:this.handleScrollToCommand,clearStickyScrollState:this.clearStickyScrollStateFromChild},this.scrollManager=new ze(this.getItemLayoutForScrollManager,this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane,this.props.telemetryVisitor),this.scrollManager.registerChangeListener(this.onScrollManagerChange),this.scrollManager.registerUserScrollEndListener(this.onUserScrollEnd)}UNSAFE_componentWillMount(){this.keyboardDidHideListener=T.Keyboard.addListener("keyboardDidHide",this.keyboardDidHide),this.keyboardDidShowListener=T.Keyboard.addListener("keyboardDidShow",this.keyboardDidShow)}componentWillUnmount(){super.componentWillUnmount(),this.keyboardDidHideListener&&this.keyboardDidHideListener.remove(),this.keyboardDidHideListener=void 0,this.keyboardDidShowListener&&this.keyboardDidShowListener.remove(),this.keyboardDidShowListener=void 0}UNSAFE_componentWillReceiveProps(e){var t;const n=this.getUpdatedItemThreads(e);let r=this.state.displayLossyWarningAsOverlay;if((this.props.dataItems!==e.dataItems||this.props.selectedComment!==e.selectedComment)&&e.selectedComment){const n=(null===(t=this.props.selectedComment)||void 0===t?void 0:t.selectionDetails.lowFidelityWarningType)!==e.selectedComment.selectionDetails.lowFidelityWarningType;if(e.componentTree.componentTreeId.renderContextType===F.a.FullPane&&n&&Object(w.h)(e.selectedComment)){const t=this.commentThreadHeights.get(e.selectedComment.selectedCardId);r=!!t&&t>=235}}if(this.props.lastContextChangeIncrement!==e.lastContextChangeIncrement&&this.commentThreadHeights.clear(),this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane){const e=this.getThreadIndexFromScrollPosition(this.scrollManager.getScrollOffset());this.forceScroll=-1===e||e===this.state.allRenderableItemThreads.length}this.setState({allRenderableItemThreads:n,currThreadIndex:Object(Be.b)(e.selectedComment,n),displayLossyWarningAsOverlay:r,commentThreadHeightSums:this.getRenderableItemThreadHeightSums(e,n)})}getRenderableItemThreadHeightSums(e,t){var n;return e.componentTree.componentTreeId.renderContextType!==F.a.FullPane||this.state&&Object(je.a)(t,this.state.allRenderableItemThreads)&&this.props.componentTree.componentTreeId.renderContextType!==F.a.HalfPane?(null===(n=this.state)||void 0===n?void 0:n.commentThreadHeightSums)||new Ne([]):new Ne(t.map((n,r)=>this.getFullPaneListItemHeight(t[r],e,!1)))}componentDidMount(){super.componentDidMount(),this.props.selectedComment&&(this.forceScrollAfterReadyToRender=!0)}componentDidUpdate(e,t){var n;const r=!(e.createdCommentLie||!this.props.createdCommentLie),o=Object(M.b)(this.props),i=o!==Object(M.b)(e),a=i&&o,s=e.componentTree.componentTreeId.renderContextType!==F.a.HalfPane&&this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane,c=Object(je.d)(e.selectedComment,e.draftState,e.cardViewStates,e.componentTree.componentTreeId.renderContextType),d=Object(je.d)(this.props.selectedComment,this.props.draftState,this.props.cardViewStates,this.props.componentTree.componentTreeId.renderContextType),l=Object(D.d)(e.draftState),u=Object(D.d)(this.props.draftState),p=c!==d;this.scrollManager.setIsHorizontal(P.w()?this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane:e.componentTree.componentTreeId.renderContextType===F.a.HalfPane);const h=!!(null===(n=Object(x.K)(this.props.draftState))||void 0===n?void 0:n.isInCurrentContext),f=h&&Object(x.f)(e.draftState,this.props.draftState),m=Object(D.m)(e.draftState,this.props.draftState);if(e.lastContextChangeIncrement!==this.props.lastContextChangeIncrement&&(this.forceScrollAfterReadyToRender=h),this.isReadyToRender()&&(this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane||r||a||p||f||m||this.forceScroll||this.forceScrollAfterReadyToRender)){const n=!this.state.allRenderableItemThreads.length,o=e.dataItems!==this.props.dataItems,h=u!==l,g=this.state.listViewWidthForHalfPane!==t.listViewWidthForHalfPane;if((p||i)&&this.scrollManager.clearStickyState(Le.UserInteraction,595138527),n)this.scrollToEmptyView();else if((o||p||h||s||g||i||f||m||this.forceScroll||this.forceScrollAfterReadyToRender)&&(d||i)){const t=e.componentTree.componentTreeId.renderContextType===F.a.HalfPane,n=this.isSelectedCardPinned(e),d=void 0!==this.state.currThreadIndex&&Math.abs(this.state.currThreadIndex-this.getThreadIndexFromScrollPosition(this.scrollManager.getScrollOffset()))<=1,l=p&&t&&!o&&!h&&!s&&!g&&!n&&!!c&&d||i&&!r,m=!(a||t||P.w()&&s),b=!!(r||a||u||p||f||this.forceScroll||this.forceScrollAfterReadyToRender)||this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane;this.scrollToCurrentIndex(l,b,m)}this.forceScrollAfterReadyToRender=!1}this.forceScroll=!1,s&&!d&&this.props.dataItems.length&&this.props.selectComment(this.props.componentTree,{renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:590206685,telemetryVisitor:this.props.telemetryVisitor},{selectedCard:W.i(this.props.dataItems).commentId,selectType:k.b.ExpandCard,source:R.a.SharedComments},!1).catch(Object(E.a)(590104653)),e.initializationStatus!==j.a.Initialized&&(this.props.initializationStatus,j.a.Initialized),super.componentDidUpdate(e,t)}onContextChanged(){this.props.initializationStatus===j.a.NotInitialized&&this.props.initializeView(this.props.componentTree.componentTreeId.renderContextType)}getCreateCommentInitialHeight(){return L.a}getKeyboardingOptions(){return Ye}renderStyle(e,t){return Object(K.g)(e,t,this.props.componentTree.componentTreeId.renderContextType)}calculateMaxDraftHeight(e){const{width:t,height:n}=Fe.a.get("window");let r;return r=t>n?.54:(Object(z.a)(),_.a.LargeDisplay,.4),(n-e)*r}keyboardDidShow(e){this.setState({maxDraftHeight:this.calculateMaxDraftHeight(e.endCoordinates.height),availableScreenHeight:Fe.a.get("window").height-e.endCoordinates.height})}keyboardDidHide(e){this.setState({maxDraftHeight:this.calculateMaxDraftHeight(0),availableScreenHeight:Fe.a.get("window").height})}renderListItem(e){const t=W.i(e.item);if(this.props.modelCapabilities.virtualized){const e=[t.commentId];this.onRequestLoadThreads(e)}const{item:n,index:r}=e,o=t.commentId,i=this.renderCommentThread(r,n);return v.createElement(Q,Object.assign({},function(e,t,n,r,o,i){if(e&&e.selectedCardId===i.threadId&&e.selectionDetails.lowFidelityWarningType){const t=e.selectionDetails.lowFidelityWarningType,a=Object($.a)(t,o,i.renderContextType,r);let s=2;return(i.renderContextType===F.a.HalfPane&&Object(z.f)()||i.renderContextType!==F.a.HalfPane&&n)&&(s=1),Object.assign(Object.assign(Object.assign({},i),a),{renderMode:s,hasLowFidelityContent:!0})}return Object.assign(Object.assign({},i),{renderMode:0,hasLowFidelityContent:Object(W.k)(t,void 0)})}(this.props.selectedComment,n,this.state.displayLossyWarningAsOverlay,this.props.localizationAPI,{onConfirm:this.onLowFidelityWarningConfirm,onCancel:this.onLowFidelityWarningCancel},{halfPaneWidth:this.state.listViewWidthForHalfPane,index:r,renderContextType:this.props.componentTree.componentTreeId.renderContextType,threadId:o,onWillUnmount:this.onListItemWillUnmount,onLayout:this.onListItemLayout,preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior()})),i)}getListHeaderMode(){return!this.isSelectedCardPinned()&&this.shouldShowHalfPaneContextChangePlaceholder()?Ke.HalfPaneContextChangePlaceholder:Ke.None}renderListHeader(e){switch(this.getListHeaderMode()){case Ke.HalfPaneContextChangePlaceholder:return v.createElement(ne.a,{style:[this.renderStyle(N.k,e),{width:this.state.listViewWidthForHalfPane}]});case Ke.None:return}}getListFooterMode(){return this.isSelectedCardPinned()?Ge.None:this.shouldShowHalfPaneContextChangePlaceholder()?Ge.HalfPaneContextChangePlaceholder:this.shouldShowGhostComment()?this.state.ghostCommentLocation===qe.InList?Ge.FullPaneGhostCard:Ge.FullPaneGhostCardPlaceholder:Ge.None}shouldShowHalfPaneContextChangePlaceholder(){return this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane&&!(this.props.nextPopulatedContextDetails===O.a.OnlyCommentsInCurrent&&1===this.state.allRenderableItemThreads.length)&&this.props.nextPopulatedContextDetails!==O.a.NoComments}renderListFooter(e){const t=this.getListFooterMode();switch(t){case Ge.HalfPaneContextChangePlaceholder:return v.createElement(ne.a,{style:[this.renderStyle(N.k,e),{width:this.state.listViewWidthForHalfPane}]});case Ge.FullPaneGhostCard:return v.createElement(U.a.Provider,{value:this.state.allRenderableItemThreads.length},this.renderGhostCard());case Ge.FullPaneGhostCardPlaceholder:return this.renderGhostPlaceholder(e);case Ge.None:return;default:Object(u.m)(t)}}renderGhostCardOverlay(e){return v.createElement(ne.a,{style:this.renderStyle(N.m,e),key:"ghostOverlay"},this.renderGhostCard())}renderGhostPlaceholder(e){return v.createElement(ne.a,{style:this.renderStyle(se,e),key:"ghostPlaceholder"})}renderGhostCard(){const e=Ae.h(this.props.localizationAPI,this.props.nextPopulatedContextDetails);return v.createElement(be,{onClick:this.onGhostCommentClicked,onFocus:this.onGhostCommentFocused,ghostCommentString:e,accessibilityLabel:e,preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),key:"ghost"})}onScrollManagerChange(e){this.props.componentTree.componentTreeId.renderContextType!==F.a.HalfPane&&e&(Ue.ContentHeight|Ue.OuterHeight)&&(this.updateGhostCommentLocation(),setTimeout(this.updateContentSizeState));const t=this.scrollManager.getScrollOffset();P.w()&&this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane&&e&Ue.ContentWidth&&this.getThreadIndexFromScrollPosition(t)!==this.state.currThreadIndex&&this.scrollToCurrentIndex(!1,!1,!1),this.props.componentTree.componentTreeId.renderContextType!==F.a.HalfPane&&e&Ue.ScrollOffset&&(this.state.showListDividingLine&&!t||!this.state.showListDividingLine&&t)&&this.setState({showListDividingLine:t>0}),e&Ue.ScrollOffset&&((!P.w()||e&Ue.ProgrammaticScrollEnd)&&this.clearReadOnlyEditorFocusOnScroll_android(),this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane&&e&Ue.ProgrammaticScrollEnd&&(!P.w()||t>0)&&this.updateCurrentThreadIndex(this.getThreadIndexFromScrollPosition(t)))}clearReadOnlyEditorFocusOnScroll_android(){}updateGhostCommentLocation(){const e=this.scrollManager.getContentHeight();if(void 0===e)return;const t=e<this.scrollManager.getOuterHeight()?qe.BelowList:qe.InList;t!==this.state.ghostCommentLocation&&this.setState({ghostCommentLocation:t})}renderEmptyListContent(){if(this.state.allRenderableItemThreads.length)return;if(this.props.createdCommentLie)return;const e=Ae.g(this.props.localizationAPI,this.props.nextPopulatedContextDetails,this.props.componentTree.componentTreeId.renderContextType);return e?v.createElement(Oe,{message:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,containerWidth:this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane?this.state.listViewWidthForHalfPane:void 0}):void 0}onPaneViewLayout(e){this.setState({listViewWidthForHalfPane:e.nativeEvent.layout.width})}getThreadPositionText(){var e;if(this.props.commentThreadCountsContextDetails){let t,n;const r=null!==(e=this.state.currThreadIndex)&&void 0!==e?e:0;if(this.props.pendingCommentLoad)t=(this.isReadyToRender()?r:this.props.pendingCommentLoad.selectedThreadIndex)||0,n=this.props.pendingCommentLoad.numberOfThreads;else{if(!this.state.allRenderableItemThreads.length)return;t=r,n=this.state.allRenderableItemThreads.length}const o=this.props.commentThreadCountsContextDetails.numInPrevious+t+1,i=this.props.commentThreadCountsContextDetails.numInPrevious+n+this.props.commentThreadCountsContextDetails.numInNext;return this.props.localizationAPI.formatString(53,o.toString(),i.toString())}}getOuterSpacingForNavigationBar(){return Object(z.a)()===_.a.LargeDisplay?ie.f:ie.g}renderNavigationBarTextWrapper(e,t){return e?v.createElement(re.a,{style:this.renderStyle(N.x,t),textStylePolyester:"MediumStandard",variantFluent:"secondaryStandard"},e):v.createElement(ne.a,{style:this.renderStyle(N.w,t)})}renderNavigationBarForExistingComments(e){const t=this.getOuterSpacingForNavigationBar();return v.createElement(Ce.a,{leftChild:void 0,centerChild:v.createElement(ne.a,{style:N.v},v.createElement(B.a,{onClick:this.onPreviousThread,text:"",accessibilityLabel:this.props.localizationAPI.getString(52),isTabbable:!0,icon:10,style:ye.a,tooltipText:this.props.localizationAPI.getString(52),testID:Object(Ee.e)(xe.a.PreviousCommentButton),nodeId:Object(Ee.e)(xe.a.PreviousCommentButton),preventDefaultKeyDownBehavior:void 0}),this.renderNavigationBarTextWrapper(this.getThreadPositionText(),e),v.createElement(B.a,{onClick:this.onNextThread,accessibilityLabel:this.props.localizationAPI.getString(51),isTabbable:!0,icon:11,style:ye.a,tooltipText:this.props.localizationAPI.getString(51),testID:Object(Ee.e)(xe.a.NextCommentButton),nodeId:Object(Ee.e)(xe.a.NextCommentButton),text:"",preventDefaultKeyDownBehavior:void 0})),rightChild:v.createElement(B.a,{text:"",tooltipText:this.props.localizationAPI.getString(20),onClick:this.closePane,accessibilityLabel:this.props.localizationAPI.getString(20),isTabbable:!0,icon:9,style:[ye.a,this.renderStyle(N.q,e)],nodeId:Object(Ee.e)(xe.a.ClosePaneButton),preventDefaultKeyDownBehavior:void 0}),showShadow:!1,outerSpacing:t})}renderNavigationBarForNewComment(e){const t=this.props.localizationAPI.getString(205),n=this.getOuterSpacingForNavigationBar();return v.createElement(Ce.a,{leftChild:void 0,centerChild:v.createElement(ne.a,{style:N.v},this.renderNavigationBarTextWrapper(t,e)),rightChild:void 0,showShadow:!1,outerSpacing:n})}getThreadIndexFromScrollPosition(e){this.state.allRenderableItemThreads.length;return T.I18nManager.isRTL,Math.round(e/this.state.listViewWidthForHalfPane)-(this.getListHeaderMode()===Ke.HalfPaneContextChangePlaceholder?1:0)}onUserScrollEnd(){this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane&&this.updateCurrentThreadIndex(this.getThreadIndexFromScrollPosition(this.scrollManager.getScrollOffset()))}updateCurrentThreadIndex(e){const t=this.state.allRenderableItemThreads.length,n=0===t?1:t,r=Object(f.i)().createActivityObject("CommentSwipe",this.props.telemetryVisitor,f.a.None,f.b.NecessaryServiceDataEvent);return-1===e?(r.addDataField("SwipeDirection",g.d.Previous,f.d.SystemMetadata),r.addDataField("SwipeAcrossContext",!0,f.d.SystemMetadata),this.props.selectionManager.selectAcrossContexts(g.d.Previous,this.props.componentTree.componentTreeId.renderContextType)):e===n?(r.addDataField("SwipeDirection",g.d.Next,f.d.SystemMetadata),r.addDataField("SwipeAcrossContext",!0,f.d.SystemMetadata),this.props.selectionManager.selectAcrossContexts(g.d.Next,this.props.componentTree.componentTreeId.renderContextType)):(e!==this.state.currThreadIndex&&e<t&&(void 0!==this.state.currThreadIndex&&(e<this.state.currThreadIndex?r.addDataField("SwipeDirection",g.d.Previous,f.d.SystemMetadata):r.addDataField("SwipeDirection",g.d.Next,f.d.SystemMetadata),r.addDataField("SwipeAcrossContext",!1,f.d.SystemMetadata)),this.props.selectComment(this.props.componentTree,{renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:590206686,telemetryVisitor:this.props.telemetryVisitor},{selectedCard:W.i(this.state.allRenderableItemThreads[e]).commentId,selectType:k.b.ExpandCard,source:R.a.SharedComments},!1).catch(Object(E.a)(590104654))),void r.successTag(595944269))}onNextThread(){Object(f.i)().createActivityObject("NextButtonPressed",this.props.telemetryVisitor,f.a.OnSuccess,f.b.NecessaryServiceDataEvent).successTag(595944270),this.props.selectionManager.selectNextOrPreviousThread({direction:g.d.Next,source:R.a.SharedComments,expandCard:!0,iterableContentTypes:void 0},void 0,this.props.componentTree.componentTreeId.renderContextType)}onPreviousThread(){Object(f.i)().createActivityObject("PreviousButtonPressed",this.props.telemetryVisitor,f.a.OnSuccess,f.b.NecessaryServiceDataEvent).successTag(595944271),this.props.selectionManager.selectNextOrPreviousThread({direction:g.d.Previous,source:R.a.SharedComments,expandCard:!0,iterableContentTypes:void 0},void 0,this.props.componentTree.componentTreeId.renderContextType)}scrollToCurrentIndex(e,t,n){let r;if(!P.w()&&this.isSelectedCardPinned())r=0;else if(void 0!==this.state.currThreadIndex)r=this.state.currThreadIndex;else{if(!this.props.topVisibleThread)return;r=this.props.topVisibleThread.index}r>=this.state.allRenderableItemThreads.length?Object(f.i)().assertConditionTag(!1,"Current index out of bounds",595961817):this.scrollManager.scrollToIndex(r,e,t,n)}scrollToEmptyView(){this.scrollManager.scrollToIndex(0,!1,!0,!1)}handleScrollToCommand(e){const t=this.scrollManager.getListRef();if(!t||this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane)return;const n=Object(T.findNodeHandle)(t);"number"==typeof n&&e.target.measureLayout(n,(t,n,r,o)=>{this.scrollManager.scrollToOffsets(!1,!0,n+e.offsetY,n+e.offsetY+e.height)},()=>{})}getFullPaneListItemOffset(e){this.commentThreadHeights.size>=this.state.allRenderableItemThreads.length+100&&this.assertStaleHeightData();const t=N.e;return e<=0?0:this.state.commentThreadHeightSums.getSum(e-1)+e*t}getFullPaneListItemHeight(e,t,n){const r=n?N.e:0,o=W.i(e).commentId;let i=this.commentThreadHeights.get(o);if(void 0!==i)return i+r;const a=t.cardViewStates[o],s=a&&Object(x.N)(a.loadState)?a.loadState.initialItemCount:e.length;return i=Object($e.c)({itemCount:s,readOnly:t.readOnly,isTask:!!this.props.tasks[o]}),i+r}setFullPaneListItemHeight(e,t,n){this.commentThreadHeights.set(t,n),this.props.componentTree.componentTreeId.renderContextType!==F.a.HalfPane&&(this.state.commentThreadHeightSums.set(n,e),this.scrollManager.onItemLayoutChange())}getItemLayout(e,t,n){if(!e)return Object(f.i)().assertConditionTag(!1,"Trying to get layout of non-existent element.",577066526),{index:t,length:0,offset:this.getFullPaneListItemOffset(t)};if(this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane){let e;T.I18nManager.isRTL;e=(t+(this.getListHeaderMode()===Ke.HalfPaneContextChangePlaceholder?1:0))*this.state.listViewWidthForHalfPane;return{length:this.state.listViewWidthForHalfPane,offset:e,index:t}}return{length:this.getFullPaneListItemHeight(e[t],this.props,n),offset:this.getFullPaneListItemOffset(t),index:t}}getItemLayoutForScrollManager(e){if(e===this.state.allRenderableItemThreads.length&&0===this.state.allRenderableItemThreads.length&&this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane){let t=0;const n=T.I18nManager.isRTL&&!1;return(n&&this.getListFooterMode()===Ge.HalfPaneContextChangePlaceholder||!n&&this.getListHeaderMode()===Ke.HalfPaneContextChangePlaceholder)&&(t=this.state.listViewWidthForHalfPane),{length:this.state.listViewWidthForHalfPane,offset:t,index:e}}if(!(e>=this.state.allRenderableItemThreads.length))return this.getItemLayout(this.state.allRenderableItemThreads,e,!1)}isSelectedCardPinned(e=this.props){return e.componentTree.componentTreeId.renderContextType===F.a.HalfPane&&e.selectedComment&&Object(D.l)(e.draftState)}renderPaneHeader(){return v.createElement(ve,{closeLabel:this.props.localizationAPI.getString(20),onClose:this.closePane,paneTitle:this.props.localizationAPI.getString(18)})}isNewCommentButtonDisabled(){return!this.props.modelCapabilities.newThread}renderNewCommentButton(e,t){const n=[this.renderStyle(N.r,e)];return this.state.isContentLargerThanList&&n.push(this.renderStyle(N.s,e)),v.createElement(B.a,{onClick:this.startNewCommentSession,accessibilityLabel:this.props.localizationAPI.getString(92),tooltipText:this.props.localizationAPI.getString(92),disabled:t,isTabbable:!0,icon:12,text:this.props.localizationAPI.getString(91),style:n,testID:Object(Ee.e)(xe.a.NewCommentButton),nodeId:Object(Ee.e)(xe.a.NewCommentButton),preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior()})}getVirtualizationParameters(){const e=Object($e.c)({itemCount:1,readOnly:this.props.readOnly,isTask:!1}),t=this.scrollManager.getOuterHeight(),n=t&&Math.ceil(t/e)||4,r=Object(z.e)("win32")?2*n+1:3,o=Object(z.e)("win32")?n+1:void 0;return{maxToRenderPerBatch:n,windowSize:r,updateCellsBatchingPeriod:150,viewabilityConfig:this.ViewabilityConfig,initialNumToRender:o}}getPinnedCardIndex_deprecated(){return this.isSelectedCardPinned()?this.state.currThreadIndex:void 0}getListProps(e){const t=this.getPinnedCardIndex_deprecated(),n=void 0===t||P.w()?this.state.allRenderableItemThreads:[this.state.allRenderableItemThreads[t]],r=P.i()?{CellRendererComponent:we.a}:{};return Object.assign(Object.assign(Object.assign({data:n,directionalLockEnabled:!0,extraData:[this.props.cardViewStates,this.props.postViewStates,this.props.selectedComment],getItemLayout:this.getItemLayoutForFlatlist,horizontal:this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane,keyboardShouldPersistTaps:"always",keyExtractor:this.getListItemKey,ListEmptyComponent:this.renderEmptyListContent(),ListFooterComponent:this.renderListFooter(e),ListHeaderComponent:this.renderListHeader(e),pagingEnabled:this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane,renderItem:this.renderListItem,removeClippedSubviews:this.shouldRemoveClippedSubviews(),contentContainerStyle:this.state.isContentLargerThanList?this.renderStyle(N.t,e):void 0,scrollEnabled:!this.isSelectedCardPinned()&&(this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane||this.state.allRenderableItemThreads.length>0),showsHorizontalScrollIndicator:!1,testID:ee.m(),accessible:!1,style:N.n},this.scrollManager.getScrollProps()),this.getVirtualizationParameters()),r)}scrollToThreadById(e){const t=this.state.allRenderableItemThreads.findIndex(t=>W.i(t).commentId===e);return t<0?(Object(f.i)().assertConditionTag(!1,"Thread not found "+e,589054428),!1):(this.scrollManager.scrollToIndex(t,!1,!0,!0),!0)}canCardDelete(e){return!!W.b(this.props.dataItems,e)||(Object(f.i)().assertConditionTag(!1,"Comment not found",595961857),!1)}shouldCheckForLowFidelityOnCardDelete(){return!0}shouldRemoveClippedSubviews(){}invokeModalDialog(e,t,n){return new Promise(r=>{const o=Ae.d(this.props.localizationAPI,e),i={title:o.confirmButton,style:y.AlertButtonStyle.destructive,onClick:()=>r(t())},a={title:o.cancelButton,style:y.AlertButtonStyle.cancel,onClick:()=>r(n())};y.Alert.alert(o.title,o.body,i,a)})}isTabIntoCard(e){return e.nativeEvent.key===C.c.Tab&&0!==this.props.dataItems.length&&(this.props.componentTree.isFocusOn({componentType:xe.a.NewCommentButton})?!e.nativeEvent.shiftKey||!this.shouldShowGhostComment():e.nativeEvent.shiftKey&&this.props.componentTree.isFocusOn({componentType:xe.a.GhostCard}))}static shouldShowLoadingUI(e){const t=!e.length;return!e.isReadyToRender||e.renderContextType===F.a.HalfPane&&(!e.selectedComment&&!t||!e.listViewWidthForHalfPane)||e.initializationStatus!==j.a.Initialized||!!e.createdCommentLie&&t}getResourceId(){var e,t;return null!==(t=null===(e=this.props.resource)||void 0===e?void 0:e.id)&&void 0!==t?t:ee.o()}getContentExtraPaddingLeft(){return this.state.paneContentSafeAreaInsets.left}getContentExtraPaddingRight(){return this.state.paneContentSafeAreaInsets.right}getAvailableScreenHeight(){return this.state.availableScreenHeight}getMaxDraftHeight(){return this.props.componentTree.componentTreeId.renderContextType===F.a.HalfPane?this.state.maxDraftHeight:void 0}getCommentCardStyle(){return N.g}getContentBackgroundColor(e,t){return P.i()?void 0:e&&!t?"CardReplyBackground":"CardBackground"}renderInner(){return v.createElement(_e.a.Provider,{value:this.scrollListener},Object(V.a)(this.renderWithTheme,G.a))}}function Qe(){const e=i.x();return t=>{const n=i.f(t),r=s.c(t),l={cardViewStates:i.b(t),dataItems:e(t),tasks:c.b(t),personaIconPropertiesMap:i.p(t),createdCommentLie:i.g(t,!0,r.componentTreeId.renderContextType),nextPopulatedContextDetails:n.nextPopulatedContextDetails,pendingCommentLoad:i.o(t),postViewStates:i.q(t),historyRecordViewStates:c.a(t),componentTree:r,commentThreadCountsContextDetails:n.commentThreadCounts,selectedThreadIdBeforeCommentSession:i.s(t),readOnly:i.m(t),highlightedCommentId:i.l(t),lastContextChangeIncrement:n.lastContextChangeIncrement,initializationStatus:t.paneState.initializationStatus,draftState:i.h(t),modelCapabilities:i.n(t),selectedComment:i.r(t),expandedComments:i.j(t),suggestionsDetails:i.u(t),foldableLayoutState:s.d(t).foldableLayoutState,displayConfigurationState:t.paneState.viewContainerDisplayConfiguration,currentFilter:a.b(t)},u=i.v(t);if(u){const e=i.e(t),n=Object(d.f)(e)?e.findIndex(e=>e===u):e.filter(o.a).findIndex(e=>e.commentId===u);n>-1&&(l.topVisibleThread={cardId:u,index:n})}return l}}const Xe=Object(r.connect)(Qe,l.b,void 0,{forwardRef:!0})(Je);t.b=Xe},function(e,t,n){"use strict";var r=n(189),o=n(301);var i=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},a=n(283);var s=function(e,t,n,r,s,c){var d=1&n,l=e.length,u=t.length;if(l!=u&&!(d&&u>l))return!1;var p=c.get(e),h=c.get(t);if(p&&h)return p==t&&h==e;var f=-1,m=!0,g=2&n?new o.a:void 0;for(c.set(e,t),c.set(t,e);++f<l;){var b=e[f],C=t[f];if(r)var y=d?r(C,b,f,t,e,c):r(b,C,f,e,t,c);if(void 0!==y){if(y)continue;m=!1;break}if(g){if(!i(t,(function(e,t){if(!Object(a.a)(g,t)&&(b===e||s(b,e,n,r,c)))return g.push(t)}))){m=!1;break}}else if(b!==C&&!s(b,C,n,r,c)){m=!1;break}}return c.delete(e),c.delete(t),m},c=n(117),d=n(228),l=n(149);var u=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n},p=n(210),h=c.a?c.a.prototype:void 0,f=h?h.valueOf:void 0;var m=function(e,t,n,r,o,i,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!i(new d.a(e),new d.a(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Object(l.a)(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var c=u;case"[object Set]":var h=1&r;if(c||(c=p.a),e.size!=t.size&&!h)return!1;var m=a.get(e);if(m)return m==t;r|=2,a.set(e,t);var g=s(c(e),c(t),r,o,i,a);return a.delete(e),g;case"[object Symbol]":if(f)return f.call(e)==f.call(t)}return!1},g=n(284),b=n(305),C=n(184);var y=function(e){return Object(g.a)(e,C.a,b.a)},v=Object.prototype.hasOwnProperty;var T=function(e,t,n,r,o,i){var a=1&n,s=y(e),c=s.length;if(c!=y(t).length&&!a)return!1;for(var d=c;d--;){var l=s[d];if(!(a?l in t:v.call(t,l)))return!1}var u=i.get(e),p=i.get(t);if(u&&p)return u==t&&p==e;var h=!0;i.set(e,t),i.set(t,e);for(var f=a;++d<c;){var m=e[l=s[d]],g=t[l];if(r)var b=a?r(g,m,l,t,e,i):r(m,g,l,e,t,i);if(!(void 0===b?m===g||o(m,g,n,r,i):b)){h=!1;break}f||(f="constructor"==l)}if(h&&!f){var C=e.constructor,T=t.constructor;C==T||!("constructor"in e)||!("constructor"in t)||"function"==typeof C&&C instanceof C&&"function"==typeof T&&T instanceof T||(h=!1)}return i.delete(e),i.delete(t),h},S=n(123),I=n(94),O=Object(S.a)(I.a,"DataView"),E=n(186),P=Object(S.a)(I.a,"Promise"),k=n(194),R=Object(S.a)(I.a,"WeakMap"),x=n(132),D=n(168),w=Object(D.a)(O),A=Object(D.a)(E.a),j=Object(D.a)(P),_=Object(D.a)(k.a),F=Object(D.a)(R),M=x.a;(O&&"[object DataView]"!=M(new O(new ArrayBuffer(1)))||E.a&&"[object Map]"!=M(new E.a)||P&&"[object Promise]"!=M(P.resolve())||k.a&&"[object Set]"!=M(new k.a)||R&&"[object WeakMap]"!=M(new R))&&(M=function(e){var t=Object(x.a)(e),n="[object Object]"==t?e.constructor:void 0,r=n?Object(D.a)(n):"";if(r)switch(r){case w:return"[object DataView]";case A:return"[object Map]";case j:return"[object Promise]";case _:return"[object Set]";case F:return"[object WeakMap]"}return t});var N=M,L=n(75),B=n(200),H=n(226),U=Object.prototype.hasOwnProperty;var V=function(e,t,n,o,i,a){var c=Object(L.a)(e),d=Object(L.a)(t),l=c?"[object Array]":N(e),u=d?"[object Array]":N(t),p="[object Object]"==(l="[object Arguments]"==l?"[object Object]":l),h="[object Object]"==(u="[object Arguments]"==u?"[object Object]":u),f=l==u;if(f&&Object(B.a)(e)){if(!Object(B.a)(t))return!1;c=!0,p=!1}if(f&&!p)return a||(a=new r.a),c||Object(H.a)(e)?s(e,t,n,o,i,a):m(e,t,l,n,o,i,a);if(!(1&n)){var g=p&&U.call(e,"__wrapped__"),b=h&&U.call(t,"__wrapped__");if(g||b){var C=g?e.value():e,y=b?t.value():t;return a||(a=new r.a),i(C,y,n,o,a)}}return!!f&&(a||(a=new r.a),T(e,t,n,o,i,a))},W=n(116);t.a=function e(t,n,r,o,i){return t===n||(null==t||null==n||!Object(W.a)(t)&&!Object(W.a)(n)?t!=t&&n!=n:V(t,n,r,o,e,i))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(196),o=n(124);function i(e,t,n,r,i){var a,s=n((function(){return function(e,t,n){return e?o.b.apply(void 0,e.map((function(e){return"string"==typeof e?n&&n(t,e)||void 0:"function"==typeof e?e(t):e}))):void 0}(e,t,i)}),[t]),c=s[0],d=s[1],l=Object(o.a)(c,r);return l.length>0&&(a=d((function(){return Object(o.d)(c,r)}),l),c=a[0],d=a[1]),{settings:c,getMemoValue:d}}var a=n(110),s=n(245),c=n(158),d=n(162),l=n(135);function u(e){var t=e&&typeof e;return("object"===t||"function"===t)&&e.__composable||void 0}function p(e,t){return Object(a.b)(e,t)}function h(e){var t=e.styles,n=e.slots;e.resolvedTokens=Object(s.a)(t,function(e){var t={};return Object.keys(e).forEach((function(n){var r=e[n],o=u("object"!=typeof r?r:r.slotType);t[n]=o&&o.resolvedTokens&&o.resolvedTokens.tokenKeys||void 0})),function(e,n){return t[e]&&t[e].hasOwnProperty(n)}}(n));var r=Object(l.a)(e);return function(t,n){return function(e,t,n,r){var o=Object(c.b)()||d.c;r=r||e;var l=i(t.settings,o,n,r,p),u=l.settings,h=l.getMemoValue;return Object(a.d)(Object(s.b)(e,o,u,t.resolvedTokens,h))}(t,e,r,n)}}var f=n(125);function m(e,t){var n=function(e,t){if(t){var n={settings:[].concat(t.settings||[],e.settings||[]).filter((function(e){return e}))};return Object(f.a)(t,e,n)}return e}(e,t&&u(t));n.useStyling=h(n);var o=Object(r.a)(n);return o.displayName=n.displayName,Object.assign(o,n.statics),o.customize=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return m({settings:e},o)},o.compose=function(e){return m(e,o)},o}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));n(8);var r=n(0),o=n(21),i=n(61),a=n(279),s=n(26);s.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::Localization::LocalizedString":{id:"$number",str:"$string"}});const c={LocalizationConstants:s.RekaServiceRegistry.getNativeService(["Mso::Document::Comments::Localization::LocalizationConstants",{localizedStrings:["Constant",["$array","Mso::Document::Comments::Localization::LocalizedString"]],localeInfo:["Constant","Mso::Document::Comments::Localization::LocalizationDetails"]}])};let d=void 0;function l(){if(!d)throw new o.a(i.h,589103745,-2130957552);return d}function u(){if(Object(r.i)().assertConditionTag(void 0===d,"LocalizationAPI has already been initialized",589103746),void 0===d){const e=c.LocalizationConstants;d=new a.a(e)}return d}},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return p}));var r,o=n(1),i=n(3);function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.apply(void 0,Object(i.g)(Object(i.g)([],n,!1),t,!1))}),t)}function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){return e.apply(void 0,t)}),t)}function c(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(r)throw new Error("Recursive calls of hooks is not supported!");r=e;var o=s.apply(void 0,t);return r=void 0,o}}c(o.useMemo);var d,l=c(o.useEffect),u=c(o.useLayoutEffect),p=(d=o.useCallback,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(r)throw new Error("Recursive calls of hooks is not supported!");r=d;var n=a.apply(void 0,e);return r=void 0,n})},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var r=n(1),o=n(105),i=n(90);class a extends r.Component{render(){return r.createElement(i.a,Object.assign({},this.props,{nodeId:"safe-area-observer",isTabbable:!1,focusable:!1}))}}function s(e){const t=t=>t.shouldRenderView?r.createElement(e,Object.assign({},t)):r.Children.only(t.children);return t.displayName="Conditional"+(e.displayName||e.name),t}const c=s(o.a),d=s(a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(79),o=n(1),i=n(2),a=n(176),s=n(54),c=n(42),d=n(74),l=n(34),u=n(12);const p=Object(u.e)({marginLeft:5,marginBottom:3}),h=o.memo((function(e){return Object(c.a)(t=>{if(e.draftWarningState){const n=Object(d.b)(t),r=s.e(e.localizationAPI,e.draftWarningState.type);return o.createElement(l.a,{style:e.target===a.a.Card?p:void 0,textStylePolyester:"Error",variantFluent:"secondaryStandard",colorFluent:n.warningTextColor,testID:e.id},r)}return i.k()&&e.defaultToPostingTip?o.createElement(l.a,{variantFluent:"secondaryStandard",colorFluent:"subText",key:"posting-tip",accessible:!0,style:p},e.localizationAPI.getString(233)):null},r.a)}))},function(e,t,n){"use strict";var r=n(132),o=n(209),i=n(116),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1;var s=function(e){return Object(i.a)(e)&&Object(o.a)(e.length)&&!!a[Object(r.a)(e)]};var c=function(e){return function(t){return e(t)}},d=n(319),l=d.a&&d.a.isTypedArray,u=l?c(l):s;t.a=u},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(79),o=n(1),i=n(413),a=n(2),s=n(74);const c=Object(i.a)(()=>{const e=Object(r.c)(a.o()?"TaskPaneCard_FluentSV":"TaskPaneCard_VisualRefresh");return e.setTheme(s.a,"comments"),e});var d=n(38);class l extends o.Component{constructor(e){super(e),this.updateState=this.updateState.bind(this),e.api.registerForThemeChange(this.updateState),this.state=e.api.getTheme()}componentWillUnmount(){this.props.api.unregisterForThemeChange(this.updateState)}updateState(){this.setState(this.props.api.getTheme())}render(){return o.createElement(r.b,{registry:c(),theme:"comments"},o.createElement(d.a.Provider,{value:this.state},this.props.children))}}},function(e,t,n){"use strict";var r=n(94).a.Uint8Array;t.a=r},function(e,t,n){"use strict";function r(e){return"Df"===e?"Df":"Msit"===e?"Msit":"Prod"===e?"Prod":"Blackforest"===e?"Blackforest":"GccModerate"===e?"GccModerate":"GccHigh"===e?"GccHigh":"DoD"===e?"DoD":"Gallatin"===e?"Gallatin":"AG08"===e?"AG08":"AG09"===e?"AG09":"Unknown"}n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var o="LokiGetAuthToken",i="LokiGetAuthTokenFailed",a="LokiAuthTokenReceivedAfterTimeout"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12);const o=Object(r.e)({alignSelf:"stretch",justifyContent:"center",marginLeft:-17,paddingLeft:17,marginRight:-17,paddingRight:17,zIndex:1})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(68),o=n(2),i=n(7);function a(e,t){if(!o.m())return!1;const n=Object(i.K)(e);return void 0!==n&&n.renderContextType!==t&&n.commentDraft.sessionConfiguration.sessionType===r.a}},function(e,t,n){"use strict";n.d(t,"b",(function(){return K}));var r=n(8),o=n(428),i=function(){function e(){this.valueStruct={hasValue:!1},this.callbacks=[]}return e.prototype.set=function(e){this.valueStruct={value:e,hasValue:!0},this.callbacks.forEach((function(t){t(e)})),this.callbacks=[]},e.prototype.getValue=function(e){var t=this;if(this.valueStruct.hasValue)try{return Promise.resolve(e(this.valueStruct.value))}catch(e){return Promise.reject(e)}return new Promise((function(n,r){t.callbacks.push((function(t){try{n(e(t))}catch(e){r(e)}}))}))},e}(),a=n(413),s=n(425),c=n(0),d=n(244),l=n(52),u=n(1),p=n(45),h=n(78),f=n(243),m=n(46),g=n(69),b=n(49),C=n(25),y=n(2),v=n(295),T=n(13),S=n(22),I=n(141),O=n(173),E=n(7),P=n(19),k=n(113),R=n(299),x=n(107),D=n(99),w=n(80),A=n(6),j=n(131),_=n(199),F=n(16),M=n(241),N=n(231),L=n(146),B=n(15),H=n(128),U=n(66),V=n(216),W=(n(72),n(24)),z=n(155);function K(e){if(e.topVisibleThread&&e.componentTree.componentTreeId.renderContextType!==A.a.HalfPane&&!e.selectedComment)return e.topVisibleThread.cardId}class G extends u.Component{constructor(e){super(e),this.memoGetActionBarItems=Object(o.a)(z.a,20,()=>{Object(c.i)().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875362)}),this.memoGetCardContextualMenuItems=Object(o.a)(z.c,20,()=>{Object(c.i)().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875363)}),this.initialAtMentionCapability=new i,this.onCommentInterruptableCommand=e=>{switch(e.type){case"DiscardDraft":{let t;if(e.mode===f.a.Dialog){const e=Object(M.a)(this.props.draftState,this.props.componentTree.componentTreeId.renderContextType);t=this.getOnWillDiscardCallback(e);const n=Object(H.b)(!0,this.props.componentTree.componentTreeId.renderContextType,this.props.draftState,this.props.selectedComment,this.props.selectedThreadIdBeforeCommentSession);return this.props.discardDraftAsync({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:587605836},S.a.Canvas,n,t)}return Promise.resolve(m.a.Unhandled)}case"BringThreadIntoView":return this.props.componentTree.componentTreeId.renderContextType!==A.a.FullPane?Promise.resolve(m.a.Unhandled):this.scrollToThreadById(e.threadId)?Promise.resolve(m.a.Handled):Promise.resolve(m.a.Failed);default:return Object(c.i)().assertConditionTag(!1,"Unknown type of CommentInterruptableCommand",593826210),Promise.resolve(m.a.Unhandled)}},this.onCardPost=(e,t)=>{const n=e.getId(),r=this.props.draftState.cardIdToDraftIdMap[n],o=this.props.draftState.drafts[r],i=Object(E.G)(this.props.draftState,!0,this.props.componentTree.componentTreeId.renderContextType)===e.getId()?{type:"CREATE"}:{type:"REPLY",parentId:n};F.c({trackback:593622435,commentCardRef:e,draftState:this.props.draftState,areMentionsEnabled:this.props.modelCapabilities.atMention===p.b.Enabled,session:i,componentTree:this.props.componentTree,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,commitSource:t,selectedTaskAssignee_deprecated:o&&o.selectedTaskAssignee}).catch(Object(C.a)(593622464))},this.cardOnCollapseCallback=e=>{F.b({trackback:562918286,commentCardRef:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.cardOnSelectCallback=e=>{F.n({trackback:571281794,commentCardRef:e,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,componentTree:this.props.componentTree,options:{selectActionType:T.b.SelectCard}})},this.cardOnSelectExpandCallback=(e,t,n)=>{const r=Object(_.a)(e.getId(),this.props.componentTree.componentTreeId.renderContextType,this.props.draftState);F.n({trackback:571281793,commentCardRef:e,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,componentTree:this.props.componentTree,options:{selectActionType:T.b.ExpandCard,relativeDraftingState:r,draftState:this.props.draftState,shouldFocusAfter:n,selectRootPost:t}})},this.cardOnFocusCallback=e=>{F.i({trackback:571340119,commentCardRef:e,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,componentTree:this.props.componentTree,options:{selectActionType:T.b.Polite},focusManager:this.props.focusManager,isDraftThread:Object(E.G)(this.props.draftState,!0,this.props.componentTree.componentTreeId.renderContextType)===e.getId()})},this.cardOnBeginReplyCallback=e=>{F.a({trackback:593826249,threadId:e.getId(),renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.cardOnResolveThread=e=>{F.m({componentTree:this.props.componentTree,focusManager:this.props.focusManager,trackback:593826250,id:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,isTask:!!this.props.tasks[e]})},this.cardOnReopenThread=e=>{F.l({trackback:593826251,id:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,isTask:!!this.props.tasks[e]})},this.cardOnDelete=e=>{F.d({trackback:593826252,id:e,data:this.props.dataItems,selectedComment:this.props.selectedComment,componentTree:this.props.componentTree,invokeModalDialog:this.invokeModalDialog,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,focusManager:this.props.focusManager,isTask:!!this.props.tasks[e],threadIndex:W.g(this.state.allRenderableItemThreads,e),shouldCheckForLowFidelity:this.shouldCheckForLowFidelityOnCardDelete()})},this.cardOnDraftingInputSizeChange=(e,t)=>{const n=Object(E.G)(this.props.draftState,!0,this.props.componentTree.componentTreeId.renderContextType);F.f({trackback:593826253,focusManager:this.props.focusManager,componentTree:this.props.componentTree,cardId:e.getId(),isCardLie:e.getId()===n,newHeight:t,renderContextType:this.props.componentTree.componentTreeId.renderContextType,selectedComment:this.props.selectedComment,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.cardOnDraftEmptinessChanged=(e,t)=>{F.q({trackback:592213848,contentId:e.getId(),isEmpty:t,renderContextType:this.props.componentTree.componentTreeId.renderContextType,draftIdMap:this.props.draftState.cardIdToDraftIdMap,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.cardOnEditorFocusLost=e=>{F.g({trackback:592065735,id:e.getId(),draftState:this.props.draftState,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.cardOnSaveDraft=(e,t)=>{F.x({trackback:593826255,id:e,editor:t,renderContextType:this.props.componentTree.componentTreeId.renderContextType,draftIdMap:this.props.draftState.cardIdToDraftIdMap,draftMap:this.props.draftState.drafts,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.onCardCancel=e=>{const t=Object(H.b)(!0,this.props.componentTree.componentTreeId.renderContextType,this.props.draftState,this.props.selectedComment,this.props.selectedThreadIdBeforeCommentSession);F.e({trackback:592840780,showDiscardDialog:!1,invokeModalDialog:this.invokeModalDialog,componentTree:this.props.componentTree,dispatchProps:this.props,closeOnDiscard:t,cardId:e.getId(),draftState:this.props.draftState,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,focusManager:this.props.focusManager,lieIndex:W.g(this.state.allRenderableItemThreads,e.getId())})},this.onTaskTopperCheckboxPressed=e=>{if(!y.b())return;const t=this.props.tasks[e];t&&F.o({componentTree:this.props.componentTree,focusManager:this.props.focusManager,trackback:593826258,id:t.commentId,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI})},this.cardOnHighlight=(e,t)=>{F.j({trackback:593826259,commentCardRef:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,shouldHighlightCard:t})},this.onPostDelete=e=>{F.D({trackback:593826312,id:e,data:this.props.dataItems,selectedComment:this.props.selectedComment,renderContextType:this.props.componentTree.componentTreeId.renderContextType,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI})},this.onPostEdit=e=>{F.E({trackback:593826316,id:e,data:this.props.dataItems,selectedComment:this.props.selectedComment,renderContextType:this.props.componentTree.componentTreeId.renderContextType,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.onPostReactionUpdated=(e,t,n)=>{F.w(587994051,e,t,this.props.componentTree.componentTreeId.renderContextType,this.props,this.props.telemetryVisitor,n)},this.onPostCommit=(e,t)=>{F.C({trackback:593826260,id:e.getId(),data:this.props.dataItems,draftState:this.props.draftState,contentPromise:e.getContentsAsync(),atMentionsEnabled:this.props.modelCapabilities.atMention===p.b.Enabled,componentTree:this.props.componentTree,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,commitSource:t}).catch(Object(C.a)(593826261))},this.onPostCancel=e=>{const t=Object(H.b)(!0,this.props.componentTree.componentTreeId.renderContextType,this.props.draftState,this.props.selectedComment,this.props.selectedThreadIdBeforeCommentSession);F.z({trackback:593826263,commentId:e.getId(),setContents:e.setContents.bind(e),data:this.props.dataItems,draftState:this.props.draftState,shouldClosePaneAfterDiscardDraft:t,onWillDiscardCallback:void 0,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI})},this.onPostDraftEmptinessChanged=(e,t)=>{F.q({trackback:592041678,contentId:e.getId(),isEmpty:t,renderContextType:this.props.componentTree.componentTreeId.renderContextType,draftIdMap:this.props.draftState.postIdToDraftIdMap,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.onPostSaveDraft=(e,t)=>{F.x({trackback:592720405,id:e,editor:t,renderContextType:this.props.componentTree.componentTreeId.renderContextType,draftIdMap:this.props.draftState.postIdToDraftIdMap,draftMap:this.props.draftState.drafts,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.onPresentLinkToComment=e=>{F.v(578852484,e,this.props.componentTree.componentTreeId.renderContextType,this.props,this.props.telemetryVisitor)},this.onRenderableItemSelect=(e,t)=>{const n=this.getRenderableItemFromRef(e);n?F.J({trackback:593826266,renderableItem:n,selectedComment:this.props.selectedComment,cardCollapsedState:Object(j.a)(W.j(n),this.props.expandedComments,this.props.componentTree.componentTreeId.renderContextType),dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,componentTree:this.props.componentTree,shouldFocusAfter:t,draftState_deprecated:this.props.draftState}).catch(Object(C.a)(590123737)):Object(c.i)().assertConditionTag(!1,"Selection coming from an unknown post?",593826265)},this.onPostCollapseParent=e=>{const t=this.getRenderableItemFromRef(e);t?F.B(589940445,t,this.props,this.props.telemetryVisitor,this.props.componentTree):Object(c.i)().assertConditionTag(!1,"Collapse from an unknown post?",589940444)},this.onPostFocusParent=e=>{const t=this.getRenderableItemFromRef(e);t?F.H(t,this.props.componentTree,this.props.focusManager,this.props.draftState):Object(c.i)().assertConditionTag(!1,"Focus parent from unknown post?",545867681)},this.getContentFilterProps=()=>{var e;return Object(c.i)().assertConditionTag(!!this.props.currentFilter,"Filter should be set if we are getting props for ContentFilter",527958876),{currentFilter:null!==(e=this.props.currentFilter)&&void 0!==e?e:{mentionsToCurrentUser:!1},createOrUpdateFilter:this.props.createOrUpdateFilter,preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),personaIconPropertiesMap:this.props.personaIconPropertiesMap,localizationAPI:this.props.localizationAPI}},this.getThreadedRenderableIds=Object(a.b)(e=>e.map(e=>e.map(W.f)),()=>[this.state.allRenderableItemThreads]),this.getThreadPostOrHistoryRecordStates=(()=>{const e=(t=[],n={},r=[],function(e,o,i){if(void 0===i&&(i=function(e,t,n){return n[t]}),e===t&&o===n)return r;var a=e.map((function(e,a){return e===t[a]&&e.every((function(t){return i(e[0],t,o)===i(e[0],t,n)}))?r[a]:e.map((function(t){return i(e[0],t,o)}))}));return t=e,n=o,r=a,a});var t,n,r;return()=>e(this.getThreadedRenderableIds(),Object.assign(Object.assign({},this.props.postViewStates),this.props.historyRecordViewStates))})(),this.getListItemKey=e=>{const t=W.i(e).commentId,n=this.props.cardViewStates[t];return n&&n.alternateId||t},this.getHostableComponentInstanceId=(e,t,n)=>"cardInPane_"+Object(B.j)({id:e,renderContextType:t},n),this.onSelectedTaskAssigneeUpdated=e=>{y.b()?F.y({trackback:593826304,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,selectedAssignee:e}):Object(c.i)().assertConditionTag(!1,"Selected Task Assignee Updated action type is not supported",593826305)},this.getRenderableItemActionBarItems=(...e)=>{if(!this.renderableItemActionBarItems||void 0===this.memoGetActionBarItems)throw new r.d("Function should not be called when DeleteRestricted gate is off.",557601691);return this.memoGetActionBarItems(this.renderableItemActionBarItems,...e)},this.getCardContextualMenuItems=(...e)=>{if(!this.cardContextMenuItems||void 0===this.memoGetCardContextualMenuItems)throw new r.d("Function should not be called when DeleteRestricted gate is off.",557601692);return this.memoGetCardContextualMenuItems(this.cardContextMenuItems,...e)},this.onCardMounted=e=>{F.k({cardProps:e,componentTree:this.props.componentTree,focusManager:this.props.focusManager})},this.onCardEditorMounted=e=>{F.h({cardId:e,componentTree:this.props.componentTree,focusManager:this.props.focusManager})},this.onPostMounted=e=>{F.I({postId:e,componentTree:this.props.componentTree,focusManager:this.props.focusManager})},this.onPostEditorMounted=e=>{F.F({postId:e,componentTree:this.props.componentTree,focusManager:this.props.focusManager})},this.notifyRenderedOnce=Object(s.a)(()=>{this.props.onInitialRender({renderContextType:this.props.componentTree.componentTreeId.renderContextType})}),this.onPostError=e=>{F.G({trackback:593764372,id:e.getId(),data:this.props.dataItems,renderContextType:this.props.componentTree.componentTreeId.renderContextType,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.onClearPostError=e=>{F.A({trackback:593764373,id:e.getId(),data:this.props.dataItems,renderContextType:this.props.componentTree.componentTreeId.renderContextType,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.onLowFidelityWarningCancel=()=>{F.r({selectedState:this.props.selectedComment,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.onLowFidelityWarningConfirm=()=>{F.s({selectedState:this.props.selectedComment,onCardDelete:this.cardOnDelete,onPostDelete:this.onPostDelete,onPostEdit:this.onPostEdit})},this.commentEditorOnKeyDown=e=>{this.commentEditorKeyDownHandler.onKeyDown(e)},this.startNewCommentSession=()=>{this.props.discardDraftAndStartNewCommentSession({renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:593826323,telemetryVisitor:this.props.telemetryVisitor})},this.closePane=this.closePane.bind(this),this.onCommentUIAction=this.onCommentUIAction.bind(this),this.onMentionCreated=this.onMentionCreated.bind(this),this.onMentioneesStillInDraftUpdated=this.onMentioneesStillInDraftUpdated.bind(this),this.renderCommentThread=this.renderCommentThread.bind(this),this.onGhostCommentClicked=this.onGhostCommentClicked.bind(this),this.invokeModalDialog=this.invokeModalDialog.bind(this),this.deleteThreadConfirmCallback=this.deleteThreadConfirmCallback.bind(this),this.getOnWillDiscardCallback=this.getOnWillDiscardCallback.bind(this),this.isReadyToRender=this.isReadyToRender.bind(this),this.commentPostCallbackProps={onDelete:this.onPostDelete,onEdit:this.onPostEdit,onCommit:this.onPostCommit,onCancel:this.onPostCancel,onSelect:this.onRenderableItemSelect,onDraftEmptinessChanged:this.onPostDraftEmptinessChanged,onSaveDraft:this.onPostSaveDraft,onLowFidelityWarningConfirm:this.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:this.onLowFidelityWarningCancel,onPostMounted:this.onPostMounted,onPostEditorMounted:this.onPostEditorMounted,onError:this.onPostError,onClearError:this.onClearPostError,commentEditorAdditionalKeyDownHandler:this.commentEditorOnKeyDown,onCollapseParent:this.onPostCollapseParent,onFocusParent:this.onPostFocusParent,onReactionUpdated:this.onPostReactionUpdated,onPresentLinkToComment:this.onPresentLinkToComment},this.commentCardCallbackProps={onEditorPress:this.cardOnBeginReplyCallback,onCardCollapse:this.cardOnCollapseCallback,onCardSelect:this.cardOnSelectCallback,onCardSelectExpand:this.cardOnSelectExpandCallback,onCardFocus:this.cardOnFocusCallback,onCardHighlightChange:this.cardOnHighlight,onDraftingInputSizeChange:this.cardOnDraftingInputSizeChange,onDraftEmptinessChanged:this.cardOnDraftEmptinessChanged,onEditorBlur:this.cardOnEditorFocusLost,onCancel:this.onCardCancel,onPost:this.onCardPost,onSaveDraft:this.cardOnSaveDraft,onSelectedTaskAssigneeUpdated:this.onSelectedTaskAssigneeUpdated,onCardMounted:this.onCardMounted,onCardEditorMounted:this.onCardEditorMounted,onCardRendered:this.notifyRenderedOnce,onLowFidelityWarningCancel:this.onLowFidelityWarningCancel,onLowFidelityWarningConfirm:this.onLowFidelityWarningConfirm,onTaskTopperCheckboxPressed:this.onTaskTopperCheckboxPressed,commentEditorAdditionalKeyDownHandler:this.commentEditorOnKeyDown,onReactionUpdated:this.onPostReactionUpdated,onEditRootPost:this.onPostEdit},this.cardContextualMenuCallbackProps={onReopenThread:this.cardOnReopenThread,onResolveThread:this.cardOnResolveThread,onDeleteThread:this.cardOnDelete,onEditRootPost:this.onPostEdit,onPresentLinkToComment:this.onPresentLinkToComment},this.renderableItemActionBarItems=z.d(this.props.localizationAPI,this.commentPostCallbackProps),this.cardContextMenuItems=z.b(this.props.localizationAPI,this.cardContextualMenuCallbackProps),this.paneContainerKeyDownHandler=this.props.focusManager.paneContainerKeyDown(()=>this.props.componentTree),this.commentContentsKeyDownHandler=this.props.focusManager.commentContentsKeyDown(()=>this.props.componentTree,()=>this.props.dataItems),this.commentEditorKeyDownHandler=this.props.focusManager.commentEditorKeyDown(()=>this.props.componentTree);const t=Object(c.i)().createActivityObject("BaseCommentPaneConstruction",this.props.telemetryVisitor,c.a.None,c.b.NecessaryServiceDataEvent);t.addDataField("PaneCorrelationId",this.props.correlationId,c.d.SystemMetadata),t.addDataField("SharedCommentsVersion",v.a,c.d.SystemMetadata),t.addDataField("RenderContextType",this.props.componentTree.componentTreeId.renderContextType,c.d.SystemMetadata),t.successTag(593826206)}onCommentUIAction(e){return e.actionType===h.a.BackKeyPressed?(Object(c.i)().assertConditionTag(Object(b.d)(e.actionBehavior),"This action type does not support toggled/enabled status",593826207),Object(b.d)(e.actionBehavior)&&this.onBackKeyPressed(),b.a.Success):b.a.NotHandled}getOnWillDiscardCallback(e){return Object(I.a)(this.props.draftState)===w.a.CannotAutoDiscard?(t,n)=>this.invokeModalDialog(e,t,n):void 0}updateDraftRenderLocks(e){0!==Object(P.e)(this.props.draftState)&&this.props.updateRenderLocksForAllDrafts({renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:593826211,telemetryVisitor:this.props.telemetryVisitor},e)}componentDidMount(){var e,t;null===(t=(e=this.props).componentRef)||void 0===t||t.call(e,this),this.props.registerComponentUIActionListener(this.onCommentUIAction),this.props.registerComponentInterruptableCommandListener(this.onCommentInterruptableCommand),this.props.modelCapabilities.atMention!==p.b.Unknown&&this.processAtMentionCapabilityState(),this.updateDraftRenderLocks(!0),y.p()&&this.props.lastContextChangeIncrement>0&&this.onContextChanged()}componentWillUnmount(){this.props.unregisterComponentUIActionListener(this.onCommentUIAction),this.props.unregisterComponentInterruptableCommandListener(this.onCommentInterruptableCommand)}componentDidUpdate(e,t){if(this.props.lastContextChangeIncrement!==e.lastContextChangeIncrement&&this.onContextChanged(),this.props.modelCapabilities.atMention!==e.modelCapabilities.atMention&&this.processAtMentionCapabilityState(),this.sendReadyToRenderNotification(e),this.props.draftState!==e.draftState)for(const t of Object(P.f)(this.props.draftState))if(this.props.draftState.drafts[t].renderContextType!==this.props.componentTree.componentTreeId.renderContextType&&(void 0===e.draftState.drafts[t]||e.draftState.drafts[t].renderContextType!==this.props.draftState.drafts[t].renderContextType)){this.updateDraftRenderLocks(!0);break}this.props.focusManager.commentPanePropsUpdated(this.props.componentTree,e,this.props)}focus(){this.props.focusManager.focusCommentPaneCommand(this.props.componentTree)}getInstanceId(){var e;return null!==(e=this.props.componentInstanceId)&&void 0!==e?e:"CommentPane"}getRenderableItemFromRef(e){const t=Object(E.G)(this.props.draftState,!0,this.props.componentTree.componentTreeId.renderContextType),n=e.getId();return n===t?this.props.createdCommentLie&&{commentModel:this.props.createdCommentLie.newComment}:this.props.dataItems.find(e=>W.f(e)===n)}closePane(){F.p({ownProps:this.props,dispatchProps:this.props,componentTree:this.props.componentTree,draftState:this.props.draftState,invokeModalDialog:this.invokeModalDialog})}renderCommentThread(e,t,n=L.e){var r,o;const i=W.i(t),a=i.commentId===Object(E.G)(this.props.draftState,!0,this.props.componentTree.componentTreeId.renderContextType);if(y.R())return u.createElement(R.a,{commentAPI:this.props.commentAPI,componentTree:this.props.componentTree,focusManager:this.props.focusManager,localizationAPI:this.props.localizationAPI,peopleAPI:this.props.peopleAPI,resource:{id:i.commentId},getDiscardDraftCallback:this.getOnWillDiscardCallback,telemetryVisitor:this.props.telemetryVisitor,accessibilityPositionInSet:e+1,accessibilitySetSize:this.state.allRenderableItemThreads.length,onInitialRender:this.props.onInitialRender,correlationId:this.props.correlationId,lppManager:this.props.lppManager,componentInstanceId:this.getHostableComponentInstanceId(i.commentId,this.props.componentTree.componentTreeId.renderContextType,a)});const s=y.K()?this.state.allRenderableItemThreads.length>0&&W.i(this.state.allRenderableItemThreads[0]).commentId===i.commentId:0===this.props.dataItems.length||W.i(this.props.dataItems).commentId===i.commentId,c=this.getMentionableCommentEditorProps(this.props.modelCapabilities.atMention,this.props.suggestionsDetails),l=i.commentId,p=Object(P.d)(this.props.draftState),h=p||this.props.readOnly?x.a.None:x.a.Any,f=null===(r=this.props.tasks[l])||void 0===r?void 0:r.currentState,m=this.props.componentTree.componentTreeId.renderContextType===A.a.HalfPane&&!!Object(E.J)(this.props.draftState),g=this.props.highlightedCommentId||K(this.props),b=this.getPinnedCardIndex_deprecated(),C=this.getThreadPostOrHistoryRecordStates()[b&&!y.w()?b:e],v=(null===(o=this.props.selectedComment)||void 0===o?void 0:o.selectedCardId)===l?this.props.selectedComment:void 0,T=Object(j.a)(i.commentId,this.props.expandedComments,this.props.componentTree.componentTreeId.renderContextType);return n({thread:t,renderContextType:this.props.componentTree.componentTreeId.renderContextType,cardState:this.props.cardViewStates[l],postCallbacks:this.commentPostCallbackProps,mentionableEditorProps:c,cardCallbacks:this.commentCardCallbackProps,localizationAPI:this.props.localizationAPI,getActionBarItems:this.getRenderableItemActionBarItems,selectedState:v,isolationEdit:m,isAtMentionEnabled:!!c,areTasksEnabled:Object(E.c)(this.props.modelCapabilities),isDraftThread:a,foldableLayoutState:this.props.foldableLayoutState,isCommentsContextReadOnly:this.props.readOnly,keyboardingOptions:this.getKeyboardingOptions(),personaIconPropertiesMap:this.props.personaIconPropertiesMap,draftState:this.props.draftState,cardCollapsedState:T,cardRelativeDraftingState:Object(_.a)(i.commentId,this.props.componentTree.componentTreeId.renderContextType,this.props.draftState),accessibilityPositionInSet:e+1,accessibilitySetSize:this.state.allRenderableItemThreads.length,maximumDimensions:void 0,getCardContextualMenuItems:this.getCardContextualMenuItems,mentionEditorProps:c,availableScreenHeight:this.getAvailableScreenHeight(),extraPaddingLeft:this.getContentExtraPaddingLeft(),extraPaddingRight:this.getContentExtraPaddingRight(),preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),isCardHighlighted:g===l,contentBackgroundColor:this.getContentBackgroundColor(t.length>1,m),maxDraftHeight:this.getMaxDraftHeight(),restrictActionControls_deprecated:p,allowedDraftingSession:h,taskState:f,cardStyle:this.getCommentCardStyle(),onCardLayout:this.onCardLayout,isCardTabbable:L.b(this.getKeyboardingOptions().cardTabbingMode,l,s,T,this.props.selectedComment),postOrHistoryRecordStates:C,richTextCapabilities:this.props.modelCapabilities.richTextCapabilities,isUIAAnnotationPatternEnabled:this.props.modelCapabilities.UIAAnnotationPattern,isResolveSupported:this.props.modelCapabilities.resolve,tabFocusTrapBehavior:d.a.Unspecified})}onMentionCreated(e){F.t({failTag:593826271,successTag:593826272,person:e,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:593826273})}onMentioneesStillInDraftUpdated(e){F.u({trackback:593826275,emailsStillInDraft:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})}onBackKeyPressed(){if(Object(P.c)(this.props.draftState)){const e=Object(M.a)(this.props.draftState,this.props.componentTree.componentTreeId.renderContextType),t=Object(H.b)(!0,this.props.componentTree.componentTreeId.renderContextType,this.props.draftState,this.props.selectedComment,this.props.selectedThreadIdBeforeCommentSession),n=Object(E.I)(this.props.draftState),r=Object(E.J)(this.props.draftState);if(n){const e=Object(I.a)(this.props.draftState)===w.a.CannotAutoDiscard;F.e({trackback:592840781,showDiscardDialog:e,invokeModalDialog:this.invokeModalDialog,componentTree:this.props.componentTree,dispatchProps:this.props,closeOnDiscard:t,cardId:n,draftState:this.props.draftState,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,focusManager:this.props.focusManager,lieIndex:W.g(this.state.allRenderableItemThreads,n)})}else r&&F.z({trackback:592487364,commentId:r,setContents:void 0,data:this.props.dataItems,draftState:this.props.draftState,shouldClosePaneAfterDiscardDraft:t,onWillDiscardCallback:this.getOnWillDiscardCallback(e),renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI})}else this.props.componentTree.componentTreeId.renderContextType===A.a.HalfPane&&F.p({ownProps:this.props,dispatchProps:this.props,componentTree:this.props.componentTree,draftState:this.props.draftState,invokeModalDialog:this.invokeModalDialog})}sendReadyToRenderNotification(e){this.props.initializationStatus===D.a.Initialized&&(this.props.componentTree.componentTreeId.renderContextType===e.componentTree.componentTreeId.renderContextType&&this.props.initializationStatus===e.initializationStatus||this.props.readyToRender({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:593826313}))}deleteThreadConfirmCallback(){return this.props.selectedComment?(this.props.requestDeleteThread({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:593826314},this.props.selectedComment.selectedCardId),m.a.Handled):(Object(c.i)().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",593826315),m.a.Unhandled)}processAtMentionCapabilityState(){const e=this.props.modelCapabilities.atMention;e!==p.b.Unknown&&this.initialAtMentionCapability.set(e)}getUpdatedItemThreads(e){if(y.G()&&!this.isReadyToRenderWithProps(e))return[];const t=Object(N.a)(this.props.draftState,this.props.componentTree.componentTreeId.renderContextType),n=Object(N.a)(e.draftState,e.componentTree.componentTreeId.renderContextType);return this.props.dataItems!==e.dataItems||this.props.createdCommentLie!==e.createdCommentLie||this.props.cardViewStates!==e.cardViewStates||this.props.componentTree.componentTreeId.renderContextType!==e.componentTree.componentTreeId.renderContextType||this.props.personaIconPropertiesMap!==e.personaIconPropertiesMap||t!==n?W.c(e.dataItems,e.cardViewStates,e.createdCommentLie,e.componentTree.componentTreeId.renderContextType!==A.a.HalfPane,n):this.state.allRenderableItemThreads}getInitialState(e){return{allRenderableItemThreads:y.G()&&!this.isReadyToRenderWithProps(e)?[]:W.c(e.dataItems,e.cardViewStates,e.createdCommentLie,e.componentTree.componentTreeId.renderContextType!==A.a.HalfPane,Object(N.a)(e.draftState,e.componentTree.componentTreeId.renderContextType)),atMentionState:void 0}}onRequestLoadThreads(e){this.props.modelCapabilities.virtualized?this.props.queueLoadThreads({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:593826320},e):Object(c.i)().assertConditionTag(!1,"onRequestLoadThreads called for non-virtualized store",593826321)}shouldShowGhostComment(){return this.props.componentTree.componentTreeId.renderContextType===A.a.FullPane&&this.props.nextPopulatedContextDetails!==g.a.Unknown&&this.props.nextPopulatedContextDetails!==g.a.NoComments&&this.props.nextPopulatedContextDetails!==g.a.OnlyCommentsInCurrent}onGhostCommentClicked(){const e=y.n(),t=e&&!y.Y()||!e&&!0;this.props.discardDraftIfEmpty({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:590955266},S.a.SharedComments,t?k.a.GhostCard:void 0).then(e=>{t&&e.draftDiscardBehavior!==w.a.NoDraft&&e.draftDiscardResult!==m.a.Handled||this.props.selectionManager.selectAcrossContexts(l.d.Next,this.props.componentTree.componentTreeId.renderContextType)}).catch(Object(C.a)(590955267))}isReadyToRender(){return this.isReadyToRenderWithProps(this.props)}isReadyToRenderWithProps(e){const t=e.modelCapabilities.virtualized;return Object(O.a)({commentData:W.d(e.dataItems),pendingCommentLoad:e.pendingCommentLoad,virtualized:t})}canCardDelete(e){return!0}shouldCheckForLowFidelityOnCardDelete(){return!1}render(){return u.createElement(V.a.Provider,{value:this.props.lppManager},u.createElement(U.a.Provider,{value:this.props.componentTree.componentTreeId},this.renderInner()))}}t.a=G},function(e,t,n){var r=n(120);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useAsyncStorage",{enumerable:!0,get:function(){return i.useAsyncStorage}}),t.default=void 0;var o=r(n(332)),i=n(390),a=o.default;t.default=a},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e){return Object(r.b)("END_VIEW_INIT",{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t){return Object(r.b)("LOAD_PERSONA_ICON_PROPERTIES",{personaIconPropertiesMap:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t){return Object(r.b)("RESOLVE_ATMENTION_CAPABILITY",{capability:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),o=n(95),i=n(34),a=n(230);class s extends r.PureComponent{render(){let e;return e=this.props.accessibilityLabel?this.props.accessibilityLabel:this.props.text,r.createElement(o.a,{onPress:this.props.onClick,accessibilityLabel:e,accessibilityRole:"button",style:a.a,tooltip:this.props.tooltipText,isTabbable:!0,preventDefaultKeyDownBehavior:void 0,nextFocusLeft:this.props.nextFocusLeft,nextFocusRight:this.props.nextFocusRight},r.createElement(i.a,{textStylePolyester:"MediumStandard",variantFluent:"secondaryStandard"},this.props.text))}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r.b})),n.d(t,"d",(function(){return r.n})),n.d(t,"a",(function(){return o.b})),n.d(t,"c",(function(){return i.a}));n(49),n(254);var r=n(51),o=(n(250),n(37)),i=n(127);n(133)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(8);function o(){return Promise.resolve(void 0)}function i(e){switch(e){case"ExtensionAwareCommentPaneContainer":return Promise.resolve(n(317));case"HostableCommentCardRendererContainer":return Promise.resolve(n(410));default:Object(r.m)(e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n(7),i=n(71),a=n(60);function s(e,t){const n=Object(o.K)(e);if(!n)return Object(r.i)().assertConditionTag(!1,"Attempting to discard a draft when no draft is active within card.",593085890),Object(a.c)(t)?i.a.ClosePaneDraft:i.a.CancelNewDraft;switch(n.commentDraft.sessionConfiguration.sessionType){case"CREATE":return i.a.CancelNewDraft;case"EDIT":return i.a.CancelPostEdit;case"REPLY":return i.a.CancelReplyDraft;case"METADATA":return Object(r.i)().assertConditionTag(!1,"Metadata session should not be canceled with modal dialog.",593085891),i.a.CancelNewDraft}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(36);function o(e){return e===r.a.LowFidelityWarningDelete||e===r.a.LowFidelityWarningEdit}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Dialog=1]="Dialog",e[e.ForceDiscard=2]="ForceDiscard",e[e.TryAutoDiscard=3]="TryAutoDiscard"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return v}));var r,o,i=n(3),a=n(1),s=n(424),c=n(0),d=function(e){function t(t){var n,r=e.call(this,t)||this;return r.handleComponentCommand=function(e){var t=function(e,t,n){if(n.details.componentInstanceId===e)if(n.details.componentKey===t)switch(n.command){case"UpdateComponentDataProps":return{resource:n.updatedComponentDataProps.resource?Object(i.a)({},n.updatedComponentDataProps.resource):void 0,maximumDimensions:Object(i.a)({},n.updatedComponentDataProps.maximumDimensions),isVirtualized:n.updatedComponentDataProps.isVirtualized,accessibilityMetadata:n.updatedComponentDataProps.accessibilityMetadata};case"Focus":return}else Object(c.i)().assertConditionTag(!1,"componentInstanceId and componentName are out of sync",589951873)}(r.componentInstanceId,r.props.componentName,e);t&&r.setState(t)},r.componentInstanceId=null!==(n=r.props.componentInstanceId)&&void 0!==n?n:Object(s.b)(),r.state={resource:r.props.resource,maximumDimensions:r.props.maximumDimensions,isVirtualized:r.props.isVirtualized,accessibilityMetadata:r.props.accessibilityMetadata},r}return Object(i.c)(t,e),t.prototype.componentDidMount=function(){var e=this;this.registrationToken=this.props.onComponentCommand.subscribe((function(t){e.handleComponentCommand(t)}))},t.prototype.componentWillUnmount=function(){var e;null===(e=this.registrationToken)||void 0===e||e.unsubscribe()},t.prototype.render=function(){var e=this.props.InnerHostableComponent;return a.createElement(e,Object(i.a)({},this.state,{componentRef:this.props.componentRef,componentInstanceId:this.componentInstanceId}))},t}(a.PureComponent),l=n(32),u=l.AppRegistry.registerComponent.bind(l.AppRegistry),p=n(26),h=n(43);function f(){return(r||(r=Object(h.a)())).isChangeGateEnabled("ComponentRegistrationFix",Object(h.c)(5758332))}!function(e){e[e.Unregistered=0]="Unregistered",e[e.Registered=1]="Registered"}(o||(o={}));var m=function(){function e(e,t){var n=this;this.componentName=e,this._registryInstance=t,this.onComponentCommand=new p.EventImpl((function(){})),this._registryInstance.onComponentCommand.subscribe((function(e){e.details.componentKey===n.componentName&&n.onComponentCommand.trigger(e)}))}return e.prototype.unregister=function(){this.onComponentCommand.unsubscribeAll(),this._registryInstance.unregisterComponent(this.componentName)},e}(),g=function(){function e(e,t){var n=this;this._componentName=e,this._registryInstance=t,this.onStateChanged=new p.EventImpl((function(){})),this._registryInstance.onComponentStateChanged.subscribe((function(e){e.componentName===n._componentName&&n.onStateChanged.trigger(e.state)}))}return Object.defineProperty(e.prototype,"component",{get:function(){return this._registryInstance.componentMap[this._componentName]},enumerable:!1,configurable:!0}),e}(),b=function(){function e(){this.componentMap={},this.onComponentStateChanged=new p.EventImpl((function(){})),this.onComponentCommand=new p.EventImpl((function(){}))}return e.prototype.initialize=function(){},e.prototype.registerComponent=function(e,t){return f()?(this.componentMap[e]=t,this.onComponentStateChanged.trigger({componentName:e,state:o.Registered})):(this.onComponentStateChanged.trigger({componentName:e,state:o.Registered}),this.componentMap[e]=t),new m(e,this)},e.prototype.unregisterComponent=function(e){delete this.componentMap[e],this.onComponentStateChanged.trigger({componentName:e,state:o.Unregistered})},e.prototype.getComponent=function(e){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){return[2,new g(e,this)]}))}))},e}(),C=["SDX::ComponentRegistry::ComponentRegistryHostService",{dispatchComponentCommand:["FireAndForgetMethod",[["$union",["SDX::ComponentRegistry::FocusCommandArgs","SDX::ComponentRegistry::UpdateComponentDataPropsCommandArgs"]]]]}];p.CustomTypeRegistry.registerTypeInfos({"SDX::ComponentRegistry::SharedComponentCommandDetails":{componentKey:"$string",componentInstanceId:"$string"},"SDX::ComponentRegistry::FocusCommandArgs":{command:"$string",details:"SDX::ComponentRegistry::SharedComponentCommandDetails"},"SDX::ComponentRegistry::UpdateComponentDataPropsCommandArgs":{command:"$string",details:"SDX::ComponentRegistry::SharedComponentCommandDetails",updatedComponentDataProps:"SDX::ComponentRegistry::HostableComponentDataProps"}});var y,v,T=function(){function e(e){this._parentServiceProvider=e}return e.getInstance=function(){return this.instance},e.register=function(t){var n=this;this.instance||(this.instance=new e(t),p.RekaServiceRegistry.registerService({serviceInfo:this.ServiceInfo,factory:function(){return n.instance}}))},e.prototype.dispatchComponentCommand=function(e){this._parentServiceProvider.onComponentCommand.trigger(e)},e.ServiceInfo=C,e}(),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.c)(t,e),t.prototype.initialize=function(){T.register(this)},t.prototype.registerComponent=function(t,n){var r=this,o=a.forwardRef((function(e,o){return a.createElement(d,Object(i.a)({},e,{componentRef:e.componentRef||o,InnerHostableComponent:n,componentName:t,onComponentCommand:r.onComponentCommand}))}));return u(t,(function(){return o})),e.prototype.registerComponent.call(this,t,o)},t}(b);function I(){if(void 0===y){var e=new S;e.initialize(),y=e}return y}!function(e){e[e.Unspecified=0]="Unspecified",e[e.Trap=1]="Trap",e[e.DoNotTrap=2]="DoNotTrap"}(v||(v={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return u}));var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e,t,n,o,i){var a=(n=n||{}).tokens||{},s=o.handlers,c=function(e,t,n){var o=r({},t),i={};for(var a in n)void 0!==e[a]&&e[a]!==o[a]&&(i[a]=o[a]=e[a]);return{tokens:o,deltas:i,tokenKeys:n}}(e,a,o.tokenKeys),d={tokens:c.tokens||{}};return Object.getOwnPropertyNames(s).forEach((function(e){var r=s[e];d[e]=r(n[e]||{},c,t,e,i)})),d}var i=n(191),a=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function s(e,t){return e._keys=t,e}function c(e,t,n,r){void 0!==e[t]&&(r[n||t]=e[t])}function d(e,t,n,r){var o=n.source,i=n.lookup;if(void 0!==e[o]){var a=i&&i(t),s=e[o];"string"==typeof s&&a&&void 0!==a[s]&&(s=a[s]),r[n.target||o]=s}}function l(e,t,n,r,o,s,l,u){var p=t.tokens,h=t.tokenKeys,f=t.deltas;return o((function(){var t=Object(i.a)(e,"root"===r?h:void 0,function(e,t,n){var r={};if(n.toStyle.length>0){for(var o={},i=0,a=n.toStyle;i<a.length;i++){d(e,t,u=a[i],o)}Object.keys(o).length>0&&(r.style=o)}for(var s=0,l=n.toTokens;s<l.length;s++){var u;c(e,(u=l[s]).source,u.target,r)}return r}(p,n,l),function(e,t,n){if(e&&e.length>0)return i.a.apply(void 0,e.map((function(e){return e(t,n)})))}(l.functions,p,n));return u&&(t=u(t,r)),t}),a([r],s.map((function(e){return void 0!==f[e]?f[e]:""})),!0))[0]}function u(e,t){var n={},r={};return Object.getOwnPropertyNames(e).forEach((function(o){var i=e[o],a={toStyle:[],toTokens:[],functions:[]},s=a.toStyle,c=a.toTokens,d=a.functions,u={};if(i)for(var p=0,h=Array.isArray(i)?i:[i];p<h.length;p++){var f=h[p];if("function"==typeof f)d.push(f),f._keys.forEach((function(e){u[e]=void 0}));else for(var m=0,g=Array.isArray(f)?f:[f];m<g.length;m++){var b=g[m];u[b.source]=void 0;var C=b.target||b.source;t&&t(o,C)?c.push(b):s.push(b)}}Object.assign(n,u),r[o]=function(e,t,n,r,o){return l(e,t,n,r,o,Object.getOwnPropertyNames(u),a)}})),{tokenKeys:n,handlers:r}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(1),o=n(9),i=n(6),a=n(42),s=n(12),c=n(38),d=n(20),l=n(53),u=n(4);const p=Object(s.e)({elevation:2}),h=new u.b([u.b.always(e=>({alignItems:"stretch",backgroundColor:e.palette.NavigationBarBackground,borderColor:e.palette.NavigationBarBorder,borderBottomWidth:1,borderTopWidth:1,flexDirection:"row",height:50,justifyContent:"space-between",paddingLeft:16,paddingRight:16})),u.b.rule({platform:"ios",displayClass:l.a.SmallPhone},{height:45,borderLeftWidth:o.StyleSheet.hairlineWidth,borderRightWidth:o.StyleSheet.hairlineWidth,borderTopWidth:o.StyleSheet.hairlineWidth,borderBottomWidth:o.StyleSheet.hairlineWidth}),u.b.rule({platform:"ios",displayClass:l.a.LargeDisplay},{height:45,borderLeftWidth:0,borderRightWidth:0,borderTopWidth:0,borderBottomWidth:1})]),f=Object(s.e)({width:"25%",flexDirection:"row",justifyContent:"flex-start"}),m=Object(s.e)({width:"50%",flexDirection:"row",justifyContent:"center"}),g=Object(s.e)({width:"25%",flexDirection:"row",justifyContent:"flex-end"});class b extends r.PureComponent{constructor(){super(...arguments),this.renderWithTheme=e=>{const t=[this.renderStyle(h,e),this.props.backgroundColor&&{backgroundColor:this.props.backgroundColor},this.props.showShadow&&p,"number"==typeof this.props.outerSpacing&&{paddingLeft:this.props.outerSpacing,paddingRight:this.props.outerSpacing}];return r.createElement(d.a,{style:t,accessibilityRole:"header"},r.createElement(o.SafeAreaView,{style:f},this.props.leftChild),r.createElement(d.a,{style:m},this.props.centerChild),r.createElement(o.SafeAreaView,{style:g},this.props.rightChild))},this.render=()=>Object(a.a)(this.renderWithTheme,c.a)}renderStyle(e,t){return Object(s.g)(e,t,i.a.HalfPane)}}n(238)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),o=n(8),i=function(){function e(e,t){var n=this;this.apiName=e,this.DefaultCtor=t,this.reset=function(){n.instance=void 0,n.ctorStack=void 0,n.injectionStack=void 0}}return e.prototype.getAndInitialize=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(this.instance)throw new o.d("'".concat(this.apiName,"' singleton is already initialized"),538035215);if(!this.DefaultCtor)throw new o.d("'".concat(this.apiName,"' not initialized but no default constructor exists"),538035216);return this.ctorStack=Object(o.f)(),this.instance=new((e=this.DefaultCtor).bind.apply(e,Object(r.g)([void 0],t,!1)))},e.prototype.getInstanceOrThrow=function(){var e=this.instance;if(!e)throw new o.d("'".concat(this.apiName,"' singleton has not been initialized"),538035217);return e},e.prototype.getInstance=function(){return this.instance},e.prototype.injectImplementation=function(e){if(this.getInstance())throw new o.d("API has already been initialized.\nFirst initialization: ".concat(this.ctorStack),538035218);this.DefaultCtor=e},e.prototype.injectInstance=function(e){if(this.getInstance())throw new o.d("API has already been initialized or injected.\nInitialize or Inject Callstack: ".concat(this.getInjectOrInitializeStack()),538035219);this.injectionStack=Object(o.f)(),this.instance=e},e.prototype.getInjectOrInitializeStack=function(){var e,t;return null!==(t=null!==(e=this.ctorStack)&&void 0!==e?e:this.injectionStack)&&void 0!==t?t:"Callstack Not Retrieved"},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceInfos=t.NativeServices=void 0;var r=n(407);Object.defineProperty(t,"NativeServices",{enumerable:!0,get:function(){return r.NativeServices}}),Object.defineProperty(t,"ServiceInfos",{enumerable:!0,get:function(){return r.ServiceInfos}})},,function(e,t,n){},function(e,t,n){"use strict";const{Buffer:r}=n(338),{isASCIIHex:o}=n(339);function i(e,t,n){let r=e.indexOf(t);for(;r>=0;)e[r]=n,r=e.indexOf(t,r+1);return e}function a(e){let t=e.toString(16).toUpperCase();return 1===t.length&&(t="0"+t),"%"+t}function s(e){const t=r.alloc(e.byteLength);let n=0;for(let r=0;r<e.length;++r)37===e[r]&&o(e[r+1])&&o(e[r+2])?(t[n++]=parseInt(e.slice(r+1,r+3).toString(),16),r+=2):t[n++]=e[r];return t.slice(0,n)}function c(e){let t="";for(const n of e)t+=32===n?"+":42===n||45===n||46===n||n>=48&&n<=57||n>=65&&n<=90||95===n||n>=97&&n<=122?String.fromCodePoint(n):a(n);return t}e.exports={percentEncode:a,percentDecode:s,parseUrlencoded:e=>function(e){const t=function(e,t){const n=[];let r=0,o=e.indexOf(t);for(;o>=0;)n.push(e.slice(r,o)),r=o+1,o=e.indexOf(t,r);return r!==e.length&&n.push(e.slice(r)),n}(e,38),n=[];for(const e of t){if(0===e.length)continue;let t,o;const a=e.indexOf(61);a>=0?(t=e.slice(0,a),o=e.slice(a+1)):(t=e,o=r.alloc(0)),t=i(r.from(t),43,32),o=i(r.from(o),43,32),n.push([s(t).toString(),s(o).toString()])}return n}(r.from(e)),serializeUrlencoded:function(e,t){let n="utf-8";void 0!==t&&(n=t);let o="";for(const[t,i]of e.entries()){const e=c(r.from(i[0]));let a=i[1];i.length>2&&void 0!==i[2]&&("hidden"===i[2]&&"_charset_"===e?a=n:"file"===i[2]&&(a=a.name)),a=c(r.from(a)),0!==t&&(o+="&"),o+=`${e}=${a}`}return o}}},function(e,t,n){"use strict";e.exports=n(374)},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},function(e,t,n){"use strict";function r(e){switch(e){case"load":case"ins":case"mod":case"del":return!0;default:return!1}}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Indeterminate=1]="Indeterminate",e[e.SinglePortrait=2]="SinglePortrait",e[e.DoublePortrait=3]="DoublePortrait",e[e.SingleLandscape=4]="SingleLandscape",e[e.DoubleLandscape=5]="DoubleLandscape"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t){return Object(r.b)("ADD_CONTENT_EXTENSION",{extension:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t,n){return Object(r.b)("BEGIN_DRAFTING_FAILURE",{beginDraftingParams:t,errorInfo:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t,n){return Object(r.b)("BEGIN_DRAFTING_SUCCESS",{draftDetails:t,draftRenderContextType:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e){return Object(r.b)("BEGIN_PROCESSING_COMMIT",{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e){return Object(r.b)("BEGIN_PROCESSING_DISCARD",{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e){return Object(r.b)("BEGIN_VIEW_INIT",{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e){return Object(r.b)("CANCEL_DISCARD",{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t,n){return Object(r.b)("CLEAR_COMMENT_HIGHLIGHT",{actionSource:t,commentId:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e){return Object(r.b)("CLEAR_COMMENT_SELECTION",{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(10);function o(e,t){return Object(r.b)("COMMIT_DRAFT",t,e)}function i(e){switch(e.sessionType){case"CREATE":return"Create";case"REPLY":return"Reply";case"EDIT":return"Edit"}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t,n){return Object(r.b)("HIGHLIGHT_COMMENT",{commentId:t,actionSource:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t,n){return Object(r.b)("LOAD_COMMENT",{commentData:t,tasks:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t){return Object(r.b)("VIRTUALIZE_COMMENTS",{threadInfo:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t){return Object(r.b)("RELOAD_COMMENTS",t,e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t,n){return Object(r.b)("SESSION_REQUEST_STARTED",{params:t,captureSelectedThreadIdBeforeSession:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t,n){return Object(r.b)("SHOW_LOW_FIDELITY_WARNING",{commentId:t,lowFidelityWarningType:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t){return Object(r.b)("TOP_VISIBLE_THREAD_CHANGED",{threadId:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t){return Object(r.b)("UPDATE_CONTEXT_DETAILS",{contextState:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);function o(e,t){return Object(r.b)("UPDATE_SUGGESTIONS_DETAILS",{details:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(3),o=n(413),i=n(11),a=n(212),s=n(1),c=n(302),d=n(98),l=n(213);const u=Object(d.c)(a.TouchableWin32);class p extends s.PureComponent{constructor(e){super(e),this.refManager=new i.g,this.focus=this.refManager.focus,this.blur=this.refManager.blur,this.getFocusState=this.refManager.getFocusState,this.getChildNodes=this.refManager.getChildNodes,this.addChildNode=this.refManager.addChildNode,this.getDescendantById=this.refManager.getDescendantById,this.getId=this.refManager.getId,this.getData=this.refManager.getData,this.isTabbable=this.refManager.isTabbable,this.getNextTabTarget=this.refManager.getNextTabTarget,this.getIterator=this.refManager.getIterator,this.onFocusStateChange=e=>{this.setState({hasFocus:e!==i.b.Unfocused}),this.props.onFocusStateChange&&this.props.onFocusStateChange(e)},this.getOnAccessibilityOrKeyPress=Object(o.b)((e,t)=>e||t?n=>{n&&n.target!==n.currentTarget||(e?e():t&&t(null!=n?n:Object(c.a)()))}:void 0,()=>[this.props.onAccessibilityOrKeyPress,this.props.onPress]),this.renderStyle=e=>e.isFocused?[this.props.style,this.props.focusedStyle]:e.isHovered?[this.props.style,this.props.hoveredStyle]:e.isPressed?[this.props.style,this.props.pressedStyle]:this.props.style,this.state={hasFocus:!1}}render(){const e=this.props,{focusedStyle:t,hoveredStyle:n,pressedStyle:o,style:i,onAccessibilityOrKeyPress:a,onFocusStateChange:c,onPress:d,pointerEvents:p,accessibilityRole:h}=e,f=Object(r.f)(e,["focusedStyle","hoveredStyle","pressedStyle","style","onAccessibilityOrKeyPress","onFocusStateChange","onPress","pointerEvents","accessibilityRole"]);return s.createElement(u,Object.assign({},f,{renderStyle:this.renderStyle,touchableHandlePress:this.props.onPress,touchableHandleKeyPressDown:this.getOnAccessibilityOrKeyPress(),focusable:!this.props.disabled,ref:this.refManager.ref,accessibilityRole:Object(l.b)(h)||"button",onFocusStateChange:this.onFocusStateChange,onAccessibilityTap:this.getOnAccessibilityOrKeyPress()}))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(11),o=n(32),i=n(1),a=n(30),s=n(177),c=n(178),d=n(20);class l extends i.Component{constructor(e){super(e),this.personaRef=i.createRef(),this.registrationRef=i.createRef(),this.onFocus=()=>{this.setState({isFocusOn:!0})},this.onBlur=()=>{this.setState({isFocusOn:!1})},this.state={isFocusOn:!1,isFocusWithin:!1}}*getIterator(){yield this}getId(){return this.props.nodeId||""}getData(){return this.props.nodeData}getFocusState(){return Object(r.k)(this.state)}getNextTabTarget(){return this.getFocusState()===r.b.Unfocused&&this.isTabbable()?this:void 0}isTabbable(){return!!this.props.isTabbable}getChildNodes(){return[]}addChildNode(){throw new Error("Method not implemented.")}getDescendantById(){}focus(){this.personaRef.current&&Object(s.a)(this.personaRef.current)}blur(){}componentDidUpdate(e,t){Object(r.k)(this.state)!==Object(r.k)(t)&&(this.props.onFocusStateChange&&this.props.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))}render(){const e=i.createElement(o.PersonaProfile,{accessible:this.props.accessible,size:this.props.size,displayName:Object(a.k)(this.props.author),authorId:this.props.author.appAuthorId,emailAddress:this.props.author.Email,contextId:this.props.author.authorContextId,resolutionId:this.props.author.UserId,testID:this.props.nodeId,ref:this.personaRef,onFocus:this.onFocus,onBlur:this.onBlur});return i.createElement(r.h,{node:this,position:0,ref:this.registrationRef},i.createElement(d.a,{style:this.props.style,keyDownEvents:Object(r.s)(this.props.preventDefaultKeyDownBehavior,r.a.Capturing),onStartShouldSetResponder:c.a},e))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11),o=n(1),i=n(15),a=n(105),s=n(167);class c extends o.PureComponent{constructor(e){super(e),this.lppRef=null,this.lppContainer=void 0,this.setLPPRef=e=>{this.lppRef=e},this.state={calloutAnchor:void 0}}handleKeyDown(e){var t,n,o,i,a,c,d;switch(e){case r.c.ArrowDown:return null===(t=this.lppRef)||void 0===t||t.onCustomKeyPressed(s.a.DOWN),!0;case r.c.ArrowUp:return null===(n=this.lppRef)||void 0===n||n.onCustomKeyPressed(s.a.UP),!0;case r.c.Enter:return null===(o=this.lppRef)||void 0===o||o.onCustomKeyPressed(s.a.ENTER),!0;case r.c.Escape:return null===(i=this.lppRef)||void 0===i||i.onCustomKeyPressed(s.a.ESCAPE),null===(c=(a=this.props).onDismiss)||void 0===c||c.call(a),!0;case r.c.Tab:return null===(d=this.lppRef)||void 0===d||d.onCustomKeyPressed(s.a.TAB),!0}return!1}hidePicker(){this.setState({calloutAnchor:void 0})}showPicker(e,t){e&&(this.setState({calloutAnchor:e}),this.updatePicker(null!=t?t:""))}updatePicker(e){var t;void 0!==e&&(null===(t=this.lppRef)||void 0===t||t.onQueryChanged(e))}getLPPContainer(){if(this.state.calloutAnchor&&!this.lppContainer){this.props.lppManager.refreshLPPController();const e=this.props.lppManager.getLPPController();this.lppContainer=e&&Object(s.b)(e,this.props.lppManager.getAccountID())}return this.lppContainer}render(){const e=this.getLPPContainer();return o.createElement(a.a,null,e?o.createElement(e,{calloutPositioningTarget:this.state.calloutAnchor,maxHeight:this.props.maxHeight,maxWidth:this.props.maxWidth,strings:this.props.strings,inputId:this.props.inputId,componentRef:this.setLPPRef,isOpen:!!this.state.calloutAnchor,onDismiss:this.props.onDismiss,onSuggestionSelected:this.props.onSuggestionSelected,selectedSuggestions:this.props.selectedSuggestions,suggestionListId:i.w(),accessibilitySelectionRef:this.props.accessibilitySelectionRef}):null)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n(11),o=n(79),i=n(1),a=n(351),s=n(2),c=n(130),d=n(176),l=n(215),u=n(15),p=n(42),h=n(66),f=n(74),m=n(27),g=n(12),b=n(38),C=n(150),y=n(296),v=n(225),T=n(95),S=n(20),I=(n(8),n(414)),O=n(0),E=n(21),P=n(106),k=n(83),R=n(6),x=n(297),D=n(201);class w extends i.Component{constructor(e,t){super(e,t),this.editorRef=i.createRef(),this.onDraftEmptinessChanged=e=>{this.props.isDraftEmpty!==e&&this.props.onDraftEmptinessChanged(e)},this.onEditorCommitRequested=()=>{var e,t,n;!1===this.props.isDraftEmpty&&(null===(t=(e=Object(O.i)()).logDiagnosticTrace)||void 0===t||t.call(e,I.a`EditorCommitRequested`,556827600,O.h.Info,O.c.ProductServiceUsage,Object(O.j)(O.g.ReviewedAsNotNecessary),Object(O.l)("DraftId",null!==(n=this.props.telemetryId)&&void 0!==n?n:"",O.d.SystemMetadata)),this.props.onPost(P.a.KeyboardShortcut))},this.onCommitButtonClick=()=>{var e,t,n;null===(t=(e=Object(O.i)()).logDiagnosticTrace)||void 0===t||t.call(e,I.a`SendButtonClicked`,556827601,O.h.Info,O.c.ProductServiceUsage,Object(O.j)(O.g.ReviewedAsNotNecessary),Object(O.l)("DraftId",null!==(n=this.props.telemetryId)&&void 0!==n?n:"",O.d.SystemMetadata)),this.props.onPost(P.a.CommitButton)},this.onEditorUnmount=e=>{this.props.onUnmount(e)},this.onInputSizeChange=this.onInputSizeChange.bind(this),this.onLayout=this.onLayout.bind(this),this.onFocusStateChange=this.onFocusStateChange.bind(this),this.state={focusState:r.b.Unfocused,draftBoxHeight:0,viewRef:i.createRef()}}componentDidUpdate(e){this.props.editMode===c.a.None&&e.editMode!==c.a.None&&this.onInputSizeChange(this.getMinimumInputHeight())}renderStyle(e,t){return Object(g.g)(e,t,this.props.componentTreeId.renderContextType)}onInputSizeChange(e){let t=Math.max(e,this.getMinimumInputHeight());this.props.maxDraftHeight&&(t=Math.min(t,this.props.maxDraftHeight)),this.props.componentTreeId.renderContextType===R.a.HalfPane?this.props.onInputSizeChange(this.getHeight(t)):this.props.onInputSizeChange(void 0)}getPickerPosition(){if(!this.state.viewRef.current||!this.props.peoplePickerWidth)return;let e=this.props.availableScreenHeight||0;return this.props.componentTreeId.renderContextType===R.a.HalfPane&&(e=Math.max(e-this.state.draftBoxHeight,0)),{target:this.state.viewRef.current,left:0,top:0,width:this.props.peoplePickerWidth,height:e}}clear(){if(this.editorRef&&this.editorRef.current){const e=this.editorRef.current.getData();Object(D.a)(e)&&e.clear(),this.onDraftEmptinessChanged(!0)}}focus(){this.editorRef&&this.editorRef.current&&this.editorRef.current.focus()}blur(){this.editorRef&&this.editorRef.current&&this.editorRef.current.blur()}getContentsAsync(){if(this.editorRef&&this.editorRef.current){const e=this.editorRef.current.getData();if(Object(D.a)(e))return e.getContentsAsync()}return Promise.reject(new E.a("Editor ref unset",589103714,-2130957550))}renderCommentEditor(e,t){const n=this.props.editMode===c.a.Editing?k.a.Editing:k.a.ReadOnly,r=e.palette.CardPlaceholderColor;return i.createElement(x.a,Object.assign({nodeId:Object(u.s)(this.props.id),id:this.props.id,onPress:this.props.onPress,onFocus:this.props.onFocus,placeholder:this.props.placeholder,ref:this.editorRef,displayMode:n,onContentSizeChange:this.onInputSizeChange,onMount:this.props.onEditorMount,onUnmount:this.onEditorUnmount,onDraftEmptinessChanged:this.onDraftEmptinessChanged,accessibilityLabel:this.props.editorAllyLabel,savedDraftContent:this.props.savedDraftContent,isDraftEmpty:this.props.isDraftEmpty,richTextCapabilities:this.props.richTextCapabilities,shouldRestoreContentOnMount:this.props.shouldRestoreDraftOnMount},this.props.mentionEditorProps,{peoplePickerPosition:this.getPickerPosition(),placeholderTextColor:r,focusable:this.props.isEditorFocusable,isTabbable:this.props.isEditorFocusable&&this.props.editMode===c.a.Editing&&(!s.Y()||this.props.isTabbable),onCommitRequested:this.onEditorCommitRequested,onEscapeRequested:this.props.onEscapePressed,key:"editor",preventDefaultKeyDownBehavior:void 0,focusManagerKeyDownHandler:this.props.focusManagerKeyDownHandler,telemetryId:this.props.telemetryId,localizationAPI:this.props.localizationAPI},this.getExtraCommentEditorProps(e,t)))}onLayout(e){this.setState({draftBoxHeight:e.nativeEvent.layout.height})}onFocusStateChange(e){this.setState({focusState:e})}isEditingOrPending(){return this.props.editMode===c.a.Editing||this.props.editMode===c.a.Pending}}var A=n(154);const j=55;const _=Object(C.a)(class extends w{constructor(e,t){super(e,t),this.hoverManager=new l.a,this.onHoverChange=e=>{this.setState({isDraftBoxHovered:e})},this.renderWithTheme=(e,t)=>{const n=Object(g.b)(this.renderStyle(A.b,e),0,this.props.extraPaddingRight,0,this.props.extraPaddingLeft);let r=n;this.props.taskAssigner&&s.b()&&(r=[n,A.f]);const o=this.renderCommentEditor(e,t),c=this.isEditingOrPending()&&this.renderButtons(),d=[],l=this.getStyles(e);return d.push(i.createElement(T.a,Object.assign({accessible:!this.isEditingOrPending(),accessibilityLabel:this.props.editorAllyLabel,isTabbable:this.props.isTabbable&&!this.isEditingOrPending(),onPress:this.props.onPress,key:"editor",style:l,pointerEvents:this.isEditingOrPending()?"box-none":"auto",ref:this.state.viewRef,nodeId:"card-draft-box",preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,testID:this.props.id,onFocusStateChange:this.onFocusStateChange},this.hoverManager.viewProps),o)),d.push(this.renderDraftBoxMessage()),d.push(c),i.createElement(S.a,{style:r,animationClass:this.props.animationClass},i.createElement(a.UIAnchor,{uid:this.isEditingOrPending()?Object(u.N)():""},d))},this.render=()=>Object(p.a)(this.renderWithTheme,b.a,o.a),this.hoverChangeEventSubscription=this.hoverManager.hoverChangeEvent.subscribe(this.onHoverChange)}componentWillUnmount(){var e;this.hoverChangeEventSubscription&&(null===(e=this.hoverChangeEventSubscription)||void 0===e||e.unsubscribe())}getHeight(e){return 0}getMinimumInputHeight(){return 0}getExtraCommentEditorProps(e,t){var n;return{onEditorBlur:this.props.onBlur,maxHeight:Math.max(null!==(n=this.props.maxDraftHeight)&&void 0!==n?n:480,64),accessibilityLabel:this.props.editorAllyLabel,accessible:this.isEditingOrPending(),containerStyle:this.getContainerStyle(e,t)}}getContainerStyle(e,t){const n=[this.renderStyle(m.i,e)];if(!s.o()&&this.props.isCardHovered&&n.push(this.renderStyle(A.e,e)),this.state.isDraftBoxHovered&&n.push(this.renderStyle(A.d,e)),this.props.draftWarningState){const e=Object(f.b)(t);n.push(Object(g.f)(A.g,e,this.props.componentTreeId.renderContextType))}return n}getStyles(e){const t=[this.renderStyle(A.a,e)];return this.state.focusState===r.b.FocusOn&&t.push(this.renderStyle(A.c,e)),t}renderButtons(){const e={onClick:this.onCommitButtonClick,accessibilityLabel:this.props.sendLabel,isTabbable:this.props.isTabbable,icon:2,text:this.props.sendLabel,disabled:!1!==this.props.isDraftEmpty,showDelayedSpinner:this.props.editMode===c.a.Pending,id:this.props.sendTestID,usePrimaryButtonStyling:!0},t=this.props.showCancel?{onClick:this.props.onCancel,accessibilityLabel:this.props.cancelLabel,isTabbable:this.props.isTabbable,icon:1,text:this.props.cancelLabel||"",disabled:this.props.editMode===c.a.Pending,id:this.props.cancelTestID,usePrimaryButtonStyling:!1}:void 0,n=[e];return t&&n.push(t),i.createElement(y.a,{key:"commitbar",buttons:n,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,taskAssigner:this.props.taskAssigner})}renderDraftBoxMessage(){const{draftWarningState:e}=this.props,t=s.k()&&this.isEditingOrPending();if(e||t)return i.createElement(v.a,{key:"draftBoxMessage",draftWarningState:e,localizationAPI:this.props.localizationAPI,target:d.a.Card,id:e?Object(u.r)({id:this.props.parentId,renderContextType:this.props.componentTreeId.renderContextType}):Object(u.H)({id:this.props.parentId,renderContextType:this.props.componentTreeId.renderContextType}),defaultToPostingTip:t})}getEditorWrapperRefHandle(){}},{componentTreeId:h.a},"CardDraftBox");t.b=_},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));n(8);var r=n(0),o=n(21),i=n(61);function a(e){return e.replace(/\|(\||\d+)/g,(e,t)=>"|"===t?"|":`{${t}}`)}class s{constructor(e){if(this.constants=e,!e)throw new o.a("LocalizationConstants unavailable",589103710,-2130957557);this.localizedStrings=new Map(e.localizedStrings.map(({id:e,str:t})=>[e,t]))}getLocaleInfo(){return this.constants.localeInfo}getString(e){const t=this.localizedStrings.get(e);return Object(r.i)().assertConditionTag(void 0!==t,"Missing string "+e,589103711),t||""}getStringOrUndefined(e){return this.localizedStrings.get(e)}getStringWithStandardPlaceholders(e){return a(this.getString(e))}getStringWithStandardPlaceholdersOrUndefined(e){const t=this.getStringOrUndefined(e);if(void 0!==t)return a(t)}formatString(e,...t){const n=this.getString(e);try{return function(e,...t){if(t.length>100)throw new o.a(i.c,589103707,-2130957555);if("string"!=typeof e)throw new o.a("Expected string but got "+typeof e,589103708,-2130957537);return e.replace(/\|(\||\d+)/g,(e,n)=>{if("|"===n)return"|";const r=parseInt(n,10);if(r>=t.length)throw new o.a(i.i,589103709,-2130957553);return t[r]})}(n,...t)}catch(t){return Object(o.b)(t)?Object(r.i)().assertConditionTag(!1,`Comment error in format string with stringId ${e}: ${t.message}`,589103712):Object(r.i)().assertConditionTag(!1,"Unknown Error in formatString with stringId "+e,589103713),""}}}},function(e){e.exports=JSON.parse('{"brandBackground":{"fillColorRest":"PlatformColor(ButtonFace)","fillColorHover":"PlatformColor(Highlight)","fillColorPressed":"PlatformColor(Highlight)","fillColorSelected":"PlatformColor(Highlight)"},"brandBackground2":{"fillColorRest":"PlatformColor(ButtonFace)"},"brandBackgroundStatic":{"fillColorRest":"PlatformColor(Window)"},"brandForeground1":{"fillColorRest":"PlatformColor(WindowText)"},"brandForeground2":{"fillColorRest":"PlatformColor(ButtonText)"},"brandForegroundLink":{"fillColorRest":"PlatformColor(Hotlight)","fillColorHover":"PlatformColor(Hotlight)","fillColorPressed":"PlatformColor(Hotlight)","fillColorSelected":"PlatformColor(Hotlight)"},"brandStroke1":{"strokeColorRest":"PlatformColor(WindowText)","strokeWidth":1},"brandStroke2":{"strokeColorRest":"PlatformColor(Window)","strokeWidth":1},"compoundBrandBackground1":{"fillColorRest":"PlatformColor(Highlight)","fillColorHover":"PlatformColor(Highlight)","fillColorPressed":"PlatformColor(Highlight)"},"compoundBrandForeground1":{"fillColorRest":"PlatformColor(Highlight)","fillColorHover":"PlatformColor(Highlight)","fillColorPressed":"PlatformColor(Highlight)"},"compoundBrandStroke1":{"strokeColorRest":"PlatformColor(Window)","strokeColorHover":"PlatformColor(Highlight)","strokeColorPressed":"PlatformColor(Highlight)","strokeWidth":1},"neutralBackground1":{"fillColorRest":"PlatformColor(Window)","fillColorHover":"PlatformColor(Highlight)","fillColorPressed":"PlatformColor(Highlight)","fillColorSelected":"PlatformColor(Highlight)"},"neutralBackground2":{"fillColorRest":"PlatformColor(Window)","fillColorHover":"PlatformColor(Highlight)","fillColorPressed":"PlatformColor(Highlight)","fillColorSelected":"PlatformColor(Highlight)"},"neutralBackground3":{"fillColorRest":"PlatformColor(Window)","fillColorHover":"PlatformColor(Highlight)","fillColorPressed":"PlatformColor(Highlight)","fillColorSelected":"PlatformColor(Highlight)"},"neutralBackground4":{"fillColorRest":"PlatformColor(Window)","fillColorHover":"PlatformColor(Highlight)","fillColorPressed":"PlatformColor(Highlight)","fillColorSelected":"PlatformColor(Highlight)"},"neutralBackground5":{"fillColorRest":"PlatformColor(Window)","fillColorHover":"PlatformColor(Highlight)","fillColorPressed":"PlatformColor(Highlight)","fillColorSelected":"PlatformColor(Highlight)"},"neutralBackground6":{"fillColorRest":"PlatformColor(Window)"},"neutralBackgroundDisabled":{"fillColorRest":"PlatformColor(Window)"},"neutralBackgroundInverted":{"fillColorRest":"PlatformColor(WindowText)"},"neutralForeground1":{"fillColorRest":"PlatformColor(WindowText)","fillColorHover":"PlatformColor(HighlightText)","fillColorPressed":"PlatformColor(HighlightText)","fillColorSelected":"PlatformColor(HighlightText)"},"neutralForeground2":{"fillColorRest":"PlatformColor(WindowText)","fillColorHover":"PlatformColor(HighlightText)","fillColorPressed":"PlatformColor(HighlightText)","fillColorBrandHover":"PlatformColor(HighlightText)","fillColorBrandPressed":"PlatformColor(HighlightText)","fillColorBrandSelected":"PlatformColor(HighlightText)","fillColorSelected":"PlatformColor(HighlightText)"},"neutralForeground3":{"fillColorRest":"PlatformColor(WindowText)","fillColorHover":"PlatformColor(HighlightText)","fillColorPressed":"PlatformColor(HighlightText)","fillColorBrandHover":"PlatformColor(HighlightText)","fillColorBrandPressed":"PlatformColor(HighlightText)","fillColorBrandSelected":"PlatformColor(HighlightText)","fillColorSelected":"PlatformColor(HighlightText)"},"neutralForeground4":{"fillColorRest":"PlatformColor(WindowText)"},"neutralForegroundDisabled":{"fillColorRest":"PlatformColor(GrayText)"},"neutralForegroundInverted":{"fillColorRest":"PlatformColor(Window)"},"neutralForegroundInvertedLink":{"fillColorRest":"PlatformColor(Hotlight)","fillColorHover":"PlatformColor(Hotlight)","fillColorPressed":"PlatformColor(Hotlight)","fillColorSelected":"PlatformColor(Hotlight)"},"neutralForegroundOnBrand":{"fillColorRest":"PlatformColor(ButtonText)","fillColorHover":"PlatformColor(HighlightText)","fillColorPressed":"PlatformColor(HighlightText)","fillColorSelected":"PlatformColor(HighlightText)"},"neutralStencil1":{"fillColorRest":"#141414"},"neutralStencil2":{"fillColorRest":"#858585"},"neutralStroke1":{"strokeColorRest":"PlatformColor(WindowText)","strokeColorHover":"PlatformColor(Highlight)","strokeColorPressed":"PlatformColor(Highlight)","strokeColorSelected":"PlatformColor(Highlight)","strokeWidth":1},"neutralStroke2":{"strokeColorRest":"PlatformColor(WindowText)","strokeWidth":1},"neutralStroke3":{"strokeColorRest":"PlatformColor(WindowText)","strokeWidth":1},"neutralStrokeAccessible":{"strokeColorRest":"PlatformColor(WindowText)","strokeColorHover":"PlatformColor(Highlight)","strokeColorPressed":"PlatformColor(Highlight)","strokeColorSelected":"PlatformColor(Highlight)","strokeWidth":1},"neutralStrokeDisabled":{"strokeColorRest":"PlatformColor(GrayText)","strokeWidth":1},"redBackground1":{"fillColorRest":"PlatformColor(ButtonFace)"},"redBackground2":{"fillColorRest":"PlatformColor(Window)"},"redBackground3":{"fillColorRest":"PlatformColor(ButtonFace)"},"redBorder1":{"strokeColorRest":"PlatformColor(WindowText)","strokeWidth":1},"redBorder2":{"strokeColorRest":"PlatformColor(WindowText)","strokeWidth":1},"redBorderActive":{"strokeColorRest":"PlatformColor(Highlight)","strokeWidth":1},"redForeground1":{"fillColorRest":"PlatformColor(ButtonText)"},"redForeground2":{"fillColorRest":"PlatformColor(WindowText)"},"redForeground3":{"fillColorRest":"PlatformColor(WindowText)"},"strokeFocus1":{"strokeColorRest":"PlatformColor(Window)","strokeWidth":1},"strokeFocus2":{"strokeColorRest":"PlatformColor(Highlight)","strokeWidth":1},"subtleBackground":{"fillColorRest":"transparent","fillColorHover":"PlatformColor(Highlight)","fillColorPressed":"PlatformColor(Highlight)","fillColorSelected":"PlatformColor(Highlight)"},"transparentBackground":{"fillColorRest":"transparent","fillColorHover":"transparent","fillColorPressed":"transparent","fillColorSelected":"transparent"},"transparentStroke":{"strokeAlignment":"inner","strokeColorRest":"PlatformColor(WindowText)","strokeColorHover":"PlatformColor(Highlight)","strokeColorPressed":"PlatformColor(Highlight)","strokeColorDisabled":"PlatformColor(GrayText)","strokeWidth":1}}')},function(e,t,n){"use strict";function r(e,t){if(t)return e;throw new Error("Unhandled discriminated union member: "+JSON.stringify(e))}Object.defineProperty(t,"__esModule",{value:!0}),t.assertNever=r,t.default=r},function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(234))},function(e,t,n){"use strict";t.a=function(e,t){return e.has(t)}},function(e,t,n){"use strict";var r=n(211),o=n(75);t.a=function(e,t,n){var i=t(e);return Object(o.a)(e)?i:Object(r.a)(i,n(e))}},function(e,t,n){"use strict";t.a=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){"use strict";t.a=function(){return[]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="O365"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));const r=/{([^{}]+)}|[^{}]+/g,o=/{([^{}]+)}/g;function i(e,t,n){const o=[];return e.replace(r,(r,i)=>{const a=e+o.length;let s;return s=void 0!==i?t(i,a):n?n(r,a):r,s&&o.push(s),""}),o}function a(e,...t){return e.replace(o,(e,n)=>{try{return t[+n]}catch(e){return""}})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(3),o=n(11),i=n(1),a=n(98);function s(e){return t=>{const{nodeId:n,isTabbable:s,onFocusStateChange:c,onFocus:d,onBlur:l,nodeData:u,keyDownEvents:p,preventDefaultKeyDownBehavior:h,focusable:f,children:m}=t,g=Object(r.f)(t,["nodeId","isTabbable","onFocusStateChange","onFocus","onBlur","nodeData","keyDownEvents","preventDefaultKeyDownBehavior","focusable","children"]),[b,C]=i.useState(!1),y=Object(o.u)(n,u,s,c,b,!1),v=i.useCallback(e=>function(e,t,n){e.target===e.currentTarget&&(t(!0),null==n||n(e))}(e,C,d),[C,d]),T=i.useCallback(e=>function(e,t,n){e.target===e.currentTarget&&(t(!1),null==n||n(e))}(e,C,l),[C,l]),S=e,I=g;return i.createElement(a.a.Consumer,null,e=>i.createElement(o.h,{node:y.current,position:e,ref:y.current.registrationRef},i.createElement(S,Object.assign({},I,{componentRef:y.current.innerComponentRef,onFocus:v,onBlur:T,keyDownEvents:Object(a.b)(p,h)}))))}}},function(e,t,n){"use strict";function r(e){return e.tooltipText||e.text}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);const o=r.createContext(new Proxy({},{get:()=>{throw new Error("ScrollListenerContext undefined. Did you forget to render a ScrollListenerContext context provider?")}}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(17);function o(e,t,n,o){let i,a,s,c;return e===r.a.Edit?(i=37,a=42,s=35,c=39):(i=2,a=41,s=36,c=43),{renderContextType:n,cancelLabel:o.getString(15),confirmLabel:o.getString(i),cancelAccessibilityLabel:o.getString(c),confirmAccessibilityLabel:o.getString(a),warningLabel:o.getString(s),onCancel:t.onCancel,onConfirm:t.onConfirm}}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(403),o=n(404),i=n(333),a=n(405);e.exports=function(e){return r(e)||o(e)||i(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";const r=n(406).SharedCommentsVersion;t.a=r},function(e,t,n){"use strict";n.d(t,"a",(function(){return Z}));var r=n(32),o=n(1),i=n(90),a=n(290),s=n(66),c=n(29),d=n(12),l=n(38),u=n(137);class p extends o.Component{constructor(e){super(e),this.state={showLoadingUI:!1}}setTimer(){this.timeoutId||(this.timeoutId=setTimeout(()=>{this.setState({showLoadingUI:!0}),this.timeoutId=void 0},this.props.delay))}clearTimer(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0)}componentDidMount(){this.props.isLoading&&this.setTimer()}componentWillUnmount(){this.clearTimer()}componentDidUpdate(e){!e.isLoading&&this.props.isLoading?this.setTimer():e.isLoading&&!this.props.isLoading&&(this.clearTimer(),this.setState({showLoadingUI:!1}))}render(){return this.state.showLoadingUI?this.props.loadingUI:o.Children.only(this.props.children)}}var h=n(20),f=n(413),m=n(79),g=n(9),b=n(30),C=n(54),y=n(42),v=n(74),T=n(288),S=n(111),I=n(429),O=n(289);var E=n(95),P=n(105),k=n(77),R=n(430),x=n(11),D=n(179),w=n(34),A=n(4);const j=new A.b([A.b.always(e=>({width:200,flex:1,borderRadius:2,borderWidth:1,flexDirection:"column",backgroundColor:e.palette.CardBorder,borderColor:e.palette.CardBorder,padding:1}))]),_=new A.b([A.b.always(e=>({flex:1,flexDirection:"row",paddingLeft:9,paddingBottom:8,paddingTop:8,backgroundColor:e.palette.CardBackground}))]),F=new A.a([A.a.always({marginLeft:9,marginRight:15,flex:1,alignSelf:"center"})]),M=new A.b([A.b.always(e=>({backgroundColor:e.menuFocus}))]);const N=[{key:x.c.ArrowUp,eventPhase:x.a.Capturing},{key:x.c.ArrowLeft,eventPhase:x.a.Capturing},{key:x.c.ArrowDown,eventPhase:x.a.Capturing},{key:x.c.ArrowRight,eventPhase:x.a.Capturing}],L=o.memo(e=>{const[t,n]=o.useState(0),r={};Object.keys(e.candidates).forEach(t=>{e.candidates[t].stillInDraft&&(r[t]=e.candidates[t])});const i=Object.keys(r).length,a=o.useCallback(e=>function(e,t,n,r){let o=t;switch(e.nativeEvent.key){case x.c.ArrowUp:o--;break;case x.c.ArrowDown:o++;break;default:return}o<0?o=r-1:o>=r&&(o=0),n(o),e.stopPropagation()}(e,t,n,i),[t,n,i]);return Object(y.a)(n=>o.createElement(R.a,{target:e.anchorRef,onDismiss:e.onHide,setInitialFocus:!0},o.createElement(h.a,{style:Object(d.g)(j,n,e.renderContextType),onKeyDown:a,keyDownEvents:N},Object.keys(r).map((n,a)=>{const s=r[n];return o.createElement(H,{key:Object(k.d)(s.mentionee)?s.mentionee.UserId:s.mentionee.Id,candidate:s.mentionee,onClick:e.onCandidateChosen,renderContextType:e.renderContextType,selected:t===a,index:a,totalSuggestions:i})}))),l.a)});const B=[{key:x.c.Tab,eventPhase:x.a.Capturing},{key:x.c.Tab,eventPhase:x.a.Capturing,shiftKey:!0}];const H=o.memo(e=>{const{onClick:t,candidate:n}=e,i=o.useCallback(e=>{t(n)},[t,n]),a=Object(b.g)(e.candidate),s=o.useRef(null),u=o.useRef(!1);o.useEffect(()=>function(e,t,n){var r;t.current!==n&&n&&(null===(r=e.current)||void 0===r||r.focus()),t.current=n}(s,u,e.selected),[s,u,e.selected]);const p=o.useCallback(t=>function(e,t,n){switch(e.nativeEvent.key){case x.c.Tab:e.stopPropagation(),t(n)}}(t,e.onClick,e.candidate),[e.onClick,e.candidate]);return Object(y.a)((t,n)=>{const l=Object(v.b)(n);return o.createElement(E.a,Object.assign({style:Object(d.g)(_,t,e.renderContextType),onPress:i,keyDownEvents:B,onKeyDown:p,preventDefaultKeyDownBehavior:void 0,isTabbable:!1,ref:s,accessible:!0,tooltip:a,accessibilityPositionInSet:e.index+1,accessibilitySetSize:e.totalSuggestions,accessibilityLabel:a,focusedStyle:Object(d.f)(M,l,e.renderContextType)},{accessibilityRole:"listitem"}),o.createElement(D.a,{author:{DisplayName:a,Provider:"",Email:e.candidate.EmailAddresses[0],UserId:e.candidate.Id,IsCurrentUser:!1},accessible:!1,size:r.PersonaImageSize.extraSmall,preventDefaultKeyDownBehavior:void 0}),o.createElement(w.a,{numberOfLines:1,colorFluent:e.selected?l.selectedText:l.text,variantFluent:"secondaryStandard",style:F.render(Object(c.c)(e.renderContextType)),accessible:!1},e.candidate.Name))},l.a,m.a)});H.displayName="Suggestion";const U=new A.b([A.b.always({flexDirection:"row",justifyContent:"flex-start",alignItems:"center",flex:1,borderWidth:0})]),V=new A.b([A.b.always({borderWidth:1,paddingRight:5,paddingLeft:5,alignSelf:"stretch",flexDirection:"row",borderColor:"transparent",borderRadius:2,flexGrow:0,flexShrink:1})]),W=new A.b([A.b.always(e=>({borderStyle:"dashed",borderColor:e.palette.FocusBorderColor}))]),z=new A.b([A.b.always({marginBottom:2,borderBottomWidth:1,flexDirection:"row",borderColor:"transparent",flexShrink:1})]),K=new A.a([A.a.always({textAlignVertical:"center",paddingBottom:1,flexGrow:0,flexShrink:1})]),G=new A.a([A.a.always({marginLeft:6})]),q=Object(d.e)({flexShrink:1,alignSelf:"stretch"});class $ extends o.PureComponent{constructor(e){super(e),this.makeSquareCheckbox=Object(f.a)((e,t)=>((e,t)=>{const n=Object(v.b)(t),r=Object(O.a)(I.a.customize({tokens:{borderRadius:2,checkboxBackgroundColor:n.buttonBackground,checkboxBorderColor:n.squareCheckboxBorderColor},root:{style:{alignItems:"center",marginRight:0,height:26,width:26,paddingRight:3,paddingLeft:3,paddingTop:3,paddingBottom:3,borderRadius:4,borderWidth:1,borderColor:"transparent",marginBottom:2}},checkbox:{style:{marginTop:0,width:18,height:18,paddingLeft:1,justifyContent:"center",alignItems:"center"}},checkmark:{accessible:!1,style:{fontSize:12,fontWeight:"bold"}},content:{style:{display:"none"}},_overrides:{checked:{tokens:{checkboxBackgroundColor:n.completedSquareCheckboxColor,checkboxBorderColor:n.squareCheckboxBorderColor,checkmarkColor:n.completedCheckColor}},pressed:{tokens:{checkboxBackgroundColor:n.completedSquareCheckboxColor,checkboxBorderColor:n.completedSquareCheckboxColor,checkmarkColor:n.completedCheckColor}},hovered:{checkmark:{style:{opacity:1}},tokens:{checkmarkColor:n.checkHoverColor,checkboxBackgroundColor:n.buttonHoveredBackground}},focused:{root:{style:{borderColor:e.palette.FocusBorderColor,borderStyle:"dashed",padding:0}}}}}));return r.displayName="SquareCheckbox",r})(e,t)),this.getCheckboxAriaLabel=Object(f.a)(e=>Object(T.b)(this.props.label,Object(b.g)(e))),this.onChange=()=>{this.setState({isChecked:!this.state.isChecked})},this.onCalloutAnchorClick=()=>{this.state.isPickerOpen||this.setState({isPickerOpen:!0})},this.onPickerHide=()=>{this.setState({isPickerOpen:!1})},this.onCandidateChosen=e=>{this.setState({displayedAssignee:e,isPickerOpen:!1,isChecked:!0})},this.renderWithContexts=(e,t,n)=>{const r=n.renderContextType,i=this.makeSquareCheckbox(e,t);return o.createElement(P.a,{key:"task assigner",style:this.renderStyle(U,e,r)},o.createElement(i,{checked:this.state.isChecked,onChange:this.onChange,ariaLabel:this.getCheckboxAriaLabel(this.state.displayedAssignee),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,isTabbable:this.props.isTabbable,nodeId:"task-assigner-checkbox",tooltip:this.state.isChecked?void 0:Object(C.b)(this.props.localizationAPI,this.props.isTaskThread,this.state.displayedAssignee)}),this.renderAssignerText(e,t,r))},this.render=()=>Object(y.a)(this.renderWithContexts,l.a,m.a,s.a),this.state={displayedAssignee:Object(b.f)(e.candidateAssignees),isPickerOpen:!1,isChecked:!1},this.anchorRef=o.createRef()}componentDidUpdate(e,t){t.isChecked!==this.state.isChecked?this.props.onSelectedTaskAssigneeUpdated(this.state.isChecked?this.state.displayedAssignee:void 0):this.state.isChecked&&this.state.displayedAssignee.AadObjectId!==t.displayedAssignee.AadObjectId&&this.props.onSelectedTaskAssigneeUpdated(this.state.displayedAssignee)}static getDerivedStateFromProps(e,t){return t.displayedAssignee&&e.candidateAssignees[Object(b.h)(t.displayedAssignee)]?{}:{displayedAssignee:Object(b.f)(e.candidateAssignees),isChecked:!1}}renderStyle(e,t,n){return d.g(e,t,n)}renderAssignString(e,t){return o.createElement(w.a,{numberOfLines:1,variantFluent:"secondaryStandard",key:"task-assignment-string",accessible:!1,style:this.renderStyle(G,e,t)},this.props.label)}renderAssigneeName(e,t){return o.createElement(w.a,{numberOfLines:1,variantFluent:"secondarySemibold",key:"name",accessible:!1,style:this.renderStyle(K,e,t)},this.state.displayedAssignee.Name)}renderAssignerText(e,t,n){let r=void 0;const i=Object(v.b)(t);Object.keys(this.props.candidateAssignees).length>1&&(r=Object(S.b)({icon:8,renderTarget:"Pane",themeId:e.themeId}));const a=!!r,s=[this.renderStyle(z,e,n)];return a&&s.push({borderColor:i.squareCheckboxBorderColor}),o.createElement(P.a,{style:q},this.renderAssignString(e,n),o.createElement(E.a,{style:this.renderStyle(V,e,n),focusedStyle:a?this.renderStyle(W,e,n):void 0,onPress:a?this.onCalloutAnchorClick:void 0,isTabbable:!(!this.props.isTabbable||!a)&&this.props.isTabbable,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,nodeId:"task-assigner-anchor",accessibilityLabel:this.props.pickerAriaLabel,accessibilityRole:a?"combobox":void 0,accessible:a,ref:this.anchorRef},o.createElement(P.a,{style:s,tooltip:a?this.props.assignerTooltip:Object(C.b)(this.props.localizationAPI,this.props.isTaskThread,this.state.displayedAssignee)},this.renderAssigneeName(e,n),r&&o.createElement(g.Image,{source:r.source,style:d.i}))),this.state.isPickerOpen&&o.createElement(L,{onHide:this.onPickerHide,candidates:this.props.candidateAssignees,onCandidateChosen:this.onCandidateChosen,anchorRef:this.anchorRef,renderContextType:n}))}}const Y=new A.b([A.b.always({flexDirection:"row",justifyContent:"flex-end",padding:0,paddingTop:6,paddingBottom:1}),A.b.rule({isFluentEnabled:!0},{alignItems:"center",paddingRight:3,paddingTop:3})]),J=r.StyleSheet.createViewStyle({paddingBottom:3}),Q=new A.b([A.b.always(e=>({flex:0,marginLeft:7,borderWidth:1,borderColor:e.palette.ButtonBorder,borderRadius:2,height:26,width:39}))]),X=r.StyleSheet.createViewStyle({justifyContent:"center"}),Z=o.memo((function(e){const t=Object(s.b)().renderContextType;return o.createElement(l.a.Consumer,null,n=>o.createElement(i.a,{key:"draft-button-container",style:[Y.render(Object(c.c)(t)),e.taskAssigner?J:void 0],animationClass:e.animationClass,focusable:!1},e.taskAssigner&&o.createElement($,Object.assign({},e.taskAssigner)),function(e,t,n,i){return t.map((t,s)=>o.createElement(p,{key:s,delay:d.a,isLoading:!!t.showDelayedSpinner,loadingUI:o.createElement(h.a,{style:[Object(d.g)(Q,e,i),X]},o.createElement(r.Spinner,{size:"small"}))},o.createElement(u.a,{onClick:t.onClick,accessibilityLabel:t.accessibilityLabel,isTabbable:!!t.isTabbable,style:Object(d.g)(Q,e,i),tooltipText:Object(a.a)(t),testID:t.id,nodeId:t.id||"",disabled:t.disabled,icon:t.icon,useAppColor:t.usePrimaryButtonStyling,preventDefaultKeyDownBehavior:n,text:""})))}(n,e.buttons,e.preventDefaultKeyDownBehavior,t)))}))},function(e,t,n){"use strict";var r=n(3),o=n(8),i=n(413),a=n(414),s=n(0),c=n(11),d=n(1),l=(n(9),n(25)),u=n(106),p=n(83),h=n(6);function f(e){const t=e;return void 0!==t.onMentionCreated&&void 0!==t.onMentioneesStillInDraftUpdated&&void 0!==t.correlationId}var m=n(20),g=n(129),b=n(32),C=n(222),y=n(30),v=n(2),T=n(177),S=n(54),I=n(252);var O=n(42),E=n(216),P=n(112),k=n(277),R=n(105);const x=[{key:c.c.ArrowDown,eventPhase:b.EventPhase.Capturing},{key:c.c.ArrowUp,eventPhase:b.EventPhase.Capturing},{key:c.c.Enter,eventPhase:b.EventPhase.Capturing},{key:c.c.Escape,eventPhase:b.EventPhase.Capturing},{key:c.c.Tab,eventPhase:b.EventPhase.Capturing}];class D{constructor(){this.hasBeenFulfilled=!1,this.promise=new Promise(e=>{this.resolve=e})}fulfill(e){!this.hasBeenFulfilled&&this.resolve&&(this.resolve(e),this.hasBeenFulfilled=!0)}}class w extends d.PureComponent{constructor(e){var t;super(e),this.rteRef=null,this.lppRef=null,this.isFocused=!1,this.receivedFinalContentForUnmount=!1,this.supportsDeferredPromises=!0,this.lastKnownCursorPosition=void 0,this.tryFulfillDeferredContentsPromise=()=>{this.deferredContentsPromise&&(this.deferredContentsPromise.fulfill(this.getFinalContentDelta()),this.deferredContentsPromise=void 0)},this.setLPPRef=e=>{this.lppRef=e},this.setAccessibilitySelectionRef=e=>{this.setState({accessibilitySelectionRef:e})},this.onFocus=()=>{const e=this.isFocused;this.isFocused=!0,e||this.props.onFocus()},this.onBlur=()=>{const e=this.isFocused;this.isFocused=!1,e&&this.props.onBlur()},this.onKeyDown=e=>{var t;this.state.caretAnchorUID&&(null===(t=this.lppRef)||void 0===t?void 0:t.handleKeyDown(e.nativeEvent.key))&&e.stopPropagation()},this.previousMentions=[],this.onMentioneesChanged=e=>{if(!this.props.onMentionCreated||!this.props.onMentioneesStillInDraftUpdated||!e)return;const t=e.nativeEvent.atMentions,n=this.props.onMentionCreated;t.forEach(e=>{if(void 0===this.previousMentions.find(t=>t.id===e.id)){Object(s.i)().assertConditionTag(!v.b()||void 0!==e.directoryId,"Mentionees should have directoryId when tasks is enabled",591155840);const t=this.getLPPSuggestion(e);n(t)}}),this.previousMentions=t,this.props.onMentioneesStillInDraftUpdated(new Set(t.map(e=>e.email)))},this.emptyLPPStringOverride={},this.getMemoizedLPPStrings=Object(i.b)(S.i,()=>[v.Z()?this.props.localizationAPI:Object(C.a)(),this.emptyLPPStringOverride]),this.getLPPSuggestion=e=>({Id:e.id,Name:e.fullName,EmailAddresses:[e.email],UserPrincipalName:"",SuggestionType:"Person",SuggestionOrigin:"UserTyped",SuggestionSubtype:"OrganizationUser",HostAppSuggestion:{},Source:"HostApp",AadObjectId:e.directoryId}),this.onEditorWillUnmount=e=>{this.lastKnownContentsDelta=w.sanitizeAndStringifyDelta(null==e?void 0:e.nativeEvent.formattedText,574980951),this.receivedFinalContentForUnmount=!0,v.L()||(this.unmountedEditorFinalContent_deprecated=this.lastKnownContentsDelta),this.tryFulfillDeferredContentsPromise()},this.onPickerVisibilityChanged=e=>{var t,n;e&&(null===(n=(t=this.props).onPickerVisibilityChanged)||void 0===n||n.call(t,e.nativeEvent.isVisible))},this.onPickerTelemetryEvent=e=>{var t,n;e&&(null===(n=(t=this.props).onPickerTelemetryEvent)||void 0===n||n.call(t,e.nativeEvent))},this.onSelectionChange=e=>{e&&(this.lastKnownCursorPosition=e.nativeEvent.selection.start)},this.hidePicker=()=>{var e;this.setState({accessibilitySelectionRef:void 0,caretAnchorUID:void 0}),null===(e=this.lppRef)||void 0===e||e.hidePicker()},this.onCustomPickerEvent=e=>{if(this.lppRef&&e)switch(e.nativeEvent.PickerEvent){case"StartPicker":return this.setState({caretAnchorUID:e.nativeEvent.caretAnchorUID}),void this.lppRef.showPicker(e.nativeEvent.caretAnchorUID,e.nativeEvent.searchString);case"StopPicker":return void this.hidePicker();case"UpdatePicker":return void this.lppRef.updatePicker(e.nativeEvent.searchString)}},this.onDismissPicker=()=>{var e;this.hidePicker(),null===(e=this.rteRef)||void 0===e||e.endCustomPickerExperience(null)},this.onSuggestionSelected=e=>{var t,n;const r=this.getAtMentionSuggestion(e);null===(t=this.rteRef)||void 0===t||t.endCustomPickerExperience(r),this.setState({caretAnchorUID:void 0}),null===(n=this.lppRef)||void 0===n||n.hidePicker(),Object(g.a)(r.fullName)},this.renderWithContexts=e=>{var t;const n=this.props.defaultValue?JSON.parse(this.props.defaultValue):void 0,r=this.props.displayMode===p.a.ReadOnly;return function(e,...t){return d.Children.toArray(t).reduce((e,t)=>{if(!t)return e;if(I.isElement(t))return t.props.children&&Object(o.j)("Warning: wrapper elements should not contain children"),d.cloneElement(t,void 0,e);throw new Error("Expected element but got "+t)},e)}(d.createElement(d.Fragment,null,d.createElement(b.AtMentionTextInput,{ref:this.setRTERef,initialFormattedText:n,editable:!r,onFocus:this.onFocus,onBlur:this.onBlur,onContentSizeChange:this.props.onContentSizeChange,style:this.props.style,onPress:this.props.onPress,onChangeText:this.onChangeText,onIsEmpty:this.onIsEmpty,placeholderTextColor:this.props.placeholderTextColor,placeholder:this.props.placeholder,scrollEnabled:!r,onMentioneesChanged:this.onMentioneesChanged,isAtMentionsEnabled:f(this.props),acceptsKeyboardFocus:this.props.acceptsKeyboardFocus,hyperlinksOpenBrowser:!0,hyperlinksRequireControlKey:!0,testID:this.props.testID,maximumNumberOfLines:this.props.maxLines,supportedFormatting:this.props.richTextCapabilities,accessibilityLabel:this.props.accessibilityLabel,accessible:this.props.accessible,onComponentWillUnmount:this.onEditorWillUnmount,onPickerVisibilityChanged:this.onPickerVisibilityChanged,documentUrl:null===(t=this.props.suggestionsDetails)||void 0===t?void 0:t.hostResourceUrl,onPickerTelemetryEvent:this.onPickerTelemetryEvent,onSelectionChange:this.onSelectionChange,onCustomPickerEvent:v.r()?this.onCustomPickerEvent:void 0,accessibilityControls:this.state.accessibilitySelectionRef}),v.r()&&d.createElement(k.a,{ref:this.setLPPRef,lppManager:e,calloutPositioningTarget:this.state.caretAnchorUID,maxHeight:400,maxWidth:300,strings:this.getMemoizedLPPStrings(),inputId:this.props.correlationId||"LPP_INPUT_ID",isOpen:!!this.state.caretAnchorUID,onDismiss:this.onDismissPicker,onSuggestionSelected:this.onSuggestionSelected,accessibilitySelectionRef:this.setAccessibilitySelectionRef})),v.r()&&d.createElement(R.a,{keyDownEvents:this.state.caretAnchorUID?x:void 0,onKeyDown:this.onKeyDown}))},this.setRTERef=this.setRTERef.bind(this),this.onChangeText=this.onChangeText.bind(this),this.onIsEmpty=this.onIsEmpty.bind(this),this.onMentionCreated=this.onMentionCreated.bind(this),this.lastKnownContentsDelta=null!==(t=e.defaultValue)&&void 0!==t?t:Object(P.b)(),this.state={caretAnchorUID:void 0,accessibilitySelectionRef:void 0}}clear(){this.rteRef&&this.rteRef.clear()}isEmpty(){return!0}getCaretRect(){return this.rteRef?this.rteRef.getCaretRect():Promise.reject()}getFormattedText(){return Object(r.b)(this,void 0,void 0,(function*(){if(!this.rteRef||(v.L()?this.receivedFinalContentForUnmount:this.unmountedEditorFinalContent_deprecated))return Object(s.i)().assertConditionTag(v.L()?this.receivedFinalContentForUnmount:!!this.unmountedEditorFinalContent_deprecated,"RichTextEdit ref not set, but no contents persisted from unmount",574984778),Promise.resolve(this.getFinalContentDelta());let e;try{e=w.sanitizeAndStringifyDelta(yield this.rteRef.getFormattedText(),574984779)}catch(e){return this.supportsDeferredPromises?(Object(s.i)().assertConditionTag(!1,"RichTextEditWrapper failed to get editor content beginning to unmount",527558788),this.deferredContentsPromise=new D,this.deferredContentsPromise.promise):Promise.resolve(this.getFinalContentDelta())}return this.lastKnownContentsDelta=e,Promise.resolve(e)}))}componentDidUpdate(e){this.props.displayMode!==p.a.Editing&&e.displayMode===p.a.Editing&&(this.previousMentions=[])}componentWillUnmount(){this.tryFulfillDeferredContentsPromise(),this.supportsDeferredPromises=!1}getFinalContentDelta(){var e,t;return v.L()?this.lastKnownContentsDelta:null!==(t=null!==(e=this.unmountedEditorFinalContent_deprecated)&&void 0!==e?e:this.props.defaultValue)&&void 0!==t?t:Object(P.b)()}setFormattedText(e){this.rteRef&&(this.lastKnownContentsDelta=e,this.rteRef.setFormattedText(JSON.parse(e)))}setCursorPosition(e){this.rteRef&&(this.lastKnownCursorPosition=e,this.rteRef.setTextSelection(e,e))}getCursorPositionAsync(){return void 0!==this.lastKnownCursorPosition?Promise.resolve(this.lastKnownCursorPosition):this.rteRef?this.rteRef.getSelectionStart():Promise.resolve(void 0)}setRTERef(e){this.rteRef=e}focus(){this.rteRef&&Object(T.a)(this.rteRef)}blur(){this.rteRef&&this.rteRef.blur()}onChangeText(e){this.props.onChangeText(e.nativeEvent.text),this.unmountedEditorFinalContent_deprecated=void 0,this.receivedFinalContentForUnmount=!1,this.deferredContentsPromise=void 0}onIsEmpty(e){e&&this.props.onIsEmpty(e.nativeEvent.isEmpty)}onMentionCreated(e){this.props.onMentionCreated&&this.props.onMentionCreated({Email:e.email,DisplayName:e.fullName,Id:e.id})}getAtMentionSuggestion(e){var t;return{email:Object(y.h)(e),fullName:e.Name,directoryId:null!==(t=e.AadObjectId)&&void 0!==t?t:"",resolveState:b.AtMentionResolvedState.Resolved}}render(){return Object(O.a)(this.renderWithContexts,E.a)}}w.sanitizeAndStringifyDelta=(e,t)=>{if(void 0===(null==e?void 0:e.ops))return Object(s.i)().assertConditionTag(!1,"Delta ops not set",t),Object(P.b)();const n={ops:e.ops.filter(e=>void 0!==e.insert)};return JSON.stringify(n)};var A=n(178),j=n(66),_=n(291),F=n(206),M=(n(72),n(60)),N=n(27),L=n(29),B=n(12),H=n(424);class U{onPickerTelemetryEvent(e,t,n){if(this.pickerSession||"SearchStart"!==n.type&&"SearchComplete"!==n.type||(this.pickerSession=function(e,t,n,r){switch(r.type){case"SearchStart":if(r.isNewSession||!n){const n=z(t);return W(e,n),function(e,t){const n=Object(s.i)().createActivityObject("PickerDisplayed",e,s.a.None,s.b.NecessaryServiceDataEvent);V(t,n),n.successTag(590443477)}(e,n),n}break;case"SearchComplete":if(!n){const n=z(t);return W(e,n),n}}return n}(e,t,this.pickerSession,n)),this.pickerSession)switch(n.type){case"SearchStart":!function(e,t,n){const r=Object(s.i)().createActivityObject("SearchStart",e,s.a.None,s.b.NecessaryServiceDataEvent);V(t,r),r.addDataField("QueryLength",n,s.d.SystemMetadata),r.successTag(590443479)}(e,this.pickerSession,n.searchStringLength);break;case"SearchComplete":!function(e,t,n,r,o,i){const a=0===r,c=Object(s.i)().createActivityObject("SearchEnd",e,s.a.None,s.b.NecessaryServiceDataEvent);V(t,c),c.addDataField("SearchDurationMS",n,s.d.SystemMetadata),c.addDataField("Succeeded",a,s.d.SystemMetadata),c.addDataField("StatusCode",r,s.d.SystemMetadata),c.addDataField("NumberOfResults",o,s.d.SystemMetadata),c.addDataField("QueryLength",i,s.d.SystemMetadata),a?c.successTag(590443480):c.failTag(590443481,-2147467259)}(e,this.pickerSession,n.sinceSearchStartMs,n.resultCode,n.totalResults,n.searchStringLength);break;case"ResultsDisplayed":!function(e,t,n,r,o){const i=Object(s.i)().createActivityObject("ResultsDisplayed",e,s.a.None,s.b.NecessaryServiceDataEvent);V(t,i),i.addDataField("SearchDurationMS",n,s.d.SystemMetadata),i.addDataField("QueryLength",o,s.d.SystemMetadata),i.addDataField("NumberOfResults",r,s.d.SystemMetadata),i.successTag(590443478)}(e,this.pickerSession,n.sinceSearchStartMs,n.numResults,n.searchStringLength);break;case"SessionEnded":!function(e,t,n,r,o){const i=Object(s.i)().createActivityObject("SessionEnded",e,s.a.None,s.b.NecessaryServiceDataEvent);V(t,i),i.addDataField("WasSelectionMade",n,s.d.SystemMetadata),i.addDataField("SelectedIndex",r,s.d.SystemMetadata),i.addDataField("QueryLength",o,s.d.SystemMetadata),i.successTag(590443482)}(e,this.pickerSession,n.wasSelectionMade,n.selectedIndex,n.searchStringLength),this.pickerSession=void 0}else Object(s.i)().assertConditionTag(!1,"Never started picker session",589615891)}}function V(e,t){t.addDataField("DraftId",e.draftTelemetryId,s.d.SystemMetadata),t.addDataField("PickerSession",e.pickerSessionId,s.d.SystemMetadata)}function W(e,t){const n=Object(s.i)().createActivityObject("PickerInvoked",e,s.a.None,s.b.NecessaryServiceDataEvent);V(t,n),n.successTag(590443476)}function z(e){return{draftTelemetryId:e||H.a,pickerSessionId:Object(H.b)()}}var K=n(187),G=n(150),q=n(4);const $=b.StyleSheet.createViewStyle({margin:0}),Y=new q.b([q.b.rule(({renderContextType:e,platform:t})=>Object(L.h)(e)&&"win32"!==t,{flex:1})]),J={key:c.c.Enter,ctrlKey:!0,eventPhase:c.a.Capturing},Q={key:c.c.Escape,eventPhase:c.a.Capturing};class X extends d.PureComponent{constructor(e,t){super(e,t),this.viewRef=d.createRef(),this.rteRef=null,this.isRestoringDraftToRte=!1,this.registrationRef=d.createRef(),this.mentionsTelemetry=new U,this.onKeyDown=e=>{var t,n;e.nativeEvent.key!==c.c.ArrowLeft&&e.nativeEvent.key!==c.c.ArrowRight&&e.nativeEvent.key!==c.c.ArrowDown&&e.nativeEvent.key!==c.c.ArrowUp?this.props.displayMode===p.a.Editing&&(e.nativeEvent.key!==c.c.Tab||e.nativeEvent.shiftKey?e.nativeEvent.key===c.c.Enter&&e.nativeEvent.ctrlKey?this.props.onCommitRequested&&this.props.onCommitRequested(u.a.KeyboardShortcut):e.nativeEvent.key!==c.c.Escape||this.state.isPickerVisible?null===(n=(t=this.props).focusManagerKeyDownHandler)||void 0===n||n.call(t,e):this.props.onEscapeRequested&&this.props.onEscapeRequested():e.stopPropagation()):e.stopPropagation()},this.onPickerVisibilityChanged=e=>{this.setState({isPickerVisible:e})},this.createOnPickerTelemetryEventHandler=Object(i.a)((e,t)=>n=>{var r;this.mentionsTelemetry.onPickerTelemetryEvent(null!==(r=null==e?void 0:e.dataFieldVisitor)&&void 0!==r?r:Object(s.j)(s.g.GlobalAPI),t,n)}),this.renderWithContext=e=>{const{paddingTop:t=0,paddingBottom:n=0,maxHeight:r,minHeight:o}=this.props,i={paddingTop:t,paddingBottom:n,paddingLeft:0,paddingRight:0},a=[$,{maxHeight:this.scaleFontAccordingToSystemFontSettings(r),minHeight:this.scaleFontAccordingToSystemFontSettings(o)||this.getDefaultEditorMinHeight()},i];a.push(B.d);let s=void 0;f(this.props)&&(s={onMentionCreated:this.props.onMentionCreated,correlationId:this.props.correlationId,peoplePickerPosition:this.props.peoplePickerPosition,onMentioneesStillInDraftUpdated:this.props.onMentioneesStillInDraftUpdated});const l=[J];this.state.isPickerVisible||l.push(Q),this.props.displayMode===p.a.Editing?l.push({key:c.c.Tab,shiftKey:!0,eventPhase:c.a.Capturing}):l.push(...Object(c.s)(c.d,c.a.Capturing)||[]);let u=d.createElement(m.a,{ref:this.viewRef,testID:void 0,style:[this.renderStyle(Y),this.props.containerStyle],keyDownEvents:l,onKeyDown:this.onKeyDown,onStartShouldSetResponder:A.a},d.createElement(w,Object.assign({},s||{},{localizationAPI:this.props.localizationAPI,ref:this.setRTERef,placeholder:this.props.placeholder,defaultValue:this.props.defaultValue,displayMode:this.props.displayMode,onFocus:this.onFocus,onBlur:this.onBlur,onContentSizeChange:this.onContentSizeChange,style:a,onPress:this.props.onPress,onChangeText:this.onChangeText,onIsEmpty:this.onIsEmpty,placeholderTextColor:this.props.placeholderTextColor,acceptsKeyboardFocus:this.props.focusable,testID:this.props.id,maxLines:this.props.maxLines,richTextCapabilities:this.props.richTextCapabilities,accessibilityLabel:this.props.accessibilityLabel,accessible:void 0===this.props.accessible||this.props.accessible,onPickerVisibilityChanged:this.onPickerVisibilityChanged,suggestionsDetails:this.props.suggestionsDetails,scrollEnabled:this.shouldEnableRichTextScroll(),onPickerTelemetryEvent:this.createOnPickerTelemetryEventHandler(e,this.props.telemetryId)})));return d.createElement(c.h,{node:this,position:0,ref:this.registrationRef},u)},this.onContentSizeChange=this.onContentSizeChange.bind(this),this.onChangeText=this.onChangeText.bind(this),this.onIsEmpty=this.onIsEmpty.bind(this),this.setRTERef=this.setRTERef.bind(this),this.onBlur=this.onBlur.bind(this),this.onFocus=this.onFocus.bind(this),this.state={isFocusOn:!1,isFocusWithin:!1,isPickerVisible:!1}}componentWillUnmount(){var e,t;null===(t=(e=this.props).onUnmount)||void 0===t||t.call(e,this)}componentDidMount(){var e,t;null===(t=(e=this.props).onMount)||void 0===t||t.call(e),this.restoreDraftIfExists()}restoreDraftIfExists(){const e=this.props.savedDraftContent;e&&(this.isRestoringDraftToRte=!0,e.editorContent.then(t=>{var n;this.isRestoringDraftToRte=!1,t&&(this.setContents(t),null===(n=e.editorCursorPosition)||void 0===n||n.then(e=>this.setCursorPosition(null!=e?e:-1)).catch(e=>{this.setCursorPosition(-1)}))}).catch(e=>{this.isRestoringDraftToRte=!1,Object(l.a)(588805470)(e)}))}clear(){this.rteRef&&this.rteRef.clear()}isEditorEmpty(){return Object(s.i)().assertConditionTag(void 0!==this.props.isDraftEmpty,"Called isEditorEmpty on an editor without a draft",588805472),!1!==this.props.isDraftEmpty}getContentsAsync(){var e,t,n,o,i,c;return Object(r.b)(this,void 0,void 0,(function*(){return this.isRestoringDraftToRte&&(null===(t=(e=Object(s.i)()).logDiagnosticTrace)||void 0===t||t.call(e,a.a`GetEditorContentsMidRestore`,540021260,s.h.Info,s.c.ProductServiceUsage,Object(s.j)(s.g.ReviewedAsNotNecessary),Object(s.l)("RichTextEditorExists",!!this.rteRef,s.d.SystemMetadata)),this.props.savedDraftContent)?this.props.savedDraftContent.editorContent:this.rteRef?this.rteRef.getFormattedText():(null===(o=(n=Object(s.i)()).logDiagnosticTrace)||void 0===o||o.call(n,a.a`GetEditorContentsFallback`,540018914,s.h.Info,s.c.ProductServiceUsage,Object(s.j)(s.g.ReviewedAsNotNecessary)),null!==(c=null===(i=this.props.savedDraftContent)||void 0===i?void 0:i.editorContent)&&void 0!==c?c:Object(P.b)())}))}getCursorPositionAsync(){return this.rteRef?this.rteRef.getCursorPositionAsync():Promise.resolve(void 0)}setCursorPosition(e){this.rteRef&&void 0!==e&&setTimeout(()=>{var t;null===(t=this.rteRef)||void 0===t||t.setCursorPosition(e)})}setContents(e){this.rteRef&&this.rteRef.setFormattedText(e)}getDisplayMode(){return this.props.displayMode}shouldBlurOnUpdate(e){return this.props.displayMode===p.a.ReadOnly&&e!==p.a.ReadOnly}componentDidUpdate(e,t){this.shouldBlurOnUpdate(e.displayMode)&&this.blur(),e.savedDraftContent||this.rteRef&&!this.rteRef.isEmpty()||this.restoreDraftIfExists(),Object(c.k)(this.state)!==Object(c.k)(t)&&(this.props.onFocusStateChange&&this.props.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))}setSelection(e){}getScrollListener(){return Object(M.c)(this.props.componentTreeId.renderContextType)?this.props.scrollListener:null}onContentSizeChange(e){if(!e)return;const t=Math.max(N.b,e.nativeEvent.contentSize.height);this.props.onContentSizeChange&&this.props.onContentSizeChange(t)}setRTERef(e){this.rteRef=e}scrollCursorIntoView(){this.rteRef&&this.rteRef.getCaretRect().then(e=>{const t=this.getScrollListener();t&&t.invokeScrollToCommand&&this.viewRef.current&&t.invokeScrollToCommand({target:this.viewRef.current,offsetY:e.y,height:e.height})}).catch(Object(l.a)(588805473))}onChangeText(e){if(this.props.displayMode===p.a.Editing){const e=this.getScrollListener();e&&e.clearStickyScrollState&&e.clearStickyScrollState()}}onIsEmpty(e){var t,n;this.props.isDraftEmpty!==e&&this.props.displayMode===p.a.Editing&&(null===(n=(t=this.props).onDraftEmptinessChanged)||void 0===n||n.call(t,e))}onFocus(){this.setState({isFocusOn:!0}),this.props.onFocus&&this.props.onFocus();{const e=this.getScrollListener();e&&e.clearStickyScrollState&&e.clearStickyScrollState()}}onBlur(){this.setState({isFocusOn:!1}),void 0!==this.props.isDraftEmpty?this.props.onEditorBlur&&this.props.onEditorBlur():Object(s.i)().assertConditionTag(this.props.displayMode!==p.a.Editing,"isEditorEmpty undefined when in Editing mode in onBlur",588805475)}focus(){this.rteRef&&this.rteRef.focus()}blur(){this.rteRef&&this.rteRef.blur()}getFocusState(){return Object(c.k)(this.state)}getId(){return this.props.nodeId||""}getData(){return this}getChildNodes(){return[]}addChildNode(e){throw new Error("Method not implemented.")}getDescendantById(e){}isTabbable(){return!!this.props.isTabbable}getNextTabTarget(){return this.getFocusState()===c.b.Unfocused&&this.isTabbable()?this:void 0}*getIterator(){yield this}renderStyle(e){return e.render(Object(L.c)(this.props.componentTreeId.renderContextType))}getDefaultEditorMinHeight(){if(Object(L.e)("win32"))return 1}scaleFontAccordingToSystemFontSettings(e){if(void 0!==e)return Math.round(e*F.a.get("window").fontScale)}shouldEnableRichTextScroll(){return(this.props.componentTreeId.renderContextType!==h.a.HalfPane||void 0!==this.props.maxHeight)&&this.props.displayMode!==p.a.ReadOnly}render(){return Object(O.a)(this.renderWithContext,K.a)}}const Z=Object(G.a)(X,{componentTreeId:j.a,scrollListener:_.a},"CommentEditor");t.a=Z},function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var r=n(11),o=n(79),i=n(1),a=n(9);var s=n(57),c=n(90),d=n(178),l=n(15),u=n(42),p=n(74),h=n(111),f=n(12),m=n(38),g=n(3),b=n(32),C=n(98),y=n(20);const v=Object(C.c)(b.HyperlinkButton);class T extends i.Component{constructor(){super(...arguments),this.refManager=new r.g,this.focus=this.refManager.focus,this.blur=this.refManager.blur,this.getFocusState=this.refManager.getFocusState,this.getChildNodes=this.refManager.getChildNodes,this.addChildNode=this.refManager.addChildNode,this.getDescendantById=this.refManager.getDescendantById,this.getId=this.refManager.getId,this.getData=this.refManager.getData,this.isTabbable=this.refManager.isTabbable,this.getNextTabTarget=this.refManager.getNextTabTarget,this.getIterator=this.refManager.getIterator}render(){const e=this.props,{preventDefaultKeyDownBehavior:t,onMouseEnter:n,onMouseLeave:o}=e,a=Object(g.f)(e,["preventDefaultKeyDownBehavior","onMouseEnter","onMouseLeave"]),s=Object(r.s)(this.props.preventDefaultKeyDownBehavior,r.a.Capturing);return i.createElement(y.a,{accessible:!1,focusable:!1,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,keyDownEvents:s},i.createElement(v,Object.assign({},a,{ref:this.refManager.ref,isTabbable:this.props.isTabbable&&!this.props.disabled,preventDefaultKeyDownBehavior:void 0})))}}var S=n(34),I=n(53),O=n(6),E=n(40),P=n(50),k=n(27),R=n(29),x=n(4);Object(f.e)({flex:1}),new x.b([x.b.always(e=>({backgroundColor:e.palette.CardBackground})),x.b.rule({displayClass:I.a.LargeDisplay,renderContextType:O.a.HalfPane},{maxWidth:278}),x.b.rule({displayClass:I.a.LargeDisplay},e=>({borderWidth:E.a,borderColor:e.palette.CardAccent})),x.b.rule({displayClass:I.a.LargeDisplay,platform:"ios"},e=>({borderWidth:P.b,borderColor:e.palette.CardAccent,borderRadius:P.a,overflow:"hidden"})),x.b.rule({displayClass:I.a.SmallPhone},{flex:1})]),new x.b([x.b.always({position:"absolute",alignItems:"center",justifyContent:"center",paddingLeft:16,paddingRight:16,backgroundColor:"rgba(255,255,255,0.65)",height:"100%",width:"100%"}),x.b.rule({displayClass:I.a.LargeDisplay,platform:"ios"},{borderRadius:P.a}),x.b.rule(R.d,{zIndex:100})]);const D=new x.b([x.b.always({flex:0,padding:16,justifyContent:"center"}),x.b.rule({renderContextType:O.a.HalfPane,displayClass:I.a.SmallPhone},{flex:1}),x.b.rule({platform:"ios",renderContextType:O.a.HalfPane,displayClass:I.a.SmallPhone},e=>({backgroundColor:e.palette.CardReplyBackground_HalfPane})),...k.n,x.b.rule({platform:"win32"},{flexDirection:"row",paddingLeft:16,paddingBottom:16}),x.b.rule({platform:"win32",renderContextType:O.a.DiscreteIsolated},{paddingLeft:16+k.g+k.a})]),w=(new x.b([x.b.always(e=>({flexDirection:"row",flex:0,borderTopColor:e.palette.CardAccent,borderTopWidth:1,alignItems:"stretch"}))]),new x.b([x.b.always({flex:1,alignContent:"center",justifyContent:"center",height:48}),x.b.rule({renderContextType:O.a.FullPane},{height:32}),x.b.rule({displayClass:I.a.LargeDisplay},e=>({backgroundColor:e.palette.CardReplyBackground})),x.b.rule({platform:"ios"},{borderTopWidth:0,height:45}),x.b.rule({displayClass:I.a.LargeDisplay,platform:"ios"},e=>({backgroundColor:e.palette.CardHeroBarBackground}))]),new x.b([x.b.always(e=>({borderLeftColor:e.palette.ButtonBorder,borderLeftWidth:1})),x.b.rule({platform:"ios"},{borderLeftWidth:0})]),b.StyleSheet.createViewStyle({textAlign:"center"}),Object(f.e)({flexDirection:"column",flex:1})),A=Object(f.e)({width:32,paddingTop:4}),j=Object(f.e)({paddingRight:16,height:16,width:16}),_=Object(f.e)({marginRight:14}),F=Object(f.e)({flexDirection:"row",paddingTop:10}),M=Object(f.e)({marginRight:10});class N extends i.PureComponent{constructor(e){super(e),this.setFocusState=e=>this.setState({focusState:e}),this.renderWithTheme=(e,t)=>{if(!function(e){const t=e;return void 0!==t.renderContextType&&"string"==typeof t.warningLabel&&"string"==typeof t.confirmLabel}(this.props))return i.createElement(i.Fragment,null,i.Children.only(this.props.children));const n=Object(p.b)(t),{focusState:o}=this.state,u=Object(h.a)({icon:19,themeId:e.themeId,renderTarget:"Pane"});return i.createElement(c.a,{style:[this.renderStyle(D,this.props,e),o===r.b.FocusOn&&this.renderStyle(s.n,this.props,e)],accessibilityLabel:this.props.warningLabel,isTabbable:!0,accessible:!0,focusable:!0,onFocusStateChange:this.setFocusState,onStartShouldSetResponder:d.a,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,nodeId:this.props.nodeId},u&&i.createElement(y.a,{style:A},i.createElement(a.Image,{source:u.source,style:j})),i.createElement(y.a,{style:w},i.createElement(S.a,{textStylePolyester:"MediumSecondary",variantFluent:"secondaryStandard",colorFluent:n.subTextColor,style:_},this.props.warningLabel),i.createElement(y.a,{style:F},i.createElement(T,{onClick:this.props.onConfirm,isTabbable:!0,text:this.props.confirmLabel,style:M,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,nodeId:Object(l.y)()}),i.createElement(T,{onClick:this.props.onCancel,isTabbable:!0,text:this.props.cancelLabel,style:M,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,nodeId:Object(l.x)()}))))},this.render=()=>Object(u.a)(this.renderWithTheme,m.a,o.a),this.state={focusState:r.b.Unfocused}}renderStyle(e,t,n){return Object(f.g)(e,n,t.renderContextType)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return B}));var r=n(89),o=n(2),i=n(5),a=n(93),s=n(413),c=n(11),d=n(1),l=n(8),u=n(428),p=n(425),h=n(77),f=n(0),m=n(45),g=n(25),b=n(13),C=n(22),y=n(7),v=n(107),T=n(76),S=n(6),I=n(96),O=n(16),E=n(146),P=n(66),k=n(216);n(72);var R=n(24),x=n(155),D=n(64);class w extends d.Component{constructor(e){super(e),this.memoGetActionBarItems=Object(u.a)(x.a,20,()=>{Object(f.i)().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875360)}),this.memoGetCardContextualMenuItems=Object(u.a)(x.c,20,()=>{Object(f.i)().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875361)}),this.getMentionableCommentEditorProps=Object(s.a)((e,t)=>{if(e===m.b.Enabled)return{onMentionCreated:this.onMentionCreated,onMentioneesStillInDraftUpdated:this.onMentioneesStillInDraftUpdated,getAuthToken:this.getAuthToken,correlationId:this.props.correlationId,suggestionsDetails:t}}),this.getRenderableItemActionBarItems=(...e)=>{if(!this.renderableItemActionBarItems||void 0===this.memoGetActionBarItems)throw new l.d("Function should not be called when DeleteRestricted gate is off.",557601689);return this.memoGetActionBarItems(this.renderableItemActionBarItems,...e)},this.getCardContextualMenuItems=(...e)=>{if(!this.cardContextMenuItems||void 0===this.memoGetCardContextualMenuItems)throw new l.d("Function should not be called when DeleteRestricted gate is off.",557601690);return this.memoGetCardContextualMenuItems(this.cardContextMenuItems,...e)},this.onPostDelete=e=>{O.D({trackback:593826139,id:e,data:this.props.dataItems,selectedComment:this.props.selectedState,renderContextType:this.props.componentTree.componentTreeId.renderContextType,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI})},this.onPostEdit=e=>{O.E({trackback:593801875,id:e,data:this.props.dataItems,selectedComment:this.props.selectedState,renderContextType:this.props.componentTree.componentTreeId.renderContextType,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.onPostCommit=(e,t)=>{O.C({trackback:593826141,id:e.getId(),data:this.props.dataItems,draftState:this.props.draftState,contentPromise:e.getContentsAsync(),atMentionsEnabled:this.props.modelCapabilities.atMention===m.b.Enabled,componentTree:this.props.componentTree,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor,commitSource:t,localizationAPI:this.props.localizationAPI}).catch(Object(g.a)(593826142))},this.onPostDraftEmptinessChanged=(e,t)=>{O.q({trackback:592041679,contentId:e.getId(),isEmpty:t,renderContextType:this.props.componentTree.componentTreeId.renderContextType,draftIdMap:this.props.draftState.postIdToDraftIdMap,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.onPostSaveDraft=(e,t)=>{O.x({trackback:592720402,id:e,editor:t,renderContextType:this.props.componentTree.componentTreeId.renderContextType,draftIdMap:this.props.draftState.postIdToDraftIdMap,draftMap:this.props.draftState.drafts,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.onPostCancel=e=>{O.z({trackback:593826145,commentId:e.getId(),setContents:e.setContents.bind(e),data:this.props.dataItems,draftState:this.props.draftState,shouldClosePaneAfterDiscardDraft:!1,onWillDiscardCallback:void 0,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI})},this.onLowFidelityWarningCancel=()=>{O.r({selectedState:this.props.selectedState,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.onLowFidelityWarningConfirm=()=>{O.s({selectedState:this.props.selectedState,onCardDelete:this.cardOnDelete,onPostDelete:this.onPostDelete,onPostEdit:this.onPostEdit})},this.onPostReactionUpdated=(e,t,n)=>{O.w(587994052,e,t,this.props.componentTree.componentTreeId.renderContextType,this.props,this.props.telemetryVisitor,n)},this.onPresentLinkToComment=e=>{O.v(578852485,e,this.props.componentTree.componentTreeId.renderContextType,this.props,this.props.telemetryVisitor)},this.onRenderableItemSelect=(e,t)=>{const n=this.getRenderableItemFromRef(e);n?O.J({trackback:593826147,renderableItem:n,selectedComment:this.props.selectedState,cardCollapsedState:this.props.cardCollapsedState,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,componentTree:this.props.componentTree,shouldFocusAfter:t,draftState_deprecated:this.props.draftState}).catch(Object(g.a)(590123736)):Object(f.i)().assertConditionTag(!1,"Comment not rendered within Card. Is something incorrect in the tree?",593826146)},this.onPostCollapse=e=>{const t=this.getRenderableItemFromRef(e);t?O.B(589940442,t,this.props,this.props.telemetryVisitor,this.props.componentTree):Object(f.i)().assertConditionTag(!1,"Collapse from an unknown post?",589940441)},this.onPostFocusParent=e=>{const t=this.getRenderableItemFromRef(e);t?O.H(t,this.props.componentTree,this.props.focusManager,this.props.draftState):Object(f.i)().assertConditionTag(!1,"Focus parent from unknown post?",545867680)},this.cardOnResolveThread=e=>{O.m({componentTree:this.props.componentTree,focusManager:this.props.focusManager,trackback:593826176,id:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,isTask:!!this.props.threadTaskState})},this.cardOnReopenThread=e=>{O.l({trackback:593826177,id:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,isTask:!!this.props.threadTaskState})},this.cardOnDelete=e=>{Object(f.i)().assertConditionTag(this.props.componentTree.componentTreeId.renderContextType!==S.a.HalfPane,"Discard not yet fully supported for HalfPane in DHC",593826178),O.d({trackback:592840777,id:e,data:this.props.dataItems,selectedComment:this.props.selectedState,componentTree:this.props.componentTree,invokeModalDialog:void 0,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,focusManager:this.props.focusManager,isTask:!!this.props.threadTaskState,threadIndex:0,shouldCheckForLowFidelity:this.shouldCheckForLowFidelityOnCardDelete()})},this.cardOnPost=(e,t)=>{const n=this.props.isDraftThread?{type:"CREATE"}:{type:"REPLY",parentId:e.getId()},r=this.props.draftState.drafts[this.props.draftState.cardIdToDraftIdMap[this.props.threadId]];O.c({trackback:593622431,commentCardRef:e,draftState:this.props.draftState,areMentionsEnabled:this.props.modelCapabilities.atMention===m.b.Enabled,session:n,componentTree:this.props.componentTree,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,commitSource:t,selectedTaskAssignee_deprecated:r&&r.selectedTaskAssignee}).catch(Object(g.a)(593622432))},this.cardOnCollapseCallback=e=>{O.b({trackback:562918285,commentCardRef:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.cardOnSelectCallback=e=>{O.n({trackback:571281792,commentCardRef:e,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,componentTree:this.props.componentTree,options:{selectActionType:b.b.SelectCard}})},this.cardOnSelectExpandCallback=(e,t,n)=>{O.n({trackback:571281763,commentCardRef:e,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,componentTree:this.props.componentTree,options:{selectActionType:b.b.ExpandCard,relativeDraftingState:this.props.cardRelativeDraftingState,draftState:this.props.draftState,shouldFocusAfter:n,selectRootPost:t}})},this.cardOnFocusCallback=e=>{O.i({trackback:571340120,commentCardRef:e,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,componentTree:this.props.componentTree,options:{selectActionType:b.b.Polite},focusManager:this.props.focusManager,isDraftThread:this.props.isDraftThread})},this.cardOnBeginReplyCallback=e=>{O.a({trackback:593826189,threadId:e.getId(),renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.cardOnHighlight=(e,t)=>{O.j({trackback:593826190,commentCardRef:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,shouldHighlightCard:t})},this.cardOnDraftingInputSizeChange=(e,t)=>{O.f({trackback:593826191,focusManager:this.props.focusManager,componentTree:this.props.componentTree,cardId:e.getId(),isCardLie:this.props.isDraftThread,newHeight:t,renderContextType:this.props.componentTree.componentTreeId.renderContextType,selectedComment:this.props.selectedState,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.cardOnDraftEmptinessChanged=(e,t)=>{O.q({trackback:592213847,contentId:e.getId(),isEmpty:t,renderContextType:this.props.componentTree.componentTreeId.renderContextType,draftIdMap:this.props.draftState.cardIdToDraftIdMap,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.cardOnEditorFocusLost=e=>{O.g({trackback:592065734,id:e.getId(),draftState:this.props.draftState,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.cardOnTaskTopperCheckboxPressed=()=>{o.b()&&(this.props.threadTaskState?O.o({componentTree:this.props.componentTree,focusManager:this.props.focusManager,trackback:593826194,id:this.props.threadId,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI}):Object(f.i)().assertConditionTag(!1,"props.threadTaskState is undefined",593826193))},this.cardOnSaveDraft=(e,t)=>{O.x({trackback:592720403,id:e,editor:t,renderContextType:this.props.componentTree.componentTreeId.renderContextType,draftIdMap:this.props.draftState.cardIdToDraftIdMap,draftMap:this.props.draftState.drafts,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.cardOnCancel=e=>{Object(f.i)().assertConditionTag(this.props.isDraftThread||this.props.cardRelativeDraftingState===T.a.InCard,"Mismatch between selectedComment state and cancel reply callback.",593826196),O.e({trackback:592840778,showDiscardDialog:!1,invokeModalDialog:void 0,componentTree:this.props.componentTree,dispatchProps:this.props,closeOnDiscard:!1,cardId:this.props.threadId,draftState:this.props.draftState,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,focusManager:this.props.focusManager,lieIndex:0})},this.commentEditorOnKeyDown=e=>{this.commentEditorKeyDownHandler.onKeyDown(e)},this.onPostError=e=>{O.G({trackback:593764370,id:e.getId(),data:this.props.dataItems,renderContextType:this.props.componentTree.componentTreeId.renderContextType,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.onClearPostError=e=>{O.A({trackback:593764371,id:e.getId(),data:this.props.dataItems,renderContextType:this.props.componentTree.componentTreeId.renderContextType,actionDispatchers:this.props,telemetryVisitor:this.props.telemetryVisitor})},this.onCardMounted=e=>{O.k({cardProps:e,componentTree:this.props.componentTree,focusManager:this.props.focusManager})},this.onCardEditorMounted=e=>{O.h({cardId:e,componentTree:this.props.componentTree,focusManager:this.props.focusManager})},this.onPostMounted=e=>{O.I({postId:e,componentTree:this.props.componentTree,focusManager:this.props.focusManager})},this.onPostEditorMounted=e=>{O.F({postId:e,componentTree:this.props.componentTree,focusManager:this.props.focusManager})},this.onCardRendered=Object(p.a)(e=>{this.props.onInitialRender({commentId:e.id,renderContextType:this.props.componentTree.componentTreeId.renderContextType})}),this.onSelectedTaskAssigneeUpdated=e=>{o.b()?O.y({trackback:593826204,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,selectedAssignee:e}):Object(f.i)().assertConditionTag(!1,"Selected Task Assignee Updated action type is not supported",593826205)},this.getPostOrHistoryRecordStates=Object(s.b)(E.c,()=>[this.props.dataItems,this.props.threadPostStates,this.props.historyRecordViewStates]),this.onMentionCreated=this.onMentionCreated.bind(this),this.onMentioneesStillInDraftUpdated=this.onMentioneesStillInDraftUpdated.bind(this),this.getAuthToken=this.getAuthToken.bind(this),this.commentPostCallbackProps={onDelete:this.onPostDelete,onEdit:this.onPostEdit,onCommit:this.onPostCommit,onCancel:this.onPostCancel,onSelect:this.onRenderableItemSelect,onDraftEmptinessChanged:this.onPostDraftEmptinessChanged,onSaveDraft:this.onPostSaveDraft,onLowFidelityWarningConfirm:this.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:this.onLowFidelityWarningCancel,onPostMounted:this.onPostMounted,onPostEditorMounted:this.onPostEditorMounted,onError:this.onPostError,onClearError:this.onClearPostError,commentEditorAdditionalKeyDownHandler:this.commentEditorOnKeyDown,onCollapseParent:this.onPostCollapse,onFocusParent:this.onPostFocusParent,onReactionUpdated:this.onPostReactionUpdated,onPresentLinkToComment:this.onPresentLinkToComment},this.commentCardCallbackProps={onEditorPress:this.cardOnBeginReplyCallback,onCardCollapse:this.cardOnCollapseCallback,onCardSelect:this.cardOnSelectCallback,onCardSelectExpand:this.cardOnSelectExpandCallback,onCardFocus:this.cardOnFocusCallback,onCardHighlightChange:this.cardOnHighlight,onDraftingInputSizeChange:this.cardOnDraftingInputSizeChange,onDraftEmptinessChanged:this.cardOnDraftEmptinessChanged,onEditorBlur:this.cardOnEditorFocusLost,onCancel:this.cardOnCancel,onPost:this.cardOnPost,onSaveDraft:this.cardOnSaveDraft,onSelectedTaskAssigneeUpdated:this.onSelectedTaskAssigneeUpdated,onCardMounted:this.onCardMounted,onCardEditorMounted:this.onCardEditorMounted,onCardRendered:this.onCardRendered,onLowFidelityWarningConfirm:this.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:this.onLowFidelityWarningCancel,onTaskTopperCheckboxPressed:this.cardOnTaskTopperCheckboxPressed,commentEditorAdditionalKeyDownHandler:this.commentEditorOnKeyDown,onReactionUpdated:this.onPostReactionUpdated,onEditRootPost:this.onPostEdit},this.contextualMenuCallbackProps={onReopenThread:this.cardOnReopenThread,onResolveThread:this.cardOnResolveThread,onDeleteThread:this.cardOnDelete,onEditRootPost:this.onPostEdit,onPresentLinkToComment:this.onPresentLinkToComment},this.renderableItemActionBarItems=x.d(this.props.localizationAPI,this.commentPostCallbackProps),this.cardContextMenuItems=x.b(this.props.localizationAPI,this.contextualMenuCallbackProps),this.commentContentsKeyDownHandler=this.props.focusManager.commentContentsKeyDown(()=>this.props.componentTree,o.b()?()=>this.props.dataItems:void 0),this.commentEditorKeyDownHandler=this.props.focusManager.commentEditorKeyDown(()=>this.props.componentTree)}focus(){this.props.focusManager.focusCommentCardCommand(this.props.componentTree,this.props.threadId),this.props.selectComment(this.props.componentTree,{renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:590205772,telemetryVisitor:this.props.telemetryVisitor},{selectedCard:this.props.threadId,selectType:b.b.ExpandCard,source:C.a.Canvas},!1).catch(Object(g.a)(590104656))}getInstanceId(){return this.props.componentInstanceId}shouldComponentUpdate(e,t){return w.havePropsMeaningfullyChanged(e,this.props)}updateDraftRenderLockIfApplicable(e){const t=Object(y.K)(this.props.draftState);t&&t.threadId===this.props.threadId&&this.props.updateRenderLockForDraft({renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:593826137,telemetryVisitor:this.props.telemetryVisitor},e,t.commentDraft.sessionConfiguration.draftId)}componentDidMount(){var e,t,n,r;null===(t=(e=this.props).componentRef)||void 0===t||t.call(e,this),null===(r=(n=this.props).setComponentRef)||void 0===r||r.call(n,this.props.componentInstanceId,this),this.updateDraftRenderLockIfApplicable(!0)}componentWillUnmount(){var e,t;null===(t=(e=this.props).setComponentRef)||void 0===t||t.call(e,this.props.componentInstanceId,null)}componentDidUpdate(e,t){if(this.props.draftState!==e.draftState){const t=Object(y.K)(e.draftState),n=Object(y.K)(this.props.draftState);!n||n.renderContextType===this.props.componentTree.componentTreeId.renderContextType||void 0!==t&&t.renderContextType===n.renderContextType||this.updateDraftRenderLockIfApplicable(!0)}this.props.focusManager.discreteCommentCardPropsUpdated(this.props.componentTree,e,this.props)}static havePropsMeaningfullyChanged(e,t){const n=Object.keys(e),r=Object.keys(t);return n.length!==r.length||n.some(n=>{if(t[n]===e[n])return!1;if("dataItems"===n){if(t.dataItems.length!==e.dataItems.length)return!0;for(let n=0;n<t.dataItems.length;n++){const r=t.dataItems[n],o=e.dataItems[n];if(Object(D.a)(r)&&Object(D.a)(o)&&r.commentModel!==o.commentModel||!!r.historyItem!=!!o.historyItem)return!0}return!1}return"object"!=typeof t[n]||!function(e,t){if(!e&&t||e&&!t)return!1;if(!e&&!t)return!0;const n=Object.keys(e),r=Object.keys(t);return n.length===r.length&&n.every(n=>e[n]===t[n])}(t[n],e[n])})}getAuthToken(){return this.props.peopleAPI.getAuthToken(h.c.Loki)}getRenderableItemFromRef(e){const t=e.getId();return this.props.dataItems.find(e=>R.f(e)===t)}shouldCheckForLowFidelityOnCardDelete(){return!1}getKeyboardingOptions(){return{cardTabbingMode:I.a.ExpandedCardOrFirstCardTabbable,postTabbingMode:I.b.ExpandedCardRootPostTabbable}}onMentionCreated(e){O.t({failTag:593826199,successTag:593826200,person:e,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:593826201})}onMentioneesStillInDraftUpdated(e){O.u({trackback:593826203,emailsStillInDraft:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})}renderThread(e){return e}onQueueLoadThread(){this.props.modelCapabilities.virtualized&&!this.props.isDraftThread&&this.props.queueLoadThread({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:573145492})}render(){var e,t;this.onQueueLoadThread();const n=this.getMentionableCommentEditorProps(this.props.modelCapabilities.atMention,this.props.suggestionsDetails),r=void 0!==this.props.cardRelativeDraftingState,o=r||this.props.readOnly?v.a.None:v.a.Any,i=this.props.dataItems.length>1,a=E.e({thread:this.props.dataItems,renderContextType:this.props.componentTree.componentTreeId.renderContextType,cardState:this.props.cardState,postCallbacks:this.commentPostCallbackProps,mentionableEditorProps:n,cardCallbacks:this.commentCardCallbackProps,localizationAPI:this.props.localizationAPI,getActionBarItems:this.getRenderableItemActionBarItems,selectedState:this.props.selectedState,isolationEdit:this.props.componentTree.componentTreeId.renderContextType===S.a.HalfPane,isAtMentionEnabled:this.props.modelCapabilities.atMention===m.b.Enabled,areTasksEnabled:Object(y.c)(this.props.modelCapabilities),isDraftThread:this.props.isDraftThread,isCommentsContextReadOnly:this.props.readOnly,keyboardingOptions:this.getKeyboardingOptions(),personaIconPropertiesMap:this.props.personaIconPropertiesMap,draftState:this.props.draftState,cardCollapsedState:this.props.cardCollapsedState,cardRelativeDraftingState:this.props.cardRelativeDraftingState,accessibilitySetSize:this.props.accessibilitySetSize,accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetLevel:this.props.accessibilitySetLevel,maximumDimensions:this.props.maximumDimensions,getCardContextualMenuItems:this.getCardContextualMenuItems,mentionEditorProps:n,restrictActionControls_deprecated:r,allowedDraftingSession:o,availableScreenHeight:void 0,contentBackgroundColor:i?"CardReplyBackground":"CardBackground",extraPaddingLeft:void 0,extraPaddingRight:void 0,preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),isCardHighlighted:this.props.isHighlighted,maxDraftHeight:void 0,taskState:this.props.threadTaskState,cardStyle:void 0,onCardLayout:void 0,isCardTabbable:E.b(this.getKeyboardingOptions().cardTabbingMode,this.props.threadId,this.props.firstCardInCurrentContext,this.props.cardCollapsedState,this.props.selectedState),postOrHistoryRecordStates:this.getPostOrHistoryRecordStates(),richTextCapabilities:this.props.modelCapabilities.richTextCapabilities,isUIAAnnotationPatternEnabled:this.props.modelCapabilities.UIAAnnotationPattern,isResolveSupported:this.props.modelCapabilities.resolve,tabFocusTrapBehavior:null===(t=null===(e=this.props)||void 0===e?void 0:e.accessibilityMetadata)||void 0===t?void 0:t.tabFocusTrapBehavior});return d.createElement(k.a.Provider,{value:this.props.lppManager},d.createElement(P.a.Provider,{value:this.props.componentTree.componentTreeId},this.renderThread(a)))}}var A=n(12);const j=e=>Object(A.e)({width:null==e?void 0:e.width});var _=n(39),F=n(90),M=n(18);var N=n(131),L=n(144);const B=Object(r.connect)(()=>{let e;const t=a.e(),n=a.c(),r=a.n(e=>i.g(e,!0),e=>i.i(e,!0),t,n),s=a.h(r),c=a.m(r),d=a.k(),l=a.i(),u=a.b(),p=a.a(),h=a.l(),f=a.j(r,h),m=a.f(h);return(t,n)=>{if(n.isVirtualized&&e)return e;const a=r(t,n),g=o.b()?h(t,n):void 0,b=a.thread[0].commentId;return e={threadId:b,dataItems:f(t,n),threadTaskState:g&&g.currentState,threadPostStates:c(t,n),historyRecordViewStates:m(t,n),selectedState:d(t,n),cardCollapsedState:Object(N.a)(b,i.j(t),n.componentTree.componentTreeId.renderContextType),readOnly:i.m(t),cardState:u(t,n),isHighlighted:l(t,n),personaIconPropertiesMap:i.p(t),isDraftThread:a.isDraftThread,draftState:i.h(t),firstCardInCurrentContext:s(t,n),cardRelativeDraftingState:p(t,n),modelCapabilities:i.n(t),suggestionsDetails:i.u(t)},e}},L.a)(class extends w{constructor(e){super(e),this.setViewTreeRoot=e=>{if(this.props.componentTree.setViewTreeRootHelper(e,this.props.resource.id),e){const t=e.getInnerRef();t.current&&this.props.focusManager.discreteCommentCardRootRefMounted(t)}},this.onRootViewKeyDown=e=>{this.props.componentTree.onKeyDownTabHandlerHelper(this.props.resource.id,e).wasHandled||this.commentContentsKeyDownHandler.onKeyDown(e)},this.getContentsPreventDefaultKeyDownBehavior=Object(s.b)(c.i,()=>[this.commentContentsKeyDownHandler.getKeyDownEvents(),!0]),this.getRootViewKeyDownEvents=Object(s.a)(()=>Object(c.j)({useJSTabLoop:!0,handleKeysDuringBubbling:!0})),this.getMemoizedDiscreteCommentCardStyle=Object(s.b)(j,()=>[this.props.maximumDimensions]),this.componentTree=this.props.componentTree}componentDidUpdate(e,t){this.props.resource.id!==e.resource.id&&this.props.componentTree.updateIdForViewTree(e.resource.id,this.props.resource.id),super.componentDidUpdate(e,t)}shouldCheckForLowFidelityOnCardDelete(){return!0}renderThread(e){return d.createElement(F.a,{nodeId:Object(_.a)({componentType:M.a.DiscreteHostedCommentRoot,id:this.props.resource.id,renderContextType:this.props.componentTree.componentTreeId.renderContextType}),style:this.getMemoizedDiscreteCommentCardStyle(),ref:this.setViewTreeRoot,onKeyDown:this.onRootViewKeyDown,keyDownEvents:this.getRootViewKeyDownEvents()},e)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(1),n(158);var r=n(125);var o=function(){function e(t){for(var n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];if(this.themeData=void 0,this.listeners=[],this.parentRef=void 0,this.listeners=[],this.recipes=r,this.parentRef=t instanceof e?t:void 0,this.parentRef){var i=function(){n.invalidate()};this.parentRef.addOnThemeChanged(i)}this.getParent=function(){return n.parentRef?n.parentRef.theme:t}}return Object.defineProperty(e.prototype,"theme",{get:function(){if(!this.themeData){for(var e=this.getParent(),t=0,n=this.recipes;t<n.length;t++){var o=n[t];i=e,a="function"==typeof o?o(e):o,e=Object(r.a)(i,a)}this.themeData=e}var i,a;return this.themeData},enumerable:!1,configurable:!0}),e.prototype.addOnThemeChanged=function(e){this.listeners.push(e)},e.prototype.removeOnThemeChanged=function(e){this.listeners=this.listeners.filter((function(t){return t!==e}))},e.prototype.invalidate=function(){this.themeData=void 0;for(var e=0,t=this.listeners;e<t.length;e++){(0,t[e])()}},e.prototype.update=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.recipes=e||[],this.invalidate()},e}()},function(e,t,n){"use strict";var r=n(203);var o=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var i=function(e){return this.__data__.has(e)};function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r.a;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=o,a.prototype.has=i;t.a=a},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(11);class o{constructor(e){const{eventPhase:t,altKey:n,shiftKey:o,ctrlKey:i,metaKey:a}=e.nativeEvent;this.eventPhase=t,this.altKey=n,this.shiftKey=o,this.ctrlKey=i,this.metaKey=a,this.key=Object(r.q)(e.nativeEvent.key),this.target=e.target}isEventTarget(e){return e===this.target}preventDefault(){}stopPropagation(){}}function i(e){return new o(e)}function a(){return{nativeEvent:void 0,currentTarget:void 0,target:void 0,bubbles:!1,cancelable:!1,defaultPrevented:!1,eventPhase:0,isTrusted:!1,preventDefault:()=>{},isDefaultPrevented:()=>!1,stopPropagation:()=>{},isPropagationStopped:()=>!1,persist:()=>{},timeStamp:Date.now(),type:""}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r={children:!0,accessible:!0,accessibilityActions:!0,accessibilityAnnotation:!0,accessibilityControls:!0,accessibilityDescription:!0,accessibilityDescribedBy:!0,accessibilityItemType:!0,accessibilityLabel:!0,accessibilityLabeledBy:!0,accessibilityLevel:!0,accessibilityPositionInSet:!0,accessibilityRole:!0,accessibilitySetSize:!0,accessibilityState:!0,accessibilityHint:!0,accessibilityValue:!0,animationClass:!0,cursor:!0,enableFocusRing:!0,hitSlop:!0,onLayout:!0,pointerEvents:!0,removeClippedSubviews:!0,style:!0,testID:!0,nativeID:!0,keyDownEvents:!0,keyUpEvents:!0,onBlur:!0,onBlurCapture:!0,onFocus:!0,onFocusCapture:!0,onKeyDown:!0,onKeyDownCapture:!0,onKeyUp:!0,onKeyUpCapture:!0,onMouseEnter:!0,onMouseLeave:!0,onStartShouldSetResponder:!0,onStartShouldSetResponderCapture:!0,onMoveShouldSetResponder:!0,onMoveShouldSetResponderCapture:!0,onResponderEnd:!0,onResponderGrant:!0,onResponderMove:!0,onResponderReject:!0,onAccessibilityAction:!0,onAccessibilityTap:!0,onResponderRelease:!0,onResponderStart:!0,onResponderTerminate:!0,onResponderTerminationRequest:!0,onTouchCancel:!0,onTouchEnd:!0,onTouchEndCapture:!0,onTouchMove:!0,onTouchStart:!0,tooltip:!0,type:!0,focusable:!0},o={children:!0,accessibilityActions:!0,accessibilityControls:!0,accessibilityDescribedBy:!0,accessibilityHint:!0,accessibilityItemType:!0,accessibilityLabel:!0,accessibilityLabeledBy:!0,accessibilityRole:!0,accessibilityState:!0,accessibilityValue:!0,accessible:!0,onAccessibilityAction:!0,onAccessibilityTap:!0,testID:!0,allowFontScaling:!0,ellipsizeMode:!0,lineBreakMode:!0,numberOfLines:!0,keyDownEvents:!0,keyUpEvents:!0,onKeyDown:!0,onKeyDownCapture:!0,onKeyUp:!0,onKeyUpCapture:!0,onLayout:!0,onLongPress:!0,onPress:!0,onTextLayout:!0,style:!0,selectable:!0,nativeID:!0,maxFontSizeMultiplier:!0,textStyle:!0,tooltip:!0,focusable:!0,onBlur:!0,onBlurCapture:!0,onFocus:!0,onFocusCapture:!0};function i(e){return r[e]}function a(e){return o[e]}},function(e,t,n){"use strict";var r=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},o=n(163),i=n(75),a=n(200),s=n(174),c=n(226),d=Object.prototype.hasOwnProperty;t.a=function(e,t){var n=Object(i.a)(e),l=!n&&Object(o.a)(e),u=!n&&!l&&Object(a.a)(e),p=!n&&!l&&!u&&Object(c.a)(e),h=n||l||u||p,f=h?r(e.length,String):[],m=f.length;for(var g in e)!t&&!d.call(e,g)||h&&("length"==g||u&&("offset"==g||"parent"==g)||p&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||Object(s.a)(g,m))||f.push(g);return f}},function(e,t,n){"use strict";var r=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i},o=n(286),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),r(a(e),(function(t){return i.call(e,t)})))}:o.a;t.a=s},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(221),o=n(9),i=n(303),a=n(108),s=[{tokens:{variant:"secondaryStandard",color:"bodyText"},root:{style:{margin:0}},_overrides:{disabled:{tokens:{color:"disabledText"}}},_precedence:["disabled"]},"RNFText"],c=Object(r.a)({displayName:"RNFText",settings:s,slots:{root:{slotType:o.Text,filter:i.a}},styles:{root:[a.e,a.c]}})},,,,function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createSubscription=function(e,t){var n,i=o;function a(){c.onStateChange&&c.onStateChange()}function s(){var o,s,c;n||(n=t?t.addNestedSub(a):e.subscribe(a),o=(0,r.getBatch)(),s=null,c=null,i={clear:function(){s=null,c=null},notify:function(){o((function(){for(var e=s;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],t=s;t;)e.push(t),t=t.next;return e},subscribe:function(e){var t=!0,n=c={callback:e,next:null,prev:c};return n.prev?n.prev.next=n:s=n,function(){t&&null!==s&&(t=!1,n.next?n.next.prev=n.prev:c=n.prev,n.prev?n.prev.next=n.next:s=n.next)}}})}var c={addNestedSub:function(e){return s(),i.subscribe(e)},notifyNestedSubs:function(){i.notify()},handleChangeWrapper:a,isSubscribed:function(){return Boolean(n)},trySubscribe:s,tryUnsubscribe:function(){n&&(n(),n=void 0,i.clear(),i=o)},getListeners:function(){return i}};return c};var r=n(324);var o={notify:function(){},get:function(){return[]}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.useIsomorphicLayoutEffect=void 0;var r=n(1).useLayoutEffect;t.useIsomorphicLayoutEffect=r},function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}n.r(t),n.d(t,"default",(function(){return r}))},function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}n.r(t),n.d(t,"default",(function(){return r}))},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){e.exports=n(371)()},function(e,t,n){"use strict";n.r(t);var r=n(294),o=n.n(r),i=n(293),a=n.n(i),s=n(56),c=n.n(s),d=n(101),l=n.n(d),u=n(102),p=n.n(u),h=n(118),f=n.n(h),m=n(161),g=n.n(m),b=n(182),C=n.n(b),y=n(138),v=n.n(y);var T=function(e,t,n){return t<e?e:t>n?n:t},S=n(9),I=function(){function e(t,n){l()(this,e),this._delay=n,this._callback=t}return p()(e,[{key:"dispose",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{abort:!1};this._taskHandle&&(this._taskHandle.cancel(),e.abort||this._callback(),this._taskHandle=null)}},{key:"schedule",value:function(){var e=this;if(!this._taskHandle){var t=setTimeout((function(){e._taskHandle=S.InteractionManager.runAfterInteractions((function(){e._taskHandle=null,e._callback()}))}),this._delay);this._taskHandle={cancel:function(){return clearTimeout(t)}}}}}]),e}();var O=function(){},E=n(126),P=n.n(E),k=n(47),R=n.n(k),x=function(){function e(t){l()(this,e),R()(t>=0,"CellRenderMask must contain a non-negative number os cells"),this._numCells=t,this._regions=0===t?[]:[{first:0,last:t-1,isSpacer:!0}]}return p()(e,[{key:"enumerateRegions",value:function(){return this._regions}},{key:"addCells",value:function(e){var t;R()(e.first>=0&&e.first<this._numCells&&e.last>=0&&e.last<this._numCells&&e.last>=e.first,"CellRenderMask.addCells called with invalid cell range");var n=this._findRegion(e.first),r=P()(n,2),i=r[0],a=r[1],s=this._findRegion(e.last),d=P()(s,2),l=d[0],u=d[1];if(a!==u||i.isSpacer){var p=[],h=[],f=c()({},e,{isSpacer:!1});i.first<f.first&&(i.isSpacer?p.push({first:i.first,last:f.first-1,isSpacer:!0}):f.first=i.first),l.last>f.last&&(l.isSpacer?h.push({first:f.last+1,last:l.last,isSpacer:!0}):f.last=l.last);var m=[].concat(p,[f],h),g=u-a+1;(t=this._regions).splice.apply(t,[a,g].concat(o()(m)))}}},{key:"numCells",value:function(){return this._numCells}},{key:"equals",value:function(e){return this._numCells===e._numCells&&this._regions.length===e._regions.length&&this._regions.every((function(t,n){return t.first===e._regions[n].first&&t.last===e._regions[n].last&&t.isSpacer===e._regions[n].isSpacer}))}},{key:"_findRegion",value:function(e){for(var t=0,n=this._regions.length-1;t<=n;){var r=Math.floor((t+n)/2),o=this._regions[r];if(e>=o.first&&e<=o.last)return[o,r];e<o.first?n=r-1:e>o.last&&(t=r+1)}R()(!1,"A region was not found containing cellIdx "+e)}}]),e}(),D=n(357);function w(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var j=n(47);function _(e,t,n,r,o,i){if(function(e,t,n){return e>=0&&t<=n&&t>e}(n,r,o))return!0;var a=function(e,t,n){var r=Math.min(t,n)-Math.max(e,0);return Math.max(0,r)}(n,r,o);return 100*(e?a/o:a/i)>=t}var F=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{viewAreaCoveragePercentThreshold:0};l()(this,e),this._hasInteracted=!1,this._timers=new Set,this._viewableIndices=[],this._viewableItems=new Map,this._config=t}return p()(e,[{key:"dispose",value:function(){this._timers.forEach(clearTimeout)}},{key:"computeViewableItems",value:function(e,t,n,r,o){var i=this._config,a=i.itemVisiblePercentThreshold,s=i.viewAreaCoveragePercentThreshold,c=null!=s,d=c?s:a;j(null!=d&&null!=a!=(null!=s),"Must set exactly one of itemVisiblePercentThreshold or viewAreaCoveragePercentThreshold");var l=[];if(0===e)return l;var u=-1,p=o||{first:0,last:e-1},h=p.first,f=p.last;if(f>=e)return[];for(var m=h;m<=f;m++){var g=r(m);if(g){var b=g.offset-t,C=b+g.length;if(b<n&&C>0)u=m,_(c,d,b,C,n,g.length)&&l.push(m);else if(u>=0)break}}return l}},{key:"onUpdate",value:function(e,t,n,r,o,i,a){var s=this;if((!this._config.waitForInteraction||this._hasInteracted)&&0!==e&&r(0)){var c=[];if(e&&(c=this.computeViewableItems(e,t,n,r,a)),this._viewableIndices.length!==c.length||!this._viewableIndices.every((function(e,t){return e===c[t]})))if(this._viewableIndices=c,this._config.minimumViewTime){var d=setTimeout((function(){s._timers.delete(d),s._onUpdateSync(c,i,o)}),this._config.minimumViewTime);this._timers.add(d)}else this._onUpdateSync(c,i,o)}}},{key:"resetViewableIndices",value:function(){this._viewableIndices=[]}},{key:"recordInteraction",value:function(){this._hasInteracted=!0}},{key:"_onUpdateSync",value:function(e,t,n){var r=this;e=e.filter((function(e){return r._viewableIndices.includes(e)}));for(var o,i=this._viewableItems,a=new Map(e.map((function(e){var t=n(e,!0);return[t.key,t]}))),s=[],d=w(a);!(o=d()).done;){var l=o.value,u=P()(l,2),p=u[0],h=u[1];i.has(p)||s.push(h)}for(var f,m=w(i);!(f=m()).done;){var g=f.value,b=P()(g,2),C=b[0],y=b[1];a.has(C)||s.push(c()({},y,{isViewable:!1}))}s.length>0&&(this._viewableItems=a,t({viewableItems:Array.from(a.values()),changed:s,viewabilityConfig:this._config}))}}]),e}(),M=n(166),N=n(1),L="D:\\a\\_work\\1\\s\\packages\\experimental-rn-lists\\vendored\\Lists\\VirtualizedListContext.js",B=N.createContext(null);function H(e){var t=e.children,n=e.value,r=Object(N.useMemo)((function(){return{cellKey:null,getScrollMetrics:n.getScrollMetrics,horizontal:n.horizontal,getOutermostParentListRef:n.getOutermostParentListRef,getNestedChildState:n.getNestedChildState,registerAsNestedChild:n.registerAsNestedChild,unregisterAsNestedChild:n.unregisterAsNestedChild,debugInfo:{cellKey:n.debugInfo.cellKey,horizontal:n.debugInfo.horizontal,listKey:n.debugInfo.listKey,parent:n.debugInfo.parent}}}),[n.getScrollMetrics,n.horizontal,n.getOutermostParentListRef,n.getNestedChildState,n.registerAsNestedChild,n.unregisterAsNestedChild,n.debugInfo.cellKey,n.debugInfo.horizontal,n.debugInfo.listKey,n.debugInfo.parent]);return N.createElement(B.Provider,{value:r,__self:this,__source:{fileName:L,lineNumber:119,columnNumber:10}},t)}function U(e){var t=e.cellKey,n=e.children,r=Object(N.useContext)(B);return N.createElement(B.Provider,{value:null==r?null:c()({},r,{cellKey:t}),__self:this,__source:{fileName:L,lineNumber:134,columnNumber:5}},n)}var V="D:\\a\\_work\\1\\s\\packages\\experimental-rn-lists\\vendored\\Lists\\VirtualizedList.js";function W(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var o=v()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return C()(this,n)}}var G=!1;function q(e){return null!=e&&e}function $(e){return null!=e?e:10}function Y(e){return null!=e?e:2}function J(e){return null!=e?e:21}var Q=function(e){g()(n,e);var t=K(n);function n(e){var r,o;l()(this,n),(o=t.call(this,e))._getScrollMetrics=function(){return o._scrollMetrics},o._getOutermostParentListRef=function(){return o._isNestedWithSameOrientation()?o.context.getOutermostParentListRef():f()(o)},o._getNestedChildState=function(e){var t=o._nestedChildLists.get(e);return t&&t.state},o._registerAsNestedChild=function(e){var t=o._cellKeysToChildListKeys.get(e.cellKey)||new Set;t.add(e.key),o._cellKeysToChildListKeys.set(e.cellKey,t);var n=o._nestedChildLists.get(e.key);n&&n.ref,o._nestedChildLists.set(e.key,{ref:e.ref,state:null}),o._hasInteracted&&e.ref.recordInteraction()},o._unregisterAsNestedChild=function(e){o._nestedChildLists.set(e.key,{ref:null,state:e.state})},o._onUpdateSeparators=function(e,t){e.forEach((function(e){var n=null!=e&&o._cellRefs[e];n&&n.updateSeparatorProps(t)}))},o._getSpacerKey=function(e){return e?"height":"width"},o._averageCellLength=0,o._cellKeysToChildListKeys=new Map,o._cellRefs={},o._frames={},o._footerLength=0,o._hasDoneInitialScroll=!1,o._hasInteracted=!1,o._hasMore=!1,o._hasWarned={},o._headerLength=0,o._hiPriInProgress=!1,o._highestMeasuredFrameIndex=0,o._indicesToKeys=new Map,o._lastFocusedCellKey=null,o._nestedChildLists=new Map,o._offsetFromParentVirtualizedList=0,o._prevParentOffset=0,o._scrollMetrics={contentLength:0,dOffset:0,dt:10,offset:0,timestamp:0,velocity:0,visibleLength:0},o._scrollRef=null,o._sentEndForContentLength=0,o._totalCellLength=0,o._totalCellsMeasured=0,o._viewabilityTuples=[],o._captureScrollRef=function(e){o._scrollRef=e},o._defaultRenderScrollComponent=function(e){var t,n=e.onRefresh;return o._isNestedWithSameOrientation()?N.createElement(S.View,c()({},e,{__self:f()(o),__source:{fileName:V,lineNumber:1275,columnNumber:14}})):n?(R()("boolean"==typeof e.refreshing,"`refreshing` prop must be set as a boolean in order to use `onRefresh`, but got `"+JSON.stringify(null!=(t=e.refreshing)?t:"undefined")+"`"),N.createElement(S.ScrollView,c()({},e,{refreshControl:null==e.refreshControl?N.createElement(S.RefreshControl,{refreshing:e.refreshing,onRefresh:n,progressViewOffset:e.progressViewOffset,__self:f()(o),__source:{fileName:V,lineNumber:1289,columnNumber:15}}):e.refreshControl,__self:f()(o),__source:{fileName:V,lineNumber:1285,columnNumber:9}}))):N.createElement(S.ScrollView,c()({},e,{__self:f()(o),__source:{fileName:V,lineNumber:1302,columnNumber:14}}))},o._onCellUnmount=function(e){var t=o._frames[e];t&&(o._frames[e]=c()({},t,{inLayout:!1}))},o._onLayout=function(e){o._isNestedWithSameOrientation()?o.measureLayoutRelativeToContainingList():o._scrollMetrics.visibleLength=o._selectLength(e.nativeEvent.layout),o.props.onLayout&&o.props.onLayout(e),o._scheduleCellsToRenderUpdate(),o._maybeCallOnEndReached()},o._onLayoutEmpty=function(e){o.props.onLayout&&o.props.onLayout(e)},o._onLayoutFooter=function(e){o._triggerRemeasureForChildListsInCell(o._getFooterCellKey()),o._footerLength=o._selectLength(e.nativeEvent.layout)},o._onLayoutHeader=function(e){o._headerLength=o._selectLength(e.nativeEvent.layout)},o._onContentSizeChange=function(e,t){e>0&&t>0&&null!=o.props.initialScrollIndex&&o.props.initialScrollIndex>0&&!o._hasDoneInitialScroll&&(null==o.props.contentOffset&&o.scrollToIndex({animated:!1,index:o.props.initialScrollIndex}),o._hasDoneInitialScroll=!0),o.props.onContentSizeChange&&o.props.onContentSizeChange(e,t),o._scrollMetrics.contentLength=o._selectLength({height:t,width:e}),o._scheduleCellsToRenderUpdate(),o._maybeCallOnEndReached()},o._convertParentScrollMetrics=function(e){var t=e.offset-o._offsetFromParentVirtualizedList,n=e.visibleLength,r=t-o._scrollMetrics.offset;return{visibleLength:n,contentLength:o._scrollMetrics.contentLength,offset:t,dOffset:r}},o._onScroll=function(e){o._nestedChildLists.forEach((function(t){t.ref&&t.ref._onScroll(e)})),o.props.onScroll&&o.props.onScroll(e);var t=e.timeStamp,n=o._selectLength(e.nativeEvent.layoutMeasurement),r=o._selectLength(e.nativeEvent.contentSize),i=o._selectOffset(e.nativeEvent.contentOffset),a=i-o._scrollMetrics.offset;if(o._isNestedWithSameOrientation()){if(0===o._scrollMetrics.contentLength)return;var s=o._convertParentScrollMetrics({visibleLength:n,offset:i});n=s.visibleLength,r=s.contentLength,i=s.offset,a=s.dOffset}var c=o._scrollMetrics.timestamp?Math.max(1,t-o._scrollMetrics.timestamp):1,d=a/c;c>500&&o._scrollMetrics.dt>500&&r>5*n&&!o._hasWarned.perf&&(O("VirtualizedList: You have a large list that is slow to update - make sure your renderItem function renders components that follow React performance best practices like PureComponent, shouldComponentUpdate, etc.",{dt:c,prevDt:o._scrollMetrics.dt,contentLength:r}),o._hasWarned.perf=!0),o._scrollMetrics={contentLength:r,dt:c,dOffset:a,offset:i,timestamp:t,velocity:d,visibleLength:n},o._updateViewableItems(o.props.data),o.props&&(o._maybeCallOnEndReached(),0!==d&&o._fillRateHelper.activate(),o._computeBlankness(),o._scheduleCellsToRenderUpdate())},o._onScrollBeginDrag=function(e){o._nestedChildLists.forEach((function(t){t.ref&&t.ref._onScrollBeginDrag(e)})),o._viewabilityTuples.forEach((function(e){e.viewabilityHelper.recordInteraction()})),o._hasInteracted=!0,o.props.onScrollBeginDrag&&o.props.onScrollBeginDrag(e)},o._onScrollEndDrag=function(e){o._nestedChildLists.forEach((function(t){t.ref&&t.ref._onScrollEndDrag(e)}));var t=e.nativeEvent.velocity;t&&(o._scrollMetrics.velocity=o._selectOffset(t)),o._computeBlankness(),o.props.onScrollEndDrag&&o.props.onScrollEndDrag(e)},o._onMomentumScrollBegin=function(e){o._nestedChildLists.forEach((function(t){t.ref&&t.ref._onMomentumScrollBegin(e)})),o.props.onMomentumScrollBegin&&o.props.onMomentumScrollBegin(e)},o._onMomentumScrollEnd=function(e){o._nestedChildLists.forEach((function(t){t.ref&&t.ref._onMomentumScrollEnd(e)})),o._scrollMetrics.velocity=0,o._computeBlankness(),o.props.onMomentumScrollEnd&&o.props.onMomentumScrollEnd(e)},o._updateCellsToRender=function(){o.setState((function(e,t){var r=o._adjustCellsAroundViewport(t,e.cellsAroundViewport),i=n._createRenderMask(t,r,o._getNonViewportRenderRegions());return r.first===e.cellsAroundViewport.first&&r.last===e.cellsAroundViewport.last&&i.equals(e.renderMask)?null:{cellsAroundViewport:r,renderMask:i}}))},o._getNonViewportRenderRegions=function(){if(!o._lastFocusedCellKey||!o._cellRefs[o._lastFocusedCellKey])return[];var e=o._cellRefs[o._lastFocusedCellKey].props.index,t=o.props.getItemCount(o.props.data);if(e>=t||o._indicesToKeys.get(e)!==o._lastFocusedCellKey)return[];for(var n=e,r=0,i=n-1;i>=0&&r<o._scrollMetrics.visibleLength;i--)n--,r+=o._getFrameMetricsApprox(i).length;for(var a=e,s=0,c=a+1;c<t&&s<o._scrollMetrics.visibleLength;c++)a++,s+=o._getFrameMetricsApprox(c).length;return[{first:n,last:a}]},o._createViewToken=function(e,t){var n=o.props,r=n.data,i=(0,n.getItem)(r,e);return{index:e,item:i,key:o._keyExtractor(i,e),isViewable:t}},o._getFrameMetricsApprox=function(e){var t=o._getFrameMetrics(e);if(t&&t.index===e)return t;var n=o.props,r=n.data,i=n.getItemCount,a=n.getItemLayout;return R()(e>=0&&e<i(r),"Tried to get frame for out of range index "+e),R()(!a,"Should not have to estimate frames when a measurement metrics function is provided"),{length:o._averageCellLength,offset:o._averageCellLength*e}},o._getFrameMetrics=function(e){var t=o.props,n=t.data,r=t.getItem,i=t.getItemCount,a=t.getItemLayout;R()(e>=0&&e<i(n),"Tried to get frame for out of range index "+e);var s=r(n,e),c=s&&o._frames[o._keyExtractor(s,e)];return c&&c.index===e||a&&(c=a(n,e)),c},R()(!e.onScroll||!e.onScroll.__isNative,"Components based on VirtualizedList must be wrapped with Animated.createAnimatedComponent to support native onScroll events with useNativeDriver"),R()(J(e.windowSize)>0,"VirtualizedList: The windowSize prop must be present and set to a value greater than 0."),R()(e.getItemCount,'VirtualizedList: The "getItemCount" prop must be provided'),o._fillRateHelper=new D.a(o._getFrameMetrics),o._updateCellsToRenderBatcher=new I(o._updateCellsToRender,null!=(r=o.props.updateCellsBatchingPeriod)?r:50),o.props.viewabilityConfigCallbackPairs?o._viewabilityTuples=o.props.viewabilityConfigCallbackPairs.map((function(e){return{viewabilityHelper:new F(e.viewabilityConfig),onViewableItemsChanged:e.onViewableItemsChanged}})):o.props.onViewableItemsChanged&&o._viewabilityTuples.push({viewabilityHelper:new F(o.props.viewabilityConfig),onViewableItemsChanged:o.props.onViewableItemsChanged});var i=n._initialRenderRegion(e),a={cellsAroundViewport:i,renderMask:n._createRenderMask(e,i)};if(o._isNestedWithSameOrientation()){var s=o.context.getNestedChildState(o._getListKey());s&&(a=s,o.state=s,o._frames=s.frames)}return o.state=a,o}return p()(n,[{key:"scrollToEnd",value:function(e){var t=!e||e.animated,n=this.props.getItemCount(this.props.data)-1,r=this._getFrameMetricsApprox(n),o=Math.max(0,r.offset+r.length+this._footerLength-this._scrollMetrics.visibleLength);null!=this._scrollRef&&null!=this._scrollRef.scrollTo&&this._scrollRef.scrollTo(q(this.props.horizontal)?{x:o,animated:t}:{y:o,animated:t})}},{key:"scrollToIndex",value:function(e){var t=this.props,n=t.data,r=t.horizontal,o=t.getItemCount,i=t.getItemLayout,a=t.onScrollToIndexFailed,s=e.animated,c=e.index,d=e.viewOffset,l=e.viewPosition;if(R()(c>=0,"scrollToIndex out of range: requested index "+c+" but minimum is 0"),R()(o(n)>=1,"scrollToIndex out of range: item length "+o(n)+" but minimum is 1"),R()(c<o(n),"scrollToIndex out of range: requested index "+c+" is out of 0 to "+(o(n)-1)),!i&&c>this._highestMeasuredFrameIndex)return R()(!!a,"scrollToIndex should be used in conjunction with getItemLayout or onScrollToIndexFailed, otherwise there is no way to know the location of offscreen indices or handle failures."),void a({averageItemLength:this._averageCellLength,highestMeasuredFrameIndex:this._highestMeasuredFrameIndex,index:c});var u=this._getFrameMetricsApprox(c),p=Math.max(0,u.offset-(l||0)*(this._scrollMetrics.visibleLength-u.length))-(d||0);null!=this._scrollRef&&null!=this._scrollRef.scrollTo&&this._scrollRef.scrollTo(r?{x:p,animated:s}:{y:p,animated:s})}},{key:"scrollToItem",value:function(e){for(var t=e.item,n=this.props,r=n.data,o=n.getItem,i=(0,n.getItemCount)(r),a=0;a<i;a++)if(o(r,a)===t){this.scrollToIndex(c()({},e,{index:a}));break}}},{key:"scrollToOffset",value:function(e){var t=e.animated,n=e.offset;null!=this._scrollRef&&null!=this._scrollRef.scrollTo&&this._scrollRef.scrollTo(q(this.props.horizontal)?{x:n,animated:t}:{y:n,animated:t})}},{key:"recordInteraction",value:function(){this._nestedChildLists.forEach((function(e){e.ref&&e.ref.recordInteraction()})),this._viewabilityTuples.forEach((function(e){e.viewabilityHelper.recordInteraction()})),this._updateViewableItems(this.props.data)}},{key:"flashScrollIndicators",value:function(){null!=this._scrollRef&&this._scrollRef.flashScrollIndicators()}},{key:"getScrollResponder",value:function(){if(this._scrollRef&&this._scrollRef.getScrollResponder)return this._scrollRef.getScrollResponder()}},{key:"getScrollableNode",value:function(){return this._scrollRef&&this._scrollRef.getScrollableNode?this._scrollRef.getScrollableNode():Object(S.findNodeHandle)(this._scrollRef)}},{key:"getScrollRef",value:function(){return this._scrollRef&&this._scrollRef.getScrollRef?this._scrollRef.getScrollRef():this._scrollRef}},{key:"setNativeProps",value:function(e){this._scrollRef&&this._scrollRef.setNativeProps(e)}},{key:"_getCellKey",value:function(){var e;return(null==(e=this.context)?void 0:e.cellKey)||"rootList"}},{key:"_getListKey",value:function(){return this.props.listKey||this._getCellKey()}},{key:"_getDebugInfo",value:function(){var e;return{listKey:this._getListKey(),cellKey:this._getCellKey(),horizontal:q(this.props.horizontal),parent:null==(e=this.context)?void 0:e.debugInfo}}},{key:"hasMore",value:function(){return this._hasMore}},{key:"_adjustCellsAroundViewport",value:function(e,t){var n=e.data,r=e.getItemCount,o=Y(e.onEndReachedThreshold);this._updateViewableItems(n);var i,a=this._scrollMetrics,s=a.contentLength,c=a.offset,d=a.visibleLength;if(d<=0||s<=0)return t;if(this._isVirtualizationDisabled()){var l=s-d-c<o*d?$(e.maxToRenderPerBatch):0;i={first:0,last:Math.min(this.state.cellsAroundViewport.last+l,r(n)-1)}}else{if(this.props.initialScrollIndex&&!this._scrollMetrics.offset)return t;i=Object(M.a)(e.data,e.getItemCount,$(e.maxToRenderPerBatch),J(e.windowSize),t,this._getFrameMetricsApprox,this._scrollMetrics)}if(this._nestedChildLists.size>0){var u=this._findFirstChildWithMore(i.first,i.last);i.last=null!=u?u:i.last}return i}},{key:"_findFirstChildWithMore",value:function(e,t){for(var n=e;n<=t;n++){var r=this._indicesToKeys.get(n),o=r&&this._cellKeysToChildListKeys.get(r);if(o)for(var i,a=W(o);!(i=a()).done;){var s=i.value,c=this._nestedChildLists.get(s);if(c&&c.ref&&c.ref.hasMore())return n}}return null}},{key:"componentDidMount",value:function(){this._isNestedWithSameOrientation()&&this.context.registerAsNestedChild({cellKey:this._getCellKey(),key:this._getListKey(),ref:this,parentDebugInfo:this.context.debugInfo})}},{key:"componentWillUnmount",value:function(){this._isNestedWithSameOrientation()&&this.context.unregisterAsNestedChild({key:this._getListKey(),state:c()({},this.state,{frames:this._frames})}),this._updateViewableItems(null),this._updateCellsToRenderBatcher.dispose({abort:!0}),this._viewabilityTuples.forEach((function(e){e.viewabilityHelper.dispose()})),this._fillRateHelper.deactivateAndFlush()}},{key:"_pushCells",value:function(e,t,n,r,o,i){var a,s=this,c=this.props,d=c.CellRendererComponent,l=c.ItemSeparatorComponent,u=c.data,p=c.getItem,h=c.getItemCount,f=c.horizontal,m=this.props.ListHeaderComponent?1:0,g=h(u)-1;o=Math.min(g,o);for(var b=function(r){var o=p(u,r),c=s._keyExtractor(o,r);s._indicesToKeys.set(r,c),n.has(r+m)&&t.push(e.length),e.push(N.createElement(X,{CellRendererComponent:d,ItemSeparatorComponent:r<g?l:void 0,cellKey:c,fillRateHelper:s._fillRateHelper,horizontal:f,index:r,inversionStyle:i,item:o,key:c,prevCellKey:a,onUpdateSeparators:s._onUpdateSeparators,onLayout:function(e){return s._onCellLayout(e,c,r)},onFocusCapture:function(e){return s._onCellFocusCapture(c)},onUnmount:s._onCellUnmount,parentProps:s.props,ref:function(e){s._cellRefs[c]=e},__self:s,__source:{fileName:V,lineNumber:905,columnNumber:9}})),a=c},C=r;C<=o;C++)b(C)}},{key:"_isVirtualizationDisabled",value:function(){return this.props.disableVirtualization||!1}},{key:"_isNestedWithSameOrientation",value:function(){var e=this.context;return!(!e||!!e.horizontal!==q(this.props.horizontal))}},{key:"_keyExtractor",value:function(e,t){if(null!=this.props.keyExtractor)return this.props.keyExtractor(e,t);var n=Object(M.b)(e,t);return n===String(t)&&(G=!0,e.type&&e.type.displayName&&e.type.displayName),n}},{key:"render",value:function(){var e=this,t=this.props,n=t.ListEmptyComponent,r=t.ListFooterComponent,o=t.ListHeaderComponent,i=this.props,s=i.data,d=i.horizontal,l=this.props.inverted?q(this.props.horizontal)?Z.horizontallyInverted:Z.verticallyInverted:null,u=[],p=new Set(this.props.stickyHeaderIndices),h=[];if(o){p.has(0)&&h.push(0);var f=N.isValidElement(o)?o:N.createElement(o,{__self:this,__source:{fileName:V,lineNumber:1006,columnNumber:9}});u.push(N.createElement(U,{cellKey:this._getCellKey()+"-header",key:"$header",__self:this,__source:{fileName:V,lineNumber:1009,columnNumber:9}},N.createElement(S.View,{onLayout:this._onLayoutHeader,style:S.StyleSheet.compose(l,this.props.ListHeaderComponentStyle),__self:this,__source:{fileName:V,lineNumber:1010,columnNumber:11}},f)))}var m=this.props.getItemCount(s);if(0===m&&n){var g=N.isValidElement(n)?n:N.createElement(n,{__self:this,__source:{fileName:V,lineNumber:1030,columnNumber:9}});u.push(N.cloneElement(g,{key:"$empty",onLayout:function(t){e._onLayoutEmpty(t),g.props.onLayout&&g.props.onLayout(t)},style:S.StyleSheet.compose(l,g.props.style)}))}if(m>0){G=!1,"";for(var b,C=this._getSpacerKey(!d),y=this.state.renderMask.enumerateRegions(),v=function(e,t){for(var n=e.length-1;n>=0;n--)if(t(e[n]))return e[n];return null}(y,(function(e){return e.isSpacer})),I=W(y);!(b=I()).done;){var O=b.value;if(O.isSpacer){if(this._isVirtualizationDisabled())continue;var E=O===v&&!this.props.getItemLayout?T(O.first-1,O.last,this._highestMeasuredFrameIndex):O.last,P=this._getFrameMetricsApprox(O.first),k=this._getFrameMetricsApprox(E),R=k.offset+k.length-P.offset;u.push(N.createElement(S.View,{key:"$spacer-"+O.first,style:a()({},C,R),__self:this,__source:{fileName:V,lineNumber:1075,columnNumber:22}}))}else this._pushCells(u,h,p,O.first,O.last,l)}!this._hasWarned.keys&&G&&(this._hasWarned.keys=!0)}if(r){var x=N.isValidElement(r)?r:N.createElement(r,{__self:this,__source:{fileName:V,lineNumber:1105,columnNumber:9}});u.push(N.createElement(U,{cellKey:this._getFooterCellKey(),key:"$footer",__self:this,__source:{fileName:V,lineNumber:1108,columnNumber:9}},N.createElement(S.View,{onLayout:this._onLayoutFooter,style:S.StyleSheet.compose(l,this.props.ListFooterComponentStyle),__self:this,__source:{fileName:V,lineNumber:1109,columnNumber:11}},x)))}var D,w=c()({},this.props,{onContentSizeChange:this._onContentSizeChange,onLayout:this._onLayout,onScroll:this._onScroll,onScrollBeginDrag:this._onScrollBeginDrag,onScrollEndDrag:this._onScrollEndDrag,onMomentumScrollBegin:this._onMomentumScrollBegin,onMomentumScrollEnd:this._onMomentumScrollEnd,scrollEventThrottle:(D=this.props.scrollEventThrottle,null!=D?D:50),invertStickyHeaders:void 0!==this.props.invertStickyHeaders?this.props.invertStickyHeaders:this.props.inverted,stickyHeaderIndices:h,style:l?[l,this.props.style]:this.props.style});this._hasMore=this.state.cellsAroundViewport.last<m-1;var A=N.createElement(H,{value:{cellKey:null,getScrollMetrics:this._getScrollMetrics,horizontal:q(this.props.horizontal),getOutermostParentListRef:this._getOutermostParentListRef,getNestedChildState:this._getNestedChildState,registerAsNestedChild:this._registerAsNestedChild,unregisterAsNestedChild:this._unregisterAsNestedChild,debugInfo:this._getDebugInfo()},__self:this,__source:{fileName:V,lineNumber:1141,columnNumber:7}},N.cloneElement((this.props.renderScrollComponent||this._defaultRenderScrollComponent)(w),{ref:this._captureScrollRef},u));return this.props.debug?N.createElement(S.View,{style:Z.debug,__self:this,__source:{fileName:V,lineNumber:1187,columnNumber:9}},A,this._renderDebugOverlay()):A}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.data,r=t.extraData;n===e.data&&r===e.extraData||this._viewabilityTuples.forEach((function(e){e.viewabilityHelper.resetViewableIndices()}));var o=this._hiPriInProgress;this._scheduleCellsToRenderUpdate(),o&&(this._hiPriInProgress=!1)}},{key:"_computeBlankness",value:function(){this._fillRateHelper.computeBlankness(this.props,this.state.cellsAroundViewport,this._scrollMetrics)}},{key:"_onCellLayout",value:function(e,t,n){var r=e.nativeEvent.layout,o={offset:this._selectOffset(r),length:this._selectLength(r),index:n,inLayout:!0},i=this._frames[t];i&&o.offset===i.offset&&o.length===i.length&&n===i.index?this._frames[t].inLayout=!0:(this._totalCellLength+=o.length-(i?i.length:0),this._totalCellsMeasured+=i?0:1,this._averageCellLength=this._totalCellLength/this._totalCellsMeasured,this._frames[t]=o,this._highestMeasuredFrameIndex=Math.max(this._highestMeasuredFrameIndex,n),this._scheduleCellsToRenderUpdate()),this._triggerRemeasureForChildListsInCell(t),this._computeBlankness(),this._updateViewableItems(this.props.data)}},{key:"_onCellFocusCapture",value:function(e){this._lastFocusedCellKey=e;var t=n._createRenderMask(this.props,this.state.cellsAroundViewport,this._getNonViewportRenderRegions());t.equals(this.state.renderMask)||this.setState(c()({},this.state,{renderMask:t}))}},{key:"_triggerRemeasureForChildListsInCell",value:function(e){var t=this._cellKeysToChildListKeys.get(e);if(t)for(var n,r=W(t);!(n=r()).done;){var o=n.value,i=this._nestedChildLists.get(o);i&&i.ref&&i.ref.measureLayoutRelativeToContainingList()}}},{key:"measureLayoutRelativeToContainingList",value:function(){var e=this;try{if(!this._scrollRef)return;this._scrollRef.measureLayout(this.context.getOutermostParentListRef().getScrollRef(),(function(t,n,r,o){e._offsetFromParentVirtualizedList=e._selectOffset({x:t,y:n}),e._scrollMetrics.contentLength=e._selectLength({width:r,height:o});var i=e._convertParentScrollMetrics(e.context.getScrollMetrics());(e._scrollMetrics.visibleLength!==i.visibleLength||e._scrollMetrics.offset!==i.offset)&&(e._scrollMetrics.visibleLength=i.visibleLength,e._scrollMetrics.offset=i.offset,e._cellKeysToChildListKeys.forEach((function(t){if(t)for(var n,r=W(t);!(n=r()).done;){var o=n.value,i=e._nestedChildLists.get(o);i&&i.ref&&i.ref.measureLayoutRelativeToContainingList()}})))}),(function(e){}))}catch(e){}}},{key:"_getFooterCellKey",value:function(){return this._getCellKey()+"-footer"}},{key:"_renderDebugOverlay",value:function(){for(var e=this,t=this._scrollMetrics.visibleLength/(this._scrollMetrics.contentLength||1),n=[],r=this.props.getItemCount(this.props.data),o=0;o<r;o++){var i=this._getFrameMetricsApprox(o);i.inLayout&&n.push(i)}var a=this._getFrameMetricsApprox(this.state.cellsAroundViewport.first).offset,s=this._getFrameMetricsApprox(this.state.cellsAroundViewport.last),c=s.offset+s.length-a,d=this._scrollMetrics.offset,l=this._scrollMetrics.visibleLength;return N.createElement(S.View,{style:[Z.debugOverlayBase,Z.debugOverlay],__self:this,__source:{fileName:V,lineNumber:1463,columnNumber:7}},n.map((function(n,r){return N.createElement(S.View,{key:"f"+r,style:[Z.debugOverlayBase,Z.debugOverlayFrame,{top:n.offset*t,height:n.length*t}],__self:e,__source:{fileName:V,lineNumber:1465,columnNumber:11}})})),N.createElement(S.View,{style:[Z.debugOverlayBase,Z.debugOverlayFrameLast,{top:a*t,height:c*t}],__self:this,__source:{fileName:V,lineNumber:1477,columnNumber:9}}),N.createElement(S.View,{style:[Z.debugOverlayBase,Z.debugOverlayFrameVis,{top:d*t,height:l*t}],__self:this,__source:{fileName:V,lineNumber:1487,columnNumber:9}}))}},{key:"_selectLength",value:function(e){return q(this.props.horizontal)?e.width:e.height}},{key:"_selectOffset",value:function(e){return q(this.props.horizontal)?e.x:e.y}},{key:"_maybeCallOnEndReached",value:function(){var e=this.props,t=e.data,n=e.getItemCount,r=e.onEndReached,o=e.onEndReachedThreshold,i=this._scrollMetrics,a=i.contentLength,s=i.visibleLength,c=a-s-i.offset,d=null!=o?o*s:2;r&&this.state.cellsAroundViewport.last===n(t)-1&&c<d&&this._scrollMetrics.contentLength!==this._sentEndForContentLength?(this._sentEndForContentLength=this._scrollMetrics.contentLength,r({distanceFromEnd:c})):c>d&&(this._sentEndForContentLength=0)}},{key:"_scheduleCellsToRenderUpdate",value:function(){var e=this.state.cellsAroundViewport,t=e.first,n=e.last,r=this._scrollMetrics,o=r.offset,i=r.visibleLength,a=r.velocity,s=this.props.getItemCount(this.props.data),c=!1,d=Y(this.props.onEndReachedThreshold)*i/2;if(t>0){var l=o-this._getFrameMetricsApprox(t).offset;c=c||l<0||a<-2&&l<d}if(n>0&&n<s-1){var u=this._getFrameMetricsApprox(n).offset-(o+i);c=c||u<0||a>2&&u<d}if(c&&(this._averageCellLength||this.props.getItemLayout)&&!this._hiPriInProgress)return this._hiPriInProgress=!0,this._updateCellsToRenderBatcher.dispose({abort:!0}),void this._updateCellsToRender();this._updateCellsToRenderBatcher.schedule()}},{key:"_updateViewableItems",value:function(e){var t=this,n=this.props.getItemCount;this._viewabilityTuples.forEach((function(r){r.viewabilityHelper.onUpdate(n(e),t._scrollMetrics.offset,t._scrollMetrics.visibleLength,t._getFrameMetrics,t._createViewToken,r.onViewableItemsChanged,t.state.cellsAroundViewport)}))}}],[{key:"_createRenderMask",value:function(e,t,r){var i=e.getItemCount(e.data);R()(t.first>=0&&t.last>=t.first-1&&t.last<i,'Invalid cells around viewport "['+t.first+", "+t.last+']" was passed to VirtualizedList._createRenderMask');var a=new x(i);if(i>0){for(var s,c=W([t].concat(o()(null!=r?r:[])));!(s=c()).done;){var d=s.value;d.last>=d.first&&a.addCells(d)}if(null==e.initialScrollIndex||0===e.initialScrollIndex){var l=n._initialRenderRegion(e);a.addCells(l)}var u=new Set(e.stickyHeaderIndices);n._ensureClosestStickyHeader(e,u,a,t.first)}return a}},{key:"_initialRenderRegion",value:function(e){var t,n=e.getItemCount(e.data),r=e.initialScrollIndex||0;return{first:r,last:Math.min(n,r+(t=e.initialNumToRender,null!=t?t:10))-1}}},{key:"_ensureClosestStickyHeader",value:function(e,t,n,r){for(var o=e.ListHeaderComponent?1:0,i=r-1;i>=0;i--)if(t.has(i+o)){n.addCells({first:i,last:i});break}}},{key:"getDerivedStateFromProps",value:function(e,t){if(e.getItemCount(e.data)===t.renderMask.numCells())return t;var r=n._constrainToItemCount(t.cellsAroundViewport,e);return{cellsAroundViewport:r,renderMask:n._createRenderMask(e,r)}}},{key:"_constrainToItemCount",value:function(e,t){var n=t.getItemCount(t.data),r=Math.min(n-1,e.last),o=$(t.maxToRenderPerBatch);return{first:T(0,n-1-o,e.first),last:r}}}]),n}(N.PureComponent);Q.contextType=B;var X=function(e){g()(n,e);var t=K(n);function n(){var e;l()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={separatorProps:{highlighted:!1,leadingItem:e.props.item}},e._separators={highlight:function(){var t=e.props,n=t.cellKey,r=t.prevCellKey;e.props.onUpdateSeparators([n,r],{highlighted:!0})},unhighlight:function(){var t=e.props,n=t.cellKey,r=t.prevCellKey;e.props.onUpdateSeparators([n,r],{highlighted:!1})},updateProps:function(t,n){var r=e.props,o=r.cellKey,i=r.prevCellKey;e.props.onUpdateSeparators(["leading"===t?i:o],n)}},e}return p()(n,[{key:"updateSeparatorProps",value:function(e){this.setState((function(t){return{separatorProps:c()({},t.separatorProps,e)}}))}},{key:"componentWillUnmount",value:function(){this.props.onUnmount(this.props.cellKey)}},{key:"_renderElement",value:function(e,t,n,r){return t?N.createElement(t,{item:n,index:r,separators:this._separators}):e?e({item:n,index:r,separators:this._separators}):void R()(!1,"VirtualizedList: Either ListItemComponent or renderItem props are required but none were found.")}},{key:"render",value:function(){var e=this.props,t=e.CellRendererComponent,n=e.ItemSeparatorComponent,r=e.fillRateHelper,o=e.horizontal,i=e.item,a=e.index,s=e.inversionStyle,d=e.parentProps,l=e.onFocusCapture,u=d.renderItem,p=d.getItemLayout,h=d.ListItemComponent,f=this._renderElement(u,h,i,a),m=!p||d.debug||r.enabled()?this.props.onLayout:void 0,g=n&&N.createElement(n,c()({},this.state.separatorProps,{__self:this,__source:{fileName:V,lineNumber:1991,columnNumber:53}})),b=s?o?[Z.rowReverse,s]:[Z.columnReverse,s]:o?[Z.row,s]:s,C=t?N.createElement(t,c()({},this.props,{style:b,onLayout:m,onFocusCapture:l,__self:this,__source:{fileName:V,lineNumber:2012,columnNumber:7}}),f,g):N.createElement(S.View,{style:b,onLayout:m,onFocusCapture:l,__self:this,__source:{fileName:V,lineNumber:2e3,columnNumber:7}},f,g);return N.createElement(U,{cellKey:this.props.cellKey,__self:this,__source:{fileName:V,lineNumber:2019,columnNumber:7}},C)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{separatorProps:c()({},t.separatorProps,{leadingItem:e.item})}}}]),n}(N.Component);var Z=S.StyleSheet.create({verticallyInverted:{transform:[{scaleY:-1}]},horizontallyInverted:{transform:[{scaleX:-1}]},row:{flexDirection:"row"},rowReverse:{flexDirection:"row-reverse"},columnReverse:{flexDirection:"column-reverse"},debug:{flex:1},debugOverlayBase:{position:"absolute",top:0,right:0},debugOverlay:{bottom:0,width:20,borderColor:"blue",borderWidth:1},debugOverlayFrame:{left:0,backgroundColor:"orange"},debugOverlayFrameLast:{left:0,borderColor:"green",borderWidth:2},debugOverlayFrameVis:{left:0,borderColor:"red",borderWidth:2}});t.default=Q},function(e,t,n){"use strict";n.r(t),n.d(t,"ExtensionAwareCommentPane",(function(){return f}));var r=n(1),o=n(63),i=n(2),a=n(89);const s=a.useSelector;var c=n(185),d=n(87),l=n(33),u=n(219);const p=r.createContext(void 0);var h=n(227);const f=r.memo(e=>{const t=s(t=>Object(c.b)(t,e.extensionRenderMode)),n=s(l.e)!==o.a.Visible,a=s(d.f);if(t||n)return null;let f=r.createElement(u.b,{commentAPI:e.commentAPI,peopleAPI:e.peopleAPI,localizationAPI:e.localizationAPI,focusManager:e.focusManager,selectionManager:e.selectionManager,initializationReason:e.initializationReason,registerComponentUIActionListener:e.registerComponentUIActionListener,unregisterComponentUIActionListener:e.unregisterComponentUIActionListener,registerComponentInterruptableCommandListener:e.registerComponentInterruptableCommandListener,unregisterComponentInterruptableCommandListener:e.unregisterComponentInterruptableCommandListener,resource:e.resource,telemetryVisitor:e.telemetryVisitor,correlationId:e.correlationId,onInitialRender:e.onInitialRender,lppManager:e.lppManager,createOrUpdateFilter:e.createOrUpdateFilter,componentRef:e.componentRef,componentInstanceId:e.componentInstanceId});return i.E()&&(f=r.createElement(h.a,{api:e.themeAPI},f)),a&&(f=r.createElement(p.Provider,{value:a},f)),f})},function(e){e.exports=JSON.parse('{"brandBackground":{"fillColorRest":"#185abd","fillColorHover":"#1651aa","fillColorPressed":"#0e336a","fillColorSelected":"#13458f"},"brandBackground2":{"fillColorRest":"#d2e0f4"},"brandBackgroundStatic":{"fillColorRest":"#185abd"},"brandForeground1":{"fillColorRest":"#185abd"},"brandForeground2":{"fillColorRest":"#1651aa"},"brandForegroundLink":{"fillColorRest":"#185abd","fillColorHover":"#1651aa","fillColorPressed":"#0e336a","fillColorSelected":"#13458f"},"brandStroke1":{"strokeColorRest":"#185abd","strokeWidth":1},"brandStroke2":{"strokeColorRest":"#6794d7","strokeWidth":1},"compoundBrandBackground1":{"fillColorRest":"#185abd","fillColorHover":"#1651aa","fillColorPressed":"#0e336a"},"compoundBrandForeground1":{"fillColorRest":"#185abd","fillColorHover":"#1651aa","fillColorPressed":"#0e336a"},"compoundBrandStroke1":{"strokeColorRest":"#185abd","strokeColorHover":"#1651aa","strokeColorPressed":"#0e336a","strokeWidth":1},"neutralBackground1":{"fillColorRest":"#ffffff","fillColorHover":"#f5f5f5","fillColorPressed":"#e0e0e0","fillColorSelected":"#ebebeb"},"neutralBackground2":{"fillColorRest":"#fafafa","fillColorHover":"#f0f0f0","fillColorPressed":"#dbdbdb","fillColorSelected":"#e6e6e6"},"neutralBackground3":{"fillColorRest":"#f5f5f5","fillColorHover":"#ebebeb","fillColorPressed":"#d6d6d6","fillColorSelected":"#e0e0e0"},"neutralBackground4":{"fillColorRest":"#f0f0f0","fillColorHover":"#fafafa","fillColorPressed":"#f5f5f5","fillColorSelected":"#ffffff"},"neutralBackground5":{"fillColorRest":"#ebebeb","fillColorHover":"#f5f5f5","fillColorPressed":"#f0f0f0","fillColorSelected":"#fafafa"},"neutralBackground6":{"fillColorRest":"#e6e6e6"},"neutralBackgroundDisabled":{"fillColorRest":"#f0f0f0"},"neutralBackgroundInverted":{"fillColorRest":"#616161"},"neutralForeground1":{"fillColorRest":"#242424","fillColorHover":"#242424","fillColorPressed":"#242424","fillColorSelected":"#242424"},"neutralForeground2":{"fillColorRest":"#424242","fillColorHover":"#242424","fillColorPressed":"#242424","fillColorBrandHover":"#1651aa","fillColorBrandPressed":"#0e336a","fillColorBrandSelected":"#13458f","fillColorSelected":"#242424"},"neutralForeground3":{"fillColorRest":"#616161","fillColorHover":"#424242","fillColorPressed":"#424242","fillColorBrandHover":"#1651aa","fillColorBrandPressed":"#0e336a","fillColorBrandSelected":"#13458f","fillColorSelected":"#424242"},"neutralForeground4":{"fillColorRest":"#707070"},"neutralForegroundDisabled":{"fillColorRest":"#bdbdbd"},"neutralForegroundInverted":{"fillColorRest":"#ffffff"},"neutralForegroundInvertedLink":{"fillColorRest":"#ffffff","fillColorHover":"#ffffff","fillColorPressed":"#ffffff","fillColorSelected":"#ffffff"},"neutralForegroundOnBrand":{"fillColorRest":"#ffffff","fillColorHover":"#ffffff","fillColorPressed":"#ffffff","fillColorSelected":"#ffffff"},"neutralStencil1":{"fillColorRest":"#e6e6e6"},"neutralStencil2":{"fillColorRest":"#fafafa"},"neutralStroke1":{"strokeColorRest":"#d1d1d1","strokeColorHover":"#c7c7c7","strokeColorPressed":"#b3b3b3","strokeColorSelected":"#bdbdbd","strokeWidth":1},"neutralStroke2":{"strokeColorRest":"#e0e0e0","strokeWidth":1},"neutralStroke3":{"strokeColorRest":"#f0f0f0","strokeWidth":1},"neutralStrokeAccessible":{"strokeColorRest":"#616161","strokeColorHover":"#575757","strokeColorPressed":"#4d4d4d","strokeColorSelected":"#185abd","strokeWidth":1},"neutralStrokeDisabled":{"strokeColorRest":"#e0e0e0","strokeWidth":1},"redBackground1":{"fillColorRest":"#f9f0f2"},"redBackground2":{"fillColorRest":"#d69ca5"},"redBackground3":{"fillColorRest":"#750b1c"},"redBorder1":{"strokeColorRest":"#d69ca5","strokeWidth":1},"redBorder2":{"strokeColorRest":"#750b1c","strokeWidth":1},"redBorderActive":{"strokeColorRest":"#750b1c","strokeWidth":1},"redForeground1":{"fillColorRest":"#690a19"},"redForeground2":{"fillColorRest":"#420610"},"redForeground3":{"fillColorRest":"#750b1c"},"strokeFocus1":{"strokeColorRest":"#ffffff","strokeWidth":1},"strokeFocus2":{"strokeColorRest":"#000000","strokeWidth":1},"subtleBackground":{"fillColorRest":"transparent","fillColorHover":"#f5f5f5","fillColorPressed":"#e0e0e0","fillColorSelected":"#ebebeb"},"transparentBackground":{"fillColorRest":"transparent","fillColorHover":"transparent","fillColorPressed":"transparent","fillColorSelected":"transparent"},"transparentStroke":{"strokeAlignment":"inner","strokeColorRest":"transparent","strokeColorHover":"transparent","strokeColorPressed":"transparent","strokeColorDisabled":"transparent","strokeWidth":1}}')},function(e,t,n){"use strict";(function(e){var r=n(282),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o&&r.a.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();t.a=s}).call(this,n(314)(e))},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r={encode:function(e){var t,r,o,i,a,s=[],c="",d="",l=0;do{o=(t=e.charCodeAt(l++))>>2,i=(3&t)<<4|(r=e.charCodeAt(l++))>>4,a=(15&r)<<2|(c=e.charCodeAt(l++))>>6,d=63&c,isNaN(r)?a=d=64:isNaN(c)&&(d=64),s.push(n.charAt(o)+n.charAt(i)+n.charAt(a)+n.charAt(d)),t=r=c="",o=i=a=d=""}while(l<e.length);return s.join("")},encodeFromByteArray:function(e){var t,r,o,i,a,s=[],c="",d="",l=0;do{o=(t=e[l++])>>2,i=(3&t)<<4|(r=e[l++])>>4,a=(15&r)<<2|(c=e[l++])>>6,d=63&c,isNaN(r)?a=d=64:isNaN(c)&&(d=64),s.push(n.charAt(o)+n.charAt(i)+n.charAt(a)+n.charAt(d)),t=r=c="",o=i=a=d=""}while(l<e.length);return s.join("")},decode:function(e){var t,r,o,i,a="",s="",c="",d=0;if(/[^A-Za-z0-9\+\/\=]/g.exec(e))throw new Error("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.");e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{t=n.indexOf(e.charAt(d++))<<2|(o=n.indexOf(e.charAt(d++)))>>4,r=(15&o)<<4|(i=n.indexOf(e.charAt(d++)))>>2,s=(3&i)<<6|(c=n.indexOf(e.charAt(d++))),a+=String.fromCharCode(t),64!=i&&(a+=String.fromCharCode(r)),64!=c&&(a+=String.fromCharCode(s)),t=r=s="",o=i=c=""}while(d<e.length);return a}};t.default=r},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9),o={};function i(e){return o[e]||Object(r.requireNativeComponent)(e)}},,function(e,t,n){"use strict";(function(e){}).call(this,n(366))},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.setBatch=t.getBatch=void 0;var n=function(e){e()};t.setBatch=function(e){return n=e};t.getBatch=function(){return n}},function(e,t,n){var r=n(120);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){void 0===t&&(t={});var n=t,r=n.getDisplayName,l=void 0===r?function(e){return"ConnectAdvanced("+e+")"}:r,p=n.methodName,S=void 0===p?"connectAdvanced":p,I=n.renderCountProp,O=void 0===I?void 0:I,E=n.shouldHandleStateChanges,P=void 0===E||E,k=n.storeKey,R=void 0===k?"store":k,x=(n.withRef,n.forwardRef),D=void 0!==x&&x,w=n.context,A=void 0===w?u.ReactReduxContext:w,j=(0,i.default)(n,h);0;var _=A;return function(t){var n=t.displayName||t.name||"Component",r=l(n),u=(0,o.default)({},j,{getDisplayName:l,methodName:S,renderCountProp:O,shouldHandleStateChanges:P,storeKey:R,displayName:r,wrappedComponentName:n,WrappedComponent:t}),p=j.pure;var h=p?s.useMemo:function(e){return e()};function I(n){var r=(0,s.useMemo)((function(){var e=n.reactReduxForwardedRef,t=(0,i.default)(n,f);return[n.context,e,t]}),[n]),a=r[0],l=r[1],p=r[2],S=(0,s.useMemo)((function(){return a&&a.Consumer&&(0,c.isContextConsumer)(s.default.createElement(a.Consumer,null))?a:_}),[a,_]),I=(0,s.useContext)(S),O=Boolean(n.store)&&Boolean(n.store.getState)&&Boolean(n.store.dispatch);Boolean(I)&&Boolean(I.store);var E=O?n.store:I.store,k=(0,s.useMemo)((function(){return function(t){return e(t.dispatch,u)}(E)}),[E]),R=(0,s.useMemo)((function(){if(!P)return g;var e=(0,d.createSubscription)(E,O?null:I.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[E,O,I]),x=R[0],D=R[1],w=(0,s.useMemo)((function(){return O?I:(0,o.default)({},I,{subscription:x})}),[O,I,x]),A=(0,s.useReducer)(b,m,T),j=A[0][0],F=A[1];if(j&&j.error)throw j.error;var M=(0,s.useRef)(),N=(0,s.useRef)(p),L=(0,s.useRef)(),B=(0,s.useRef)(!1),H=h((function(){return L.current&&p===N.current?L.current:k(E.getState(),p)}),[E,j,p]);C(y,[N,M,B,p,H,L,D]),C(v,[P,E,x,k,N,M,B,L,D,F],[E,x,k]);var U=(0,s.useMemo)((function(){return s.default.createElement(t,(0,o.default)({},H,{ref:l}))}),[l,t,H]);return(0,s.useMemo)((function(){return P?s.default.createElement(S.Provider,{value:w},U):U}),[S,U,w])}var E=p?s.default.memo(I):I;if(E.WrappedComponent=t,E.displayName=I.displayName=r,D){var k=s.default.forwardRef((function(e,t){return s.default.createElement(E,(0,o.default)({},e,{reactReduxForwardedRef:t}))}));return k.displayName=r,k.WrappedComponent=t,(0,a.default)(k,t)}return(0,a.default)(E,t)}};var o=r(n(312)),i=r(n(313)),a=r(n(373)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}r.default=e,n&&n.set(e,r);return r}(n(1)),c=n(252),d=n(310),l=n(311),u=n(197);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}var h=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],f=["reactReduxForwardedRef"],m=[],g=[null,null];function b(e,t){var n=e[1];return[t.payload,n+1]}function C(e,t,n){(0,l.useIsomorphicLayoutEffect)((function(){return e.apply(void 0,t)}),n)}function y(e,t,n,r,o,i,a){e.current=r,t.current=o,n.current=!1,i.current&&(i.current=null,a())}function v(e,t,n,r,o,i,a,s,c,d){if(e){var l=!1,u=null,p=function(){if(!l){var e,n,p=t.getState();try{e=r(p,o.current)}catch(e){n=e,u=e}n||(u=null),e===i.current?a.current||c():(i.current=e,s.current=e,a.current=!0,d({type:"STORE_UPDATED",payload:{error:n}}))}};n.onStateChange=p,n.trySubscribe(),p();return function(){if(l=!0,n.tryUnsubscribe(),n.onStateChange=null,u)throw u}}}var T=function(){return[null,0]}},function(e,t){function n(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(n(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(var i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(t,r[i])||!n(e[r[i]],t[r[i]]))return!1;return!0}},function(e,t,n){var r=n(120);Object.defineProperty(t,"__esModule",{value:!0}),t.getDependsOnOwnProps=o,t.wrapMapToPropsConstant=function(e){return function(t,n){var r=e(t,n);function o(){return r}return o.dependsOnOwnProps=!1,o}},t.wrapMapToPropsFunc=function(e,t){return function(t,n){n.displayName;var r=function(e,t){return r.dependsOnOwnProps?r.mapToProps(e,t):r.mapToProps(e)};return r.dependsOnOwnProps=!0,r.mapToProps=function(t,n){r.mapToProps=e,r.dependsOnOwnProps=o(e);var i=r(t,n);return"function"==typeof i&&(r.mapToProps=i,r.dependsOnOwnProps=o(i),i=r(t,n)),i},r}};r(n(328));function o(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}},function(e,t,n){var r=n(120);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){(0,o.default)(e)||(0,i.default)(n+"() in "+t+" must return a plain object. Instead received "+e+".")};var o=r(n(378)),i=r(n(329))},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){try{throw new Error(e)}catch(e){}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createStoreHook=a,t.useStore=void 0;var r=n(1),o=n(197),i=n(331);function a(e){void 0===e&&(e=o.ReactReduxContext);var t=e===o.ReactReduxContext?i.useReduxContext:function(){return(0,r.useContext)(e)};return function(){return t().store}}var s=a();t.useStore=s},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.useReduxContext=function(){0;return(0,r.useContext)(o.ReactReduxContext)};var r=n(1),o=n(197)},function(e,t,n){"use strict";var r=n(120);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(126)),i=r(n(389));if(!i.default)throw new Error("[@RNC/AsyncStorage]: NativeModule: AsyncStorage is null.\n\nTo fix this issue try these steps:\n\n  • Run `react-native link @react-native-community/async-storage` in the project root.\n\n  • Rebuild and restart the app.\n\n  • Run the packager with `--reset-cache` flag.\n\n  • If you are using CocoaPods on iOS, run `pod install` in the `ios` directory and then rebuild and re-run the app.\n\n  • If this happens while testing with Jest, check out docs how to integrate AsyncStorage with it: https://react-native-community.github.io/async-storage/docs/advanced/jest\n\nIf none of these fix the issue, please open an issue on the Github repository: https://github.com/react-native-community/react-native-async-storage/issues \n");function a(e,t){var n=arguments.length>1;if(n&&"string"!=typeof t&&null==t)throw new Error("[AsyncStorage] Passing null/undefined as value is not supported. If you want to remove value, Use .remove method instead.\nPassed value: ".concat(t,"\nPassed key: ").concat(e,"\n"))}var s={_getRequests:[],_getKeys:[],_immediate:null,getItem:function(e,t){return new Promise((function(n,r){a(e),i.default.multiGet([e],(function(e,o){var i=o&&o[0]&&o[0][1]?o[0][1]:null,a=c(e);t&&t(a&&a[0],i),a?r(a[0]):n(i)}))}))},setItem:function(e,t,n){return new Promise((function(r,o){a(e,t),i.default.multiSet([[e,t]],(function(e){var t=c(e);n&&n(t&&t[0]),t?o(t[0]):r(null)}))}))},removeItem:function(e,t){return new Promise((function(n,r){a(e),i.default.multiRemove([e],(function(e){var o=c(e);t&&t(o&&o[0]),o?r(o[0]):n(null)}))}))},mergeItem:function(e,t,n){return new Promise((function(r,o){a(e,t),i.default.multiMerge([[e,t]],(function(e){var t=c(e);n&&n(t&&t[0]),t?o(t[0]):r(null)}))}))},clear:function(e){return new Promise((function(t,n){i.default.clear((function(r){var o=d(r);e&&e(o),o?n(o):t(null)}))}))},getAllKeys:function(e){return new Promise((function(t,n){i.default.getAllKeys((function(r,o){var i=d(r);e&&e(i,o),i?n(i):t(o)}))}))},flushGetRequests:function(){var e=this._getRequests,t=this._getKeys;this._getRequests=[],this._getKeys=[],i.default.multiGet(t,(function(t,n){var r={};n&&n.forEach((function(e){var t=(0,o.default)(e,2),n=t[0],i=t[1];return r[n]=i,i}));for(var i=e.length,a=0;a<i;a++){var s=e[a],c=s.keys.map((function(e){return[e,r[e]]}));s.callback&&s.callback(null,c),s.resolve&&s.resolve(c)}}))},multiGet:function(e,t){var n=this;this._immediate||(this._immediate=setImmediate((function(){n._immediate=null,n.flushGetRequests()})));var r={keys:e,callback:t,keyIndex:this._getKeys.length,resolve:null,reject:null},o=new Promise((function(e,t){r.resolve=e,r.reject=t}));return this._getRequests.push(r),e.forEach((function(e){-1===n._getKeys.indexOf(e)&&n._getKeys.push(e)})),o},multiSet:function(e,t){return new Promise((function(n,r){e.forEach((function(e){var t=(0,o.default)(e,2);a(t[0],t[1])})),i.default.multiSet(e,(function(e){var o=c(e);t&&t(o),o?r(o):n(null)}))}))},multiRemove:function(e,t){return new Promise((function(n,r){e.forEach((function(e){return a(e)})),i.default.multiRemove(e,(function(e){var o=c(e);t&&t(o),o?r(o):n(null)}))}))},multiMerge:function(e,t){return new Promise((function(n,r){i.default.multiMerge(e,(function(e){var o=c(e);t&&t(o),o?r(o):n(null)}))}))}};function c(e){return!e||Array.isArray(e)&&0===e.length?null:(Array.isArray(e)?e:[e]).map((function(e){return d(e)}))}function d(e){if(!e)return null;var t=new Error(e.message);return t.key=e.key,t}i.default.multiMerge||(delete s.mergeItem,delete s.multiMerge);var l=s;t.default=l},function(e,t,n){var r=n(334);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";function r(e,t){return`${t&&t.context?t.context:"Value"} ${e}.`}function o(e){return a(Math.trunc(e))}function i(e){return e<0?-1:1}function a(e){return 0===e?0:e}function s(e,t){const n=!t.unsigned;let s,c;64===e?(c=Math.pow(2,53)-1,s=n?1-Math.pow(2,53):0):n?(s=-Math.pow(2,e-1),c=Math.pow(2,e-1)-1):(s=0,c=Math.pow(2,e)-1);const d=Math.pow(2,e),l=Math.pow(2,e-1);return(e,t)=>{void 0===t&&(t={});let u=+e;if(u=a(u),t.enforceRange){if(!Number.isFinite(u))throw new TypeError(r("is not a finite number",t));if(u=o(u),u<s||u>c)throw new TypeError(r(`is outside the accepted range of ${s} to ${c}, inclusive`,t));return u}return!Number.isNaN(u)&&t.clamp?(u=Math.min(Math.max(u,s),c),u=function(e){return a(e>0&&e%1==.5&&0==(1&e)||e<0&&e%1==-.5&&1==(1&e)?Math.floor(e):Math.round(e))}(u),u):Number.isFinite(u)&&0!==u?(u=o(u),u>=s&&u<=c?u:(u=function(e,t){const n=e%t;return i(t)!==i(n)?n+t:n}(u,d),n&&u>=l?u-d:u)):0}}function c(e,t){if("function"!=typeof e)throw new TypeError(r("is not a function",t));return e}t.any=e=>e,t.void=function(){},t.boolean=function(e){return!!e},t.byte=s(8,{unsigned:!1}),t.octet=s(8,{unsigned:!0}),t.short=s(16,{unsigned:!1}),t["unsigned short"]=s(16,{unsigned:!0}),t.long=s(32,{unsigned:!1}),t["unsigned long"]=s(32,{unsigned:!0}),t["long long"]=s(64,{unsigned:!1}),t["unsigned long long"]=s(64,{unsigned:!0}),t.double=(e,t)=>{const n=+e;if(!Number.isFinite(n))throw new TypeError(r("is not a finite floating-point value",t));return n},t["unrestricted double"]=e=>+e,t.float=(e,t)=>{const n=+e;if(!Number.isFinite(n))throw new TypeError(r("is not a finite floating-point value",t));if(Object.is(n,-0))return n;const o=Math.fround(n);if(!Number.isFinite(o))throw new TypeError(r("is outside the range of a single-precision floating-point value",t));return o},t["unrestricted float"]=e=>{const t=+e;return isNaN(t)||Object.is(t,-0)?t:Math.fround(t)},t.DOMString=function(e,t){if(void 0===t&&(t={}),t.treatNullAsEmptyString&&null===e)return"";if("symbol"==typeof e)throw new TypeError(r("is a symbol, which cannot be converted to a string",t));return String(e)},t.ByteString=(e,n)=>{const o=t.DOMString(e,n);let i;for(let e=0;void 0!==(i=o.codePointAt(e));++e)if(i>255)throw new TypeError(r("is not a valid ByteString",n));return o},t.USVString=(e,n)=>{const r=t.DOMString(e,n),o=r.length,i=[];for(let e=0;e<o;++e){const t=r.charCodeAt(e);if(t<55296||t>57343)i.push(String.fromCodePoint(t));else if(56320<=t&&t<=57343)i.push(String.fromCodePoint(65533));else if(e===o-1)i.push(String.fromCodePoint(65533));else{const n=r.charCodeAt(e+1);if(56320<=n&&n<=57343){const r=1023&t,o=1023&n;i.push(String.fromCodePoint(65536+1024*r+o)),++e}else i.push(String.fromCodePoint(65533))}}return i.join("")},t.object=(e,t)=>{if("Object"!==function(e){if(null===e)return"Null";switch(typeof e){case"undefined":return"Undefined";case"boolean":return"Boolean";case"number":return"Number";case"string":return"String";case"symbol":return"Symbol";case"object":case"function":default:return"Object"}}(e))throw new TypeError(r("is not an object",t));return e};const d=Object.getOwnPropertyDescriptor(ArrayBuffer.prototype,"byteLength").get;function l(e){try{return d.call(e),!0}catch(e){return!1}}t.ArrayBuffer=(e,t)=>{if(!l(e))throw new TypeError(r("is not a view on an ArrayBuffer object",t));return e};const u=Object.getOwnPropertyDescriptor(DataView.prototype,"byteLength").get;t.DataView=(e,t)=>{try{return u.call(e),e}catch(e){throw new TypeError(r("is not a view on an DataView object",t))}},[Int8Array,Int16Array,Int32Array,Uint8Array,Uint16Array,Uint32Array,Uint8ClampedArray,Float32Array,Float64Array].forEach(e=>{const n=e.name,o=/^[AEIOU]/.test(n)?"an":"a";t[n]=(e,t)=>{if(!ArrayBuffer.isView(e)||e.constructor.name!==n)throw new TypeError(r(`is not ${o} ${n} object`,t));return e}}),t.ArrayBufferView=(e,t)=>{if(!ArrayBuffer.isView(e))throw new TypeError(r("is not a view on an ArrayBuffer object",t));return e},t.BufferSource=(e,t)=>{if(!ArrayBuffer.isView(e)&&!l(e))throw new TypeError(r("is not an ArrayBuffer object or a view on one",t));return e},t.DOMTimeStamp=t["unsigned long long"],t.Function=c,t.VoidFunction=c},function(e,t,n){"use strict";const r=Symbol("wrapper"),o=Symbol("impl"),i=Symbol("SameObject caches"),a=Symbol.for("[webidl2js]  constructor registry");function s(e){return e?e[r]:null}function c(e){return e?e[o]:null}const d=Symbol("internal"),l=Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]()));const u=Object.getOwnPropertyDescriptor(ArrayBuffer.prototype,"byteLength").get;const p=Symbol("supports property index"),h=Symbol("supported property indices"),f=Symbol("supports property name"),m=Symbol("supported property names"),g=Symbol("indexed property get"),b=Symbol("indexed property set new"),C=Symbol("indexed property set existing"),y=Symbol("named property get"),v=Symbol("named property set new"),T=Symbol("named property set existing"),S=Symbol("named property delete");e.exports={isObject:function(e){return"object"==typeof e&&null!==e||"function"==typeof e},hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},wrapperSymbol:r,implSymbol:o,getSameObject:function(e,t,n){return e[i]||(e[i]=Object.create(null)),t in e[i]||(e[i][t]=n()),e[i][t]},ctorRegistrySymbol:a,wrapperForImpl:s,implForWrapper:c,tryWrapperForImpl:function(e){const t=s(e);return t||e},tryImplForWrapper:function(e){const t=c(e);return t||e},iterInternalSymbol:d,IteratorPrototype:l,isArrayBuffer:function(e){try{return u.call(e),!0}catch(e){return!1}},isArrayIndexPropName:function(e){if("string"!=typeof e)return!1;const t=e>>>0;return t!==Math.pow(2,32)-1&&e===""+t},supportsPropertyIndex:p,supportedPropertyIndices:h,supportsPropertyName:f,supportedPropertyNames:m,indexedGet:g,indexedSetNew:b,indexedSetExisting:C,namedGet:y,namedSetNew:v,namedSetExisting:T,namedDelete:S}},function(e,t,n){"use strict";const{Buffer:r}=n(338),o=n(397),i=n(339),{percentEncode:a,percentDecode:s}=n(251),c={ftp:21,file:null,http:80,https:443,ws:80,wss:443},d=Symbol("failure");function l(e){return o.ucs2.decode(e).length}function u(e,t){const n=e[t];return isNaN(n)?void 0:String.fromCodePoint(n)}function p(e){return"."===e||"%2e"===e.toLowerCase()}function h(e){return 2===e.length&&i.isASCIIAlpha(e.codePointAt(0))&&(":"===e[1]||"|"===e[1])}function f(e){return void 0!==c[e]}function m(e){return f(e.scheme)}function g(e){return!f(e.scheme)}function b(e){return c[e]}function C(e){return e<=31||e>126}const y=new Set([47,58,59,61,64,91,92,93,94,124]);function v(e){return O(e)||y.has(e)}const T=new Set([32,34,60,62,96]);function S(e){return C(e)||T.has(e)}const I=new Set([35,63,123,125]);function O(e){return S(e)||I.has(e)}function E(e,t){const n=String.fromCodePoint(e);return t(e)?function(e){const t=r.from(e);let n="";for(let e=0;e<t.length;++e)n+=a(t[e]);return n}(n):n}function P(e){let t=10;if(e.length>=2&&"0"===e.charAt(0)&&"x"===e.charAt(1).toLowerCase()?(e=e.substring(2),t=16):e.length>=2&&"0"===e.charAt(0)&&(e=e.substring(1),t=8),""===e)return 0;let n=/[^0-7]/;return 10===t&&(n=/[^0-9]/),16===t&&(n=/[^0-9A-Fa-f]/),n.test(e)?d:parseInt(e,t)}function k(e,t=!1){if("["===e[0])return"]"!==e[e.length-1]?d:function(e){const t=[0,0,0,0,0,0,0,0];let n=0,r=null,a=0;if(58===(e=o.ucs2.decode(e))[a]){if(58!==e[a+1])return d;a+=2,++n,r=n}for(;a<e.length;){if(8===n)return d;if(58===e[a]){if(null!==r)return d;++a,++n,r=n;continue}let o=0,s=0;for(;s<4&&i.isASCIIHex(e[a]);)o=16*o+parseInt(u(e,a),16),++a,++s;if(46===e[a]){if(0===s)return d;if(a-=s,n>6)return d;let r=0;for(;void 0!==e[a];){let o=null;if(r>0){if(!(46===e[a]&&r<4))return d;++a}if(!i.isASCIIDigit(e[a]))return d;for(;i.isASCIIDigit(e[a]);){const t=parseInt(u(e,a));if(null===o)o=t;else{if(0===o)return d;o=10*o+t}if(o>255)return d;++a}t[n]=256*t[n]+o,++r,2!==r&&4!==r||++n}if(4!==r)return d;break}if(58===e[a]){if(++a,void 0===e[a])return d}else if(void 0!==e[a])return d;t[n]=o,++n}if(null!==r){let e=n-r;for(n=7;0!==n&&e>0;){const o=t[r+e-1];t[r+e-1]=t[n],t[n]=o,--n,--e}}else if(null===r&&8!==n)return d;return t}(e.substring(1,e.length-1));if(t)return function(e){if(t=e,-1!==t.search(/\u0000|\u0009|\u000A|\u000D|\u0020|#|\/|:|\?|@|\[|\\|\]/))return d;var t;let n="";const r=o.ucs2.decode(e);for(let e=0;e<r.length;++e)n+=E(r[e],C);return n}(e);const n=function(e){const t=e;if(null===t)return d;return t}(s(r.from(e)).toString());if(n===d)return d;if(-1!==n.search(/\u0000|\u0009|\u000A|\u000D|\u0020|#|%|\/|:|\?|@|\[|\\|\]/))return d;const a=function(e){const t=e.split(".");if(""===t[t.length-1]&&t.length>1&&t.pop(),t.length>4)return e;const n=[];for(const r of t){if(""===r)return e;const t=P(r);if(t===d)return e;n.push(t)}for(let e=0;e<n.length-1;++e)if(n[e]>255)return d;if(n[n.length-1]>=Math.pow(256,5-n.length))return d;let r=n.pop(),o=0;for(const e of n)r+=e*Math.pow(256,3-o),++o;return r}(n);return"number"==typeof a||a===d?a:n}function R(e){return"number"==typeof e?function(e){let t="",n=e;for(let e=1;e<=4;++e)t=String(n%256)+t,4!==e&&(t="."+t),n=Math.floor(n/256);return t}(e):e instanceof Array?"["+function(e){let t="";const n=function(e){let t=null,n=1,r=null,o=0;for(let i=0;i<e.length;++i)0!==e[i]?(o>n&&(t=r,n=o),r=null,o=0):(null===r&&(r=i),++o);o>n&&(t=r,n=o);return{idx:t,len:n}}(e).idx;let r=!1;for(let o=0;o<=7;++o)if(!r||0!==e[o])if(r&&(r=!1),n!==o)t+=e[o].toString(16),7!==o&&(t+=":");else{t+=0===o?"::":":",r=!0}return t}(e)+"]":e}function x(e){const{path:t}=e;var n;0!==t.length&&("file"===e.scheme&&1===t.length&&(n=t[0],/^[A-Za-z]:$/.test(n))||t.pop())}function D(e){return""!==e.username||""!==e.password}function w(e,t,n,r,i){if(this.pointer=0,this.input=e,this.base=t||null,this.encodingOverride=n||"utf-8",this.stateOverride=i,this.url=r,this.failure=!1,this.parseError=!1,!this.url){this.url={scheme:"",username:"",password:"",host:null,port:null,path:[],query:null,fragment:null,cannotBeABaseURL:!1};const e=function(e){return e.replace(/^[\u0000-\u001F\u0020]+|[\u0000-\u001F\u0020]+$/g,"")}(this.input);e!==this.input&&(this.parseError=!0),this.input=e}const a=function(e){return e.replace(/\u0009|\u000A|\u000D/g,"")}(this.input);for(a!==this.input&&(this.parseError=!0),this.input=a,this.state=i||"scheme start",this.buffer="",this.atFlag=!1,this.arrFlag=!1,this.passwordTokenSeenFlag=!1,this.input=o.ucs2.decode(this.input);this.pointer<=this.input.length;++this.pointer){const e=this.input[this.pointer],t=isNaN(e)?void 0:String.fromCodePoint(e),n=this["parse "+this.state](e,t);if(!n)break;if(n===d){this.failure=!0;break}}}w.prototype["parse scheme start"]=function(e,t){if(i.isASCIIAlpha(e))this.buffer+=t.toLowerCase(),this.state="scheme";else{if(this.stateOverride)return this.parseError=!0,d;this.state="no scheme",--this.pointer}return!0},w.prototype["parse scheme"]=function(e,t){if(i.isASCIIAlphanumeric(e)||43===e||45===e||46===e)this.buffer+=t.toLowerCase();else if(58===e){if(this.stateOverride){if(m(this.url)&&!f(this.buffer))return!1;if(!m(this.url)&&f(this.buffer))return!1;if((D(this.url)||null!==this.url.port)&&"file"===this.buffer)return!1;if("file"===this.url.scheme&&(""===this.url.host||null===this.url.host))return!1}if(this.url.scheme=this.buffer,this.stateOverride)return this.url.port===b(this.url.scheme)&&(this.url.port=null),!1;this.buffer="","file"===this.url.scheme?(47===this.input[this.pointer+1]&&47===this.input[this.pointer+2]||(this.parseError=!0),this.state="file"):m(this.url)&&null!==this.base&&this.base.scheme===this.url.scheme?this.state="special relative or authority":m(this.url)?this.state="special authority slashes":47===this.input[this.pointer+1]?(this.state="path or authority",++this.pointer):(this.url.cannotBeABaseURL=!0,this.url.path.push(""),this.state="cannot-be-a-base-URL path")}else{if(this.stateOverride)return this.parseError=!0,d;this.buffer="",this.state="no scheme",this.pointer=-1}return!0},w.prototype["parse no scheme"]=function(e){return null===this.base||this.base.cannotBeABaseURL&&35!==e?d:(this.base.cannotBeABaseURL&&35===e?(this.url.scheme=this.base.scheme,this.url.path=this.base.path.slice(),this.url.query=this.base.query,this.url.fragment="",this.url.cannotBeABaseURL=!0,this.state="fragment"):"file"===this.base.scheme?(this.state="file",--this.pointer):(this.state="relative",--this.pointer),!0)},w.prototype["parse special relative or authority"]=function(e){return 47===e&&47===this.input[this.pointer+1]?(this.state="special authority ignore slashes",++this.pointer):(this.parseError=!0,this.state="relative",--this.pointer),!0},w.prototype["parse path or authority"]=function(e){return 47===e?this.state="authority":(this.state="path",--this.pointer),!0},w.prototype["parse relative"]=function(e){return this.url.scheme=this.base.scheme,isNaN(e)?(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(),this.url.query=this.base.query):47===e?this.state="relative slash":63===e?(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(),this.url.query="",this.state="query"):35===e?(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(),this.url.query=this.base.query,this.url.fragment="",this.state="fragment"):m(this.url)&&92===e?(this.parseError=!0,this.state="relative slash"):(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(0,this.base.path.length-1),this.state="path",--this.pointer),!0},w.prototype["parse relative slash"]=function(e){return!m(this.url)||47!==e&&92!==e?47===e?this.state="authority":(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.state="path",--this.pointer):(92===e&&(this.parseError=!0),this.state="special authority ignore slashes"),!0},w.prototype["parse special authority slashes"]=function(e){return 47===e&&47===this.input[this.pointer+1]?(this.state="special authority ignore slashes",++this.pointer):(this.parseError=!0,this.state="special authority ignore slashes",--this.pointer),!0},w.prototype["parse special authority ignore slashes"]=function(e){return 47!==e&&92!==e?(this.state="authority",--this.pointer):this.parseError=!0,!0},w.prototype["parse authority"]=function(e,t){if(64===e){this.parseError=!0,this.atFlag&&(this.buffer="%40"+this.buffer),this.atFlag=!0;const e=l(this.buffer);for(let t=0;t<e;++t){const e=this.buffer.codePointAt(t);if(58===e&&!this.passwordTokenSeenFlag){this.passwordTokenSeenFlag=!0;continue}const n=E(e,v);this.passwordTokenSeenFlag?this.url.password+=n:this.url.username+=n}this.buffer=""}else if(isNaN(e)||47===e||63===e||35===e||m(this.url)&&92===e){if(this.atFlag&&""===this.buffer)return this.parseError=!0,d;this.pointer-=l(this.buffer)+1,this.buffer="",this.state="host"}else this.buffer+=t;return!0},w.prototype["parse hostname"]=w.prototype["parse host"]=function(e,t){if(this.stateOverride&&"file"===this.url.scheme)--this.pointer,this.state="file host";else if(58!==e||this.arrFlag)if(isNaN(e)||47===e||63===e||35===e||m(this.url)&&92===e){if(--this.pointer,m(this.url)&&""===this.buffer)return this.parseError=!0,d;if(this.stateOverride&&""===this.buffer&&(D(this.url)||null!==this.url.port))return this.parseError=!0,!1;const e=k(this.buffer,g(this.url));if(e===d)return d;if(this.url.host=e,this.buffer="",this.state="path start",this.stateOverride)return!1}else 91===e?this.arrFlag=!0:93===e&&(this.arrFlag=!1),this.buffer+=t;else{if(""===this.buffer)return this.parseError=!0,d;const e=k(this.buffer,g(this.url));if(e===d)return d;if(this.url.host=e,this.buffer="",this.state="port","hostname"===this.stateOverride)return!1}return!0},w.prototype["parse port"]=function(e,t){if(i.isASCIIDigit(e))this.buffer+=t;else{if(!(isNaN(e)||47===e||63===e||35===e||m(this.url)&&92===e||this.stateOverride))return this.parseError=!0,d;if(""!==this.buffer){const e=parseInt(this.buffer);if(e>Math.pow(2,16)-1)return this.parseError=!0,d;this.url.port=e===b(this.url.scheme)?null:e,this.buffer=""}if(this.stateOverride)return!1;this.state="path start",--this.pointer}return!0};const A=new Set([47,92,63,35]);function j(e,t){const n=e.length-t;return n>=2&&(r=e[t],o=e[t+1],i.isASCIIAlpha(r)&&(58===o||124===o))&&(2===n||A.has(e[t+2]));var r,o}w.prototype["parse file"]=function(e){return this.url.scheme="file",47===e||92===e?(92===e&&(this.parseError=!0),this.state="file slash"):null!==this.base&&"file"===this.base.scheme?isNaN(e)?(this.url.host=this.base.host,this.url.path=this.base.path.slice(),this.url.query=this.base.query):63===e?(this.url.host=this.base.host,this.url.path=this.base.path.slice(),this.url.query="",this.state="query"):35===e?(this.url.host=this.base.host,this.url.path=this.base.path.slice(),this.url.query=this.base.query,this.url.fragment="",this.state="fragment"):(j(this.input,this.pointer)?this.parseError=!0:(this.url.host=this.base.host,this.url.path=this.base.path.slice(),x(this.url)),this.state="path",--this.pointer):(this.state="path",--this.pointer),!0},w.prototype["parse file slash"]=function(e){var t;return 47===e||92===e?(92===e&&(this.parseError=!0),this.state="file host"):(null===this.base||"file"!==this.base.scheme||j(this.input,this.pointer)||(2===(t=this.base.path[0]).length&&i.isASCIIAlpha(t.codePointAt(0))&&":"===t[1]?this.url.path.push(this.base.path[0]):this.url.host=this.base.host),this.state="path",--this.pointer),!0},w.prototype["parse file host"]=function(e,t){if(isNaN(e)||47===e||92===e||63===e||35===e)if(--this.pointer,!this.stateOverride&&h(this.buffer))this.parseError=!0,this.state="path";else if(""===this.buffer){if(this.url.host="",this.stateOverride)return!1;this.state="path start"}else{let e=k(this.buffer,g(this.url));if(e===d)return d;if("localhost"===e&&(e=""),this.url.host=e,this.stateOverride)return!1;this.buffer="",this.state="path start"}else this.buffer+=t;return!0},w.prototype["parse path start"]=function(e){return m(this.url)?(92===e&&(this.parseError=!0),this.state="path",47!==e&&92!==e&&--this.pointer):this.stateOverride||63!==e?this.stateOverride||35!==e?void 0!==e&&(this.state="path",47!==e&&--this.pointer):(this.url.fragment="",this.state="fragment"):(this.url.query="",this.state="query"),!0},w.prototype["parse path"]=function(e){if(isNaN(e)||47===e||m(this.url)&&92===e||!this.stateOverride&&(63===e||35===e)){if(m(this.url)&&92===e&&(this.parseError=!0),".."===(t=(t=this.buffer).toLowerCase())||"%2e."===t||".%2e"===t||"%2e%2e"===t?(x(this.url),47===e||m(this.url)&&92===e||this.url.path.push("")):!p(this.buffer)||47===e||m(this.url)&&92===e?p(this.buffer)||("file"===this.url.scheme&&0===this.url.path.length&&h(this.buffer)&&(""!==this.url.host&&null!==this.url.host&&(this.parseError=!0,this.url.host=""),this.buffer=this.buffer[0]+":"),this.url.path.push(this.buffer)):this.url.path.push(""),this.buffer="","file"===this.url.scheme&&(void 0===e||63===e||35===e))for(;this.url.path.length>1&&""===this.url.path[0];)this.parseError=!0,this.url.path.shift();63===e&&(this.url.query="",this.state="query"),35===e&&(this.url.fragment="",this.state="fragment")}else 37!==e||i.isASCIIHex(this.input[this.pointer+1])&&i.isASCIIHex(this.input[this.pointer+2])||(this.parseError=!0),this.buffer+=E(e,O);var t;return!0},w.prototype["parse cannot-be-a-base-URL path"]=function(e){return 63===e?(this.url.query="",this.state="query"):35===e?(this.url.fragment="",this.state="fragment"):(isNaN(e)||37===e||(this.parseError=!0),37!==e||i.isASCIIHex(this.input[this.pointer+1])&&i.isASCIIHex(this.input[this.pointer+2])||(this.parseError=!0),isNaN(e)||(this.url.path[0]+=E(e,C))),!0},w.prototype["parse query"]=function(e,t){if(isNaN(e)||!this.stateOverride&&35===e){m(this.url)&&"ws"!==this.url.scheme&&"wss"!==this.url.scheme||(this.encodingOverride="utf-8");const t=r.from(this.buffer);for(let e=0;e<t.length;++e)t[e]<33||t[e]>126||34===t[e]||35===t[e]||60===t[e]||62===t[e]||39===t[e]&&m(this.url)?this.url.query+=a(t[e]):this.url.query+=String.fromCodePoint(t[e]);this.buffer="",35===e&&(this.url.fragment="",this.state="fragment")}else 37!==e||i.isASCIIHex(this.input[this.pointer+1])&&i.isASCIIHex(this.input[this.pointer+2])||(this.parseError=!0),this.buffer+=t;return!0},w.prototype["parse fragment"]=function(e){return isNaN(e)||(0===e?this.parseError=!0:(37!==e||i.isASCIIHex(this.input[this.pointer+1])&&i.isASCIIHex(this.input[this.pointer+2])||(this.parseError=!0),this.url.fragment+=E(e,S))),!0},e.exports.serializeURL=function(e,t){let n=e.scheme+":";if(null!==e.host?(n+="//",""===e.username&&""===e.password||(n+=e.username,""!==e.password&&(n+=":"+e.password),n+="@"),n+=R(e.host),null!==e.port&&(n+=":"+e.port)):null===e.host&&"file"===e.scheme&&(n+="//"),e.cannotBeABaseURL)n+=e.path[0];else for(const t of e.path)n+="/"+t;return null!==e.query&&(n+="?"+e.query),t||null===e.fragment||(n+="#"+e.fragment),n},e.exports.serializeURLOrigin=function(t){switch(t.scheme){case"blob":try{return e.exports.serializeURLOrigin(e.exports.parseURL(t.path[0]))}catch(e){return"null"}case"ftp":case"http":case"https":case"ws":case"wss":return function(e){let t=e.scheme+"://";return t+=R(e.host),null!==e.port&&(t+=":"+e.port),t}({scheme:t.scheme,host:t.host,port:t.port});case"file":default:return"null"}},e.exports.basicURLParse=function(e,t){void 0===t&&(t={});const n=new w(e,t.baseURL,t.encodingOverride,t.url,t.stateOverride);return n.failure?null:n.url},e.exports.setTheUsername=function(e,t){e.username="";const n=o.ucs2.decode(t);for(let t=0;t<n.length;++t)e.username+=E(n[t],v)},e.exports.setThePassword=function(e,t){e.password="";const n=o.ucs2.decode(t);for(let t=0;t<n.length;++t)e.password+=E(n[t],v)},e.exports.serializeHost=R,e.exports.cannotHaveAUsernamePasswordPort=function(e){return null===e.host||""===e.host||e.cannotBeABaseURL||"file"===e.scheme},e.exports.serializeInteger=function(e){return String(e)},e.exports.parseURL=function(t,n){return void 0===n&&(n={}),e.exports.basicURLParse(t,{baseURL:n.baseURL,encodingOverride:n.encodingOverride})}},function(e,t,n){"use strict";(function(e){var r=n(394),o=n(395),i=n(396);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return d(this,e,t,n)}function d(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=p(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(t,n),o=(e=s(e,r)).write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|h(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):p(e,t);if("Buffer"===t.type&&i(t.data))return p(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(l(t),e=s(e,t<0?0:0|h(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t){var n=t.length<0?0:0|h(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function h(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function f(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(e).length;default:if(r)return H(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return x(this,t,n);case"utf8":case"utf-8":return P(this,t,n);case"ascii":return k(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return E(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function b(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:C(e,t,n,r,o);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):C(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function C(e,t,n,r,o){var i,a=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,n/=2}function d(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var l=-1;for(i=n;i<s;i++)if(d(e,i)===d(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*a}else-1!==l&&(i-=i-l),l=-1}else for(n+c>s&&(n=s-c),i=n;i>=0;i--){for(var u=!0,p=0;p<c;p++)if(d(e,i+p)!==d(t,p)){u=!1;break}if(u)return i}return-1}function y(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function v(e,t,n,r){return V(H(t,e.length-n),e,n,r)}function T(e,t,n,r){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function S(e,t,n,r){return T(e,t,n,r)}function I(e,t,n,r){return V(U(t),e,n,r)}function O(e,t,n,r){return V(function(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function E(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function P(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,s,c,d=e[o],l=null,u=d>239?4:d>223?3:d>191?2:1;if(o+u<=n)switch(u){case 1:d<128&&(l=d);break;case 2:128==(192&(i=e[o+1]))&&(c=(31&d)<<6|63&i)>127&&(l=c);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(c=(15&d)<<12|(63&i)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(c=(15&d)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,u=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=u}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return d(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return u(null,e)},c.allocUnsafeSlow=function(e){return u(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},c.byteLength=f,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?P(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,o){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(i,a),d=this.slice(r,o),l=e.slice(t,n),u=0;u<s;++u)if(d[u]!==l[u]){i=d[u],a=l[u];break}return i<a?-1:a<i?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return v(this,e,t,n);case"ascii":return T(this,e,t,n);case"latin1":case"binary":return S(this,e,t,n);case"base64":return I(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function k(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function R(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function x(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=B(e[i]);return o}function D(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function w(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function A(e,t,n,r,o,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function j(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function _(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function F(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function M(e,t,n,r,i){return i||F(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function N(e,t,n,r,i){return i||F(e,0,n,8),o.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var o=t-e;n=new c(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||w(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||w(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},c.prototype.readUInt8=function(e,t){return t||w(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||w(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||w(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||w(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||w(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||w(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||w(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return t||w(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||w(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||w(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||w(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||w(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||w(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||w(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||w(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||w(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||A(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||A(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):_(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):_(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);A(this,e,t,n,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);A(this,e,t,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):_(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):_(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return M(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return M(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return N(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return N(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=c.isBuffer(e)?e:H(new c(e,r).toString()),s=a.length;for(i=0;i<n-t;++i)this[i+t]=a[i%s]}return this};var L=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function H(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function U(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(L,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(234))},function(e,t,n){"use strict";function r(e){return e>=48&&e<=57}function o(e){return e>=65&&e<=90||e>=97&&e<=122}e.exports={isASCIIDigit:r,isASCIIAlpha:o,isASCIIAlphanumeric:function(e){return o(e)||r(e)},isASCIIHex:function(e){return r(e)||e>=65&&e<=70||e>=97&&e<=102}}},function(e,t,n){"use strict";const r=n(335),o=n(336),i=o.implSymbol,a=o.ctorRegistrySymbol,s=Object.create(o.IteratorPrototype,{next:{value:function(){const e=this[o.iterInternalSymbol],{target:t,kind:n,index:r}=e,a=Array.from(t[i]);if(r>=a.length)return{value:void 0,done:!0};const s=a[r];e.index=r+1;const[c,d]=s.map(o.tryWrapperForImpl);let l;switch(n){case"key":l=c;break;case"value":l=d;break;case"key+value":l=[c,d]}return{value:l,done:!1}},writable:!0,enumerable:!0,configurable:!0},[Symbol.toStringTag]:{value:"URLSearchParams Iterator",configurable:!0}}),c={_mixedIntoPredicates:[],is(t){if(t){if(o.hasOwn(t,i)&&t[i]instanceof d.implementation)return!0;for(const n of e.exports._mixedIntoPredicates)if(n(t))return!0}return!1},isImpl(t){if(t){if(t instanceof d.implementation)return!0;const n=o.wrapperForImpl(t);for(const t of e.exports._mixedIntoPredicates)if(t(n))return!0}return!1},convert(t,{context:n="The provided value"}={}){if(e.exports.is(t))return o.implForWrapper(t);throw new TypeError(n+" is not of type 'URLSearchParams'.")},createDefaultIterator(e,t){const n=Object.create(s);return Object.defineProperty(n,o.iterInternalSymbol,{value:{target:e,kind:t,index:0},configurable:!0}),n},create(e,t,n){if(void 0===e[a])throw new Error("Internal error: invalid global object");const r=e[a].URLSearchParams;if(void 0===r)throw new Error("Internal error: constructor URLSearchParams is not installed on the passed global object");let o=Object.create(r.prototype);return o=c.setup(o,e,t,n),o},createImpl(e,t,n){const r=c.create(e,t,n);return o.implForWrapper(r)},_internalSetup(e){},setup:(e,t,n=[],r={})=>(r.wrapper=e,c._internalSetup(e),Object.defineProperty(e,i,{value:new d.implementation(t,n,r),configurable:!0}),e[i][o.wrapperSymbol]=e,d.init&&d.init(e[i],r),e),install(t){class n{constructor(){const e=[];{let t=arguments[0];if(void 0!==t)if(o.isObject(t))if(void 0!==t[Symbol.iterator]){if(!o.isObject(t))throw new TypeError("Failed to construct 'URLSearchParams': parameter 1 sequence is not an iterable object.");{const e=[],n=t;for(let t of n){if(!o.isObject(t))throw new TypeError("Failed to construct 'URLSearchParams': parameter 1 sequence's element is not an iterable object.");{const e=[],n=t;for(let t of n)t=r.USVString(t,{context:"Failed to construct 'URLSearchParams': parameter 1 sequence's element's element"}),e.push(t);t=e}e.push(t)}t=e}}else{if(!o.isObject(t))throw new TypeError("Failed to construct 'URLSearchParams': parameter 1 record is not an object.");{const e=Object.create(null);for(const n of Reflect.ownKeys(t)){const o=Object.getOwnPropertyDescriptor(t,n);if(o&&o.enumerable){let o=n;o=r.USVString(o,{context:"Failed to construct 'URLSearchParams': parameter 1 record's key"});let i=t[n];i=r.USVString(i,{context:"Failed to construct 'URLSearchParams': parameter 1 record's value"}),e[o]=i}}t=e}}else t=r.USVString(t,{context:"Failed to construct 'URLSearchParams': parameter 1"});else t="";e.push(t)}return c.setup(Object.create(this.constructor.prototype),t,e)}append(t,n){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");if(arguments.length<2)throw new TypeError("Failed to execute 'append' on 'URLSearchParams': 2 arguments required, but only "+arguments.length+" present.");const o=[];{let e=arguments[0];e=r.USVString(e,{context:"Failed to execute 'append' on 'URLSearchParams': parameter 1"}),o.push(e)}{let e=arguments[1];e=r.USVString(e,{context:"Failed to execute 'append' on 'URLSearchParams': parameter 2"}),o.push(e)}return this[i].append(...o)}delete(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");if(arguments.length<1)throw new TypeError("Failed to execute 'delete' on 'URLSearchParams': 1 argument required, but only "+arguments.length+" present.");const n=[];{let e=arguments[0];e=r.USVString(e,{context:"Failed to execute 'delete' on 'URLSearchParams': parameter 1"}),n.push(e)}return this[i].delete(...n)}get(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");if(arguments.length<1)throw new TypeError("Failed to execute 'get' on 'URLSearchParams': 1 argument required, but only "+arguments.length+" present.");const n=[];{let e=arguments[0];e=r.USVString(e,{context:"Failed to execute 'get' on 'URLSearchParams': parameter 1"}),n.push(e)}return this[i].get(...n)}getAll(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");if(arguments.length<1)throw new TypeError("Failed to execute 'getAll' on 'URLSearchParams': 1 argument required, but only "+arguments.length+" present.");const n=[];{let e=arguments[0];e=r.USVString(e,{context:"Failed to execute 'getAll' on 'URLSearchParams': parameter 1"}),n.push(e)}return o.tryWrapperForImpl(this[i].getAll(...n))}has(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");if(arguments.length<1)throw new TypeError("Failed to execute 'has' on 'URLSearchParams': 1 argument required, but only "+arguments.length+" present.");const n=[];{let e=arguments[0];e=r.USVString(e,{context:"Failed to execute 'has' on 'URLSearchParams': parameter 1"}),n.push(e)}return this[i].has(...n)}set(t,n){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");if(arguments.length<2)throw new TypeError("Failed to execute 'set' on 'URLSearchParams': 2 arguments required, but only "+arguments.length+" present.");const o=[];{let e=arguments[0];e=r.USVString(e,{context:"Failed to execute 'set' on 'URLSearchParams': parameter 1"}),o.push(e)}{let e=arguments[1];e=r.USVString(e,{context:"Failed to execute 'set' on 'URLSearchParams': parameter 2"}),o.push(e)}return this[i].set(...o)}sort(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].sort()}toString(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].toString()}keys(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return e.exports.createDefaultIterator(this,"key")}values(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return e.exports.createDefaultIterator(this,"value")}entries(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return e.exports.createDefaultIterator(this,"key+value")}forEach(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");if(arguments.length<1)throw new TypeError("Failed to execute 'forEach' on 'iterable': 1 argument required, but only 0 present.");if("function"!=typeof t)throw new TypeError("Failed to execute 'forEach' on 'iterable': The callback provided as parameter 1 is not a function.");const n=arguments[1];let r=Array.from(this[i]),a=0;for(;a<r.length;){const[e,s]=r[a].map(o.tryWrapperForImpl);t.call(n,s,e,this),r=Array.from(this[i]),a++}}}Object.defineProperties(n.prototype,{append:{enumerable:!0},delete:{enumerable:!0},get:{enumerable:!0},getAll:{enumerable:!0},has:{enumerable:!0},set:{enumerable:!0},sort:{enumerable:!0},toString:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0},forEach:{enumerable:!0},[Symbol.toStringTag]:{value:"URLSearchParams",configurable:!0},[Symbol.iterator]:{value:n.prototype.entries,configurable:!0,writable:!0}}),void 0===t[a]&&(t[a]=Object.create(null)),t[a].URLSearchParams=n,Object.defineProperty(t,"URLSearchParams",{configurable:!0,writable:!0,value:n})}};e.exports=c;const d=n(399)},function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",(function(){return r}))},function(e,t){e.exports=OfficePlatformGlobal.ReactNativeReka},function(e,t,n){var r=n(367),o=n(368);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[i+s]=a[s];return t||o(a)}},function(e){e.exports=JSON.parse('{"color":{"anchor":{"primary":"#394146","shade10":"#333a3f","shade20":"#2b3135","shade30":"#202427","shade40":"#111315","shade50":"#090a0b","tint10":"#4d565c","tint20":"#626c72","tint30":"#808a90","tint40":"#bcc3c7","tint50":"#dbdfe1","tint60":"#f6f7f8"},"beige":{"primary":"#7a7574","shade10":"#6e6968","shade20":"#5d5958","shade30":"#444241","shade40":"#252323","shade50":"#141313","tint10":"#8a8584","tint20":"#9a9594","tint30":"#afabaa","tint40":"#d7d4d4","tint50":"#eae8e8","tint60":"#faf9f9"},"berry":{"primary":"#c239b3","shade10":"#af33a1","shade20":"#932b88","shade30":"#6d2064","shade40":"#3a1136","shade50":"#1f091d","tint10":"#c94cbc","tint20":"#d161c4","tint30":"#da7ed0","tint40":"#edbbe7","tint50":"#f5daf2","tint60":"#fdf5fc"},"black":"#000000","blackAlpha":{"5":"#0000000d","10":"#0000001a","20":"#00000033","30":"#0000004d","40":"#00000066","50":"#00000080","60":"#00000099","70":"#000000b3","80":"#000000cc","90":"#000000e6"},"blue":{"primary":"#0078d4","shade10":"#006cbf","shade20":"#005ba1","shade30":"#004377","shade40":"#002440","shade50":"#001322","tint10":"#1a86d9","tint20":"#3595de","tint30":"#5caae5","tint40":"#a9d3f2","tint50":"#d0e7f8","tint60":"#f3f9fd"},"brand":{"primary":"#185abd","shade10":"#1651aa","shade20":"#13458f","shade30":"#0e336a","shade40":"#004578","shade50":"#043862","shade60":"#092c47","tint10":"#2e6ac5","tint20":"#6794d7","tint30":"#aec6eb","tint40":"#d2e0f4","tint50":"#deecf9","tint60":"#eff6fc"},"brandShadowAmbient":"#0000004d","brandShadowKey":"#00000040","brass":{"primary":"#986f0b","shade10":"#89640a","shade20":"#745408","shade30":"#553e06","shade40":"#2e2103","shade50":"#181202","tint10":"#a47d1e","tint20":"#b18c34","tint30":"#c1a256","tint40":"#e0cea2","tint50":"#efe4cb","tint60":"#fbf8f2"},"bronze":{"primary":"#a74109","shade10":"#963a08","shade20":"#7f3107","shade30":"#5e2405","shade40":"#321303","shade50":"#1b0a01","tint10":"#b2521e","tint20":"#bc6535","tint30":"#ca8057","tint40":"#e5bba4","tint50":"#f1d9cc","tint60":"#fbf5f2"},"brown":{"primary":"#8e562e","shade10":"#804d29","shade20":"#6c4123","shade30":"#50301a","shade40":"#2b1a0e","shade50":"#170e07","tint10":"#9c663f","tint20":"#a97652","tint30":"#bb8f6f","tint40":"#ddc3b0","tint50":"#edded3","tint60":"#faf7f4"},"burgundy":{"primary":"#a4262c","shade10":"#942228","shade20":"#7d1d21","shade30":"#5c1519","shade40":"#310b0d","shade50":"#1a0607","tint10":"#af393e","tint20":"#ba4d52","tint30":"#c86c70","tint40":"#e4afb2","tint50":"#f0d3d4","tint60":"#fbf4f4"},"charcoal":{"primary":"#393939","shade10":"#333333","shade20":"#2b2b2b","shade30":"#202020","shade40":"#111111","shade50":"#090909","tint10":"#515151","tint20":"#686868","tint30":"#888888","tint40":"#c4c4c4","tint50":"#dfdfdf","tint60":"#f7f7f7"},"cornflower":{"primary":"#4f6bed","shade10":"#4760d5","shade20":"#3c51b4","shade30":"#2c3c85","shade40":"#182047","shade50":"#0d1126","tint10":"#637cef","tint20":"#778df1","tint30":"#93a4f4","tint40":"#c8d1fa","tint50":"#e1e6fc","tint60":"#f7f9fe"},"cranberry":{"primary":"#c50f1f","shade10":"#b10e1c","shade20":"#960b18","shade30":"#6e0811","shade40":"#3b0509","shade50":"#200205","tint10":"#cc2635","tint20":"#d33f4c","tint30":"#dc626d","tint40":"#eeacb2","tint50":"#f6d1d5","tint60":"#fdf3f4"},"cyan":{"primary":"#0099bc","shade10":"#008aa9","shade20":"#00748f","shade30":"#005669","shade40":"#002e38","shade50":"#00181e","tint10":"#18a4c4","tint20":"#31afcc","tint30":"#56bfd7","tint40":"#a4deeb","tint50":"#cdedf4","tint60":"#f2fafc"},"darkBlue":{"primary":"#003966","shade10":"#00335c","shade20":"#002b4e","shade30":"#002039","shade40":"#00111f","shade50":"#000910","tint10":"#0e4a78","tint20":"#215c8b","tint30":"#4178a3","tint40":"#92b5d1","tint50":"#c2d6e7","tint60":"#eff4f9"},"darkBrown":{"primary":"#4d291c","shade10":"#452519","shade20":"#3a1f15","shade30":"#2b1710","shade40":"#170c08","shade50":"#0c0704","tint10":"#623a2b","tint20":"#784d3e","tint30":"#946b5c","tint40":"#caada3","tint50":"#e3d2cb","tint60":"#f8f3f2"},"darkGreen":{"primary":"#0b6a0b","shade10":"#0a5f0a","shade20":"#085108","shade30":"#063b06","shade40":"#032003","shade50":"#021102","tint10":"#1a7c1a","tint20":"#2d8e2d","tint30":"#4da64d","tint40":"#9ad29a","tint50":"#c6e7c6","tint60":"#f0f9f0"},"darkOrange":{"primary":"#da3b01","shade10":"#c43501","shade20":"#a62d01","shade30":"#7a2101","shade40":"#411200","shade50":"#230900","tint10":"#de501c","tint20":"#e36537","tint30":"#e9835e","tint40":"#f4bfab","tint50":"#f9dcd1","tint60":"#fdf6f3"},"darkPurple":{"primary":"#401b6c","shade10":"#3a1861","shade20":"#311552","shade30":"#240f3c","shade40":"#130820","shade50":"#0a0411","tint10":"#512b7e","tint20":"#633e8f","tint30":"#7e5ca7","tint40":"#b9a3d3","tint50":"#d8cce7","tint60":"#f5f2f9"},"darkRed":{"primary":"#750b1c","shade10":"#690a19","shade20":"#590815","shade30":"#420610","shade40":"#230308","shade50":"#130204","tint10":"#861b2c","tint20":"#962f3f","tint30":"#ac4f5e","tint40":"#d69ca5","tint50":"#e9c7cd","tint60":"#f9f0f2"},"darkTeal":{"primary":"#006666","shade10":"#005c5c","shade20":"#004e4e","shade30":"#003939","shade40":"#001f1f","shade50":"#001010","tint10":"#0e7878","tint20":"#218b8b","tint30":"#41a3a3","tint40":"#92d1d1","tint50":"#c2e7e7","tint60":"#eff9f9"},"excel":{"primary":"#107c41","shade10":"#0f703b","shade20":"#0c5f32","shade30":"#094624","shade40":"#094624","shade50":"#052912","shade60":"#03160a","tint10":"#218d51","tint20":"#55b17e","tint30":"#a0d8b9","tint40":"#caead8","tint50":"#a0d8b9","tint60":"#caead8"},"forest":{"primary":"#498205","shade10":"#427505","shade20":"#376304","shade30":"#294903","shade40":"#162702","shade50":"#0c1501","tint10":"#599116","tint20":"#6ba02b","tint30":"#85b44c","tint40":"#bdd99b","tint50":"#dbebc7","tint60":"#f6faf0"},"gold":{"primary":"#c19c00","shade10":"#ae8c00","shade20":"#937700","shade30":"#6c5700","shade40":"#3a2f00","shade50":"#1f1900","tint10":"#c8a718","tint20":"#d0b232","tint30":"#dac157","tint40":"#ecdfa5","tint50":"#f5eece","tint60":"#fdfbf2"},"grape":{"primary":"#881798","shade10":"#7a1589","shade20":"#671174","shade30":"#4c0d55","shade40":"#29072e","shade50":"#160418","tint10":"#952aa4","tint20":"#a33fb1","tint30":"#b55fc1","tint40":"#d9a7e0","tint50":"#eaceef","tint60":"#faf2fb"},"green":{"primary":"#107c10","shade10":"#0e700e","shade20":"#0c5e0c","shade30":"#094509","shade40":"#052505","shade50":"#031403","tint10":"#218c21","tint20":"#359b35","tint30":"#54b054","tint40":"#9fd89f","tint50":"#c9eac9","tint60":"#f1faf1"},"grey":{"0":"#000000","2":"#050505","4":"#0a0a0a","6":"#0f0f0f","8":"#141414","10":"#1a1a1a","12":"#1f1f1f","14":"#242424","16":"#292929","18":"#2e2e2e","20":"#333333","22":"#383838","24":"#3d3d3d","26":"#424242","28":"#474747","30":"#4d4d4d","32":"#525252","34":"#575757","36":"#5c5c5c","38":"#616161","40":"#666666","42":"#6b6b6b","44":"#707070","46":"#757575","48":"#7a7a7a","50":"#808080","52":"#858585","54":"#8a8a8a","56":"#8f8f8f","58":"#949494","60":"#999999","62":"#9e9e9e","64":"#a3a3a3","66":"#a8a8a8","68":"#adadad","70":"#b3b3b3","72":"#b8b8b8","74":"#bdbdbd","76":"#c2c2c2","78":"#c7c7c7","80":"#cccccc","82":"#d1d1d1","84":"#d6d6d6","86":"#dbdbdb","88":"#e0e0e0","90":"#e6e6e6","92":"#ebebeb","94":"#f0f0f0","96":"#f5f5f5","98":"#fafafa","100":"#ffffff"},"hotPink":{"primary":"#e3008c","shade10":"#cc007e","shade20":"#ad006a","shade30":"#7f004e","shade40":"#44002a","shade50":"#240016","tint10":"#e61c99","tint20":"#ea38a6","tint30":"#ee5fb7","tint40":"#f7adda","tint50":"#fbd2eb","tint60":"#fef4fa"},"lavender":{"primary":"#7160e8","shade10":"#6656d1","shade20":"#5649b0","shade30":"#3f3682","shade40":"#221d46","shade50":"#120f25","tint10":"#8172eb","tint20":"#9184ee","tint30":"#a79cf1","tint40":"#d2ccf8","tint50":"#e7e4fb","tint60":"#f9f8fe"},"lightBlue":{"primary":"#3a96dd","shade10":"#3487c7","shade20":"#2c72a8","shade30":"#20547c","shade40":"#112d42","shade50":"#091823","tint10":"#4fa1e1","tint20":"#65ade5","tint30":"#83bdeb","tint40":"#bfddf5","tint50":"#dcedfa","tint60":"#f6fafe"},"lightGreen":{"primary":"#13a10e","shade10":"#11910d","shade20":"#0e7a0b","shade30":"#0b5a08","shade40":"#063004","shade50":"#031a02","tint10":"#27ac22","tint20":"#3db838","tint30":"#5ec75a","tint40":"#a7e3a5","tint50":"#cef0cd","tint60":"#f2fbf2"},"lightTeal":{"primary":"#00b7c3","shade10":"#00a5af","shade20":"#008b94","shade30":"#00666d","shade40":"#00373a","shade50":"#001d1f","tint10":"#18bfca","tint20":"#32c8d1","tint30":"#58d3db","tint40":"#a6e9ed","tint50":"#cef3f5","tint60":"#f2fcfd"},"lilac":{"primary":"#b146c2","shade10":"#9f3faf","shade20":"#863593","shade30":"#63276d","shade40":"#35153a","shade50":"#1c0b1f","tint10":"#ba58c9","tint20":"#c36bd1","tint30":"#cf87da","tint40":"#e6bfed","tint50":"#f2dcf5","tint60":"#fcf6fd"},"lime":{"primary":"#73aa24","shade10":"#689920","shade20":"#57811b","shade30":"#405f14","shade40":"#23330b","shade50":"#121b06","tint10":"#81b437","tint20":"#90be4c","tint30":"#a4cc6c","tint40":"#cfe5af","tint50":"#e5f1d3","tint60":"#f8fcf4"},"magenta":{"primary":"#bf0077","shade10":"#ac006b","shade20":"#91005a","shade30":"#6b0043","shade40":"#390024","shade50":"#1f0013","tint10":"#c71885","tint20":"#ce3293","tint30":"#d957a8","tint40":"#eca5d1","tint50":"#f5cee6","tint60":"#fcf2f9"},"marigold":{"primary":"#eaa300","shade10":"#d39300","shade20":"#b27c00","shade30":"#835b00","shade40":"#463100","shade50":"#251a00","tint10":"#edad1c","tint20":"#efb839","tint30":"#f2c661","tint40":"#f9e2ae","tint50":"#fcefd3","tint60":"#fefbf4"},"mink":{"primary":"#5d5a58","shade10":"#54514f","shade20":"#474443","shade30":"#343231","shade40":"#1c1b1a","shade50":"#0f0e0e","tint10":"#706d6b","tint20":"#84817e","tint30":"#9e9b99","tint40":"#cecccb","tint50":"#e5e4e3","tint60":"#f8f8f8"},"navy":{"primary":"#0027b4","shade10":"#0023a2","shade20":"#001e89","shade30":"#001665","shade40":"#000c36","shade50":"#00061d","tint10":"#173bbd","tint20":"#3050c6","tint30":"#546fd2","tint40":"#a3b2e8","tint50":"#ccd5f3","tint60":"#f2f4fc"},"neutralShadowAmbient":"#0000001f","neutralShadowKey":"#00000024","office":{"primary":"#d83b01","shade10":"#c33400","shade20":"#a52c00","shade30":"#792000","shade40":"#792000","shade50":"#4d2415","shade60":"#29130b","tint10":"#dd4f1b","tint20":"#e8825d","tint30":"#f4beaa","tint40":"#f9dcd1","tint50":"#f4beaa","tint60":"#f9dcd1"},"oneNote":{"primary":"#80397b","shade10":"#6c2f68","shade20":"#52254f","shade30":"#3c1a3a","shade40":"#430e60","shade50":"#430e60","shade60":"#430e60","tint10":"#9e5499","tint20":"#d4a9d1","tint30":"#e0bfde","tint40":"#f0daee","tint50":"#e6d1f2","tint60":"#e6d1f2"},"orange":{"primary":"#f7630c","shade10":"#de590b","shade20":"#bc4b09","shade30":"#8a3707","shade40":"#4a1e04","shade50":"#271002","tint10":"#f87528","tint20":"#f98845","tint30":"#faa06b","tint40":"#fdcfb4","tint50":"#fee5d7","tint60":"#fff9f5"},"orchid":{"primary":"#8764b8","shade10":"#795aa6","shade20":"#674c8c","shade30":"#4c3867","shade40":"#281e37","shade50":"#16101d","tint10":"#9373c0","tint20":"#a083c9","tint30":"#b29ad4","tint40":"#d7caea","tint50":"#e9e2f4","tint60":"#f9f8fc"},"outlook":{"primary":"#0078d4","shade10":"#106ebe","shade20":"#1664a7","shade30":"#135995","shade40":"#004578","shade50":"#043862","shade60":"#092c47","tint10":"#2488d8","tint20":"#69afe5","tint30":"#b3d6f2","tint40":"#cce3f5","tint50":"#deecf9","tint60":"#eff6fc"},"peach":{"primary":"#ff8c00","shade10":"#e67e00","shade20":"#c26a00","shade30":"#8f4e00","shade40":"#4d2a00","shade50":"#291600","tint10":"#ff9a1f","tint20":"#ffa83d","tint30":"#ffba66","tint40":"#ffddb3","tint50":"#ffedd6","tint60":"#fffaf5"},"pink":{"primary":"#e43ba6","shade10":"#cd3595","shade20":"#ad2d7e","shade30":"#80215d","shade40":"#441232","shade50":"#24091b","tint10":"#e750b0","tint20":"#ea66ba","tint30":"#ef85c8","tint40":"#f7c0e3","tint50":"#fbddf0","tint60":"#fef6fb"},"platinum":{"primary":"#69797e","shade10":"#5f6d71","shade20":"#505c60","shade30":"#3b4447","shade40":"#1f2426","shade50":"#111314","tint10":"#79898d","tint20":"#89989d","tint30":"#a0adb2","tint40":"#cdd6d8","tint50":"#e4e9ea","tint60":"#f8f9fa"},"plum":{"primary":"#77004d","shade10":"#6b0045","shade20":"#5a003b","shade30":"#43002b","shade40":"#240017","shade50":"#13000c","tint10":"#87105d","tint20":"#98246f","tint30":"#ad4589","tint40":"#d696c0","tint50":"#e9c4dc","tint60":"#faf0f6"},"powerPoint":{"primary":"#c43e1c","shade10":"#b13719","shade20":"#952f15","shade30":"#6e220f","shade40":"#6e220f","shade50":"#3c1805","shade60":"#200d03","tint10":"#cb5031","tint20":"#dc816a","tint30":"#edbcb0","tint40":"#f6dbd4","tint50":"#edbcb0","tint60":"#f6dbd4"},"pumpkin":{"primary":"#ca5010","shade10":"#b6480e","shade20":"#9a3d0c","shade30":"#712d09","shade40":"#3d1805","shade50":"#200d03","tint10":"#d06228","tint20":"#d77440","tint30":"#df8e64","tint40":"#efc4ad","tint50":"#f7dfd2","tint60":"#fdf7f4"},"purple":{"primary":"#5c2e91","shade10":"#532982","shade20":"#46236e","shade30":"#341a51","shade40":"#1c0e2b","shade50":"#0f0717","tint10":"#6b3f9e","tint20":"#7c52ab","tint30":"#9470bd","tint40":"#c6b1de","tint50":"#e0d3ed","tint60":"#f7f4fb"},"red":{"primary":"#d13438","shade10":"#bc2f32","shade20":"#9f282b","shade30":"#751d1f","shade40":"#3f1011","shade50":"#210809","tint10":"#d7494c","tint20":"#dc5e62","tint30":"#e37d80","tint40":"#f1bbbc","tint50":"#f8dadb","tint60":"#fdf6f6"},"royalBlue":{"primary":"#004e8c","shade10":"#00467e","shade20":"#003b6a","shade30":"#002c4e","shade40":"#00172a","shade50":"#000c16","tint10":"#125e9a","tint20":"#286fa8","tint30":"#4a89ba","tint40":"#9abfdc","tint50":"#c7dced","tint60":"#f0f6fa"},"seafoam":{"primary":"#00cc6a","shade10":"#00b85f","shade20":"#009b51","shade30":"#00723b","shade40":"#003d20","shade50":"#002111","tint10":"#19d279","tint20":"#34d889","tint30":"#5ae0a0","tint40":"#a8f0cd","tint50":"#cff7e4","tint60":"#f3fdf8"},"silver":{"primary":"#859599","shade10":"#78868a","shade20":"#657174","shade30":"#4a5356","shade40":"#282d2e","shade50":"#151818","tint10":"#92a1a5","tint20":"#a0aeb1","tint30":"#b3bfc2","tint40":"#d8dfe0","tint50":"#eaeeef","tint60":"#fafbfb"},"steel":{"primary":"#005b70","shade10":"#005265","shade20":"#004555","shade30":"#00333f","shade40":"#001b22","shade50":"#000f12","tint10":"#0f6c81","tint20":"#237d92","tint30":"#4496a9","tint40":"#94c8d4","tint50":"#c3e1e8","tint60":"#eff7f9"},"teal":{"primary":"#038387","shade10":"#037679","shade20":"#026467","shade30":"#02494c","shade40":"#012728","shade50":"#001516","tint10":"#159195","tint20":"#2aa0a4","tint30":"#4cb4b7","tint40":"#9bd9db","tint50":"#c7ebec","tint60":"#f0fafa"},"white":"#ffffff","whiteAlpha":{"5":"#ffffff0d","10":"#ffffff1a","20":"#ffffff33","30":"#ffffff4d","40":"#ffffff66","50":"#ffffff80","60":"#ffffff99","70":"#ffffffb3","80":"#ffffffcc","90":"#ffffffe6"},"word":{"primary":"#185abd","shade10":"#1651aa","shade20":"#13458f","shade30":"#0e336a","shade40":"#0e336a","shade50":"#0c2145","shade60":"#071225","tint10":"#2e6ac5","tint20":"#6794d7","tint30":"#aec6eb","tint40":"#d2e0f4","tint50":"#aec6eb","tint60":"#d2e0f4"},"yellow":{"primary":"#fde300","shade10":"#e4cc00","shade20":"#c0ad00","shade30":"#8e7f00","shade40":"#4c4400","shade50":"#282400","tint10":"#fde61e","tint20":"#fdea3d","tint30":"#feee66","tint40":"#fef7b2","tint50":"#fffad6","tint60":"#fffef5"},"hcButtonFace":"PlatformColor(ButtonFace)","hcButtonText":"PlatformColor(ButtonText)","hcCanvas":"PlatformColor(Window)","hcCanvasText":"PlatformColor(WindowText)","hcDisabled":"PlatformColor(GrayText)","hcHighlight":"PlatformColor(Highlight)","hcHighlightText":"PlatformColor(HighlightText)","hcHyperlink":"PlatformColor(Hotlight)"},"corner":{"radius":{"circle":9999,"extraLarge":8,"large":6,"medium":4,"none":0,"small":2}},"font":{"family":{"default":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","monospace":"Consolas, \\"Courier New\\", monospace","numeric":"\\"Bahnschrift\\", \\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif"},"lineHeight":{"100":14,"200":16,"300":20,"400":22,"500":28,"600":32,"700":36,"800":40,"900":52,"1000":92},"size":{"100":10,"200":12,"300":14,"400":16,"500":20,"600":24,"700":28,"800":32,"900":40,"1000":68},"weight":{"bold":"700","medium":"500","regular":"400","semibold":"600"}},"shadow":{"2":[{"x":0,"y":0,"blur":2,"color":"#0000001f"},{"x":0,"y":1,"blur":2,"color":"#00000024"}],"4":[{"x":0,"y":0,"blur":2,"color":"#0000001f"},{"x":0,"y":2,"blur":4,"color":"#00000024"}],"8":[{"x":0,"y":0,"blur":2,"color":"#0000001f"},{"x":0,"y":4,"blur":8,"color":"#00000024"}],"16":[{"x":0,"y":0,"blur":2,"color":"#0000001f"},{"x":0,"y":8,"blur":16,"color":"#00000024"}],"28":[{"x":0,"y":0,"blur":8,"color":"#0000001f"},{"x":0,"y":14,"blur":28,"color":"#00000024"}],"64":[{"x":0,"y":0,"blur":8,"color":"#0000001f"},{"x":0,"y":32,"blur":64,"color":"#00000024"}],"brand":{"2":[{"x":0,"y":0,"blur":2,"color":"#0000004d"},{"x":0,"y":1,"blur":2,"color":"#00000040"}],"4":[{"x":0,"y":0,"blur":2,"color":"#0000004d"},{"x":0,"y":2,"blur":4,"color":"#00000040"}],"8":[{"x":0,"y":0,"blur":2,"color":"#0000004d"},{"x":0,"y":4,"blur":8,"color":"#00000040"}],"16":[{"x":0,"y":0,"blur":2,"color":"#0000004d"},{"x":0,"y":8,"blur":16,"color":"#00000040"}],"28":[{"x":0,"y":0,"blur":8,"color":"#0000004d"},{"x":0,"y":14,"blur":28,"color":"#00000040"}],"64":[{"x":0,"y":0,"blur":8,"color":"#0000004d"},{"x":0,"y":32,"blur":64,"color":"#00000040"}]}},"spacing":{"l":16,"m":12,"mNudge":10,"none":0,"s":8,"sNudge":6,"xl":20,"xs":4,"xxl":24,"xxs":2,"xxxl":32},"stroke":{"width":{"thick":2,"thicker":3,"thickest":4,"thin":1}}}')},function(e){e.exports=JSON.parse('{"body":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":20,"fontSize":14,"fontWeight":"400"},"bodyStrong":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":20,"fontSize":14,"fontWeight":"600"},"borderless":{"strokeAlignment":"inner","strokeColorRest":"transparent","strokeColorHover":"transparent","strokeColorPressed":"transparent","strokeColorDisabled":"transparent","strokeWidth":1},"brandBackground":{"fillColorRest":"#0078d4","fillColorHover":"#106ebe","fillColorPressed":"#004578","fillColorSelected":"#005a9e"},"brandBackground2":{"fillColorRest":"#eff6fc"},"brandBackgroundStatic":{"fillColorRest":"#0078d4"},"brandForeground1":{"fillColorRest":"#0078d4"},"brandForeground2":{"fillColorRest":"#106ebe"},"brandForegroundLink":{"fillColorRest":"#106ebe","fillColorHover":"#005a9e","fillColorPressed":"#004578","fillColorSelected":"#106ebe"},"brandStroke1":{"strokeColorRest":"#0078d4","strokeWidth":1},"brandStroke2":{"strokeColorRest":"#c7e0f4","strokeWidth":1},"caption":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":16,"fontSize":12,"fontWeight":"400"},"compoundBrandBackground1":{"fillColorRest":"#0078d4","fillColorHover":"#106ebe","fillColorPressed":"#005a9e"},"compoundBrandForeground1":{"fillColorRest":"#0078d4","fillColorHover":"#106ebe","fillColorPressed":"#005a9e"},"compoundBrandStroke1":{"strokeColorRest":"#0078d4","strokeColorHover":"#106ebe","strokeColorPressed":"#005a9e","strokeWidth":1},"display":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":92,"fontSize":68,"fontWeight":"600"},"headline":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":28,"fontSize":20,"fontWeight":"600"},"largeTitle":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":52,"fontSize":40,"fontWeight":"600"},"neutralBackground1":{"fillColorRest":"#ffffff","fillColorHover":"#f5f5f5","fillColorPressed":"#e0e0e0","fillColorSelected":"#ebebeb"},"neutralBackground2":{"fillColorRest":"#fafafa","fillColorHover":"#f0f0f0","fillColorPressed":"#dbdbdb","fillColorSelected":"#e6e6e6"},"neutralBackground3":{"fillColorRest":"#f5f5f5","fillColorHover":"#ebebeb","fillColorPressed":"#d6d6d6","fillColorSelected":"#e0e0e0"},"neutralBackground4":{"fillColorRest":"#f0f0f0","fillColorHover":"#fafafa","fillColorPressed":"#f5f5f5","fillColorSelected":"#ffffff"},"neutralBackground5":{"fillColorRest":"#ebebeb","fillColorHover":"#f5f5f5","fillColorPressed":"#f0f0f0","fillColorSelected":"#fafafa"},"neutralBackground6":{"fillColorRest":"#e6e6e6"},"neutralBackgroundDisabled":{"fillColorRest":"#f0f0f0"},"neutralBackgroundInverted":{"fillColorRest":"#616161"},"neutralForeground1":{"fillColorRest":"#242424","fillColorHover":"#242424","fillColorPressed":"#242424","fillColorSelected":"#242424"},"neutralForeground2":{"fillColorRest":"#424242","fillColorHover":"#242424","fillColorPressed":"#242424","fillColorBrandHover":"#0078d4","fillColorBrandPressed":"#106ebe","fillColorBrandSelected":"#0078d4","fillColorSelected":"#242424"},"neutralForeground3":{"fillColorRest":"#616161","fillColorHover":"#424242","fillColorPressed":"#424242","fillColorBrandHover":"#0078d4","fillColorBrandPressed":"#106ebe","fillColorBrandSelected":"#0078d4","fillColorSelected":"#424242"},"neutralForeground4":{"fillColorRest":"#707070"},"neutralForegroundDisabled":{"fillColorRest":"#bdbdbd"},"neutralForegroundInverted":{"fillColorRest":"#ffffff"},"neutralForegroundInvertedLink":{"fillColorRest":"#ffffff","fillColorHover":"#ffffff","fillColorPressed":"#ffffff","fillColorSelected":"#ffffff"},"neutralForegroundOnBrand":{"fillColorRest":"#ffffff","fillColorHover":"#ffffff","fillColorPressed":"#ffffff","fillColorSelected":"#ffffff"},"neutralStencil1":{"fillColorRest":"#e6e6e6"},"neutralStencil2":{"fillColorRest":"#fafafa"},"neutralStroke1":{"strokeColorRest":"#d1d1d1","strokeColorHover":"#c7c7c7","strokeColorPressed":"#b3b3b3","strokeColorSelected":"#bdbdbd","strokeWidth":1},"neutralStroke2":{"strokeColorRest":"#e0e0e0","strokeWidth":1},"neutralStroke3":{"strokeColorRest":"#f0f0f0","strokeWidth":1},"neutralStrokeAccessible":{"strokeColorRest":"#616161","strokeColorHover":"#575757","strokeColorPressed":"#4d4d4d","strokeColorSelected":"#0078d4","strokeWidth":1},"neutralStrokeDisabled":{"strokeColorRest":"#e0e0e0","strokeWidth":1},"redBackground1":{"fillColorRest":"#f9f0f2"},"redBackground2":{"fillColorRest":"#d69ca5"},"redBackground3":{"fillColorRest":"#750b1c"},"redBorder1":{"strokeColorRest":"#d69ca5","strokeWidth":1},"redBorder2":{"strokeColorRest":"#750b1c","strokeWidth":1},"redBorderActive":{"strokeColorRest":"#750b1c","strokeWidth":1},"redForeground1":{"fillColorRest":"#690a19"},"redForeground2":{"fillColorRest":"#420610"},"redForeground3":{"fillColorRest":"#750b1c"},"strokeFocus1":{"strokeColorRest":"#ffffff","strokeWidth":1},"strokeFocus2":{"strokeColorRest":"#000000","strokeWidth":1},"subheadline":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":22,"fontSize":16,"fontWeight":"600"},"subtleBackground":{"fillColorRest":"transparent","fillColorHover":"#f5f5f5","fillColorPressed":"#e0e0e0","fillColorSelected":"#ebebeb"},"title1":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":40,"fontSize":32,"fontWeight":"600"},"title2":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":36,"fontSize":28,"fontWeight":"600"},"title3":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":32,"fontSize":24,"fontWeight":"600"},"transparentBackground":{"fillColorRest":"transparent","fillColorHover":"transparent","fillColorPressed":"transparent","fillColorSelected":"transparent"},"transparentStroke":{"strokeAlignment":"inner","strokeColorRest":"transparent","strokeColorHover":"transparent","strokeColorPressed":"transparent","strokeColorDisabled":"transparent","strokeWidth":1}}')},function(e){e.exports=JSON.parse('{"body":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":20,"fontSize":14,"fontWeight":"400"},"bodyStrong":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":20,"fontSize":14,"fontWeight":"600"},"borderless":{"strokeAlignment":"inner","strokeColorRest":"transparent","strokeColorHover":"transparent","strokeColorPressed":"transparent","strokeColorDisabled":"transparent","strokeWidth":1},"brandBackground":{"fillColorRest":"#106ebe","fillColorHover":"#0078d4","fillColorPressed":"#004578","fillColorSelected":"#005a9e"},"brandBackground2":{"fillColorRest":"#004578"},"brandBackgroundStatic":{"fillColorRest":"#0078d4"},"brandForeground1":{"fillColorRest":"#3aa0f3"},"brandForeground2":{"fillColorRest":"#6cb8f6"},"brandForegroundLink":{"fillColorRest":"#2899f5","fillColorHover":"#6cb8f6","fillColorPressed":"#3aa0f3","fillColorSelected":"#2899f5"},"brandStroke1":{"strokeColorRest":"#2899f5","strokeWidth":1},"brandStroke2":{"strokeColorRest":"#004c87","strokeWidth":1},"caption":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":16,"fontSize":12,"fontWeight":"400"},"compoundBrandBackground1":{"fillColorRest":"#2899f5","fillColorHover":"#3aa0f3","fillColorPressed":"#0078d4"},"compoundBrandForeground1":{"fillColorRest":"#2899f5","fillColorHover":"#3aa0f3","fillColorPressed":"#0078d4"},"compoundBrandStroke1":{"strokeColorRest":"#2899f5","strokeColorHover":"#3aa0f3","strokeColorPressed":"#0078d4","strokeWidth":1},"display":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":92,"fontSize":68,"fontWeight":"600"},"headline":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":28,"fontSize":20,"fontWeight":"600"},"largeTitle":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":52,"fontSize":40,"fontWeight":"600"},"neutralBackground1":{"fillColorRest":"#292929","fillColorHover":"#3d3d3d","fillColorPressed":"#1f1f1f","fillColorSelected":"#383838"},"neutralBackground2":{"fillColorRest":"#1f1f1f","fillColorHover":"#333333","fillColorPressed":"#141414","fillColorSelected":"#2e2e2e"},"neutralBackground3":{"fillColorRest":"#141414","fillColorHover":"#292929","fillColorPressed":"#0a0a0a","fillColorSelected":"#242424"},"neutralBackground4":{"fillColorRest":"#0a0a0a","fillColorHover":"#1f1f1f","fillColorPressed":"#000000","fillColorSelected":"#1a1a1a"},"neutralBackground5":{"fillColorRest":"#000000","fillColorHover":"#141414","fillColorPressed":"#050505","fillColorSelected":"#0f0f0f"},"neutralBackground6":{"fillColorRest":"#333333"},"neutralBackgroundDisabled":{"fillColorRest":"#141414"},"neutralBackgroundInverted":{"fillColorRest":"#ffffff"},"neutralForeground1":{"fillColorRest":"#ffffff","fillColorHover":"#ffffff","fillColorPressed":"#ffffff","fillColorSelected":"#ffffff"},"neutralForeground2":{"fillColorRest":"#d6d6d6","fillColorHover":"#ffffff","fillColorPressed":"#ffffff","fillColorBrandHover":"#3aa0f3","fillColorBrandPressed":"#2899f5","fillColorBrandSelected":"#3aa0f3","fillColorSelected":"#ffffff"},"neutralForeground3":{"fillColorRest":"#adadad","fillColorHover":"#d6d6d6","fillColorPressed":"#d6d6d6","fillColorBrandHover":"#3aa0f3","fillColorBrandPressed":"#2899f5","fillColorBrandSelected":"#3aa0f3","fillColorSelected":"#d6d6d6"},"neutralForeground4":{"fillColorRest":"#999999"},"neutralForegroundDisabled":{"fillColorRest":"#5c5c5c"},"neutralForegroundInverted":{"fillColorRest":"#242424"},"neutralForegroundInvertedLink":{"fillColorRest":"#ffffff","fillColorHover":"#ffffff","fillColorPressed":"#ffffff","fillColorSelected":"#ffffff"},"neutralForegroundOnBrand":{"fillColorRest":"#ffffff","fillColorHover":"#ffffff","fillColorPressed":"#ffffff","fillColorSelected":"#ffffff"},"neutralStencil1":{"fillColorRest":"#333333"},"neutralStencil2":{"fillColorRest":"#575757"},"neutralStroke1":{"strokeColorRest":"#666666","strokeColorHover":"#757575","strokeColorPressed":"#6b6b6b","strokeColorSelected":"#707070","strokeWidth":1},"neutralStroke2":{"strokeColorRest":"#525252","strokeWidth":1},"neutralStroke3":{"strokeColorRest":"#3d3d3d","strokeWidth":1},"neutralStrokeAccessible":{"strokeColorRest":"#adadad","strokeColorHover":"#bdbdbd","strokeColorPressed":"#b3b3b3","strokeColorSelected":"#3aa0f3","strokeWidth":1},"neutralStrokeDisabled":{"strokeColorRest":"#424242","strokeWidth":1},"redBackground1":{"fillColorRest":"#230308"},"redBackground2":{"fillColorRest":"#420610"},"redBackground3":{"fillColorRest":"#750b1c"},"redBorder1":{"strokeColorRest":"#750b1c","strokeWidth":1},"redBorder2":{"strokeColorRest":"#962f3f","strokeWidth":1},"redBorderActive":{"strokeColorRest":"#ac4f5e","strokeWidth":1},"redForeground1":{"fillColorRest":"#ac4f5e"},"redForeground2":{"fillColorRest":"#d69ca5"},"redForeground3":{"fillColorRest":"#962f3f"},"strokeFocus1":{"strokeColorRest":"#000000","strokeWidth":1},"strokeFocus2":{"strokeColorRest":"#ffffff","strokeWidth":1},"subheadline":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":22,"fontSize":16,"fontWeight":"600"},"subtleBackground":{"fillColorRest":"transparent","fillColorHover":"#383838","fillColorPressed":"#2e2e2e","fillColorSelected":"#333333"},"title1":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":40,"fontSize":32,"fontWeight":"600"},"title2":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":36,"fontSize":28,"fontWeight":"600"},"title3":{"fontFamily":"\\"Segoe UI\\", Roboto, \\"SF Pro Text\\", \\"Helvetica Neue\\", Helvetica, Arial, sans-serif","fontLineHeight":32,"fontSize":24,"fontWeight":"600"},"transparentBackground":{"fillColorRest":"transparent","fillColorHover":"transparent","fillColorPressed":"transparent","fillColorSelected":"transparent"},"transparentStroke":{"strokeAlignment":"inner","strokeColorRest":"transparent","strokeColorHover":"transparent","strokeColorPressed":"transparent","strokeColorDisabled":"transparent","strokeWidth":1}}')},function(e){e.exports=JSON.parse('{"brandBackground":{"fillColorRest":"#185abd","fillColorHover":"#1651aa","fillColorPressed":"#0e336a","fillColorSelected":"#13458f"},"brandBackground2":{"fillColorRest":"#d2e0f4"},"brandBackgroundStatic":{"fillColorRest":"#185abd"},"brandForeground1":{"fillColorRest":"#aec6eb"},"brandForeground2":{"fillColorRest":"#d2e0f4"},"brandForegroundLink":{"fillColorRest":"#aec6eb","fillColorHover":"#d2e0f4","fillColorPressed":"#2e6ac5","fillColorSelected":"#d2e0f4"},"brandStroke1":{"strokeColorRest":"#185abd","strokeWidth":1},"brandStroke2":{"strokeColorRest":"#6794d7","strokeWidth":1},"compoundBrandBackground1":{"fillColorRest":"#185abd","fillColorHover":"#1651aa","fillColorPressed":"#0e336a"},"compoundBrandForeground1":{"fillColorRest":"#aec6eb","fillColorHover":"#d2e0f4","fillColorPressed":"#2e6ac5"},"compoundBrandStroke1":{"strokeColorRest":"#185abd","strokeColorHover":"#1651aa","strokeColorPressed":"#0e336a","strokeWidth":1},"neutralBackground1":{"fillColorRest":"#4d4d4d","fillColorHover":"#5c5c5c","fillColorPressed":"#424242","fillColorSelected":"#575757"},"neutralBackground2":{"fillColorRest":"#424242","fillColorHover":"#525252","fillColorPressed":"#383838","fillColorSelected":"#4d4d4d"},"neutralBackground3":{"fillColorRest":"#383838","fillColorHover":"#474747","fillColorPressed":"#2e2e2e","fillColorSelected":"#424242"},"neutralBackground4":{"fillColorRest":"#2e2e2e","fillColorHover":"#3d3d3d","fillColorPressed":"#242424","fillColorSelected":"#383838"},"neutralBackground5":{"fillColorRest":"#242424","fillColorHover":"#333333","fillColorPressed":"#1a1a1a","fillColorSelected":"#2e2e2e"},"neutralBackground6":{"fillColorRest":"#1a1a1a"},"neutralBackgroundDisabled":{"fillColorRest":"#383838"},"neutralBackgroundInverted":{"fillColorRest":"#ffffff"},"neutralForeground1":{"fillColorRest":"#ffffff","fillColorHover":"#ffffff","fillColorPressed":"#ffffff","fillColorSelected":"#ffffff"},"neutralForeground2":{"fillColorRest":"#e6e6e6","fillColorHover":"#ffffff","fillColorPressed":"#ffffff","fillColorBrandHover":"#d2e0f4","fillColorBrandPressed":"#2e6ac5","fillColorBrandSelected":"#d2e0f4","fillColorSelected":"#ffffff"},"neutralForeground3":{"fillColorRest":"#cccccc","fillColorHover":"#e6e6e6","fillColorPressed":"#e6e6e6","fillColorBrandHover":"#d2e0f4","fillColorBrandPressed":"#2e6ac5","fillColorBrandSelected":"#d2e0f4","fillColorSelected":"#e6e6e6"},"neutralForeground4":{"fillColorRest":"#c2c2c2"},"neutralForegroundDisabled":{"fillColorRest":"#666666"},"neutralForegroundInverted":{"fillColorRest":"#000000"},"neutralForegroundInvertedLink":{"fillColorRest":"#4d4d4d","fillColorHover":"#4d4d4d","fillColorPressed":"#4d4d4d","fillColorSelected":"#4d4d4d"},"neutralForegroundOnBrand":{"fillColorRest":"#ffffff","fillColorHover":"#ffffff","fillColorPressed":"#ffffff","fillColorSelected":"#ffffff"},"neutralStencil1":{"fillColorRest":"#1a1a1a"},"neutralStencil2":{"fillColorRest":"#424242"},"neutralStroke1":{"strokeColorRest":"#8a8a8a","strokeColorHover":"#999999","strokeColorPressed":"#8f8f8f","strokeColorSelected":"#949494","strokeWidth":1},"neutralStroke2":{"strokeColorRest":"#757575","strokeWidth":1},"neutralStroke3":{"strokeColorRest":"#616161","strokeWidth":1},"neutralStrokeAccessible":{"strokeColorRest":"#a8a8a8","strokeColorHover":"#b8b8b8","strokeColorPressed":"#adadad","strokeColorSelected":"#185abd","strokeWidth":1},"neutralStrokeDisabled":{"strokeColorRest":"#474747","strokeWidth":1},"redBackground1":{"fillColorRest":"#230308"},"redBackground2":{"fillColorRest":"#420610"},"redBackground3":{"fillColorRest":"#750b1c"},"redBorder1":{"strokeColorRest":"#750b1c","strokeWidth":1},"redBorder2":{"strokeColorRest":"#962f3f","strokeWidth":1},"redBorderActive":{"strokeColorRest":"#ac4f5e","strokeWidth":1},"redForeground1":{"fillColorRest":"#ac4f5e"},"redForeground2":{"fillColorRest":"#d69ca5"},"redForeground3":{"fillColorRest":"#962f3f"},"strokeFocus1":{"strokeColorRest":"#000000","strokeWidth":1},"strokeFocus2":{"strokeColorRest":"#ffffff","strokeWidth":1},"subtleBackground":{"fillColorRest":"transparent","fillColorHover":"#5c5c5c","fillColorPressed":"#424242","fillColorSelected":"#575757"},"transparentBackground":{"fillColorRest":"transparent","fillColorHover":"transparent","fillColorPressed":"transparent","fillColorSelected":"transparent"},"transparentStroke":{"strokeAlignment":"inner","strokeColorRest":"transparent","strokeColorHover":"transparent","strokeColorPressed":"transparent","strokeColorDisabled":"transparent","strokeWidth":1}}')},function(e){e.exports=JSON.parse('{"brandBackground":{"fillColorRest":"#185abd","fillColorHover":"#1651aa","fillColorPressed":"#0e336a","fillColorSelected":"#13458f"},"brandBackground2":{"fillColorRest":"#d2e0f4"},"brandBackgroundStatic":{"fillColorRest":"#185abd"},"brandForeground1":{"fillColorRest":"#aec6eb"},"brandForeground2":{"fillColorRest":"#d2e0f4"},"brandForegroundLink":{"fillColorRest":"#aec6eb","fillColorHover":"#d2e0f4","fillColorPressed":"#2e6ac5","fillColorSelected":"#d2e0f4"},"brandStroke1":{"strokeColorRest":"#185abd","strokeWidth":1},"brandStroke2":{"strokeColorRest":"#6794d7","strokeWidth":1},"compoundBrandBackground1":{"fillColorRest":"#185abd","fillColorHover":"#1651aa","fillColorPressed":"#0e336a"},"compoundBrandForeground1":{"fillColorRest":"#aec6eb","fillColorHover":"#d2e0f4","fillColorPressed":"#2e6ac5"},"compoundBrandStroke1":{"strokeColorRest":"#185abd","strokeColorHover":"#1651aa","strokeColorPressed":"#0e336a","strokeWidth":1},"neutralBackground1":{"fillColorRest":"#292929","fillColorHover":"#3d3d3d","fillColorPressed":"#1f1f1f","fillColorSelected":"#383838"},"neutralBackground2":{"fillColorRest":"#1f1f1f","fillColorHover":"#333333","fillColorPressed":"#141414","fillColorSelected":"#2e2e2e"},"neutralBackground3":{"fillColorRest":"#141414","fillColorHover":"#292929","fillColorPressed":"#0a0a0a","fillColorSelected":"#242424"},"neutralBackground4":{"fillColorRest":"#0a0a0a","fillColorHover":"#1f1f1f","fillColorPressed":"#000000","fillColorSelected":"#1a1a1a"},"neutralBackground5":{"fillColorRest":"#000000","fillColorHover":"#141414","fillColorPressed":"#050505","fillColorSelected":"#0f0f0f"},"neutralBackground6":{"fillColorRest":"#333333"},"neutralBackgroundDisabled":{"fillColorRest":"#141414"},"neutralBackgroundInverted":{"fillColorRest":"#ffffff"},"neutralForeground1":{"fillColorRest":"#ffffff","fillColorHover":"#ffffff","fillColorPressed":"#ffffff","fillColorSelected":"#ffffff"},"neutralForeground2":{"fillColorRest":"#d6d6d6","fillColorHover":"#ffffff","fillColorPressed":"#ffffff","fillColorBrandHover":"#d2e0f4","fillColorBrandPressed":"#2e6ac5","fillColorBrandSelected":"#d2e0f4","fillColorSelected":"#ffffff"},"neutralForeground3":{"fillColorRest":"#adadad","fillColorHover":"#d6d6d6","fillColorPressed":"#d6d6d6","fillColorBrandHover":"#d2e0f4","fillColorBrandPressed":"#2e6ac5","fillColorBrandSelected":"#d2e0f4","fillColorSelected":"#d6d6d6"},"neutralForeground4":{"fillColorRest":"#999999"},"neutralForegroundDisabled":{"fillColorRest":"#5c5c5c"},"neutralForegroundInverted":{"fillColorRest":"#000000"},"neutralForegroundInvertedLink":{"fillColorRest":"#292929","fillColorHover":"#292929","fillColorPressed":"#292929","fillColorSelected":"#292929"},"neutralForegroundOnBrand":{"fillColorRest":"#ffffff","fillColorHover":"#ffffff","fillColorPressed":"#ffffff","fillColorSelected":"#ffffff"},"neutralStencil1":{"fillColorRest":"#333333"},"neutralStencil2":{"fillColorRest":"#575757"},"neutralStroke1":{"strokeColorRest":"#666666","strokeColorHover":"#757575","strokeColorPressed":"#6b6b6b","strokeColorSelected":"#707070","strokeWidth":1},"neutralStroke2":{"strokeColorRest":"#525252","strokeWidth":1},"neutralStroke3":{"strokeColorRest":"#3d3d3d","strokeWidth":1},"neutralStrokeAccessible":{"strokeColorRest":"#adadad","strokeColorHover":"#bdbdbd","strokeColorPressed":"#b3b3b3","strokeColorSelected":"#185abd","strokeWidth":1},"neutralStrokeDisabled":{"strokeColorRest":"#424242","strokeWidth":1},"redBackground1":{"fillColorRest":"#230308"},"redBackground2":{"fillColorRest":"#420610"},"redBackground3":{"fillColorRest":"#750b1c"},"redBorder1":{"strokeColorRest":"#750b1c","strokeWidth":1},"redBorder2":{"strokeColorRest":"#962f3f","strokeWidth":1},"redBorderActive":{"strokeColorRest":"#ac4f5e","strokeWidth":1},"redForeground1":{"fillColorRest":"#ac4f5e"},"redForeground2":{"fillColorRest":"#d69ca5"},"redForeground3":{"fillColorRest":"#962f3f"},"strokeFocus1":{"strokeColorRest":"#000000","strokeWidth":1},"strokeFocus2":{"strokeColorRest":"#ffffff","strokeWidth":1},"subtleBackground":{"fillColorRest":"transparent","fillColorHover":"#3d3d3d","fillColorPressed":"#1f1f1f","fillColorSelected":"#383838"},"transparentBackground":{"fillColorRest":"transparent","fillColorHover":"transparent","fillColorPressed":"transparent","fillColorSelected":"transparent"},"transparentStroke":{"strokeAlignment":"inner","strokeColorRest":"transparent","strokeColorHover":"transparent","strokeColorPressed":"transparent","strokeColorDisabled":"transparent","strokeWidth":1}}')},function(e,t,n){"use strict";var r=n(220);t.a=function(e,t){return Object(r.a)(e,t)}},function(e,t,n){"use strict";t.a=function(){return!1}},function(e,t){e.exports=OfficePlatformGlobal.RNWin32.UIAnchor},function(e,t,n){"use strict";(function(e){var r=n(94),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o?r.a.Buffer:void 0,s=a?a.allocUnsafe:void 0;t.a=function(e,t){if(t)return e.slice();var n=e.length,r=s?s(n):new e.constructor(n);return e.copy(r),r}}).call(this,n(314)(e))},function(e,t,n){"use strict";var r=n(109).compose;t.__esModule=!0,t.composeWithDevTools=function(){if(0!==arguments.length)return"object"==typeof arguments[0]?r:r.apply(null,arguments)},t.devToolsEnhancer=function(){return function(e){return e}}},function(e,t){e.exports=OfficePlatformGlobal.Telemetry.OTelSDX},function(e,t,n){"use strict";const{URL:r,URLSearchParams:o}=n(391),i=n(337),a=n(251),s={};r.install(s),o.install(s),t.URL=s.URL,t.URLSearchParams=s.URLSearchParams,t.parseURL=i.parseURL,t.basicURLParse=i.basicURLParse,t.serializeURL=i.serializeURL,t.serializeHost=i.serializeHost,t.serializeInteger=i.serializeInteger,t.serializeURLOrigin=i.serializeURLOrigin,t.setTheUsername=i.setTheUsername,t.setThePassword=i.setThePassword,t.cannotHaveAUsernamePasswordPort=i.cannotHaveAUsernamePasswordPort,t.percentDecode=a.percentDecode},function(e,t,n){e.exports={get FlatList(){return n(411).default},get SectionList(){return n(412).default},get VirtualizedList(){return n(316).default}}},function(e,t,n){"use strict";(function(e){var r=n(56),o=n.n(r),i=n(102),a=n.n(i),s=n(101),c=n.n(s),d=a()((function e(){c()(this,e),this.any_blank_count=0,this.any_blank_ms=0,this.any_blank_speed_sum=0,this.mostly_blank_count=0,this.mostly_blank_ms=0,this.pixels_blank=0,this.pixels_sampled=0,this.pixels_scrolled=0,this.total_time_spent=0,this.sample_count=0})),l=[],u=10,p=null,h=function(){function t(e){c()(this,t),this._anyBlankStartTime=null,this._enabled=!1,this._info=new d,this._mostlyBlankStartTime=null,this._samplesStartTime=null,this._getFrameMetrics=e,this._enabled=(p||0)>Math.random(),this._resetData()}return a()(t,[{key:"activate",value:function(){this._enabled&&null==this._samplesStartTime&&(this._samplesStartTime=e.performance.now())}},{key:"deactivateAndFlush",value:function(){if(this._enabled){var t=this._samplesStartTime;if(null!=t)if(this._info.sample_count<u)this._resetData();else{var n=e.performance.now()-t,r=o()({},this._info,{total_time_spent:n});l.forEach((function(e){return e(r)})),this._resetData()}}}},{key:"computeBlankness",value:function(t,n,r){if(!this._enabled||0===t.getItemCount(t.data)||null==this._samplesStartTime)return 0;var o=r.dOffset,i=r.offset,a=r.velocity,s=r.visibleLength;this._info.sample_count++,this._info.pixels_sampled+=Math.round(s),this._info.pixels_scrolled+=Math.round(Math.abs(o));var c=Math.round(1e3*Math.abs(a)),d=e.performance.now();null!=this._anyBlankStartTime&&(this._info.any_blank_ms+=d-this._anyBlankStartTime),this._anyBlankStartTime=null,null!=this._mostlyBlankStartTime&&(this._info.mostly_blank_ms+=d-this._mostlyBlankStartTime),this._mostlyBlankStartTime=null;for(var l=0,u=n.first,p=this._getFrameMetrics(u);u<=n.last&&(!p||!p.inLayout);)p=this._getFrameMetrics(u),u++;p&&u>0&&(l=Math.min(s,Math.max(0,p.offset-i)));for(var h=0,f=n.last,m=this._getFrameMetrics(f);f>=n.first&&(!m||!m.inLayout);)m=this._getFrameMetrics(f),f--;if(m&&f<t.getItemCount(t.data)-1){var g=m.offset+m.length;h=Math.min(s,Math.max(0,i+s-g))}var b=Math.round(l+h),C=b/s;return C>0?(this._anyBlankStartTime=d,this._info.any_blank_speed_sum+=c,this._info.any_blank_count++,this._info.pixels_blank+=b,C>.5&&(this._mostlyBlankStartTime=d,this._info.mostly_blank_count++)):(c<.01||Math.abs(o)<1)&&this.deactivateAndFlush(),C}},{key:"enabled",value:function(){return this._enabled}},{key:"_resetData",value:function(){this._anyBlankStartTime=null,this._info=new d,this._mostlyBlankStartTime=null,this._samplesStartTime=null}}],[{key:"addListener",value:function(e){return l.push(e),{remove:function(){l=l.filter((function(t){return e!==t}))}}}},{key:"setSampleRate",value:function(e){p=e}},{key:"setMinSampleCount",value:function(e){u=e}}]),t}();t.a=h}).call(this,n(234))},,,,,,,function(e,t,n){n(365),e.exports=n(409)},function(e,t,n){"use strict";(function(e){if(void 0!==e.__platformBundles){var t=e.__platformBundles.concat();Reflect.deleteProperty(e,"__platformBundles");for(var n=0;n<t.length;++n)console.log("PB start ".concat(n+1,"/").concat(t.length)),e.eval(t[n]),console.log("PB done  ".concat(n+1,"/").concat(t.length))}}).call(this,n(234))},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,d=[],l=!1,u=-1;function p(){l&&c&&(l=!1,c.length?d=c.concat(d):u=-1,d.length&&h())}function h(){if(!l){var e=s(p);l=!0;for(var t=d.length;t;){for(c=d,d=[];++u<t;)c&&c[u].run();u=-1,t=d.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new f(e,t)),1!==d.length||l||s(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},function(e,t,n){var r=n(120);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Provider",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"ReactReduxContext",{enumerable:!0,get:function(){return a.ReactReduxContext}}),Object.defineProperty(t,"connect",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"connectAdvanced",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"createDispatchHook",{enumerable:!0,get:function(){return c.createDispatchHook}}),Object.defineProperty(t,"createSelectorHook",{enumerable:!0,get:function(){return d.createSelectorHook}}),Object.defineProperty(t,"createStoreHook",{enumerable:!0,get:function(){return l.createStoreHook}}),Object.defineProperty(t,"shallowEqual",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"useDispatch",{enumerable:!0,get:function(){return c.useDispatch}}),Object.defineProperty(t,"useSelector",{enumerable:!0,get:function(){return d.useSelector}}),Object.defineProperty(t,"useStore",{enumerable:!0,get:function(){return l.useStore}});var o=r(n(370)),i=r(n(325)),a=n(197),s=r(n(375)),c=n(383),d=n(384),l=n(330),u=r(n(326))},function(e,t,n){var r=n(120);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}r.default=e,n&&n.set(e,r);return r}(n(1)),i=(r(n(315)),n(197)),a=n(310),s=n(311);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}var d=function(e){var t=e.store,n=e.context,r=e.children,c=(0,o.useMemo)((function(){var e=(0,a.createSubscription)(t);return{store:t,subscription:e}}),[t]),d=(0,o.useMemo)((function(){return t.getState()}),[t]);(0,s.useIsomorphicLayoutEffect)((function(){var e=c.subscription;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),d!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[c,d]);var l=n||i.ReactReduxContext;return o.default.createElement(l.Provider,{value:c},r)};t.default=d},function(e,t,n){"use strict";var r=n(372);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,i,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";var r=n(252),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function c(e){return r.isMemo(e)?a:s[e.$$typeof]||o}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=a;var d=Object.defineProperty,l=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,h=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(f){var o=h(n);o&&o!==f&&e(t,o,r)}var a=l(n);u&&(a=a.concat(u(n)));for(var s=c(t),m=c(n),g=0;g<a.length;++g){var b=a[g];if(!(i[b]||r&&r[b]||m&&m[b]||s&&s[b])){var C=p(n,b);try{d(t,b,C)}catch(e){}}}}return t}},function(e,t,n){"use strict";var r="function"==typeof Symbol&&Symbol.for,o=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,a=r?Symbol.for("react.fragment"):60107,s=r?Symbol.for("react.strict_mode"):60108,c=r?Symbol.for("react.profiler"):60114,d=r?Symbol.for("react.provider"):60109,l=r?Symbol.for("react.context"):60110,u=r?Symbol.for("react.async_mode"):60111,p=r?Symbol.for("react.concurrent_mode"):60111,h=r?Symbol.for("react.forward_ref"):60112,f=r?Symbol.for("react.suspense"):60113,m=r?Symbol.for("react.suspense_list"):60120,g=r?Symbol.for("react.memo"):60115,b=r?Symbol.for("react.lazy"):60116,C=r?Symbol.for("react.block"):60121,y=r?Symbol.for("react.fundamental"):60117,v=r?Symbol.for("react.responder"):60118,T=r?Symbol.for("react.scope"):60119;function S(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case u:case p:case a:case c:case s:case f:return e;default:switch(e=e&&e.$$typeof){case l:case h:case b:case g:case d:return e;default:return t}}case i:return t}}}function I(e){return S(e)===p}t.AsyncMode=u,t.ConcurrentMode=p,t.ContextConsumer=l,t.ContextProvider=d,t.Element=o,t.ForwardRef=h,t.Fragment=a,t.Lazy=b,t.Memo=g,t.Portal=i,t.Profiler=c,t.StrictMode=s,t.Suspense=f,t.isAsyncMode=function(e){return I(e)||S(e)===u},t.isConcurrentMode=I,t.isContextConsumer=function(e){return S(e)===l},t.isContextProvider=function(e){return S(e)===d},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===o},t.isForwardRef=function(e){return S(e)===h},t.isFragment=function(e){return S(e)===a},t.isLazy=function(e){return S(e)===b},t.isMemo=function(e){return S(e)===g},t.isPortal=function(e){return S(e)===i},t.isProfiler=function(e){return S(e)===c},t.isStrictMode=function(e){return S(e)===s},t.isSuspense=function(e){return S(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===p||e===c||e===s||e===f||e===m||"object"==typeof e&&null!==e&&(e.$$typeof===b||e.$$typeof===g||e.$$typeof===d||e.$$typeof===l||e.$$typeof===h||e.$$typeof===y||e.$$typeof===v||e.$$typeof===T||e.$$typeof===C)},t.typeOf=S},function(e,t,n){var r=n(120);Object.defineProperty(t,"__esModule",{value:!0}),t.createConnect=m,t.default=void 0;var o=r(n(312)),i=r(n(313)),a=r(n(325)),s=r(n(326)),c=r(n(376)),d=r(n(379)),l=r(n(380)),u=r(n(381)),p=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function h(e,t,n){for(var r=t.length-1;r>=0;r--){var o=t[r](e);if(o)return o}return function(t,r){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function f(e,t){return e===t}function m(e){var t=void 0===e?{}:e,n=t.connectHOC,r=void 0===n?a.default:n,m=t.mapStateToPropsFactories,g=void 0===m?d.default:m,b=t.mapDispatchToPropsFactories,C=void 0===b?c.default:b,y=t.mergePropsFactories,v=void 0===y?l.default:y,T=t.selectorFactory,S=void 0===T?u.default:T;return function(e,t,n,a){void 0===a&&(a={});var c=a,d=c.pure,l=void 0===d||d,u=c.areStatesEqual,m=void 0===u?f:u,b=c.areOwnPropsEqual,y=void 0===b?s.default:b,T=c.areStatePropsEqual,I=void 0===T?s.default:T,O=c.areMergedPropsEqual,E=void 0===O?s.default:O,P=(0,i.default)(c,p),k=h(e,g,"mapStateToProps"),R=h(t,C,"mapDispatchToProps"),x=h(n,v,"mergeProps");return r(S,(0,o.default)({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:k,initMapDispatchToProps:R,initMergeProps:x,pure:l,areStatesEqual:m,areOwnPropsEqual:y,areStatePropsEqual:I,areMergedPropsEqual:E},P))}}var g=m();t.default=g},function(e,t,n){var r=n(120);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.whenMapDispatchToPropsIsFunction=a,t.whenMapDispatchToPropsIsMissing=s,t.whenMapDispatchToPropsIsObject=c;var o=r(n(377)),i=n(327);function a(e){return"function"==typeof e?(0,i.wrapMapToPropsFunc)(e,"mapDispatchToProps"):void 0}function s(e){return e?void 0:(0,i.wrapMapToPropsConstant)((function(e){return{dispatch:e}}))}function c(e){return e&&"object"==typeof e?(0,i.wrapMapToPropsConstant)((function(t){return(0,o.default)(e,t)})):void 0}var d=[a,s,c];t.default=d},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n={},r=function(r){var o=e[r];"function"==typeof o&&(n[r]=function(){return t(o.apply(void 0,arguments))})};for(var o in e)r(o);return n}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if("object"!=typeof e||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=t;for(;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return t===n}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.whenMapStateToPropsIsFunction=o,t.whenMapStateToPropsIsMissing=i;var r=n(327);function o(e){return"function"==typeof e?(0,r.wrapMapToPropsFunc)(e,"mapStateToProps"):void 0}function i(e){return e?void 0:(0,r.wrapMapToPropsConstant)((function(){return{}}))}var a=[o,i];t.default=a},function(e,t,n){var r=n(120);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.defaultMergeProps=i,t.whenMergePropsIsFunction=s,t.whenMergePropsIsOmitted=c,t.wrapMergePropsFunc=a;var o=r(n(312));r(n(328));function i(e,t,n){return(0,o.default)({},n,e,t)}function a(e){return function(t,n){n.displayName;var r,o=n.pure,i=n.areMergedPropsEqual,a=!1;return function(t,n,s){var c=e(t,n,s);return a?o&&i(c,r)||(r=c):(a=!0,r=c),r}}}function s(e){return"function"==typeof e?a(e):void 0}function c(e){return e?void 0:function(){return i}}var d=[s,c];t.default=d},function(e,t,n){var r=n(120);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.initMapStateToProps,r=t.initMapDispatchToProps,c=t.initMergeProps,d=(0,o.default)(t,i),l=n(e,d),u=r(e,d),p=c(e,d);0;return(d.pure?s:a)(l,u,p,e,d)},t.impureFinalPropsSelectorFactory=a,t.pureFinalPropsSelectorFactory=s;var o=r(n(313)),i=(r(n(382)),["initMapStateToProps","initMapDispatchToProps","initMergeProps"]);function a(e,t,n,r){return function(o,i){return n(e(o,i),t(r,i),i)}}function s(e,t,n,r,o){var i,a,s,c,d,l=o.areStatesEqual,u=o.areOwnPropsEqual,p=o.areStatePropsEqual,h=!1;function f(o,h){var f,m,g=!u(h,a),b=!l(o,i);return i=o,a=h,g&&b?(s=e(i,a),t.dependsOnOwnProps&&(c=t(r,a)),d=n(s,c,a)):g?(e.dependsOnOwnProps&&(s=e(i,a)),t.dependsOnOwnProps&&(c=t(r,a)),d=n(s,c,a)):b?(f=e(i,a),m=!p(f,s),s=f,m&&(d=n(s,c,a)),d):d}return function(o,l){return h?f(o,l):(s=e(i=o,a=l),c=t(r,a),d=n(s,c,a),h=!0,d)}}},function(e,t,n){var r=n(120);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r){i(e,"mapStateToProps",r),i(t,"mapDispatchToProps",r),i(n,"mergeProps",r)};var o=r(n(329));function i(e,t,n){if(!e)throw new Error("Unexpected value for "+t+" in "+n+".");"mapStateToProps"!==t&&"mapDispatchToProps"!==t||Object.prototype.hasOwnProperty.call(e,"dependsOnOwnProps")||(0,o.default)("The selector for "+t+" of "+n+" did not specify a value for dependsOnOwnProps.")}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createDispatchHook=i,t.useDispatch=void 0;var r=n(197),o=n(330);function i(e){void 0===e&&(e=r.ReactReduxContext);var t=e===r.ReactReduxContext?o.useStore:(0,o.createStoreHook)(e);return function(){return t().dispatch}}var a=i();t.useDispatch=a},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectorHook=d,t.useSelector=void 0;var r=n(1),o=n(331),i=n(310),a=n(311),s=n(197),c=function(e,t){return e===t};function d(e){void 0===e&&(e=s.ReactReduxContext);var t=e===s.ReactReduxContext?o.useReduxContext:function(){return(0,r.useContext)(e)};return function(e,n){void 0===n&&(n=c);var o=t(),s=function(e,t,n,o){var s,c=(0,r.useReducer)((function(e){return e+1}),0)[1],d=(0,r.useMemo)((function(){return(0,i.createSubscription)(n,o)}),[n,o]),l=(0,r.useRef)(),u=(0,r.useRef)(),p=(0,r.useRef)(),h=(0,r.useRef)(),f=n.getState();try{if(e!==u.current||f!==p.current||l.current){var m=e(f);s=void 0!==h.current&&t(m,h.current)?h.current:m}else s=h.current}catch(e){throw l.current&&(e.message+="\nThe error may be correlated with this previous error:\n"+l.current.stack+"\n\n"),e}return(0,a.useIsomorphicLayoutEffect)((function(){u.current=e,p.current=f,h.current=s,l.current=void 0})),(0,a.useIsomorphicLayoutEffect)((function(){function e(){try{var e=n.getState();if(e===p.current)return;var r=u.current(e);if(t(r,h.current))return;h.current=r,p.current=e}catch(e){l.current=e}c()}return d.onStateChange=e,d.trySubscribe(),e(),function(){return d.tryUnsubscribe()}}),[n,d]),s}(e,n,o.store,o.subscription);return(0,r.useDebugValue)(s),s}}var l=d();t.useSelector=l},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"unstable_batchedUpdates",{enumerable:!0,get:function(){return r.unstable_batchedUpdates}});var r=n(9)},function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(9).NativeModules,o=r.PlatformLocalStorage||r.RNC_AsyncSQLiteDBStorage||r.RNCAsyncStorage;t.default=o},function(e,t,n){var r=n(120);Object.defineProperty(t,"__esModule",{value:!0}),t.useAsyncStorage=function(e){return{getItem:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return o.default.getItem.apply(o.default,[e].concat(n))},setItem:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return o.default.setItem.apply(o.default,[e].concat(n))},mergeItem:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return o.default.mergeItem.apply(o.default,[e].concat(n))},removeItem:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return o.default.removeItem.apply(o.default,[e].concat(n))}}};var o=r(n(332))},function(e,t,n){"use strict";const r=n(392),o=n(340);t.URL=r,t.URLSearchParams=o},function(e,t,n){"use strict";const r=n(335),o=n(336),i=o.implSymbol,a=o.ctorRegistrySymbol,s={_mixedIntoPredicates:[],is(t){if(t){if(o.hasOwn(t,i)&&t[i]instanceof c.implementation)return!0;for(const n of e.exports._mixedIntoPredicates)if(n(t))return!0}return!1},isImpl(t){if(t){if(t instanceof c.implementation)return!0;const n=o.wrapperForImpl(t);for(const t of e.exports._mixedIntoPredicates)if(t(n))return!0}return!1},convert(t,{context:n="The provided value"}={}){if(e.exports.is(t))return o.implForWrapper(t);throw new TypeError(n+" is not of type 'URL'.")},create(e,t,n){if(void 0===e[a])throw new Error("Internal error: invalid global object");const r=e[a].URL;if(void 0===r)throw new Error("Internal error: constructor URL is not installed on the passed global object");let o=Object.create(r.prototype);return o=s.setup(o,e,t,n),o},createImpl(e,t,n){const r=s.create(e,t,n);return o.implForWrapper(r)},_internalSetup(e){},setup:(e,t,n=[],r={})=>(r.wrapper=e,s._internalSetup(e),Object.defineProperty(e,i,{value:new c.implementation(t,n,r),configurable:!0}),e[i][o.wrapperSymbol]=e,c.init&&c.init(e[i],r),e),install(t){class n{constructor(e){if(arguments.length<1)throw new TypeError("Failed to construct 'URL': 1 argument required, but only "+arguments.length+" present.");const n=[];{let e=arguments[0];e=r.USVString(e,{context:"Failed to construct 'URL': parameter 1"}),n.push(e)}{let e=arguments[1];void 0!==e&&(e=r.USVString(e,{context:"Failed to construct 'URL': parameter 2"})),n.push(e)}return s.setup(Object.create(this.constructor.prototype),t,n)}toJSON(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].toJSON()}get href(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].href}set href(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");t=r.USVString(t,{context:"Failed to set the 'href' property on 'URL': The provided value"}),this[i].href=t}toString(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].href}get origin(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].origin}get protocol(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].protocol}set protocol(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");t=r.USVString(t,{context:"Failed to set the 'protocol' property on 'URL': The provided value"}),this[i].protocol=t}get username(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].username}set username(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");t=r.USVString(t,{context:"Failed to set the 'username' property on 'URL': The provided value"}),this[i].username=t}get password(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].password}set password(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");t=r.USVString(t,{context:"Failed to set the 'password' property on 'URL': The provided value"}),this[i].password=t}get host(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].host}set host(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");t=r.USVString(t,{context:"Failed to set the 'host' property on 'URL': The provided value"}),this[i].host=t}get hostname(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].hostname}set hostname(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");t=r.USVString(t,{context:"Failed to set the 'hostname' property on 'URL': The provided value"}),this[i].hostname=t}get port(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].port}set port(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");t=r.USVString(t,{context:"Failed to set the 'port' property on 'URL': The provided value"}),this[i].port=t}get pathname(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].pathname}set pathname(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");t=r.USVString(t,{context:"Failed to set the 'pathname' property on 'URL': The provided value"}),this[i].pathname=t}get search(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].search}set search(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");t=r.USVString(t,{context:"Failed to set the 'search' property on 'URL': The provided value"}),this[i].search=t}get searchParams(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return o.getSameObject(this,"searchParams",()=>o.tryWrapperForImpl(this[i].searchParams))}get hash(){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");return this[i].hash}set hash(t){if(!this||!e.exports.is(this))throw new TypeError("Illegal invocation");t=r.USVString(t,{context:"Failed to set the 'hash' property on 'URL': The provided value"}),this[i].hash=t}}Object.defineProperties(n.prototype,{toJSON:{enumerable:!0},href:{enumerable:!0},toString:{enumerable:!0},origin:{enumerable:!0},protocol:{enumerable:!0},username:{enumerable:!0},password:{enumerable:!0},host:{enumerable:!0},hostname:{enumerable:!0},port:{enumerable:!0},pathname:{enumerable:!0},search:{enumerable:!0},searchParams:{enumerable:!0},hash:{enumerable:!0},[Symbol.toStringTag]:{value:"URL",configurable:!0}}),void 0===t[a]&&(t[a]=Object.create(null)),t[a].URL=n,Object.defineProperty(t,"URL",{configurable:!0,writable:!0,value:n})}};e.exports=s;const c=n(393)},function(e,t,n){"use strict";const r=n(337),o=n(251),i=n(340);t.implementation=class{constructor(e,t){const n=t[0],o=t[1];let a=null;if(void 0!==o&&(a=r.basicURLParse(o),null===a))throw new TypeError("Invalid base URL: "+o);const s=r.basicURLParse(n,{baseURL:a});if(null===s)throw new TypeError("Invalid URL: "+n);const c=null!==s.query?s.query:"";this._url=s,this._query=i.createImpl(e,[c],{doNotStripQMark:!0}),this._query._url=this}get href(){return r.serializeURL(this._url)}set href(e){const t=r.basicURLParse(e);if(null===t)throw new TypeError("Invalid URL: "+e);this._url=t,this._query._list.splice(0);const{query:n}=t;null!==n&&(this._query._list=o.parseUrlencoded(n))}get origin(){return r.serializeURLOrigin(this._url)}get protocol(){return this._url.scheme+":"}set protocol(e){r.basicURLParse(e+":",{url:this._url,stateOverride:"scheme start"})}get username(){return this._url.username}set username(e){r.cannotHaveAUsernamePasswordPort(this._url)||r.setTheUsername(this._url,e)}get password(){return this._url.password}set password(e){r.cannotHaveAUsernamePasswordPort(this._url)||r.setThePassword(this._url,e)}get host(){const e=this._url;return null===e.host?"":null===e.port?r.serializeHost(e.host):r.serializeHost(e.host)+":"+r.serializeInteger(e.port)}set host(e){this._url.cannotBeABaseURL||r.basicURLParse(e,{url:this._url,stateOverride:"host"})}get hostname(){return null===this._url.host?"":r.serializeHost(this._url.host)}set hostname(e){this._url.cannotBeABaseURL||r.basicURLParse(e,{url:this._url,stateOverride:"hostname"})}get port(){return null===this._url.port?"":r.serializeInteger(this._url.port)}set port(e){r.cannotHaveAUsernamePasswordPort(this._url)||(""===e?this._url.port=null:r.basicURLParse(e,{url:this._url,stateOverride:"port"}))}get pathname(){return this._url.cannotBeABaseURL?this._url.path[0]:0===this._url.path.length?"":"/"+this._url.path.join("/")}set pathname(e){this._url.cannotBeABaseURL||(this._url.path=[],r.basicURLParse(e,{url:this._url,stateOverride:"path start"}))}get search(){return null===this._url.query||""===this._url.query?"":"?"+this._url.query}set search(e){const t=this._url;if(""===e)return t.query=null,void(this._query._list=[]);const n="?"===e[0]?e.substring(1):e;t.query="",r.basicURLParse(n,{url:t,stateOverride:"query"}),this._query._list=o.parseUrlencoded(n)}get searchParams(){return this._query}get hash(){return null===this._url.fragment||""===this._url.fragment?"":"#"+this._url.fragment}set hash(e){if(""===e)return void(this._url.fragment=null);const t="#"===e[0]?e.substring(1):e;this._url.fragment="",r.basicURLParse(t,{url:this._url,stateOverride:"fragment"})}toJSON(){return this.href}}},function(e,t,n){"use strict";t.byteLength=function(e){var t=d(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=d(e),a=r[0],s=r[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),l=0,u=s>0?a-4:a;for(n=0;n<u;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===s&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,c[l++]=255&t);1===s&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],a=0,s=n-o;a<s;a+=16383)i.push(l(e,a,a+16383>s?s:a+16383));1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)r[s]=a[s],o[a.charCodeAt(s)]=s;function d(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var o,i,a=[],s=t;s<n;s+=3)o=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,a,s=8*o-r-1,c=(1<<s)-1,d=c>>1,l=-7,u=n?o-1:0,p=n?-1:1,h=e[t+u];for(u+=p,i=h&(1<<-l)-1,h>>=-l,l+=s;l>0;i=256*i+e[t+u],u+=p,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=r;l>0;a=256*a+e[t+u],u+=p,l-=8);if(0===i)i=1-d;else{if(i===c)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),i-=d}return(h?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,s,c,d=8*i-o-1,l=(1<<d)-1,u=l>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+u>=1?p/c:p*Math.pow(2,1-u))*c>=2&&(a++,c/=2),a+u>=l?(s=0,a=l):a+u>=1?(s=(t*c-1)*Math.pow(2,o),a+=u):(s=t*Math.pow(2,u-1)*Math.pow(2,o),a=0));o>=8;e[n+h]=255&s,h+=f,s/=256,o-=8);for(a=a<<o|s,d+=o;d>0;e[n+h]=255&a,h+=f,a/=256,d-=8);e[n+h-f]|=128*m}},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,n){(function(e,r){var o;!function(i){t&&t.nodeType,e&&e.nodeType;var a="object"==typeof r&&r;a.global!==a&&a.window!==a&&a.self;var s,c=2147483647,d=/^xn--/,l=/[^\x20-\x7E]/,u=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},h=Math.floor,f=String.fromCharCode;function m(e){throw new RangeError(p[e])}function g(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function b(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+g((e=e.replace(u,".")).split("."),t).join(".")}function C(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function y(e){return g(e,(function(e){var t="";return e>65535&&(t+=f((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=f(e)})).join("")}function v(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function T(e,t,n){var r=0;for(e=n?h(e/700):e>>1,e+=h(e/t);e>455;r+=36)e=h(e/35);return h(r+36*e/(e+38))}function S(e){var t,n,r,o,i,a,s,d,l,u,p,f=[],g=e.length,b=0,C=128,v=72;for((n=e.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&m("not-basic"),f.push(e.charCodeAt(r));for(o=n>0?n+1:0;o<g;){for(i=b,a=1,s=36;o>=g&&m("invalid-input"),((d=(p=e.charCodeAt(o++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:36)>=36||d>h((c-b)/a))&&m("overflow"),b+=d*a,!(d<(l=s<=v?1:s>=v+26?26:s-v));s+=36)a>h(c/(u=36-l))&&m("overflow"),a*=u;v=T(b-i,t=f.length+1,0==i),h(b/t)>c-C&&m("overflow"),C+=h(b/t),b%=t,f.splice(b++,0,C)}return y(f)}function I(e){var t,n,r,o,i,a,s,d,l,u,p,g,b,y,S,I=[];for(g=(e=C(e)).length,t=128,n=0,i=72,a=0;a<g;++a)(p=e[a])<128&&I.push(f(p));for(r=o=I.length,o&&I.push("-");r<g;){for(s=c,a=0;a<g;++a)(p=e[a])>=t&&p<s&&(s=p);for(s-t>h((c-n)/(b=r+1))&&m("overflow"),n+=(s-t)*b,t=s,a=0;a<g;++a)if((p=e[a])<t&&++n>c&&m("overflow"),p==t){for(d=n,l=36;!(d<(u=l<=i?1:l>=i+26?26:l-i));l+=36)S=d-u,y=36-u,I.push(f(v(u+S%y,0))),d=h(S/y);I.push(f(v(d,0))),i=T(n,b,r==o),n=0,++r}++n,++t}return I.join("")}s={version:"1.4.1",ucs2:{decode:C,encode:y},decode:S,encode:I,toASCII:function(e){return b(e,(function(e){return l.test(e)?"xn--"+I(e):e}))},toUnicode:function(e){return b(e,(function(e){return d.test(e)?S(e.slice(4).toLowerCase()):e}))}},void 0===(o=function(){return s}.call(t,n,t,e))||(e.exports=o)}()}).call(this,n(398)(e),n(234))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";const r=n(251);t.implementation=class{constructor(e,t,{doNotStripQMark:n=!1}){let o=t[0];if(this._list=[],this._url=null,n||"string"!=typeof o||"?"!==o[0]||(o=o.slice(1)),Array.isArray(o))for(const e of o){if(2!==e.length)throw new TypeError("Failed to construct 'URLSearchParams': parameter 1 sequence's element does not contain exactly two elements.");this._list.push([e[0],e[1]])}else if("object"==typeof o&&null===Object.getPrototypeOf(o))for(const e of Object.keys(o)){const t=o[e];this._list.push([e,t])}else this._list=r.parseUrlencoded(o)}_updateSteps(){if(null!==this._url){let e=r.serializeUrlencoded(this._list);""===e&&(e=null),this._url._url.query=e}}append(e,t){this._list.push([e,t]),this._updateSteps()}delete(e){let t=0;for(;t<this._list.length;)this._list[t][0]===e?this._list.splice(t,1):t++;this._updateSteps()}get(e){for(const t of this._list)if(t[0]===e)return t[1];return null}getAll(e){const t=[];for(const n of this._list)n[0]===e&&t.push(n[1]);return t}has(e){for(const t of this._list)if(t[0]===e)return!0;return!1}set(e,t){let n=!1,r=0;for(;r<this._list.length;)this._list[r][0]===e?n?this._list.splice(r,1):(n=!0,this._list[r][1]=t,r++):r++;n||this._list.push([e,t]),this._updateSteps()}sort(){var e,t;this._list=(e=this._list,t=(e,t)=>e[0]>t[0],e.map((e,t)=>({item:e,index:t})).sort((e,n)=>t(e.item,n.item)||e.index-n.index).map(({item:e})=>e)),this._updateSteps()}[Symbol.iterator](){return this._list[Symbol.iterator]()}toString(){return r.serializeUrlencoded(this._list)}}},function(e,t){e.exports=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t,r)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(334);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e){e.exports=JSON.parse('{"SharedCommentsVersion":"3.39.1"}')},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.NativeServices=t.ServiceInfos=void 0;var i=n(26);i.CustomTypeRegistry.registerTypeInfos({"Identity::MeControlProfileData":{CompanyName:"$string",Email:"$string",FirstName:"$string",FriendlyName:"$string",HostResolutionId:"$string",IsOrgId:"$boolean",IsMsaId:"$boolean",IsAdId:"$boolean",LastName:"$string",ProfileId:"$string",ProfilePicBase64:"$string"},"Identity::MeControlProfiles":{Profiles:["$array","Identity::MeControlProfileData"]},"Identity::MeControlSignInResult":{UserCanceled:"$boolean",ErrorCode:"$number"},"Identity::MeControlSignOutResult":{UserCanceled:"$boolean",IsProfileSignedOut:"$boolean"},"Identity::MeControlSwitchProfileResult":{IsProfileSwitched:"$boolean",IdentityErrorState:"$string"},"Identity::MeControlProfileEmailToSwitchTo":{ProfileEmailToSwitchTo:"$string"},"Identity::MeControlProfileEmailToSignOut":{ProfileEmailToSignOut:"$string"},"Identity::MeControlCustomLinkId":{CustomLinkId:"$number"},"Identity::MeControlViewId":{ViewId:"$number"},"Identity::MeControlAccountImageSize":{ActiveAccountImageSize:"$number",SecondaryAccountImageSize:"$number"},"Identity::MeControlPrideColorGradientImages":{IsShowPridePreferenceEnabled:"$boolean",ActiveAccountGradientImage:"$string",SecondaryAccountGradientImage:"$string"},"Identity::UserInfo":{UserName:"$string",CorrelationId:"$string"},"Identity::ServiceInfo":{ServiceName:"$string"},"Identity::AuthData":{AuthToken:"$string",ErrorMessage:"$string",CorrelationId:"$string",OperationResult:"$boolean"},"Identity::AuthServerURLData":{ServiceName:"$string",AuthServerURL:"$string",ErrorMessage:"$string",OperationResult:"$boolean"}}),t.ServiceInfos={NativeGetMSGraphToken:["Identity::NativeGetMSGraphToken",{QueryToken:["ReturnsPromiseMethod","Identity::AuthData",["Identity::UserInfo"]]}],NativeGetLokiToken:["Identity::NativeGetLokiToken",{QueryToken:["ReturnsPromiseMethod","Identity::AuthData",["Identity::UserInfo"]]}],NativeGetLokiUrl:["Identity::NativeGetLokiUrl",{QueryLokiUrl:["ReturnsPromiseMethod","$string",["Identity::UserInfo"]]}],NativeGetTenantId:["Identity::NativeGetTenantId",{QueryTenantId:["ReturnsPromiseMethod","$string",["Identity::UserInfo"]]}],NativeGetServiceURL:["Identity::NativeGetServiceURL",{QueryAuthServerUrl:["ReturnsPromiseMethod","Identity::AuthServerURLData",["Identity::ServiceInfo"]]}],NativeGetMeControlProfiles:["Identity::NativeGetMeControlProfiles",{GetMeControlProfiles:["ReturnsPromiseMethod","Identity::MeControlProfiles",[]]}],NativeMeControlSignIn:["Identity::NativeMeControlSignIn",{MeControlSignIn:["ReturnsPromiseMethod","Identity::MeControlSignInResult",[]]}],NativeMeControlSignInWithViewId:["Identity::NativeMeControlSignInWithViewId",{MeControlSignIn:["ReturnsPromiseMethod","Identity::MeControlSignInResult",["Identity::MeControlViewId"]]}],NativeMeControlSwitchProfile:["Identity::NativeMeControlSwitchProfile",{MeControlSwitchProfile:["ReturnsPromiseMethod","Identity::MeControlSwitchProfileResult",["Identity::MeControlProfileEmailToSwitchTo"]]}],NativeMeControlSignOutProfile:["Identity::NativeMeControlSignOutProfile",{MeControlSignOutProfile:["ReturnsPromiseMethod","Identity::MeControlSignOutResult",["Identity::MeControlProfileEmailToSignOut"]]}],NativeMeControlSignOutProfileWithViewId:["Identity::NativeMeControlSignOutProfileWithViewId",{MeControlSignOutProfile:["ReturnsPromiseMethod","Identity::MeControlSignOutResult",["Identity::MeControlProfileEmailToSignOut","Identity::MeControlViewId"]]}],NativeMeControlCloseFlyout:["Identity::NativeMeControlCloseFlyout",{CloseFlyout:["ReturnsPromiseMethod","$boolean",[]]}],NativeMeControlCloseFlyoutWithViewId:["Identity::NativeMeControlCloseFlyoutWithViewId",{CloseFlyout:["ReturnsPromiseMethod","$boolean",["Identity::MeControlViewId"]]}],NativeMeControlCustomLinkClickedWithViewId:["Identity::NativeMeControlCustomLinkClickedWithViewId",{CustomLinkClicked:["ReturnsPromiseMethod","$boolean",["Identity::MeControlViewId"]]}],NativeMeControlGetPrideColorGradientImages:["Identity::NativeMeControlGetPrideColorGradientImages",{GetPrideColorGradientImages:["ReturnsPromiseMethod","Identity::MeControlPrideColorGradientImages",["Identity::MeControlAccountImageSize","Identity::MeControlViewId"]]}]},t.NativeServices={NativeGetMSGraphToken:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeGetMSGraphToken),NativeGetLokiToken:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeGetLokiToken),NativeGetLokiUrl:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeGetLokiUrl),NativeGetTenantId:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeGetTenantId),NativeGetServiceURL:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeGetServiceURL),NativeGetMeControlProfiles:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeGetMeControlProfiles),NativeMeControlSignIn:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeMeControlSignIn),NativeMeControlSignInWithViewId:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeMeControlSignInWithViewId),NativeMeControlSwitchProfile:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeMeControlSwitchProfile),NativeMeControlSignOutProfile:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeMeControlSignOutProfile),NativeMeControlSignOutProfileWithViewId:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeMeControlSignOutProfileWithViewId),NativeMeControlCloseFlyout:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeMeControlCloseFlyout),NativeMeControlCloseFlyoutWithViewId:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeMeControlCloseFlyoutWithViewId),NativeMeControlCustomLinkClickedWithViewId:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeMeControlCustomLinkClickedWithViewId),NativeMeControlGetPrideColorGradientImages:i.RekaServiceRegistry.getNativeService(t.ServiceInfos.NativeMeControlGetPrideColorGradientImages)},o(n(408),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";n.r(t);var r=n(8),o=n(43),i=n(0),a=n(11),s=n(32),c=n(342),d=function(){function e(){var e=this;this.promise=new Promise((function(t,n){e.onResolve=t,e.onReject=n}))}return Object.defineProperty(e.prototype,"resolve",{get:function(){return this.onResolve},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reject",{get:function(){return this.onReject},enumerable:!1,configurable:!0}),e}(),l=n(26),u=n(21),p=n(61),h=n(46);n(250);l.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::DiscardDraftCommand":{type:"$string",mode:"$number"},"Mso::Document::Comments::JS::CreateCommentCommand":{type:"$string"},"Mso::Document::Comments::JS::EditCommentCommand":{type:"$string",commentId:"$string"},"Mso::Document::Comments::JS::ReplyCommentCommand":{type:"$string",threadId:"$string"},"Mso::Document::Comments::JS::BringThreadIntoViewCommand":{type:"$string",threadId:"$string"}});class f{constructor(){this.commandCallbacks={},this.queuedInterruptableCommands={}}static getInstance(){return this.instance}static register(){if(this.instance)throw Object(i.i)().assertConditionTag(!1,"Already registered an instance of CommentAPIServiceModule",593000201),new u.a(p.b,589103751,-2130957534);this.instance=new f,l.RekaServiceRegistry.registerService({serviceInfo:this.ServiceInfo,factory:()=>this.instance})}registerForInterruptableCommands(e,t){this.commandCallbacks[e]&&Object(i.i)().assertConditionTag(!1,"DuplicateHandlerRegistration for InterruptableCommands",593000202),this.commandCallbacks[e]=t;const n=this.queuedInterruptableCommands[e];n&&n.forEach(e=>{t(e.command).then(t=>e.promiseValue.resolve(t),()=>{Object(i.i)().assertConditionTag(!1,"Failed to run queued interruptable command",570991756),e.promiseValue.resolve(h.a.Failed)})}),delete this.queuedInterruptableCommands[e]}unregisterForInterruptableCommands(e,t){this.commandCallbacks[e]&&this.commandCallbacks[e]===t?delete this.commandCallbacks[e]:Object(i.i)().assertConditionTag(!1,"Cannot unregister for a command callback that wasn't already registered",593000203)}dispatchInterruptableCommand(e,t){const n=this.commandCallbacks[e];if(n)return n(t);this.queuedInterruptableCommands[e]||(this.queuedInterruptableCommands[e]=[]);const r=new d;return this.queuedInterruptableCommands[e].push({command:t,promiseValue:r}),r.promise}}f.ServiceInfo=["Mso::Document::Comments::JS::CommentAPIServiceModule",{dispatchInterruptableCommand:["ReturnsPromiseMethod","$number",["$string",["$union",["Mso::Document::Comments::JS::DiscardDraftCommand","Mso::Document::Comments::JS::CreateCommentCommand","Mso::Document::Comments::JS::EditCommentCommand","Mso::Document::Comments::JS::ReplyCommentCommand","Mso::Document::Comments::JS::BringThreadIntoViewCommand"]]]]}];var m=n(222),g=n(3),b=function(e){var t,n,r={};try{for(var o=Object(g.h)(e),i=o.next();!i.done;i=o.next()){var a=Object(g.e)(i.value,2),s=a[0],c=a[1];r[s]=c}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r};n(72);var C=n(31);const y={themeId:1,palette:{ApplePaneTopBorder:C.a.GRAY_C,ButtonBorder:C.a.GRAY_D,CardAccent:C.a.GRAY_B,CardBackground:C.a.WHITE,CardHoveredBackground:C.a.GRAY_20,CardDraftBoxBackgroundHovered:C.a.WHITE,CardDraftBoxBorderHovered:C.a.GRAY_160,CardDraftBoxBorder:C.a.GRAY_110,CardDraftBoxBackground_HalfPane:C.a.WHITE,CardDraftBoxBackground:C.a.WHITE,CardExpandButtonBorder:C.a.GRAY_B,CardHeroBarBackground_HalfPane:C.a.WHITE,CardHeroBarBackground:C.a.GRAY_A,CardReplyBackground_HalfPane:C.a.GRAY_A,CardReplyBackground:C.a.GRAY_A,CardReplyTopBorder:C.a.GRAY_B,CardSelectionColor:C.a.COMMENTS_PURPLE,CardShadowColor:C.a.BLACK,CardBorder:C.a.GRAY_B,CardBorderEmphasis:C.a.COMMENTS_PURPLE,CommandBarBorder:C.a.GRAY_B,CommandBarTopBorder:C.a.GRAY_B,IconButtonDisabledTint:C.a.GRAY_C,IconButtonFocusedTint:C.a.GRAY_I,NavigationBarBackground:C.a.WHITE,NavigationBarBorder:C.a.GRAY_B,PaneBackground_HalfPane:C.a.WHITE,PaneBackground:"transparent",UnreadDotColor:C.a.DOT_BLUE,UnreadDotBorderColor:C.a.WHITE,ExpandButtonHoverBackground:"transparent",ExpandButtonBackground:"transparent",FocusBorderColor:C.a.GRAY_150,CardPlaceholderColor:C.a.GRAY_130,ResolvedCardBackground:C.a.GRAY_20}};l.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::Swatch":{color:"$string",value:"$string"},"Mso::Document::Comments::JS::Palette":{values:["$array","Mso::Document::Comments::JS::Swatch"]},"Mso::Document::Comments::JS::ThemeInformation":{themeId:"$number",palette:"Mso::Document::Comments::JS::Palette"}});const v=l.RekaServiceRegistry.getNativeService(["Mso::Document::Comments::JS::ThemeModule",{onThemeChange:["Event","Mso::Document::Comments::JS::ThemeInformation"],initialThemeInformation:["Constant","Mso::Document::Comments::JS::ThemeInformation"]}]),T=e=>{return{themeId:(t={themeId:e.themeId,palette:(n=e.palette,b(n.values.map(e=>[e.color,e.value])))}).themeId,palette:new Proxy(y.palette,{get:(e,n)=>t.palette[n]?t.palette[n]:(Object(i.i)().assertConditionTag(!1,"Theme-aware platform using unthemed color "+String(n),595338514),e[n])})};var t,n};class S{constructor(e=v){this.themeModule=e,this.listeners=new Set,this.onThemeChange=this.onThemeChange.bind(this),this.currentTheme=T(this.themeModule.initialThemeInformation),this.themeModule.onThemeChange.subscribe(this.onThemeChange)}getTheme(){return this.currentTheme}registerForThemeChange(e){this.listeners.add(e)}unregisterForThemeChange(e){this.listeners.delete(e)}onThemeChange(e){this.currentTheme=T(e);for(const e of this.listeners)e()}}let I;function O(){return I||(I=new S),I}var E=n(129),P=n(9);var k,R=n(82),x=n(413),D=n(424),w=n(425),A=n(14),j=n(1),_=n(89),F=n(122);function M(e){return e.actionType===k.CreateThread&&void 0!==e.content}function N(e){return e.actionType===k.CancelCreateThread}function L(e){return e.actionType===k.StartReplySession&&void 0!==e.threadId}function B(e){return e.actionType===k.CancelReplySession&&void 0!==e.threadId}function H(e){return e.actionType===k.PostReply&&void 0!==e.threadId&&void 0!==e.content}function U(e){return e.actionType===k.DeleteComment&&void 0!==e.commentId}function V(e){return e.actionType===k.DeleteThread&&void 0!==e.threadId}function W(e){return e.actionType===k.ResolveThread&&void 0!==e.threadId}function z(e){return e.actionType===k.ReopenThread&&void 0!==e.threadId}function K(e){return e.actionType===k.StartEditSession&&void 0!==e.commentId}function G(e){return e.actionType===k.CancelEditSession&&void 0!==e.commentId}function q(e){return e.actionType===k.PostEdit&&void 0!==e.commentId&&void 0!==e.content}function $(e){return e.actionType===k.SelectComment&&void 0!==e.commentId}function Y(e){return e.actionType===k.ClickGhostCard}!function(e){e.CreateThread="CreateThread",e.CancelCreateThread="CancelCreateThread",e.StartReplySession="StartReplySession",e.CancelReplySession="CancelReplySession",e.PostReply="PostReply",e.DeleteComment="DeleteComment",e.DeleteThread="DeleteThread",e.ResolveThread="ResolveThread",e.ReopenThread="ReopenThread",e.StartEditSession="StartEditSession",e.CancelEditSession="CancelEditSession",e.PostEdit="PostEdit",e.SelectComment="SelectComment",e.ClosePane="ClosePane",e.ClickGhostCard="ClickGhostCard"}(k||(k={})),l.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::MockUIDriverEventPayload":{apiContext:"$string",payload:"$string"}});const J={MockUIDriverModule:l.RekaServiceRegistry.getNativeService(["Mso::Document::Comments::JS::MockUIDriverModule",{sendTrace:["FireAndForgetMethod",["$string","$string"]],onMockUIEvent:["Event","Mso::Document::Comments::JS::MockUIDriverEventPayload"]}])};class Q{constructor(e){this.onMockUIAction=new l.EventImpl(()=>{}),this.onMockUIEvent=this.onMockUIEvent.bind(this),J.MockUIDriverModule.onMockUIEvent.subscribe(Object(F.b)(e,this.onMockUIEvent))}onMockUIEvent(e){const t=JSON.parse(e.payload).payload;void 0!==t.actionType?this.onMockUIAction.trigger(t):Object(i.i)().assertConditionTag(!1,"Malformed event: "+e.payload,593376714)}}var X,Z=n(67),ee=n(219),te=n(143),ne=n(53),re=n(317),oe=n(29),ie=n(227),ae=n(187),se=n(20),ce=n(34),de=n(12),le=function(){function e(e){var t=this;this.internalHandler=e,this.eventQueue=[],this._isProcessingEvents=!1,this.handler=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._isProcessingEvents?t.internalHandler.apply(t,Object(g.g)([],Object(g.e)(e),!1)):t.eventQueue.push(e)}}return Object.defineProperty(e.prototype,"isProcessingEvents",{get:function(){return this._isProcessingEvents},enumerable:!1,configurable:!0}),e.prototype.pauseProcessing=function(){this._isProcessingEvents=!1},e.prototype.startProcessing=function(){var e,t;if(!this._isProcessingEvents){this._isProcessingEvents=!0;try{for(var n=Object(g.h)(this.eventQueue),r=n.next();!r.done;r=n.next()){var o=r.value;this.handler.apply(this,Object(g.g)([],Object(g.e)(o),!1))}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.eventQueue=[]}},e}(),ue=n(144),pe=n(99),he=n(71),fe=n(232),me=n(96),ge=n(2),be=n(22),Ce=n(106),ye=n(7),ve=n(19);class Te{constructor(e,t){this.mockId="",this.mockContents="",this.getContentsAsync=this.getContentsAsync.bind(this),this.getId=this.getId.bind(this),this.getCursorPositionAsync=this.getCursorPositionAsync.bind(this),e&&(this.mockId=e),t&&(this.mockContents=t)}getId(){return this.mockId}getContentsAsync(){return Promise.resolve(this.mockContents)}getCursorPositionAsync(){return Promise.resolve(void 0)}}class Se{constructor(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}getContentsAsync(){return Promise.resolve(this.mockContents)}getCursorPositionAsync(){return Promise.resolve(void 0)}setContents(e){this.mockContents=e}getId(){return this.mockId}}!function(e){e[e.None=0]="None",e[e.NeedDrafting=1]="NeedDrafting",e[e.NeedNotDrafting=2]="NeedNotDrafting"}(X||(X={}));class Ie extends fe.a{constructor(e){super(e),this.pendingActionReason=X.None,this.pendingAction=void 0,this.onMockUIAction=new le(e=>{if(!ge.m())if(this.pendingAction)Object(i.i)().assertConditionTag(!1,"Action is already pending",592229779);else switch(e.actionType){case k.CancelCreateThread:N(e)?this.runAction(e,X.NeedDrafting,()=>this.commentCardCallbackProps.onCancel(new Te(this.getDraftCardId()))):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229780);break;case k.CancelEditSession:G(e)?this.runAction(e,X.NeedDrafting,()=>this.commentPostCallbackProps.onCancel(new Se(e.commentId))):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229781);break;case k.CancelReplySession:B(e)?this.runAction(e,X.NeedDrafting,()=>this.commentCardCallbackProps.onCancel(new Te(e.threadId))):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229782);break;case k.ClickGhostCard:Y(e)?this.runAction(e,X.NeedNotDrafting,()=>this.onGhostCommentClicked()):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229783);break;case k.ClosePane:!function(e){return e.actionType===k.ClosePane}(e)?Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229784):this.runAction(e,X.NeedNotDrafting,()=>this.closePane());break;case k.CreateThread:M(e)?this.runAction(e,X.NeedDrafting,()=>this.commentCardCallbackProps.onPost(new Te(this.getDraftCardId(),e.content),Ce.a.CommitButton)):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229785);break;case k.DeleteComment:U(e)?this.runAction(e,X.NeedNotDrafting,()=>this.commentPostCallbackProps.onDelete(e.commentId)):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229786);break;case k.DeleteThread:V(e)?this.runAction(e,X.NeedNotDrafting,()=>this.cardContextualMenuCallbackProps.onDeleteThread(e.threadId)):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229787);break;case k.PostEdit:if(q(e)){const t=new Se(e.commentId);t.setContents(e.content),this.runAction(e,X.NeedDrafting,()=>this.commentPostCallbackProps.onCommit(t,Ce.a.CommitButton))}else Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229788);break;case k.PostReply:H(e)?this.runAction(e,X.NeedDrafting,()=>this.commentCardCallbackProps.onPost(new Te(e.threadId,e.content),Ce.a.CommitButton)):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229789);break;case k.ReopenThread:z(e)?this.runAction(e,X.NeedNotDrafting,()=>this.cardContextualMenuCallbackProps.onReopenThread(e.threadId)):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229790);break;case k.ResolveThread:W(e)?this.runAction(e,X.NeedNotDrafting,()=>this.cardContextualMenuCallbackProps.onResolveThread(e.threadId)):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229791);break;case k.SelectComment:$(e)?this.runAction(e,X.NeedNotDrafting,()=>this.onRenderableItemSelect(new Se(e.commentId),!1)):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229792);break;case k.StartEditSession:K(e)?this.runAction(e,X.NeedNotDrafting,()=>this.commentPostCallbackProps.onEdit(e.commentId)):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229793);break;case k.StartReplySession:L(e)?this.runAction(e,X.NeedNotDrafting,()=>this.commentCardCallbackProps.onEditorPress(new Te(e.threadId))):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229794);break;default:Object(r.m)(e.actionType)}}),this.onCardLayout=void 0,this.state=Object.assign({actionHistory:[]},this.getInitialState(e))}componentDidMount(){super.componentDidMount(),this.registrationToken=this.props.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction.handler),void 0===this.props.pendingCommentLoad&&this.onMockUIAction.startProcessing()}componentWillUnmount(){var e;super.componentWillUnmount(),null===(e=this.registrationToken)||void 0===e||e.unsubscribe()}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.onMockUIAction.isProcessingEvents||this.props.pendingCommentLoad||this.onMockUIAction.startProcessing();!Object(ve.d)(this.props.draftState)&&this.pendingActionReason===X.NeedNotDrafting&&this.pendingAction&&(this.pendingAction(),this.pendingAction=void 0,this.pendingActionReason=X.None);const n=Object(ve.b)(this.props.draftState),r=Object(ve.b)(e.draftState);n&&!r&&this.pendingActionReason===X.NeedDrafting&&this.pendingAction&&(this.pendingAction(),this.pendingAction=void 0,this.pendingActionReason=X.None)}onDrafting(e){Object(ve.b)(this.props.draftState)?e():(this.pendingAction=e,this.pendingActionReason=X.NeedDrafting)}onNotDrafting(e){Object(ve.d)(this.props.draftState)?(this.pendingAction=e,this.pendingActionReason=X.NeedNotDrafting):e()}runAction(e,t,n){const r={action:e,pendingState:t};this.setState({actionHistory:[...this.state.actionHistory,r]},()=>{const e=()=>{n();const e=this.state.actionHistory.indexOf(r);if(e<0)Object(i.i)().assertConditionTag(!1,"Entry doesnt exist in history",592229778);else{const t=this.state.actionHistory.slice();t.splice(e,1,{action:t[e].action,pendingState:X.None}),this.setState({actionHistory:t})}};switch(t){case X.NeedDrafting:return this.onDrafting(e);case X.NeedNotDrafting:return this.onNotDrafting(e);case X.None:return n()}})}getDraftCardId(){const e=Object(ye.I)(this.props.draftState);if(!e)throw new u.a("Expected draft card",572846421,-2130957492);return e}render(){return this.renderInner()}getMentionableCommentEditorProps(e){}onContextChanged(){this.props.initializationStatus===pe.a.NotInitialized&&this.props.initializeView(this.props.componentTree.componentTreeId.renderContextType)}invokeModalDialog(e,t,n){const o={renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:r.a,telemetryVisitor:this.props.telemetryVisitor};switch(e){case he.a.CancelNewDraft:case he.a.CancelReplyDraft:case he.a.CancelPostEdit:return this.props.discardDraftAsync(o,be.a.SharedComments,!1);case he.a.DeleteThread:return this.props.selectedComment&&this.props.requestDeleteThread(o,this.props.selectedComment.selectedCardId),Promise.resolve(h.a.Handled);case he.a.ClosePaneDraft:return this.closePane(),Promise.resolve(h.a.Handled);default:Object(r.m)(e)}}getCreateCommentInitialHeight(){return 0}getKeyboardingOptions(){return{cardTabbingMode:me.a.AllCardsTabbable,postTabbingMode:me.b.AllPostsTabbable}}showDiscardDialog(){return Promise.resolve(!1)}isNewCommentButtonDisabled(){return!1}getContentsPreventDefaultKeyDownBehavior(){}getContentExtraPaddingLeft(){}getContentExtraPaddingRight(){}getAvailableScreenHeight(){}getMaxDraftHeight(){}getContentBackgroundColor(e,t){}getCommentCardStyle(){}getPinnedCardIndex_deprecated(){}scrollToThreadById(e){return!1}}const Oe={focus:()=>{},blur:()=>{}};const Ee=Object(_.connect)((function(){const e=Object(ee.c)();return t=>{const n=e(t);return n.componentTree={isFocusOn:()=>!1,isFocusWithin:()=>!1,isFocusOnOrWithin:()=>!1,isEventTarget:()=>!1,isFocusWithinAny:()=>!1,isFocusWithinPane:()=>!1,getComponent:()=>Oe,getComponentById:()=>Oe,getCurrentlyFocused:()=>[Oe],componentTreeId:{renderContextType:t.paneState.componentTree.componentTreeId.renderContextType,contextIdentifier:F.a}},n}}),ue.b,void 0,{forwardRef:!0});var Pe=Ee(class extends Ie{renderActionHistory(){return 0===this.state.actionHistory.length?j.createElement(ce.a,null,"No Actions Received"):this.state.actionHistory.map((e,t)=>j.createElement(se.a,{key:t,style:de.d},j.createElement(ce.a,null,"Action: ",e.action.actionType),j.createElement(ce.a,null,e.pendingState===X.None?"Done":"Pending: "+X[e.pendingState])))}renderInner(){return j.createElement(se.a,{testID:"MockCommentPaneRoot",style:de.d},j.createElement(ce.a,null,"MockCommentPane"),j.createElement(ce.a,null,"Items: ",this.props.dataItems.length),j.createElement(ce.a,null,"History"),j.createElement(P.ScrollView,{style:de.d},this.renderActionHistory()))}}),ke=n(114),Re=n(52);l.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::CodeMarkerPayload":{context:"$string",type:"$number",assertTag:"$number"},"Mso::Document::Comments::JS::StartEventPayload":{context:"$string",correlationId:"$string",useMockMode:"$boolean"},"Mso::Document::Comments::JS::StopEventPayload":{context:"$string"}});const xe={APIContextEventService:l.RekaServiceRegistry.getNativeService(["Mso::Document::Comments::JS::APIContextEventService",{sendCodeMarker:["FireAndForgetMethod",["Mso::Document::Comments::JS::CodeMarkerPayload"]],onStartEvent:["Event","Mso::Document::Comments::JS::StartEventPayload"],onStopEvent:["Event","Mso::Document::Comments::JS::StopEventPayload"]}])};var De;!function(e){e[e.Invalid=0]="Invalid",e[e.DataReceived=1]="DataReceived"}(De||(De={}));const we=xe.APIContextEventService;var Ae=n(255);class je{constructor(e,t){this.commentViewManager=e,this.correlationId=t,this.visit=e=>{e.attachContext(this.commentViewManager.apiContext),this.correlationId&&e.addDataField("InstanceCorrelationId",this.correlationId,i.d.SystemMetadata)}}}function _e(e){return new je(Fe(e),e.correlationId)}let Fe=()=>{throw new Error("ViewManagerFactory not set")};var Me=new class{constructor(){this.instanceMap=new Map,this.initialized=!1}getTelemetryVisitor(e){return this.instanceMap.get(e)||{visit:t=>{const n=this.instanceMap.get(e);if(!n)return t.attachContext(e),void t.addDataField("MissingInstanceTelemetry",!0,i.d.SystemMetadata);n.visit(t)}}}closeViewManager(e){const t=this.instanceMap.get(e);t&&(t.commentViewManager.teardown(),this.instanceMap.delete(e))}doesViewManagerExist(e){return this.instanceMap.has(e)}ensureViewManager(e){const{apiContext:t,displayMode:n,contentNavigationAPI:r,contentFilteredRangeHostAPI:o}=e;this.initialized||this.ensureInitialized();let i=this.instanceMap.get(t);return i?this.updateInstanceObject(i,n):(this.initializeContentNavigationAPI(t,r),this.initializeContentFilteredRangeAPI(t,o),i=_e(e),this.instanceMap.set(t,i)),i.commentViewManager}getCorrelationId(e){const t=this.instanceMap.get(e);return t&&t.correlationId}getStore(e){const t=this.instanceMap.get(e);if(!t)throw new u.a("Instance is not initialized",589103622,-2130957512);return t.commentViewManager.getCommentStore()}getViewManager(e){const t=this.tryGetViewManager(e);if(!t)throw new u.a("Instance is not initialized",589103623,-2130957512);return t}tryGetViewManager(e){var t;return null===(t=this.instanceMap.get(e))||void 0===t?void 0:t.commentViewManager}ensureInitialized(){ge.p()&&we.onStartEvent.subscribe(e=>{this.initializeContentNavigationAPI(e.context,void 0),this.initializeContentFilteredRangeAPI(e.context,void 0),this.initializeViewManager(e.context,e.correlationId,e.useMockMode)}),we.onStopEvent.subscribe(e=>{this.closeViewManager(e.context),Object(Re.e)(e.context)}),this.initialized=!0}initializeViewManager(e,t,n){const r=this.instanceMap.get(e);if(r)r.correlationId=t;else{let r;n&&ge.m()&&(Object(i.i)().createActivityObject("OnMockUIDriverCreated",this.getTelemetryVisitor(e),i.a.None,i.b.FullEvent).successTag(592511450),r=new Q(e)),this.instanceMap.set(e,_e({apiContext:e,correlationId:t,initializationReason:te.a.PaneOpen,displayMode:Z.b.FullPane,foldableLayoutState:Ae.a.Indeterminate,paneVisible:!1,initializeImmediately:!0,mockDriver:r}))}}updateInstanceObject(e,t){const n=e.commentViewManager.viewProvider;n.getViewContainer().containerType!==t&&n.changeViewContainerType(t)}initializeContentNavigationAPI(e,t){Object(Re.g)(e)||Object(Re.h)(t||new Re.b(e),e)}initializeContentFilteredRangeAPI(e,t){ge.j()&&!Object(ke.e)(e)&&Object(ke.f)(e,t||new ke.b(e))}};class Ne extends j.Component{constructor(e){super(e),this.createTelemetryContext=Object(x.a)(ae.b);const t=e.initializationReason||te.a.PaneOpen;let n=Me.tryGetViewManager(e.apiContext);if(!n){Object(i.i)().assertConditionTag(!ge.j(),"ContentFiltering is not supported when HeadlessBoot is disabled.",537421137);const r=e.useMockCommentPane&&ge.m();n=Me.ensureViewManager({apiContext:e.apiContext,displayMode:e.displayMode||Z.b.FullPane,foldableLayoutState:e.foldableLayoutState,initializationReason:t,correlationId:e.correlationId,paneVisible:t!==te.a.InitRuntime,initializeImmediately:!0,mockDriver:r?new Q(e.apiContext):void 0})}this._containerProps={commentAPI:n.commentAPI,peopleAPI:n.peopleAPI,localizationAPI:n.localizationAPI,focusManager:n.getFocusManager(),selectionManager:n.getSelectionManager(),initializationReason:n.getInitializationReason(),registerComponentUIActionListener:n.registerComponentUIActionListener,unregisterComponentUIActionListener:n.unregisterComponentUIActionListener,registerComponentInterruptableCommandListener:n.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:n.unregisterComponentInterruptableCommandListener,resource:{id:"CommentPane"},telemetryVisitor:Me.getTelemetryVisitor(this.props.apiContext),correlationId:Me.getCorrelationId(this.props.apiContext)||Object(D.b)(),lppManager:n.lppManager,createOrUpdateFilter:n.createOrUpdateFilter,onInitialRender:Object(w.a)(n.onInitialRender)},Object(oe.g)(Object(ne.b)(e.displayClass)),this.props.useMockCommentPane&&(this._mockUIDriver_deprecated=new Q(this.props.apiContext))}componentWillUnmount(){ge.p()||Me.closeViewManager(this.props.apiContext)}render(){const e=Me.getStore(this.props.apiContext);let t;t=!ge.m()&&this._mockUIDriver_deprecated?j.createElement(Pe,Object.assign({},this._containerProps,{mockUIDriver:this._mockUIDriver_deprecated})):ge.m()?j.createElement(re.ExtensionAwareCommentPane,Object.assign({},this._containerProps,{extensionRenderMode:A.d.Integrated,themeAPI:Me.getViewManager(this.props.apiContext).themeAPI})):j.createElement(ee.a,Object.assign({},this._containerProps));let n=t;return ge.E()&&ge.m()||(n=j.createElement(ie.a,{api:Me.getViewManager(this.props.apiContext).themeAPI},t)),j.createElement(_.Provider,{store:e},j.createElement(ae.a.Provider,{value:this.createTelemetryContext(Me.getTelemetryVisitor(this.props.apiContext))},n))}}const Le={name:"OfficeSharedComments",version:n(295).a};var Be=n(30),He=n(81),Ue=n(239);class Ve{constructor(e,t,n,r,o){this.hostCommentAPI=e,this.author=t,this._anchorHintText=n,this.sessionConfiguration=r,this._insertIndex=o,this._active=!0,this._propertiesToUpdate={},this.updateDraft=e=>{e.draftId===this.sessionConfiguration.draftId&&(e.anchorHintText&&(this._anchorHintText=e.anchorHintText),void 0!==e.insertIndex&&(this._insertIndex=e.insertIndex))},this.handleCommentEvents=(e,t)=>{e===He.e.CommentContextChanged&&Object(Ue.b)(t)&&t.contextDrafts?t.contextDrafts.forEach(e=>this.updateDraft(e)):e===He.e.UpdateDraftThread&&Object(Ue.d)(t)&&this.updateDraft(t)},this.hostCommentAPI.registerForCommentEvents(this.handleCommentEvents)}get active(){return this._active}get anchorHintText(){return this._anchorHintText}get insertIndex(){return this._insertIndex}get propertiesToUpdate(){return this._propertiesToUpdate}updateProperties(e,t){this._propertiesToUpdate[e]=Object.assign({},t)}commit(e){if(!this.hostCommentAPI.commit)throw new u.a(p.j,589103689,-2130957526);if(!this._active)throw new u.a(p.d,589103690,-2130957525);const t=ge.b()||ge.a(),n=t&&this.sessionConfiguration.sessionType===He.i;if(void 0===e&&!n||n&&void 0!==e)throw new u.a(p.e,589103691,-2130957507);return t?this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e,this._propertiesToUpdate):this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e)}endDrafting(){this._active=!1,this.hostCommentAPI.unregisterForCommentEvents(this.handleCommentEvents),this.hostCommentAPI.endCommentSession(this.sessionConfiguration.draftId)}}class We{constructor(e){this.hostCommentAPI=e,this.loadThreads=e.loadThreads.bind(e),this.deleteComment=e.deleteComment.bind(e),this.selectComment=e.selectComment.bind(e),this.highlightComment=e.highlightComment.bind(e),this.setThreadResolvedState=e.setThreadResolvedState.bind(e),this.selectFirstThreadInNextCommentContext=e.selectFirstThreadInNextCommentContext.bind(e),this.selectLastThreadInPreviousCommentContext=e.selectLastThreadInPreviousCommentContext.bind(e),this.registerForCommentEvents=e.registerForCommentEvents.bind(e),this.unregisterForCommentEvents=e.unregisterForCommentEvents.bind(e),this.registerForAction=e.registerForAction.bind(e),this.unregisterForAction=e.unregisterForAction.bind(e),this.resolveSupported=e.resolveSupported.bind(e),this.checkAtMentionCapability=e.checkAtMentionCapability.bind(e),e.getCommentReactionData&&(this.getCommentReactionData=e.getCommentReactionData.bind(e)),ge.t()&&(this.presentLinkToComment=e.presentLinkToComment.bind(e)),e.registerForInterruptableCommands&&(this.registerForInterruptableCommands=e.registerForInterruptableCommands.bind(e)),e.unregisterForInterruptableCommands&&(this.unregisterForInterruptableCommands=e.unregisterForInterruptableCommands.bind(e)),ge.l()&&e.diagnosticHeartbeat&&setInterval(()=>{var t;null===(t=e.diagnosticHeartbeat)||void 0===t||t.call(e)},1e3)}beginDraftingAsync(e){if(!this.hostCommentAPI.beginDraftingAsync||!this.hostCommentAPI.commit)throw new u.a("Drafting APIs are undefined on Host Comment API",589103700,-2130957527);const t=Object(D.b)(),n=Object.assign(Object.assign({},e),{draftId:t});return this.hostCommentAPI.beginDraftingAsync(n).then(e=>new Ve(this.hostCommentAPI,Object(Be.e)(e),e.anchorHintText,e.updatedDraftSessionConfiguration||n,e.insertIndex))}}var ze=n(414);function Ke(e){switch(e){case-2130958286:return"Missing CommentsModelContext";default:return""}}var Ge,qe=n(35),$e=n(51);!function(e){e[e.None=0]="None",e[e.AtMentionKnown=1]="AtMentionKnown",e[e.AtMentionEnabled=2]="AtMentionEnabled",e[e.NewThread=4]="NewThread",e[e.Resolve=8]="Resolve",e[e.Virtualized=16]="Virtualized",e[e.TasksKnown=32]="TasksKnown",e[e.TasksEnabled=64]="TasksEnabled",e[e.PresentLinkToComment=128]="PresentLinkToComment",e[e.UIAAnnotationPattern=256]="UIAAnnotationPattern"}(Ge||(Ge={})),l.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::SetThreadResolvedStateArgs":{threadId:"$string",isResolved:"$boolean"},"Mso::Document::Comments::JS::InitializeResult":{modelCapabilityFlags:"$number",richTextCapabilityFlags:"$number"},"Mso::Document::Comments::JS::CommitDraftArgs":{draftId:"$string",commentBody:["$optional","$string"],propertyUpdates:["opt-field","Mso::Document::Tasks::JS::HostUpdatableProperties"]}});const Ye={CommentAPI:l.RekaServiceRegistry.getNativeService(["Mso::Document::Comments::JS::CommentAPI",{initialize:["ReturnsPromiseMethod","Mso::Document::Comments::JS::InitializeResult",["$string"]],beginDraftingAsync:["ReturnsPromiseMethod","Mso::Document::Comments::JS::BeginDraftingHostResult",["$string",["$union",["Mso::Document::Comments::JS::CreateDraftSessionConfiguration","Mso::Document::Comments::JS::ReplyDraftSessionConfiguration","Mso::Document::Comments::JS::EditDraftSessionConfiguration","Mso::Document::Comments::JS::UpdateMetadataSessionConfiguration"]]]],commit:["FireAndForgetMethod",["$string","Mso::Document::Comments::JS::CommitDraftArgs"]],endCommentSession:["FireAndForgetMethod",["$string","$string"]],loadThreads:["FireAndForgetMethod",["$string",["$array","$string"]]],deleteComment:["FireAndForgetMethod",["$string","$string"]],selectComment:["FireAndForgetMethod",["$string","$string"]],highlightComment:["FireAndForgetMethod",["$string","$string"]],setThreadResolvedState:["FireAndForgetMethod",["$string","Mso::Document::Comments::JS::SetThreadResolvedStateArgs"]],selectFirstThreadInNextCommentContext:["FireAndForgetMethod",["$string"]],selectLastThreadInPreviousCommentContext:["FireAndForgetMethod",["$string"]],checkAtMentionCapability:["ReturnsPromiseMethod","$boolean",["$string"]],presentLinkToComment:["FireAndForgetMethod",["$string","$string"]],getCommentReactionData:["ReturnsPromiseMethod",["$array","Mso::Document::Comments::JS::CommentReactionData"],["$string","$string","$number"]],diagnosticHeartbeat:["FireAndForgetMethod",["$string"]],onNativeEvent:["Event","Mso::Document::Comments::JS::CommentModelEvent"],onUIAction:["Event","$number"],onModelEvent:["Event","Mso::Document::Comments::JS::CommentModelEvent"],onError:["Event","$number"]}])};function Je(e){if(!e)return;return{Resolve:e.Resolve,Task:e.Task?{type:"Task",assignee:e.Task.assignee,updatedState:{title:e.Task.title,schedule:e.Task.schedule,priority:e.Task.priority,completion:e.Task.completion}}:void 0,Reaction:e.Reaction?{type:"Reaction",reactionType:e.Reaction.reactionType,isActive:e.Reaction.isActive}:void 0}}class Qe{constructor(e,t){if(this.observer=e,this.apiContext=t,this.capabilityFlags=0,!Ye.CommentAPI)throw new u.a("CommentAPI unavailable",589103701,-2130957557);Ye.CommentAPI.initialize(this.apiContext).then(e=>{var t,n;this.capabilityFlags=e.modelCapabilityFlags;const r={modelCapabilityFlags:e.modelCapabilityFlags,richTextCapabilityFlags:e.richTextCapabilityFlags};this.observer.onEvent.invoke(qe.a.ModelCapabilitiesChanged,r),this.observer.enableEvents(),ge.P()&&(null===(n=(t=Object(i.i)()).logDiagnosticTrace)||void 0===n||n.call(t,ze.a`CommentsInitialized`,529105745,i.h.Info,i.c.ProductServiceUsage,Object(i.j)(i.g.ReviewedAsNotNecessary)))}).catch(e=>{if(Object(u.b)(e))Object(i.i)().assertConditionTag(!1,e.message,591209547);else{const t=function(e){if("string"==typeof e)try{const t=JSON.parse(e);if(!(t instanceof Array))return;if(1!==t.length)return;const n=parseInt(t[0]);if(isNaN(n))return;return{message:Ke(n),SDXHostAPIErrorCode:n,name:""}}catch(e){return}}(e);if(t&&-2130958286===t.SDXHostAPIErrorCode)return;Object(i.i)().assertConditionTag(!1,"Unknown error in CommentAPIModuleImpl constructor "+t,591209548)}})}beginDraftingAsync(e){return Ye.CommentAPI.beginDraftingAsync(this.apiContext,e)}commit(e,t,n){return Ye.CommentAPI.commit(this.apiContext,{draftId:e,commentBody:t,propertyUpdates:ge.b()||ge.a()?Je(n):void 0}),e}endCommentSession(e){Ye.CommentAPI.endCommentSession(this.apiContext,e)}loadThreads(e){Ye.CommentAPI.loadThreads(this.apiContext,e)}deleteComment(e){Ye.CommentAPI.deleteComment(this.apiContext,e)}selectComment(e){Ye.CommentAPI.selectComment(this.apiContext,e)}highlightComment(e){Ye.CommentAPI.highlightComment(this.apiContext,e)}setThreadResolvedState(e,t){Ye.CommentAPI.setThreadResolvedState(this.apiContext,{threadId:e,isResolved:t})}selectFirstThreadInNextCommentContext(){Ye.CommentAPI.selectFirstThreadInNextCommentContext(this.apiContext)}selectLastThreadInPreviousCommentContext(){Ye.CommentAPI.selectLastThreadInPreviousCommentContext(this.apiContext)}resolveSupported(){return!!(this.capabilityFlags&Ge.Resolve)}checkAtMentionCapability(){return Ye.CommentAPI.checkAtMentionCapability(this.apiContext)}presentLinkToComment(e){Ye.CommentAPI.presentLinkToComment(this.apiContext,e)}getCommentReactionData(e,t){return Ye.CommentAPI.getCommentReactionData(this.apiContext,e,t)}registerForCommentEvents(e){this.ensureEmitterRegistered(),this.observer.onEvent.add(e)}unregisterForCommentEvents(e){this.observer.onEvent.remove(e)}registerForAction(e,t){this.ensureEmitterRegistered(),this.observer.onAction.add(e,t)}unregisterForAction(e){this.observer.onAction.removeAll(e)}registerForInterruptableCommands(e){const t=f.getInstance();t?t.registerForInterruptableCommands(this.apiContext,e):Object(i.i)().assertConditionTag(!1,"CommentAPIServiceModule instance not initialized",591209549)}unregisterForInterruptableCommands(e){const t=f.getInstance();t?t.unregisterForInterruptableCommands(this.apiContext,e):Object(i.i)().assertConditionTag(!1,"CommentAPIServiceModule instance not initialized",591209550)}diagnosticHeartbeat(){Ye.CommentAPI.diagnosticHeartbeat(this.apiContext)}ensureEmitterRegistered(){void 0===this.eventSubscription&&(this.eventSubscription=Ye.CommentAPI.onNativeEvent.subscribe(Object(F.b)(this.apiContext,this.observer.processEvent)),this.observer.onEvent.add((e,t)=>{e===qe.a.ModelCapabilitiesChanged&&Object($e.j)(t)&&(this.capabilityFlags=t.modelCapabilityFlags)}))}}class Xe{constructor(){this._listeners=[]}add(e){this._listeners.push(e)}remove(e){const t=this._listeners.indexOf(e);t>=-1&&this._listeners.splice(t,1)}get invoke(){return(...e)=>{this._listeners.forEach(t=>t(...e))}}}var Ze=Xe;class et{constructor(){this._listeners={}}add(e,t){this.on(e).add(t)}removeAll(e){delete this._listeners[e]}on(e){return this._listeners[e]||(this._listeners[e]=new Xe),this._listeners[e]}}var tt=n(78);var nt=function(e){const t=qe.a.CommentContextChanged,n=e;return $e.b(n)?{type:"Event",eventType:t,payload:{numberOfComments:n.numberOfComments,numberOfThreads:n.numberOfThreads,newNextPopulatedContextDetails:n.newNextPopulatedContextDetails,contextDetails:n.contextDetails,contextDrafts:n.contextDrafts,selectedThreadIndex:n.selectedThreadIndex}}:{type:"Event",eventType:t}},rt=n(37);function ot(e){const t=e.date;return Object.assign(Object.assign({},e),{date:t?new Date(t):void 0})}class it{constructor(e){this.time=e}static isInstanceOf(e){return"object"==typeof e&&"number"==typeof e.time}}var at=n(133);function st(e){return{id:e.id,commentId:e.commentId,currentState:e.currentState,history:(t=e.id,n=e.history,n.map(e=>({commentId:e.commentId,taskId:t,records:e.records.map(e=>function(e){const t={time:ct(e.details.time),user:e.details.user,recordId:e.details.recordId,isLossy:e.details.isLossy};switch(e.type){case"Assign":return dt(e,Object.assign({type:at.a.Assign,assignee:e.assignee},t));case"Create":return dt(e,Object.assign({type:at.a.Create},t));case"Delete":return dt(e,Object.assign({type:at.a.Delete},t));case"Priority":return dt(e,Object.assign({type:at.a.Priority,priority:e.priority},t));case"Progress":return dt(e,Object.assign({type:at.a.Progress,completion:e.completion},t));case"Restore":return dt(e,Object.assign({type:at.a.Restore},t));case"Schedule":return dt(e,Object.assign({type:at.a.Schedule,schedule:e.schedule},t));case"SetTitle":return dt(e,Object.assign({type:at.a.SetTitle,title:e.title},t));case"Unassign":return dt(e,Object.assign({type:at.a.Unassign,assignee:e.assignee},t));case"UnassignAll":return dt(e,Object.assign({type:at.a.UnassignAll},t));case"Undo":throw new u.a("Should not receive undo history record type",589103697,-2130957497);case"Unknown":throw new u.a("Unknown history record type",589103698,-2130957498)}}(e))})))};var t,n}function ct(e){return it.isInstanceOf(e)?new Date(e.time):e}function dt(e,t){return t}function lt(e){return"CommentContextReload"===e.type}function ut(e){return void 0!==e.changes}var pt=function(e){const t=qe.a.CommentContextReload;if(!lt(e))return{type:"Event",eventType:t};if(void 0===e.numberOfComments)return void Object(i.i)().assertConditionTag(ut(e)&&0===e.changes.length,"transformCommentContextReload called with changes and without numberOfComments in the event payload",570728577);const n=[],o=[];let a;const s=()=>{const r=[{type:"Event",eventType:t,payload:Object.assign({contextDetails:e.contextDetails,comments:n},ge.b()?{tasks:o}:{})}];return a&&r.push({type:"Event",eventType:qe.a.CommentSelected,payload:{commentId:a}}),r};if(!e.numberOfComments)return s();const c=t=>{if(lt(t))return ut(t)&&(ge.b()?t.changes.forEach(e=>{e.tempId&&Object(rt.a)(e.model)&&(Object(i.i)().assertConditionTag(!a,"expect 0 or 1 remapped tempIds",591677090),a=e.model.commentId),n.push(ot(e.model)),e.task&&o.push(st(e.task))}):n.push(...t.changes.map(e=>(e.tempId&&Object(rt.a)(e.model)&&(Object(i.i)().assertConditionTag(!a,"expect 0 or 1 remapped tempIds",591677091),a=e.model.commentId),ot(e.model))))),n.length===e.numberOfComments?s():c;Object(r.n)(!1,"Non-context reload payload passed in!",576583251)};return c};var ht=function(e){return function(e){return"CommentHighlighted"===e.type}(e)?{type:"Event",eventType:qe.a.CommentHighlighted,payload:{commentId:e.commentId}}:{type:"Event",eventType:qe.a.CommentHighlighted}};var ft=function(e){return function(e){return"CommentSelected"===e.type}(e)?{type:"Event",eventType:qe.a.CommentSelected,payload:{commentId:e.commentId,selectionReason:e.selectionReason}}:{type:"Event",eventType:qe.a.CommentSelected}},mt=n(48),gt=n(254);function bt(e){const t=Object(mt.c)(e.type),n=e.tempId;let r,o;return Object(gt.a)(t)&&(e.model&&(r=ot(e.model)),ge.b()&&e.task&&(o=st(e.task))),Object.assign(Object.assign(Object.assign({type:t,index:e.index},n?{tempId:n}:{}),r?{model:r}:{}),o?{task:o}:{})}var Ct=function(e){const t=qe.a.CommentsChanged;return function(e){return"CommentsChanged"===e.type}(e)?{type:"Event",eventType:t,payload:{changes:e.changes.map(bt),contextDetails:e.contextDetails}}:{type:"Event",eventType:t}};var yt=function(e){const t=qe.a.LoadComments;if(!function(e){return"CommentsLoaded"===e.type}(e))return{type:"Event",eventType:t};if(function(e){return!!e.threads}(e)){return{type:"Event",eventType:t,payload:{threads:e.threads}}}let n;const r=[];return ge.b()?(n=[],e.changes.forEach(e=>{n.push(ot(e.model)),e.task&&r.push(st(e.task))})):n=e.changes.map(e=>ot(e.model)),{type:"Event",eventType:t,payload:Object.assign({comments:n},ge.b()?{tasks:r}:{})}};var vt=function(e){if(!function(e){return!!e.contextDetails}(e))return e;const t={nextPopulatedContextDetails:e.contextDetails.nextPopulatedContextDetails,commentThreadCounts:e.contextDetails.commentThreadCounts,isReadOnly:!!e.contextDetails.isReadOnly,topVisibleThreadId:e.contextDetails.selectionInfo?e.contextDetails.selectionInfo.topVisibleThreadId:void 0,selectedCommentId:e.contextDetails.selectionInfo?e.contextDetails.selectionInfo.selectedCommentId:void 0,highlightedCommentId:e.contextDetails.selectionInfo?e.contextDetails.selectionInfo.highlightedCommentId:void 0};return Object.assign(Object.assign({},e),{contextDetails:t})};var Tt=function(e){return function(e){return"ModelCapabilitiesChanged"===e.type}(e)?{type:"Event",eventType:qe.a.ModelCapabilitiesChanged,payload:e}:{type:"Event",eventType:qe.a.ModelCapabilitiesChanged}};var St=function(e){return function(e){return"NativeHeartbeat"===e.type}(e)?{type:"Event",eventType:He.e.NativeHeartbeat,payload:{id:e.id}}:{type:"Event",eventType:He.e.NativeHeartbeat}};var It=function(e){return function(e){return"ReturnToDraftRequested"===e.type}(e)?{type:"Event",eventType:He.e.ReturnToDraftRequested,payload:{draftId:e.draftId}}:{type:"Event",eventType:He.e.ReturnToDraftRequested}},Ot=n(148);var Et=function(e){if(!function(e){return"UIAction"===e.type}(e))return{type:"Action",actionType:void 0};const t=e.action;return{type:"Action",actionType:t,payload:{actionBehavior:Ot.a.Execute,actionType:t}}};var Pt=function(e){return function(e){return"UpdateDraftThread"===e.type}(e)?{type:"Event",eventType:He.e.UpdateDraftThread,payload:{draftId:e.draftId,anchorHintText:e.anchorHintText,insertIndex:e.insertIndex}}:{type:"Event",eventType:He.e.UpdateDraftThread}};function kt(e){return"function"==typeof e}function Rt(e,t){const n=vt(function(e){const t={};for(const n of Object.keys(e))t[n]=null===e[n]?void 0:e[n];return t}(t));switch(e){case"CommentContextChanged":return nt(n);case"CommentContextReload":return pt(n);case"CommentsLoaded":return yt(n);case"CommentsChanged":return Ct(n);case"CommentSelected":return ft(n);case"CommentHighlighted":return ht(n);case"ModelCapabilitiesChanged":return Tt(n);case"ReturnToDraftRequested":return It(n);case"UIAction":return Et(n);case"UpdateDraftThread":return Pt(n);case"NativeHeartbeat":return St(n);default:return}}class xt{constructor(e){this.telemetryVisitor=e,this._commentListeners=new Xe,this._actionListeners=new et,this._aggregateEventCallbacks={},this.processEvent=this.processEvent.bind(this),this._eventQueue=[]}get onEvent(){return this._commentListeners}get onAction(){return this._actionListeners}invokeAction(e){void 0!==e.payload&&void 0!==e.actionType?this.onAction.on(e.actionType).invoke(e.payload):Object(i.i)().assertConditionTag(!1,`Invalid '${e.actionType?tt.a[e.actionType]:"unknown"}' action payload`,591677120)}invokeEvent(e){Object(i.i)().assertConditionTag(void 0!==e.payload,`Invalid '${qe.a[e.eventType]}' event payload`,591677121),e.payload&&this.onEvent.invoke(e.eventType,e.payload)}dispatch(e){return(e.constructor===Array?e:[e]).reduce((e,t)=>"Event"===t.type?(this.invokeEvent(t),e):!!function(e){return"Action"===e.type}(t)&&(this.invokeAction(t),e),!0)}enableEvents(){if(this._eventQueue){const e=this._eventQueue;this._eventQueue=void 0,e.forEach(this.processEvent)}}processEvent(e){if(this._eventQueue)return void this._eventQueue.push(e);const t=Object(i.i)().createActivityObject("ProcessNativeEvent",this.telemetryVisitor,i.a.None,i.b.NecessaryServiceDataEvent);let n;try{n=JSON.parse(e.payload)}catch(e){return e instanceof Error&&t.addDataField("ExceptionType",e.name,i.d.SystemMetadata),void t.failTag(591677122,-2130957568)}t.addDataField("EventType",n.type,i.d.SystemMetadata);let r=this._aggregateEventCallbacks[n.type];if(r?kt(r)?r=r(n):(Object(i.i)().assertConditionTag(kt(r),"invalid data in event aggregate",591677123),delete this._aggregateEventCallbacks[n.type],r=void 0):r=Rt(n.type,n),r){if("function"!=typeof r){if(delete this._aggregateEventCallbacks[n.type],!this.dispatch(r))return void t.failTag(591677125,-2130957566)}else this._aggregateEventCallbacks[n.type]=r;t.successTag(591677126)}else t.failTag(591677124,-2130957567)}}var Dt=n(77);l.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::GrantUsersAccessResponse":{OperationResult:"$number"},"Mso::Document::Comments::JS::SuggestionsDetailsChange":{apiContext:"$string",suggestionsDetails:"Mso::Document::Comments::JS::SuggestionsDetails"}});var wt={PeopleModule:l.RekaServiceRegistry.getNativeService(["Mso::Document::Comments::JS::PeopleModule",{checkUserAccess:["ReturnsPromiseMethod","Mso::Document::Comments::JS::UserPermissions",["$string","Mso::Document::Comments::JS::IUser"]],grantUsersAccess:["ReturnsPromiseMethod","Mso::Document::Comments::JS::GrantUsersAccessResponse",["$string",["$array","Mso::Document::Comments::JS::IUser"]]],getCurrentUserId:["ReturnsPromiseMethod","$string",["$string"]],getSuggestionsDetails:["ReturnsPromiseMethod","Mso::Document::Comments::JS::SuggestionsDetails",["$string"]],onSuggestionsDetailsChange:["Event","Mso::Document::Comments::JS::SuggestionsDetailsChange"]}])},At=n(248),jt=n(25),_t=n(85);const Ft="Microsoft.Office.Docs.ModernComments";class Mt{constructor(e){this.apiContext=e,this.suggestionsDetailsListeners=[],this.eventSubscription=void 0,this.capabilities=Dt.b.GetAuthToken|Dt.b.GetSuggestionsDetails,this.getPersonaIconPropertiesArray=void 0}checkUserAccess(e){return this.getModule().checkUserAccess(this.apiContext,e)}grantUsersAccess(e){return this.getModule().grantUsersAccess(this.apiContext,e)}getContactsForMentions(e,t,n){return Promise.reject(new u.a("Not implemented on native",589103651,-2130957557))}getAuthToken(e){const t=Object(i.i)().createActivityObject("PeopleAPIGetAuthToken",Me.getTelemetryVisitor(this.apiContext),i.a.None,i.b.NecessaryServiceDataEvent);return t.addDataField("ServiceId",e,i.d.SystemMetadata),this.getCurrentUserId().then(n=>this.getTokenForUserId(n,e,t),e=>Object(u.b)(e)?(t.failTag(595957842,Object(_t.a)(e)),Promise.reject(e)):(Object(r.h)(e),t.failTag(592492748,-2130957547),Promise.reject(new u.a("Uncaught error",589103680,-2130957547))))}getModule(){return wt.PeopleModule}getCurrentUserId(){return this.getModule().getCurrentUserId(this.apiContext).catch(e=>Promise.reject(new u.a("getCurrentUserId() failed",589103681,-2130957547)))}static sanitizeIdentityErrorMessage(e){switch(e){case"error config token":case"unexpected error":return e;default:return/^error\:\-?\d+$/.test(e)?e:"Unknown error"}}getTokenForUserId(e,t,n){const r={UserName:e,CorrelationId:Ft};let o;switch(t){case Dt.c.Loki:o=At.NativeServices.NativeGetLokiToken.QueryToken(r);break;case Dt.c.MSGraph:o=At.NativeServices.NativeGetMSGraphToken.QueryToken(r);break;default:return n.failTag(595952132,-2130957547),Promise.reject(new u.a("Unrecognized service",589103682,-2130957547))}return o.then(e=>{const{AuthToken:t,ErrorMessage:r}=e;return n.addDataField("AuthDataError",Mt.sanitizeIdentityErrorMessage(r),i.d.SystemMetadata),e.OperationResult?t?(n.successTag(592492751),Promise.resolve(t)):(n.failTag(592492750,-2130957546),Promise.reject(new u.a("Auth token empty",589103684,-2130957546))):(n.failTag(592492749,-2130957547),Promise.reject(new u.a("OperationResult false",589103683,-2130957547)))},e=>(n.failTag(592492752,-2130957547),Promise.reject(new u.a("Identity QueryToken() failed",589103685,-2130957547))))}getSuggestionsDetails(){return this.getModule().getSuggestionsDetails(this.apiContext)}registerForSuggestionsDetailsChanges(e){this.eventSubscription||(this.eventSubscription=this.getModule().onSuggestionsDetailsChange.subscribe(Object(F.b)(this.apiContext,e=>{this.suggestionsDetailsListeners.forEach(t=>t(e.suggestionsDetails))}))),this.suggestionsDetailsListeners.push(e)}unregisterForSuggestionsDetailsChanges(e){const t=this.suggestionsDetailsListeners.indexOf(e);t>-1&&this.suggestionsDetailsListeners.splice(t,1),0===this.suggestionsDetailsListeners.length&&this.eventSubscription&&(this.eventSubscription.unsubscribe(),this.eventSubscription=void 0)}getLokiUrl(){return this.getCurrentUserId().then(e=>this.getLokiUrlCore(e))}getLokiUrlCore(e){const t={UserName:e,CorrelationId:Ft};return At.NativeServices.NativeGetLokiUrl.QueryLokiUrl(t).catch(e=>(Object(jt.a)(554783041)(e),Promise.reject(new u.a("Identity GetLokiUrl() failed",560214533,-2130957487))))}getTenantId(){return this.getCurrentUserId().then(e=>this.getTenantIdCore(e))}getTenantIdCore(e){const t={UserName:e,CorrelationId:Ft};return At.NativeServices.NativeGetTenantId.QueryTenantId(t).catch(e=>(Object(jt.a)(554783042)(e),Promise.reject(new u.a("Identity GetTenantId() failed",560214534,-2130957486))))}}var Nt=n(136);class Lt{constructor(e,t,n){this.viewContainerBase=e,this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.identifier=e.identifier}openView(){this.viewContainerBase.openView&&this.viewContainerBase.openView()}moveFocusToCanvas_donotuse(){this.viewContainerBase.moveFocusToCanvas_donotuse&&this.viewContainerBase.moveFocusToCanvas_donotuse()}}class Bt{constructor(e){this._moduleAPI=e,this.containerType=Z.b.FullPane}openView(){this._moduleAPI.showView()}closeView(){this._moduleAPI.closeView()}onReadyToRender(){this._moduleAPI.onReadyToRender()}moveFocusToCanvas_donotuse(){this._moduleAPI.moveFocusToCanvas_donotuse()}}class Ht extends Bt{constructor(){super(...arguments),this.containerType=Z.b.FullPane}}var Ut,Vt=n(84);class Wt{constructor(e,t){this._moduleAPI=e,this._details=t,this._activity=void 0,this._promise=void 0}run(){return this._promise||(this._activity=Object(i.i)().createActivityObject("SetHalfPaneDisplayMode",Object(i.j)(i.g.Todo,Object(o.c)(3304490)),i.a.None,i.b.NecessaryServiceDataEvent),this._activity.addDataField("DisplayMode",this._details.displayMode,i.d.SystemMetadata),this._promise=this._moduleAPI.setHalfPaneDisplayMode(this._details).then(()=>{if(this._activity)return this._activity.successTag(595932617),this._activity=void 0,this._details},()=>{this._activity&&(this._activity.failTag(595932619,-2130957524),this._activity=void 0)})),this._promise}markReplaced(){this._activity&&(this._activity.failTag(595932616,-2130957523),this._activity=void 0)}getDetails(){return this._details}}class zt extends Bt{constructor(){super(...arguments),this.containerType=Z.b.HalfPane,this._pendingDisplayConfigChange=void 0}setDisplayConfiguration(e){return this._pendingDisplayConfigChange&&!Object(Vt.b)(this._pendingDisplayConfigChange.getDetails(),e)&&(this._pendingDisplayConfigChange.markReplaced(),this._pendingDisplayConfigChange=void 0),this._pendingDisplayConfigChange||(this._pendingDisplayConfigChange=new Wt(this._moduleAPI,e)),this._pendingDisplayConfigChange.run().then(()=>{if(this._pendingDisplayConfigChange&&Object(Vt.b)(this._pendingDisplayConfigChange.getDetails(),e)){const e=this._pendingDisplayConfigChange.getDetails();return this._pendingDisplayConfigChange=void 0,e}},()=>{this._pendingDisplayConfigChange&&Object(Vt.b)(this._pendingDisplayConfigChange.getDetails(),e)&&(this._pendingDisplayConfigChange=void 0)})}}!function(e){e[e.HalfPane=0]="HalfPane",e[e.FullPane=1]="FullPane"}(Ut||(Ut={})),l.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::ViewContainerNativeEventBase":{apiContext:"$string"},"Mso::Document::Comments::JS::ViewContainerChangedNativeEvent":{type:"$string",apiContext:"$string",newDisplayMode:"$number"},"Mso::Document::Comments::JS::FocusTriggeredNativeEvent":{type:"$string",apiContext:"$string",shouldFocus:"$boolean"},"Mso::Document::Comments::JS::VisibilityChangedNativeEvent":{type:"$string",apiContext:"$string",viewContainerVisibilityState:"$number"},"Mso::Document::Comments::JS::FoldableLayoutStateChangedNativeEvent":{type:"$string",apiContext:"$string",newFoldableLayoutState:"$number"}}),l.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::ViewContainerEventPayload":{apiContext:"$string",payload:"$string"}});const Kt={ViewContainerModule:l.RekaServiceRegistry.getNativeService(["Mso::Document::Comments::JS::ViewContainerModule",{setHalfPaneDisplayMode:["ReturnsPromiseMethod","$any",["$string","$string"]],closeView:["FireAndForgetMethod",["$string"]],showView:["FireAndForgetMethod",["$string"]],onReadyToRender:["FireAndForgetMethod",["$string"]],moveFocusToCanvas_donotuse:["FireAndForgetMethod",["$string"]],onEvent:["Event",["$union",["Mso::Document::Comments::JS::ViewContainerChangedNativeEvent","Mso::Document::Comments::JS::FocusTriggeredNativeEvent","Mso::Document::Comments::JS::VisibilityChangedNativeEvent","Mso::Document::Comments::JS::FoldableLayoutStateChangedNativeEvent"]]],onDisplayModeChange:["Event","Mso::Document::Comments::JS::ViewContainerEventPayload"]}])};class Gt{constructor(e){this.apiContext=e}setHalfPaneDisplayMode(e){return Kt.ViewContainerModule.setHalfPaneDisplayMode(this.apiContext,JSON.stringify([e]))}showView(){ge.p()&&Kt.ViewContainerModule.showView(this.apiContext)}closeView(){Kt.ViewContainerModule.closeView(this.apiContext)}onReadyToRender(){Kt.ViewContainerModule.onReadyToRender(this.apiContext)}onEvent(e){Kt.ViewContainerModule.onEvent.subscribe(Object(F.b)(this.apiContext,e))}moveFocusToCanvas_donotuse(){Kt.ViewContainerModule.moveFocusToCanvas_donotuse(this.apiContext)}}class qt extends class{constructor(){this.changedEvent=new Ze,this.fireEvent=e=>{this.changedEvent.invoke(e)}}registerForViewContainerEvents(e){this.changedEvent.add(e)}unregisterForViewContainerEvents(e){this.changedEvent.remove(e)}}{constructor(e,t,n,o){super(),this.processEvent=e=>{switch(e.type){case"ViewContainerChanged":this.changeViewContainerType(function(e){switch(e){case Ut.FullPane:return Z.b.FullPane;case Ut.HalfPane:return Z.b.HalfPane;default:Object(r.m)(e)}}(e.newDisplayMode));break;case"FocusTriggered":this.fireEvent({eventType:Nt.a.FocusTriggered});break;case"VisibilityChanged":this.fireEvent({eventType:Nt.a.VisibilityChanged,viewContainerVisibilityState:e.viewContainerVisibilityState});break;case"FoldableLayoutStateChanged":this.fireEvent({eventType:Nt.a.FoldableLayoutStateChanged,newFoldableLayoutState:e.newFoldableLayoutState});break;default:Object(r.m)(e)}},this._apiContext=e,this._moduleAPI=new Gt(e),this._moduleAPI.onEvent(this.processEvent),this._foldableLayoutState=n,this.updateForNewViewContainerType(t)}getViewContainer(){return Object(r.n)(this._currentContainer,"Container must be set prior to querying it.",576583252),this._currentContainer}changeViewContainerType(e){this.updateForNewViewContainerType(e),this.fireEvent({eventType:Nt.a.ViewContainerChanged,newViewContainer:this._currentContainer})}updateForNewViewContainerType(e){switch(e){case Z.b.FullPane:this._currentContainer=new Lt(new Ht(this._moduleAPI),this._apiContext,this);break;case Z.b.HalfPane:this._currentContainer=new Lt(new zt(this._moduleAPI),this._apiContext,this),this._currentContainer.foldableLayoutState=this._foldableLayoutState}}}var $t,Yt=n(13),Jt=n(173),Qt=n(65),Xt=n(17),Zt=n(5),en=n(33),tn=n(23),nn=n(58),rn=n(76);!function(e){e[e.NoCommand=0]="NoCommand",e[e.ComponentNotFound=1]="ComponentNotFound",e[e.ShouldRetry=2]="ShouldRetry",e[e.Handled=3]="Handled"}($t||($t={}));var on,an=n(6),sn=n(131),cn=n(60);function dn(e,t){return{type:on.DispatchAction,action:t,causedBy:e,priorityArgs:{priority:1}}}function ln(e){return e.type===on.FocusComponent&&void 0!==e.component}function un(e,t,n={priorityArgs:{priority:1}}){return Object.assign({type:on.FocusComponent,component:t,causedBy:e},n)}!function(e){e[e.PreserveFocus=0]="PreserveFocus",e[e.FocusComponent=1]="FocusComponent",e[e.DispatchAction=2]="DispatchAction",e[e.Compound=3]="Compound"}(on||(on={}));var pn=n(18);function hn(e,t,n){if(!t)return n;if(!n)return t;return{type:on.Compound,priorityArgs:{priority:1},first:t,then:n,causedBy:e}}function fn(e,t,n,o){if(!e)return $t.NoCommand;let a=$t.Handled;if(ln(e)){const n=e.component;n.componentType,pn.a.Card,0,a=function(e,t,n){return t?(R.a&&Object(r.i)("Calling focus for componentType: "+e.component.componentType),n(e.component),t.focus(e.preventScroll?{preventScroll:e.preventScroll}:void 0),$t.Handled):function(e){return 1!==e.priorityArgs.priority&&0!==e.priorityArgs.phase}(e)?$t.ShouldRetry:$t.ComponentNotFound}(e,Object(pn.c)(n)?t.getComponentById(n):t.getComponent(n.componentType),o)}else if(function(e){return e.type===on.DispatchAction&&void 0!==e.action}(e))n.dispatch(e.action);else if(function(e){return e.type===on.Compound&&void 0!==e.first&&void 0!==e.then}(e)){const r=fn(e.first,t,n,o),a=fn(e.then,t,n,o);Object(i.i)().assertConditionTag(r!==$t.ShouldRetry&&a!==$t.ShouldRetry,"Compound command failed with status FocusManagerResult.ShouldRetry. No retry will occur.",559748948)}return e.stopPropagation&&e.causedBy&&e.causedBy.stopPropagation(),e.preventDefault&&e.causedBy&&e.causedBy.preventDefault(),a}var mn=n(39);function gn(e,t){return!!(Object(pn.c)(t)?e.getComponentById(t):e.getComponent(t.componentType))}function bn(e,t,n={priority:1}){var r,o;if(!Object(cn.c)(e.componentTreeId.renderContextType))return void Object(i.i)().assertConditionTag(!1,"Shouldn't be called with renderContextType: "+e.componentTreeId.renderContextType,576337157);const a=null!==(o=null!==(r=function(e,t,n){if(!ge.x()||e.componentTreeId.renderContextType!==an.a.FullPane)return;const r=t.getState();if(!Zt.n(r).newThread)return;if(e.getComponent(pn.a.NewCommentButton))return un(void 0,{componentType:pn.a.NewCommentButton},{priorityArgs:n});Object(i.i)().assertConditionTag(!1,"cant find new comment button, but its enabled",579086400)}(e,t,n))&&void 0!==r?r:function(e,t){e.componentTreeId.renderContextType}(e))&&void 0!==o?o:function(e){return un(void 0,{componentType:pn.a.CommentsList},{priorityArgs:e})}(n);if(a)return a;Object(i.i)().assertConditionTag(!1,"Couldn't find a focus target",576337158)}var Cn=n(177),yn=n(302);function vn(e,t,n,r,o){const i=(e,...t)=>r(e,...t),a=(r,...a)=>{const s=i(r,...a);o(s,r,e(),t,n)};return a.processCommand=i,a}function Tn(e,t,n,r,o){const i=(e,o,...i)=>{if(!n(o))return;const s=Object(a.l)(Object(a.q)(e.key),t),c=r[a.c[s]];return c?c.handler(e,o,...i):void 0},s=Object.keys(r).map(e=>({key:e,eventPhase:r[e].phase})),c=(...t)=>({onKeyDown:n=>((t,[n,...r])=>{const a=n();o(i(Object(yn.b)(t),a,...r),a,e(),()=>{},()=>{})})(n,t),getKeyDownEvents:()=>s});return c.processEvent=i,c}var Sn=n(104),In=n(69);class On{constructor(e,t=0,n=!1){this.model=e,this.startPostIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}getRootCommentForCurrentElement(e){if(!this.model[this.pointer])return;const t=Object(rt.b)(this.model[this.pointer]);return e&&e.commentId===t?e:this.model.find(e=>e.commentId===t)}next(){const e=this.pointer;let t;if(this.pointer<this.model.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,t=this.getRootCommentForCurrentElement(t)}while(this.pointer<this.model.length&&t&&t.commentFlags&He.f.Resolved);else++this.pointer;return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&e<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}}previous(){const e=this.pointer;let t;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,t=this.getRootCommentForCurrentElement(t)}while(this.pointer>-1&&t&&t.commentFlags&He.f.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.model[this.pointer]}:{done:!0}}currentIndex(){return this.pointer}}var En=n(145),Pn=n(63),kn=n(24),Rn=n(55),xn=n(64);class Dn{constructor(e,t=0,n=!1){this.items=e,this.startItemIndex=t,this.ignoreResolvedThreads=n,this.pointer=0,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t}getRootCommentForCurrentElement(e){if(!this.items[this.pointer])return;const t=kn.j(this.items[this.pointer]);if(e&&e.commentId===t)return e;for(let e=this.pointer;e>=0;--e){const n=this.items[e];if(Object(xn.a)(n)&&n.commentModel.commentId===t)return n.commentModel}for(let e=this.pointer+1;e<this.items.length;++e){const n=this.items[e];if(Object(xn.a)(n)&&n.commentModel.commentId===t)return n.commentModel}}next(){const e=this.pointer;let t;if(this.pointer<this.items.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,t=this.getRootCommentForCurrentElement(t)}while(this.pointer<this.items.length&&t&&t.commentFlags&Rn.a.Resolved);else++this.pointer;return this.pointer<this.items.length-1||this.pointer===this.items.length-1&&e<this.items.length-1?{done:!1,value:this.items[this.pointer]}:{done:!0}}previous(){const e=this.pointer;let t;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,t=this.getRootCommentForCurrentElement(t)}while(this.pointer>-1&&t&&t.commentFlags&Rn.a.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.items[this.pointer]}:{done:!0}}currentIndex(){return this.pointer}}class wn{constructor(e,t){this.commentStore=e,this.telemetryVisitor=t}selectThreadInCurrentContext(e,t,n,r,o){return dn(e,Yt.M(t,n,void 0,r?Yt.b.ExpandCard:Yt.b.SelectCard,o))}collapseThreadInCurrentContext(e,t,n){return dn(e,Yt.m(t,n))}selectPost(e,t,n,r,o){return dn(e,Yt.M(t,n,r,Yt.b.SelectPost,o))}selectFirstThreadInCurrentContext(e,t,n,r,o){if(!ge.X()&&ge.Y()){const t=Zt.g(this.commentStore.getState(),!0,r),o=Object(ye.G)(Zt.h(this.commentStore.getState()),!0,r);if(o&&t&&0===t.index)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:588129411,telemetryVisitor:this.telemetryVisitor},o,!1,n)}const a=Zt.e(this.commentStore.getState()),s=Zt.c(this.commentStore.getState());let c=void 0;if(Object(tn.c)(s))if(Object(tn.f)(a))if(o){c=new En.a(a,s,-1,o).next().value}else c=a[0];else Object(i.i)().assertConditionTag(!1,"Map-Based Data w/o Map-Based Thread Data is unsupported",537515152);else{let e=void 0;if(o){e=new En.b(s,-1,o).next().value}else e=s[0];c=null==e?void 0:e.commentId}if(c)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:593278811,telemetryVisitor:this.telemetryVisitor},c,t,n)}selectLastThreadInCurrentContext(e,t,n,r,o){const a=Zt.c(this.commentStore.getState());if(!Object(tn.c)(a)&&ge.Y()){const t=Zt.g(this.commentStore.getState(),!0,r),o=Object(ye.G)(Zt.h(this.commentStore.getState()),!0,r);if(o&&t&&t.index===a.length)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:588129412,telemetryVisitor:this.telemetryVisitor},o,!1,n)}const s=Zt.e(this.commentStore.getState());if(!Object(ye.d)(s,a,o))return;let c=void 0;if(Object(tn.c)(a))if(Object(tn.f)(s)){c=new En.a(s,a,s.length,o).previous().value}else Object(i.i)().assertConditionTag(!1,"Map-Based Data w/o Map-Based Thread Data is unsupported",537515153);else{const e=new En.b(a,a.length,o).previous().value;c=null==e?void 0:e.commentId}if(c)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:593278813,telemetryVisitor:this.telemetryVisitor},c,t,n);Object(i.i)().assertConditionTag(!1,"Unable to find last thread",593278812)}focusAndCollapseSelectedThread(e,t){const n=Zt.r(this.commentStore.getState());if(n){if(ge.Y()&&Object(ye.G)(Zt.h(this.commentStore.getState()))===n.selectedCardId)return;const r=Zt.j(this.commentStore.getState());if(Object(sn.a)(n.selectedCardId,r,t)===nn.a.Expanded)return hn(e,un(e,{componentType:pn.a.Card,id:n.selectedCardId,renderContextType:t}),this.collapseThreadInCurrentContext(e,{renderContextType:t,trackback:593278814,telemetryVisitor:this.telemetryVisitor},n.selectedCardId))}}selectNextOrPreviousThread(e,t,n,r,o){const a=this.commentStore.getState(),s=Zt.r(a);if(ge.U()&&(!s||r===an.a.DiscreteIntegrated||r===an.a.None&&en.e(a)!==Pn.a.Visible)){if(void 0!==n)return dn(e,Yt.N({renderContextType:r,trackback:578352064,telemetryVisitor:this.telemetryVisitor},t.direction,t.iterableContentTypes,!!t.restrictToCurrentContext,!!t.restrictToCurrentContext,s?{contentId:s.selectedCardId,contentType:A.b.CommentThread}:void 0,n));Object(i.i)().assertConditionTag(!1,"contentNavigationReason undefined when expecting to use content navigation",560756106)}const c=Zt.e(a),d=Zt.c(a),l=Zt.f(a).nextPopulatedContextDetails;if(void 0!==s){const n=Zt.g(a,!0,r),u=Object(ye.G)(Zt.h(a),!0,r);let p;p=!Object(tn.c)(d)&&ge.Y()&&n&&s.selectedCardId===u?n.index+(t.direction===Re.d.Next?-1:0):this.getSelectedThreadIndex();let h=void 0;if(Object(tn.c)(d))if(Object(tn.f)(c)){const e=new En.a(c,d,p,o);h=t.direction===Re.d.Next?e.next().value:e.previous().value}else Object(i.i)().assertConditionTag(!1,"Map-Based Data w/o Map-Based Thread Data is unsupported",537515154);else{const i=new En.b(d,p,o),a=t.direction===Re.d.Next?i.next():i.previous();if(ge.Y()&&u&&n&&s.selectedCardId!==u){if(t.direction===Re.d.Next?p<n.index&&(a.done||i.currentIndex()>=n.index):p>=n.index&&(a.done||i.currentIndex()<n.index))return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:588289059,telemetryVisitor:this.telemetryVisitor},u,!1,t.source)}a.done||(h=a.value.commentId)}if(h)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:593278816,telemetryVisitor:this.telemetryVisitor},h,t.expandCard,t.source);if(!t.restrictToCurrentContext)return this.selectAcrossContexts(e,t,r,l,o)}else{if(Object(ye.d)(c,d,o))return this.selectFirstThreadInCurrentContext(e,t.expandCard,t.source,r,o);if(!t.restrictToCurrentContext&&l!==In.a.NoComments)return this.selectAcrossContexts(e,t,r,l,o)}}selectAcrossContexts(e,t,n,r,o){return ge.m()&&ge.U()&&!en.a(this.commentStore.getState())&&Object(i.i)().assertConditionTag(!1,"This method should only be called if pane is closed, DHCs are on, and content navigation is off.",560551957),t.direction===Re.d.Next?r===In.a.OnlyCommentsInCurrent?this.selectFirstThreadInCurrentContext(e,t.expandCard,t.source,n,o):dn(e,Yt.O({renderContextType:n,trackback:593278817,telemetryVisitor:this.telemetryVisitor})):r===In.a.OnlyCommentsInCurrent?this.selectLastThreadInCurrentContext(e,t.expandCard,t.source,n,o):dn(e,Yt.P({renderContextType:n,trackback:593278818,telemetryVisitor:this.telemetryVisitor}))}selectNextPostWithinCard(e,t,n){const r=Zt.r(this.commentStore.getState());if(void 0===r)return void Object(i.i)().assertConditionTag(!1,"Expected selectedComment",593278853);if(!ge.b()){const n=Zt.c(this.commentStore.getState()),o=this.getSelectedIndex();let i=void 0,a=void 0;if(Object(tn.c)(n)){const e=Zt.a(this.commentStore.getState())[r.selectedCardId];e&&o<e.length-1&&(i=r.selectedCardId,a=e[o+1])}else{const e=new On(n,o).next(),t=n[o];!e.done&&e.value.parentId&&e.value.parentId===Object(rt.b)(t)&&(i=e.value.parentId,a=e.value.commentId)}return i&&a?this.selectPost(e,{renderContextType:t,trackback:593278854,telemetryVisitor:this.telemetryVisitor},i,a,be.a.SharedComments):void 0}if(!n)return void Object(i.i)().assertConditionTag(!1,"renderableItems must not be undefined",593278855);const o=this.getSelectedIndexFromRenderableItems(n);if(o<0)return void Object(i.i)().assertConditionTag(!1,"Selection not found in renderableItems",571777352);const a=new Dn(n,o).next(),s=n[o],c=kn.j(s);return a.done||kn.j(a.value)!==c?void 0:this.selectPost(e,{renderContextType:t,trackback:593278856,telemetryVisitor:this.telemetryVisitor},kn.j(a.value),kn.f(a.value),be.a.SharedComments)}selectPreviousPostWithinCard(e,t,n){const r=Zt.r(this.commentStore.getState());if(void 0===r)return void Object(i.i)().assertConditionTag(!1,"Expected selectedComment",593278857);if(!ge.b()){const n=Zt.c(this.commentStore.getState()),o=this.getSelectedIndex();let i=void 0,a=void 0;if(Object(tn.c)(n)){const e=Zt.a(this.commentStore.getState())[r.selectedCardId];e&&o>0&&(i=r.selectedCardId,a=e[o-1])}else{const e=n[o];if(e.parentId){const t=new On(n,o).previous();t.done||Object(rt.b)(t.value)!==e.parentId||(i=Object(rt.b)(t.value),a=t.value.commentId)}}return i&&a?this.selectPost(e,{renderContextType:t,trackback:593278858,telemetryVisitor:this.telemetryVisitor},i,a,be.a.SharedComments):void 0}if(!n)return void Object(i.i)().assertConditionTag(!1,"renderableItems must not be undefined",593278859);const o=this.getSelectedIndexFromRenderableItems(n);if(o<0)return void Object(i.i)().assertConditionTag(!1,"Selection not found in renderableItems",571777353);const a=n[o],s=kn.h(a);if(s){const r=new Dn(n,o).previous();if(!r.done&&kn.j(r.value)===s)return this.selectPost(e,{renderContextType:t,trackback:593278860,telemetryVisitor:this.telemetryVisitor},kn.j(r.value),kn.f(r.value),be.a.SharedComments)}}selectRootPostOfSelectedThread(e,t){const n=Zt.r(this.commentStore.getState());if(n&&!Object(Xt.j)(n.selectionDetails)){let r;if(ge.N())r=n.selectedCardId;else{const e=this.getSelectedIndex();r=Zt.c(this.commentStore.getState())[e].commentId}return this.selectPost(e,{renderContextType:t,trackback:593278861,telemetryVisitor:this.telemetryVisitor},r,r,be.a.SharedComments)}}focusAndSelectSiblingThread(e,t){if(t<0)return;const n=Zt.e(this.commentStore.getState()),r=Object(tn.f)(n)?n:n.filter(e=>!e.parentId);if(0===r.length)return;if(ge.S()?0===t&&1===r.length:t-1<0&&t+1>=r.length)return;let o;o=t>=1?t-1:t+1;const i=Object(tn.f)(r)?r[o]:r[o].commentId;return hn(void 0,un(void 0,{componentType:pn.a.Card,id:i,renderContextType:e}),dn(void 0,Yt.M({renderContextType:e,trackback:593278862,telemetryVisitor:this.telemetryVisitor},i,void 0,Yt.b.SelectCard,be.a.SharedComments)))}getSelectedIndex(){const e=this.commentStore.getState();return Object(ye.u)(Zt.e(e),Zt.a(e),Zt.r(e))}getSelectedThreadIndex(){const e=this.commentStore.getState();return Object(ye.L)(Zt.e(e),Zt.r(e))}getSelectedIndexFromRenderableItems(e){const t=Zt.r(this.commentStore.getState());if(!t)return-1;const n=Object(Xt.b)(t);return ge.W()?e.findIndex(e=>kn.f(e)===n):e.findIndex(e=>Object(xn.a)(e)?e.commentModel.commentId===n:e.historyItem.records[0].recordId===n)}}class An{constructor(e,t){this.isRTL=e,this.telemetryVisitor=t,this.focusToRetry=void 0,this.draftToFocus=void 0,this._commentStore=void 0,this.commandExecutor=function(e,t){const n=(o,i,a,s,c)=>{if(!t||!o||-1===t.indexOf(o.type)||3===o.priorityArgs.priority)return o&&-1!==(null==t?void 0:t.indexOf(o.type))&&(R.a&&(null==o?void 0:o.type)===on.FocusComponent&&Object(r.i)("Executing non-debounced focus command "+JSON.stringify(o)),void 0!==n.pendingCommand&&clearTimeout(n.pendingCommand),n.pendingCommand=void 0),void s(o,fn(o,i,a,c));void 0!==n.pendingCommand&&clearTimeout(n.pendingCommand),R.a&&o.type===on.FocusComponent&&Object(r.i)("Caching debounced command "+JSON.stringify(o)),n.pendingCommand=setTimeout(()=>{R.a&&o.type===on.FocusComponent&&Object(r.i)("Executing debounced command "+JSON.stringify(o)),s(o,fn(o,i,a,c)),n.pendingCommand=void 0},e)};return n.pendingCommand=void 0,n}(50,[on.FocusComponent]),this.pendingOnComponentFocusedRequest=void 0,this.clearPendingOnComponentFocusedRequest=e=>{const t=e?Object(mn.d)(e):"";!this.pendingOnComponentFocusedRequest||""!==t&&t===Object(mn.d)(this.pendingOnComponentFocusedRequest.targetedComponent)||(R.a&&Object(r.i)("Pending component focused request cleared."),clearTimeout(this.pendingOnComponentFocusedRequest.token),this.pendingOnComponentFocusedRequest=void 0)},this.commandOnWillFocusCallback=e=>{this.clearPendingOnComponentFocusedRequest(e)},this.commandExecuteCallback=(e,t)=>{e&&ln(e)&&(t===$t.ShouldRetry?this.focusToRetry={command:e,timestamp:Date.now()}:t===$t.Handled&&(this.focusToRetry=void 0))},this.commentContentsKeyDown=Tn(()=>this.commentStore,this.isRTL,e=>{const t=Zt.h(this.commentStore.getState());if(ge.Y()){const n=Object(ye.I)(t);if(n&&e.isFocusOnOrWithin({componentType:pn.a.CardEditor,id:n,renderContextType:t.drafts[t.cardIdToDraftIdMap[n]].renderContextType}))return!1;const r=Object(ye.J)(t);if(r&&e.isFocusOnOrWithin({componentType:pn.a.PostEditor,id:r,renderContextType:t.drafts[t.postIdToDraftIdMap[r]].renderContextType}))return!1}else if(Object(ve.c)(t))return!1;return!e.isFocusOn({componentType:pn.a.GhostCard})&&!e.isFocusOn({componentType:pn.a.NewCommentButton})},{ArrowDown:{handler:(e,t,n)=>{const r=this.onDownKey(e,t,n?n():void 0);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r},phase:a.a.Bubbling},ArrowUp:{handler:(e,t,n)=>{const r=this.onUpKey(e,t,n?n():void 0);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r},phase:a.a.Bubbling},ArrowRight:{handler:(e,t)=>{if(t.componentTreeId.renderContextType===an.a.HalfPane)return;const n=this.onRightKey(e,t);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n},phase:a.a.Bubbling},ArrowLeft:{handler:(e,t)=>{if(t.componentTreeId.renderContextType===an.a.HalfPane)return;const n=this.onLeftKey(e,t.componentTreeId.renderContextType);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n},phase:a.a.Bubbling},Home:{handler:(e,t)=>{if(t.componentTreeId.renderContextType!==an.a.FullPane)return;const n=this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,be.a.SharedComments,t.componentTreeId.renderContextType,!1);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n},phase:a.a.Capturing},End:{handler:(e,t)=>{if(t.componentTreeId.renderContextType!==an.a.FullPane)return;const n=this.selectionCommandFactory.selectLastThreadInCurrentContext(e,!0,be.a.SharedComments,t.componentTreeId.renderContextType,!1);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n},phase:a.a.Capturing},F12:{handler:(e,t)=>{const n=e.altKey?this.handleMoveFocusEvent(e,t):void 0;return n&&(n.stopPropagation=!0),n},phase:a.a.None},Escape:{handler:(e,t)=>{const n=this.handleMoveFocusEvent(e,t);return n&&(n.stopPropagation=!0),n},phase:a.a.None}},this.commandExecutor),this.focusCommentCardCommand=vn(()=>this.commentStore,this.commandExecuteCallback,this.commandOnWillFocusCallback,(e,t)=>{const n=Zt.h(this.commentStore.getState()),r=Object(ye.K)(n);let o=void 0;return(o=this.checkForRetryOfEditorFocus(e,n))||!ge.Y()&&(null==r?void 0:r.threadId)===t&&(o=this.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,n),o)?o:un(void 0,{componentType:Object(mn.c)(t,n),id:t,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:1},preventScroll:e.componentTreeId.renderContextType===an.a.DiscreteIntegrated})},this.commandExecutor),this.focusCommentPostCommand=vn(()=>this.commentStore,this.commandExecuteCallback,this.commandOnWillFocusCallback,(e,t)=>{const n=Zt.h(this.commentStore.getState());if(!ge.Y()&&n.postIdToDraftIdMap[t]){const t=this.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,n);if(t)return t}return un(void 0,{componentType:pn.a.Post,id:t,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:1}})},this.commandExecutor),this.focusCommentPaneCommand=vn(()=>this.commentStore,this.commandExecuteCallback,this.commandOnWillFocusCallback,e=>{if(!Object(cn.c)(e.componentTreeId.renderContextType))return void Object(i.i)().assertConditionTag(!1,"paneContainerFocusHandler called outside of a pane render context",575239242);const t=Zt.h(this.commentStore.getState()),n=Zt.r(this.commentStore.getState());let r=void 0;if(r=this.checkForRetryOfEditorFocus(e,t))return r;if(!e.isFocusWithinPane()||e.isFocusOn({componentType:pn.a.PaneRoot})){if(!ge.Y()&&(r=this.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,t)))return r;if(r=this.checkForCommentSelectionFocus(e.componentTreeId.renderContextType,n,t))return r;if(!ge.x()&&!e.getComponent(pn.a.ClosePaneButton)){const t=Zt.e(this.commentStore.getState());return t.length>0?this.focusCommentCardCommand.processCommand(e,Object(tn.f)(t)?t[0]:t[0].commentId):void Object(i.i)().assertConditionTag(!0,"Shouldn't be reached on current config",575239243)}return bn(e,this.commentStore)}},this.commandExecutor),this.commentCardMounted=vn(()=>this.commentStore,this.commandExecuteCallback,this.commandOnWillFocusCallback,(e,t)=>{const n=Zt.h(this.commentStore.getState()),r={componentType:Object(mn.c)(t.id,n),id:t.id,renderContextType:e.componentTreeId.renderContextType};let o=void 0;if(o=this.handleFocusRetry(e,r,n,1))return o;if(!t.selected)return;if(e.isFocusWithin(r))return;const i=Object(cn.c)(e.componentTreeId.renderContextType);return i&&!e.isFocusWithinPane()||!(i||e.isFocusWithinAny(pn.a.Card)||e.isFocusWithinAny(pn.a.DraftCard))?void 0:this.focusCommentCardCommand.processCommand(e,t.id)},this.commandExecutor),this.commentCardEditorMounted=vn(()=>this.commentStore,this.commandExecuteCallback,this.commandOnWillFocusCallback,(e,t)=>this.handleFocusRetry(e,{componentType:pn.a.CardEditor,id:t,renderContextType:e.componentTreeId.renderContextType},Zt.h(this.commentStore.getState()),1),this.commandExecutor),this.commentPostMounted=vn(()=>this.commentStore,this.commandExecuteCallback,this.commandOnWillFocusCallback,(e,t)=>this.handleFocusRetry(e,{componentType:pn.a.Post,id:t,renderContextType:e.componentTreeId.renderContextType},Zt.h(this.commentStore.getState()),1),this.commandExecutor),this.commentPostEditorMounted=vn(()=>this.commentStore,this.commandExecuteCallback,this.commandOnWillFocusCallback,(e,t)=>this.handleFocusRetry(e,{componentType:pn.a.PostEditor,id:t,renderContextType:e.componentTreeId.renderContextType},Zt.h(this.commentStore.getState()),1),this.commandExecutor),this.commentPanePropsUpdated=vn(()=>this.commentStore,this.commandExecuteCallback,this.commandOnWillFocusCallback,(e,t,n)=>{let r=void 0;if(r=this.checkForRetryCommandOnPropsUpdated(e,n.draftState,!1))return r;const o=t.draftState,i=n.draftState,a=t.selectedComment,s=n.selectedComment;return(r=this.checkForDiscard(e,o,i,a,s))||(r=this.checkForHalfPaneFullTransition(e,t,n))?r:e.isFocusWithinPane()?(r=this.checkForLowFidelityWarning(e,a,s))||(r=this.checkForSelectionChange(e,i,a,s))||(r=this.checkForCardPendingChange(e,t.cardViewStates,n.cardViewStates,i))||(r=this.checkForReplyFinished(e,s,t.draftState,n.draftState,s&&n.cardViewStates[s.selectedCardId]))?r:this.checkForLowFidelityWarning(e,a,s):void 0},this.commandExecutor),this.discreteCommentCardRootRefMounted=e=>{Object(Cn.b)(e)},this.discreteCommentCardPropsUpdated=vn(()=>this.commentStore,this.commandExecuteCallback,this.commandOnWillFocusCallback,(e,t,n)=>{let r=void 0;return(r=this.checkForRetryCommandOnDiscreteCardPropsUpdated(e,n))||(r=this.checkForDiscard(e,t.draftState,n.draftState,t.selectedState,n.selectedState))?r:e.isFocusWithinAny(pn.a.Card)||e.isFocusWithinAny(pn.a.DraftCard)?this.shouldFocusFromCardPendingStateChange(t.cardState,n.cardState)?un(void 0,{renderContextType:e.componentTreeId.renderContextType,componentType:Object(mn.b)(n.isDraftThread),id:n.threadId}):(r=this.checkForLowFidelityWarning(e,t.selectedState,n.selectedState))||(r=this.checkForSelectionChange(e,n.draftState,t.selectedState,n.selectedState))||(r=this.checkForReplyFinished(e,n.selectedState,t.draftState,n.draftState,n.cardState))?r:this.checkForLowFidelityWarning(e,t.selectedState,n.selectedState):void 0},this.commandExecutor),this.paneContainerKeyDown=Tn(()=>this.commentStore,this.isRTL,e=>!!Object(cn.c)(e.componentTreeId.renderContextType)||(Object(i.i)().assertConditionTag(!1,"paneContainerKeyDownHandler called outside of a pane render context",575239244),!1),{Escape:{handler:(e,t)=>dn(e,Yt.D({renderContextType:t.componentTreeId.renderContextType,trackback:575239245,telemetryVisitor:this.telemetryVisitor})),phase:a.a.Capturing},Tab:{handler:(e,t)=>this.paneContainerTabHandling(e,t),phase:a.a.None}},this.commandExecutor),this.commentEditorKeyDown=Tn(()=>this.commentStore,this.isRTL,()=>!0,{F12:{handler:(e,t)=>{const n=e.altKey?this.handleMoveFocusEvent(e,t):void 0;return n&&(n.stopPropagation=!0),n},phase:a.a.None}},this.commandExecutor),this.onUserAction=vn(()=>this.commentStore,this.commandExecuteCallback,this.commandOnWillFocusCallback,(e,t)=>{var n;switch(t.userAction){case Sn.a.RequestNewCommentFromHost:if(!Object(cn.c)(e.componentTreeId.renderContextType))return;return bn(e,this.commentStore);case Sn.a.CancelReplyDraft:return un(void 0,{componentType:pn.a.Card,id:t.cardId,renderContextType:e.componentTreeId.renderContextType});case Sn.a.DeleteThread:case Sn.a.CancelNewThreadDraft:if(!Object(cn.c)(e.componentTreeId.renderContextType))return;if(e.componentTreeId.renderContextType===an.a.HalfPane&&t.userAction===Sn.a.CancelNewThreadDraft)return;return null!==(n=bn(e,this.commentStore,{priority:3,phase:0}))&&void 0!==n?n:this.selectionCommandFactory.focusAndSelectSiblingThread(e.componentTreeId.renderContextType,t.threadIndex);case Sn.a.ResolveThread:return void 0;default:Object(r.m)(t)}},this.commandExecutor)}postOnComponentFocusedRequest(e,t){this.clearPendingOnComponentFocusedRequest();const n=setTimeout(t,500);this.pendingOnComponentFocusedRequest={callback:t,token:n,targetedComponent:e},R.a&&Object(r.i)(`Pending component focused request added for ${Object(mn.d)(e)}.`)}initialize(e,t){if(this._commentStore)throw new u.a("FocusManager already initialized",575239239,-2130957489);this._commentStore=e,this.selectionCommandFactory=null!=t?t:new wn(e,this.telemetryVisitor)}get commentStore(){if(!this._commentStore)throw new u.a("FocusManager not initialized",575239240,-2130957490);return this._commentStore}setDeferredActiveEditorFocusCommand(e){this.draftToFocus={draftId:e,timestamp:Date.now(),isPendingSetFocus:!0}}handleFocusRetry(e,t,n,r){let o=void 0;if(o=this.checkForRetryOfEditorFocus(e,n))return o;if(!this.focusToRetry||!t)return;if(!ge.T()&&!this.shouldRetryFocusForPhase(this.focusToRetry,r))return;const a=this.focusToRetry.command.component,s=Date.now()-this.focusToRetry.timestamp;if(s>15e3)return Object(i.i)().assertConditionTag(!1,`Took too long to mount component type ${a.componentType} for focus retry: ${s} ms`,575239241),void(this.focusToRetry=void 0);if((!ge.T()||this.shouldRetryFocusForPhase(this.focusToRetry,r))&&Object(pn.b)(a,t)){const e=this.focusToRetry.command;return this.focusToRetry=void 0,e}}shouldArrowNavigatePosts(e,t,n){if(Object(sn.a)(e.selectedCardId,t,n.componentTreeId.renderContextType)===nn.a.Collapsed)return!1;if(e.selectedCardId===Object(ye.G)(Zt.h(this.commentStore.getState())))return!1;const r={componentType:pn.a.Post,id:Object(Xt.b)(e),renderContextType:n.componentTreeId.renderContextType};return n.isFocusOnOrWithin(r)}onDownKey(e,t,n){if(!Zt.k(this.commentStore.getState()))return;const r=ge.m()&&!en.a(this.commentStore.getState()),o=Zt.r(this.commentStore.getState()),a=Zt.j(this.commentStore.getState());if(o){if(!this.shouldArrowNavigatePosts(o,a,t)){if(t.componentTreeId.renderContextType===an.a.DiscreteIsolated)return;const n={direction:Re.d.Next,source:be.a.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(e,n,Re.c.Keyboarding,t.componentTreeId.renderContextType,r)}return this.selectionCommandFactory.selectNextPostWithinCard(e,t.componentTreeId.renderContextType,n)}if(t.componentTreeId.renderContextType!==an.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,be.a.SharedComments,t.componentTreeId.renderContextType,r);Object(i.i)().assertConditionTag(!1,"selectedComment missing on down key handler for DiscreteIsolated card",575239249)}onUpKey(e,t,n){if(!Zt.k(this.commentStore.getState()))return;const r=ge.m()&&!en.a(this.commentStore.getState()),o=Zt.r(this.commentStore.getState()),a=Zt.j(this.commentStore.getState());if(o){if(!this.shouldArrowNavigatePosts(o,a,t)){if(t.componentTreeId.renderContextType===an.a.DiscreteIsolated)return;const n={direction:Re.d.Previous,source:be.a.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(e,n,Re.c.Keyboarding,t.componentTreeId.renderContextType,r)}return this.selectionCommandFactory.selectPreviousPostWithinCard(e,t.componentTreeId.renderContextType,n)}if(t.componentTreeId.renderContextType!==an.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,be.a.SharedComments,t.componentTreeId.renderContextType,r);Object(i.i)().assertConditionTag(!1,"selectedComment missing on up key handler for DiscreteIsolated card",575239250)}onRightKey(e,t){if(!Zt.k(this.commentStore.getState()))return;const n=Zt.r(this.commentStore.getState());if(ge.Y()&&n&&n.selectedCardId===Object(ye.G)(Zt.h(this.commentStore.getState())))return;let r=this.selectionCommandFactory.selectRootPostOfSelectedThread(e,t.componentTreeId.renderContextType);return r||(n&&Object(Xt.j)(n.selectionDetails)&&t.isFocusOn({componentType:pn.a.Card,id:n.selectedCardId,renderContextType:t.componentTreeId.renderContextType})&&(r=this.focusCommentPostCommand.processCommand(t,n.selectionDetails.selectedPostId)),r||void 0)}onLeftKey(e,t){if(Zt.k(this.commentStore.getState()))return this.selectionCommandFactory.focusAndCollapseSelectedThread(e,t)}onTabKeyInPane(e,t){return void 0===Zt.r(this.commentStore.getState())&&Zt.k(this.commentStore.getState())?this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,be.a.SharedComments,t,!1):ge.Y()?void 0:this.checkForActiveEditorFocus(e,t,Zt.h(this.commentStore.getState()))}isDraftInOtherContext(){const e=Zt.t(this.commentStore.getState());return!!e&&!e.isInCurrentContext}logEditorRetryError(e,t,n,r){var o,a,s;null===(a=(o=Object(i.i)()).logDiagnosticTrace)||void 0===a||a.call(o,ze.a`CommentsEditorFocusRetry`,r,i.h.Info,i.c.ProductServiceUsage,this.telemetryVisitor,Object(i.l)("RenderContextType",t.componentTreeId.renderContextType,i.d.SystemMetadata),Object(i.l)("IsDraftInCurrentContext",!!e&&e.isInCurrentContext,i.d.SystemMetadata),Object(i.l)("DraftRenderContextType",null!==(s=null==e?void 0:e.renderContextType)&&void 0!==s?s:an.a.None,i.d.SystemMetadata),Object(i.l)("ComponentType",null!=n?n:0,i.d.SystemMetadata))}checkForRetryOfEditorFocus(e,t){if(void 0===this.draftToFocus)return;if(!this.draftToFocus.isPendingSetFocus)return{causedBy:void 0,type:on.PreserveFocus,priorityArgs:{priority:1}};const n=t.drafts[this.draftToFocus.draftId],r=Date.now()-this.draftToFocus.timestamp;if(r>15e3)return Object(i.i)().assertConditionTag(!1,`Took too long to focus draft editor: ${r} ms, expected draft still exists: ${!!n}`,575239251),this.draftToFocus=void 0,void this.logEditorRetryError(n,e,void 0,556607431);if(!n||n.renderContextType!==e.componentTreeId.renderContextType)return void this.logEditorRetryError(n,e,void 0,556794945);const o=this.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,t,{priority:ge.H()?2:3,phase:0});if(o&&gn(e,o.component))return this.draftToFocus=Object.assign(Object.assign({},this.draftToFocus),{isPendingSetFocus:!1}),setTimeout(()=>this.draftToFocus=void 0),this.clearPendingOnComponentFocusedRequest(),o;this.logEditorRetryError(n,e,null==o?void 0:o.component.componentType,556794947)}checkForActiveEditorFocus(e,t,n,r={priority:1}){if(this.isDraftInOtherContext())return;const o=Object(ye.J)(n);if(o)return un(e,{componentType:pn.a.PostEditor,id:o,renderContextType:t},{priorityArgs:r});const i=Object(ye.I)(n);return i?un(e,{componentType:pn.a.CardEditor,id:i,renderContextType:t},{priorityArgs:r}):void 0}handleMoveFocusEvent(e,t){const n=Zt.r(this.commentStore.getState()),r=n?{contentId:null==n?void 0:n.selectedCardId,contentType:A.b.CommentThread}:void 0;return dn(e,Yt.v({renderContextType:t.componentTreeId.renderContextType,trackback:575239252,telemetryVisitor:this.telemetryVisitor},r))}checkForCommentSelectionFocus(e,t,n){if(ge.Y()||!this.isDraftInOtherContext())return t&&t.selectedCardId?un(void 0,{componentType:Object(mn.c)(t.selectedCardId,n),id:t.selectedCardId,renderContextType:e},{priorityArgs:{priority:2,phase:1}}):void 0}checkForDiscard(e,t,n,r,o){if(!r||!o)return;const i=r.selectionDetails,a=o.selectionDetails;if(Object(ve.j)(t)&&!Object(ve.c)(n))return this.focusCommentCardCommand.processCommand(e,o.selectedCardId);if(Object(Xt.j)(i)===Object(Xt.j)(a)&&r.selectedCardId===o.selectedCardId&&Object(ve.m)(t,n)){if(!Object(Xt.j)(i)||!Object(Xt.j)(a))return un(void 0,{componentType:pn.a.CardEditor,id:o.selectedCardId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}});if(i.selectedPostId===a.selectedPostId)return un(void 0,{componentType:pn.a.PostEditor,id:a.selectedPostId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}})}}paneContainerTabHandling(e,t){}checkForSelectionChange(e,t,n,r){if(!r)return;if((!n||Object(Xt.b)(n)!==Object(Xt.b)(r)||Object(Xt.j)(n.selectionDetails)!==Object(Xt.j)(r.selectionDetails))&&(this.clearPendingOnComponentFocusedRequest(),(ge.Y()||!Object(ve.d)(t))&&!e.isFocusOn({componentType:pn.a.NextCommentButton})&&!e.isFocusOn({componentType:pn.a.PreviousCommentButton}))){if(!Object(Xt.j)(r.selectionDetails)){if(e.isFocusOnOrWithin({componentType:r.selectedCardId!==(null==n?void 0:n.selectedCardId)?Object(mn.c)(r.selectedCardId,t):pn.a.CardEditor,id:r.selectedCardId,renderContextType:e.componentTreeId.renderContextType},!0))return;return this.focusCommentCardCommand.processCommand(e,r.selectedCardId)}if(!e.isFocusOnOrWithin({componentType:pn.a.Post,id:r.selectionDetails.selectedPostId,renderContextType:e.componentTreeId.renderContextType}))return this.focusCommentPostCommand.processCommand(e,r.selectionDetails.selectedPostId)}}checkForReplyFinished(e,t,n,r,o){const i=Object(ye.I)(n),a=Object(ye.I)(r);if(o&&o.pending!==Qt.a.Editor)return i&&!a&&(null==t?void 0:t.selectedCardId)===i&&e.isFocusWithin({componentType:pn.a.Card,id:i,renderContextType:e.componentTreeId.renderContextType})?this.focusCommentCardCommand.processCommand(e,i):void 0}checkForHalfPaneFullTransition(e,t,n){if(e.componentTreeId.renderContextType===an.a.HalfPane&&Object(Vt.c)(n.displayConfigurationState)&&n.displayConfigurationState.displayMode===Vt.a.Normal&&(!Object(Vt.c)(t.displayConfigurationState)||t.displayConfigurationState.displayMode===Vt.a.Variable))return un(void 0,{componentType:pn.a.ClosePaneButton})}shouldFocusFromCardPendingStateChange(e,t){return!!e&&(e.pending!==t.pending&&t.pending!==Qt.a.Editor)}checkForCardPendingChange(e,t,n,r){const o=Object.entries(n).find(e=>{const n=t[e[0]];return this.shouldFocusFromCardPendingStateChange(n,e[1])});if(o)return un(void 0,{renderContextType:e.componentTreeId.renderContextType,componentType:Object(mn.c)(o[0],r),id:o[0]})}checkForRetryCommandOnPropsUpdated(e,t,n){const r=!n&&this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&gn(e,this.focusToRetry.command.component)?this.focusToRetry.command.component:void 0;return this.handleFocusRetry(e,r,t,2)}checkForRetryCommandOnDiscreteCardPropsUpdated(e,t){const n=this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&(!Object(pn.c)(this.focusToRetry.command.component)||!Object(pn.d)(this.focusToRetry.command.component.componentType)||this.focusToRetry.command.component.id===t.threadId),r=this.draftToFocus&&(t.cardRelativeDraftingState===rn.a.InCard||t.cardRelativeDraftingState===rn.a.InChildPost);if(n||r)return this.checkForRetryCommandOnPropsUpdated(e,t.draftState,!n)}checkForLowFidelityWarning(e,t,n){if(n&&(ge.i()?Object(Xt.h)(n):Object(Xt.g)(n))){const r=t?Object(Xt.b)(t):void 0,o=Object(Xt.b)(n);if(o!==r||n.selectionDetails.lowFidelityWarningType!==(null==t?void 0:t.selectionDetails.lowFidelityWarningType))return un(void 0,{componentType:pn.a.Post,renderContextType:e.componentTreeId.renderContextType,id:o})}}shouldRetryFocusForPhase(e,t){return 1!==e.command.priorityArgs.priority&&0!=(e.command.priorityArgs.phase&t)}}var jn=n(109);function _n(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(o){return"function"==typeof o?o(n,r,e):t(o)}}}}var Fn=_n();Fn.withExtraArgument=_n;var Mn=Fn;const Nn=n(9).unstable_batchedUpdates,Ln=()=>e=>t=>Nn(()=>e(t)),Bn=()=>e=>t=>{const n="string"==typeof t.type?t.type:t.name||"Unknown Action",o=Object(r.k)(r.c.Redux,n),i=e(t);return null==o||o.end(),i};var Hn=n(159),Un=n(45),Vn=n(192),Wn=n(86),zn=n(127),Kn=n(15),Gn=n(142),qn=n(112),$n=n(151);var Yn=n(153),Jn=n(88);function Qn(e,t,n,r){if(!ge.b())return;const o=Object.assign({},e),a=Object.assign({},t);let s=!1,c=!1;return n.changes.forEach(n=>{if(n.type===Un.d.Unknown)return void Object(i.i)().assertConditionTag(!1,"Unknown change type",554836096);const d=n.model.commentId;switch(n.type){case Un.d.Delete:if(delete o[d],void 0!==e[d]){if(Object.keys(e).includes(d)){if(ge.I())Zn(a,e[d],void 0);else for(const t of e[d].history)for(const n of t.records)delete a[kn.a(e[d].id,n.recordId)];s=!0}}break;case Un.d.Load:case Un.d.Insert:case Un.d.Modify:Object(i.i)().assertConditionTag(n.type===Un.d.Modify||!o[d],"Task should not already be populated on initial load",554836097);const l=n.task;if(l){if(!function(e){return 0===e.history.length||e.history[0].records.length>0&&e.history[0].records[0].type===Jn.a.Create}(l))return void Object(i.i)().assertConditionTag(!1,"Invalid task payload - dropping task data",554836098);if(ge.I()&&(s=s||!o[d]||o[d].currentState.completion!==l.currentState.completion),ge.q())s=Xn(t,a,l,r)||s;else{0===l.history.length&&(c=!0);const e=new Set;for(const n of l.history)for(const o of n.records){e.add(o.recordId);const n=kn.a(l.id,o.recordId);t[n]||(s=!0,a[n]=Object(ye.t)(Object(ye.o)(o.time,void 0,r.dataCulture)))}if(ge.I()){const t=Zn(a,l,e);s=s||t}}o[d]=l}else if(""===n.model.parentId&&o[d]){const e=o[d];ge.I()?Zn(a,e,void 0):e.history.forEach(t=>t.records.forEach(t=>{delete a[kn.a(e.id,t.recordId)]})),delete o[d],s=!0}}}),s||c?{updatedTasks:o,updatedHistoryRecordViewState:a}:void 0}function Xn(e,t,n,r){if(0===n.history.length)return!0;let o=!1;const i=e&&Object.keys(e).length>0,a=i?new Set:void 0;for(const i of n.history)for(const s of i.records){null==a||a.add(s.recordId);const i=kn.a(n.id,s.recordId);e[i]?t[i]=e[i]:(o=!0,t[i]=Object(ye.t)(Object(ye.o)(s.time,void 0,r.dataCulture)))}if(ge.I()&&i){const e=Zn(t,n,a);o=o||e}return o}function Zn(e,t,n){let r=!1;for(const o of t.history)for(const i of o.records)n&&n.has(i.recordId)||(delete e[kn.a(t.id,i.recordId)],r=!0);return r}function er(e){if(!e)return;const t={};return void 0!==e.isReadOnly&&(t.isReadOnly=e.isReadOnly),void 0!==e.nextPopulatedContextDetails&&(t.nextPopulatedContextDetails=e.nextPopulatedContextDetails),void 0!==e.commentThreadCounts&&(t.commentThreadCounts=e.commentThreadCounts||void 0),Object.keys(t).length?t:void 0}var tr=n(59),nr=n(100);class rr{constructor(e,t,n){this.componentTreeId={renderContextType:e,contextIdentifier:t},n&&Object(cn.a)(n.componentTreeId.renderContextType,e)?this.viewForest=new a.e(n.viewForest):this.viewForest=new a.e}getViewForest(){return this.viewForest}getViewTrees(){return this.viewForest.getViewTrees()}getComponent(e){return this.viewForest.getDescendantById(Object(mn.e)(e))}getComponentById(e){return this.viewForest.getDescendantById(Object(mn.a)(e))}isEventTarget(e,t){return!1}isFocusWithinPane(){return this.isFocusWithin({componentType:pn.a.PaneRoot})}isFocusWithinAny(e){const t=this.getCurrentlyFocused(),n=Object(mn.a)({componentType:e,id:"",renderContextType:this.componentTreeId.renderContextType});return t.some(e=>e.getId().startsWith(n))}isFocusOn(e){const t=this.viewForest.getDescendantById(Object(mn.d)(e));return!!t&&t.getFocusState()===a.b.FocusOn}isFocusWithin(e){const t=this.viewForest.getDescendantById(Object(mn.d)(e));return!!t&&t.getFocusState()===a.b.FocusWithin}isFocusOnOrWithin(e){const t=this.viewForest.getDescendantById(Object(mn.d)(e));return!!t&&(t.getFocusState()===a.b.FocusOn||t.getFocusState()===a.b.FocusWithin)}getCurrentlyFocused(){const e=[];for(const t of this.getViewTrees()){const n=t.getRoot();if(!n)continue;const r=n.getIterator();let o;for(;!(o=r.next()).done;)o.value.getFocusState()!==a.b.Unfocused&&e.push(o.value)}return e}setViewTreeRootHelper(e,t){this.getViewForest().getOrCreateViewTreeById(t).setRoot(e)}updateIdForViewTree(e,t){this.getViewForest().updateIdForViewTree(e,t)}onKeyDownTabHandlerHelper(e,t){return Object(a.r)(this.getViewForest().getOrCreateViewTreeById(e),t)}}function or(e={extensions:{}},t=Yt.a){switch(t.type){case"ADD_CONTENT_EXTENSION":return function(e,t){Object(i.i)().assertConditionTag(void 0===e[t.payload.extension.provider.scope.renderMode],"Attempting to register extension on surface where extension is already registered. Overwriting previous registration.",594834317);const n=t.payload.extension;return Object.assign(Object.assign({},e),{extensions:Object.assign(Object.assign({},e.extensions),{[t.payload.extension.provider.scope.renderMode]:{controller:n,priority:n.priority}})})}(e,t);case"REMOVE_CONTENT_EXTENSION":return function(e,t){const n=Object.assign({},e.extensions);for(const e of t.payload.renderModes)delete n[e];return Object.assign(Object.assign({},e),{extensions:n})}(e,t);case"UPDATE_EXTENSION_PRIORITY":return function(e,t){const n=Object.assign({},e.extensions);for(const e in t.payload.updates)n[e]&&(n[e]=Object.assign(Object.assign({},n[e]),{priority:t.payload.updates[e]}));return Object.assign(Object.assign({},e),{extensions:n})}(e,t);default:return e}}function ir(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function ar(e){return!!e&&!!e[Yr]}function sr(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===Jr}(e)||Array.isArray(e)||!!e[$r]||!!e.constructor[$r]||fr(e)||mr(e))}function cr(e,t,n){void 0===n&&(n=!1),0===dr(e)?(n?Object.keys:Qr)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function dr(e){var t=e[Yr];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:fr(e)?2:mr(e)?3:0}function lr(e,t){return 2===dr(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function ur(e,t){return 2===dr(e)?e.get(t):e[t]}function pr(e,t,n){var r=dr(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function hr(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function fr(e){return zr&&e instanceof Map}function mr(e){return Kr&&e instanceof Set}function gr(e){return e.o||e.t}function br(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Xr(e);delete t[Yr];for(var n=Qr(t),r=0;r<n.length;r++){var o=n[r],i=t[o];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[o]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function Cr(e,t){return void 0===t&&(t=!1),vr(e)||ar(e)||!sr(e)||(dr(e)>1&&(e.set=e.add=e.clear=e.delete=yr),Object.freeze(e),t&&cr(e,(function(e,t){return Cr(t,!0)}),!0)),e}function yr(){ir(2)}function vr(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function Tr(e){var t=Zr[e];return t||ir(18,e),t}function Sr(e,t){Zr[e]||(Zr[e]=t)}function Ir(){return Vr}function Or(e,t){t&&(Tr("Patches"),e.u=[],e.s=[],e.v=t)}function Er(e){Pr(e),e.p.forEach(Rr),e.p=null}function Pr(e){e===Vr&&(Vr=e.l)}function kr(e){return Vr={p:[],l:Vr,h:e,m:!0,_:0}}function Rr(e){var t=e[Yr];0===t.i||1===t.i?t.j():t.O=!0}function xr(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.g||Tr("ES5").S(t,e,r),r?(n[Yr].P&&(Er(t),ir(4)),sr(e)&&(e=Dr(t,e),t.l||Ar(t,e)),t.u&&Tr("Patches").M(n[Yr].t,e,t.u,t.s)):e=Dr(t,n,[]),Er(t),t.u&&t.v(t.u,t.s),e!==qr?e:void 0}function Dr(e,t,n){if(vr(t))return t;var r=t[Yr];if(!r)return cr(t,(function(o,i){return wr(e,r,t,o,i,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return Ar(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var o=4===r.i||5===r.i?r.o=br(r.k):r.o;cr(3===r.i?new Set(o):o,(function(t,i){return wr(e,r,o,t,i,n)})),Ar(e,o,!1),n&&e.u&&Tr("Patches").R(r,n,e.u,e.s)}return r.o}function wr(e,t,n,r,o,i){if(ar(o)){var a=Dr(e,o,i&&t&&3!==t.i&&!lr(t.D,r)?i.concat(r):void 0);if(pr(n,r,a),!ar(a))return;e.m=!1}if(sr(o)&&!vr(o)){if(!e.h.F&&e._<1)return;Dr(e,o),t&&t.A.l||Ar(e,o)}}function Ar(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&Cr(t,n)}function jr(e,t){var n=e[Yr];return(n?gr(n):e)[t]}function _r(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function Fr(e){e.P||(e.P=!0,e.l&&Fr(e.l))}function Mr(e){e.o||(e.o=br(e.t))}function Nr(e,t,n){var r=fr(t)?Tr("MapSet").N(t,n):mr(t)?Tr("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:Ir(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},o=r,i=eo;n&&(o=[r],i=to);var a=Proxy.revocable(o,i),s=a.revoke,c=a.proxy;return r.k=c,r.j=s,c}(t,n):Tr("ES5").J(t,n);return(n?n.A:Ir()).p.push(r),r}function Lr(e){return ar(e)||ir(22,e),function e(t){if(!sr(t))return t;var n,r=t[Yr],o=dr(t);if(r){if(!r.P&&(r.i<4||!Tr("ES5").K(r)))return r.t;r.I=!0,n=Br(t,o),r.I=!1}else n=Br(t,o);return cr(n,(function(t,o){r&&ur(r.t,t)===o||pr(n,t,e(o))})),3===o?new Set(n):n}(e)}function Br(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return br(e)}function Hr(){function e(e,t){var n=o[e];return n?n.enumerable=t:o[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[Yr];return eo.get(t,e)},set:function(t){var n=this[Yr];eo.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var o=e[t][Yr];if(!o.P)switch(o.i){case 5:r(o)&&Fr(o);break;case 4:n(o)&&Fr(o)}}}function n(e){for(var t=e.t,n=e.k,r=Qr(n),o=r.length-1;o>=0;o--){var i=r[o];if(i!==Yr){var a=t[i];if(void 0===a&&!lr(t,i))return!0;var s=n[i],c=s&&s[Yr];if(c?c.t!==a:!hr(s,a))return!0}}var d=!!t[Yr];return r.length!==Qr(t).length+(d?0:1)}function r(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);if(n&&!n.get)return!0;for(var r=0;r<t.length;r++)if(!t.hasOwnProperty(r))return!0;return!1}var o={};Sr("ES5",{J:function(t,n){var r=Array.isArray(t),o=function(t,n){if(t){for(var r=Array(n.length),o=0;o<n.length;o++)Object.defineProperty(r,""+o,e(o,!0));return r}var i=Xr(n);delete i[Yr];for(var a=Qr(i),s=0;s<a.length;s++){var c=a[s];i[c]=e(c,t||!!i[c].enumerable)}return Object.create(Object.getPrototypeOf(n),i)}(r,t),i={i:r?5:4,A:n?n.A:Ir(),P:!1,I:!1,D:{},l:n,t:t,k:o,o:null,O:!1,C:!1};return Object.defineProperty(o,Yr,{value:i,writable:!0}),o},S:function(e,n,o){o?ar(n)&&n[Yr].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[Yr];if(n){var o=n.t,i=n.k,a=n.D,s=n.i;if(4===s)cr(i,(function(t){t!==Yr&&(void 0!==o[t]||lr(o,t)?a[t]||e(i[t]):(a[t]=!0,Fr(n)))})),cr(o,(function(e){void 0!==i[e]||lr(i,e)||(a[e]=!1,Fr(n))}));else if(5===s){if(r(n)&&(Fr(n),a.length=!0),i.length<o.length)for(var c=i.length;c<o.length;c++)a[c]=!1;else for(var d=o.length;d<i.length;d++)a[d]=!0;for(var l=Math.min(i.length,o.length),u=0;u<l;u++)i.hasOwnProperty(u)||(a[u]=!0),void 0===a[u]&&e(i[u])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):r(e)}})}var Ur,Vr,Wr="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),zr="undefined"!=typeof Map,Kr="undefined"!=typeof Set,Gr="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,qr=Wr?Symbol.for("immer-nothing"):((Ur={})["immer-nothing"]=!0,Ur),$r=Wr?Symbol.for("immer-draftable"):"__$immer_draftable",Yr=Wr?Symbol.for("immer-state"):"__$immer_state",Jr=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),Qr="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Xr=Object.getOwnPropertyDescriptors||function(e){var t={};return Qr(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},Zr={},eo={get:function(e,t){if(t===Yr)return e;var n=gr(e);if(!lr(n,t))return function(e,t,n){var r,o=_r(t,n);return o?"value"in o?o.value:null===(r=o.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!sr(r)?r:r===jr(e.t,t)?(Mr(e),e.o[t]=Nr(e.A.h,r,e)):r},has:function(e,t){return t in gr(e)},ownKeys:function(e){return Reflect.ownKeys(gr(e))},set:function(e,t,n){var r=_r(gr(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var o=jr(gr(e),t),i=null==o?void 0:o[Yr];if(i&&i.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(hr(n,o)&&(void 0!==n||lr(e.t,t)))return!0;Mr(e),Fr(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==jr(e.t,t)||t in e.t?(e.D[t]=!1,Mr(e),Fr(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=gr(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){ir(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){ir(12)}},to={};cr(eo,(function(e,t){to[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),to.deleteProperty=function(e,t){return to.set.call(this,e,t,void 0)},to.set=function(e,t,n){return eo.set.call(this,e[0],t,n,e[0])};var no=new(function(){function e(e){var t=this;this.g=Gr,this.F=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var o=n;n=e;var i=t;return function(e){var t=this;void 0===e&&(e=o);for(var r=arguments.length,a=Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return i.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(a))}))}}var a;if("function"!=typeof n&&ir(6),void 0!==r&&"function"!=typeof r&&ir(7),sr(e)){var s=kr(t),c=Nr(t,e,void 0),d=!0;try{a=n(c),d=!1}finally{d?Er(s):Pr(s)}return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(e){return Or(s,r),xr(e,s)}),(function(e){throw Er(s),e})):(Or(s,r),xr(a,s))}if(!e||"object"!=typeof e){if(void 0===(a=n(e))&&(a=e),a===qr&&(a=void 0),t.F&&Cr(a,!0),r){var l=[],u=[];Tr("Patches").M(e,a,l,u),r(l,u)}return a}ir(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(o))}))};var r,o,i=t.produce(e,n,(function(e,t){r=e,o=t}));return"undefined"!=typeof Promise&&i instanceof Promise?i.then((function(e){return[e,r,o]})):[i,r,o]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){sr(e)||ir(8),ar(e)&&(e=Lr(e));var t=kr(this),n=Nr(this,e,void 0);return n[Yr].C=!0,Pr(t),n},t.finishDraft=function(e,t){var n=(e&&e[Yr]).A;return Or(n,t),xr(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!Gr&&ir(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var o=Tr("Patches").$;return ar(e)?o(e,t):this.produce(e,(function(e){return o(e,t)}))},e}()),ro=no.produce,oo=(no.produceWithPatches.bind(no),no.setAutoFreeze.bind(no),no.setUseProxies.bind(no),no.applyPatches.bind(no),no.createDraft.bind(no),no.finishDraft.bind(no),ro);function io(e=so(),t=Yt.a){return ao(e,n=>{switch(t.type){case"LOAD_DEFAULT_FILTER":return void function(e,t){co(e,t.payload.filteredRange,!0)&&(e.defaultFilterId=t.payload.filteredRange.id)}(n,t);case"LOAD_FILTER":return void function(e,t){Object(i.i)().assertConditionTag(!!e.defaultFilterId,"Default filter should be loaded before new filters are loaded",528779299),co(e,t.payload.filteredRange,t.payload.shouldSetActive)}(n,t);case"SET_FILTERING_CAPABILITIES":return void function(e,t){e.filteringCapabilities=t.payload.capabilities}(n,t);case"UPDATE_FILTER_RANGE":return void function(e,t){if(Object(i.i)().assertConditionTag(t.payload.filterId.length>0,"FilterId must not be empty string",529138905),0===t.payload.changes.length||!t.payload.filterId)return;const n=e.filteredRanges[t.payload.filterId];if(!n)return void Object(i.i)().assertConditionTag(!1,"Processing update for a filter that is not found?",529138910);t.payload.changes.forEach(r=>{switch(r.type){case"FilterUpdate":if(t.payload.filterId===e.defaultFilterId){Object(i.i)().assertConditionTag(!1,"Should not attempt to update the default filter",528532106);break}Object(i.i)().assertConditionTag(n.canUpdateFilter,"Should not get into FilterUpdate if canUpdateFilter is false",528749965),n.filter=r.updatedFilter;break;case"Insert":if(r.index<0||r.index>n.order.length){Object(i.i)().assertConditionTag(!1,"Insert index out of bounds?",529138908);break}n.order=[...n.order.slice(0,r.index),r.content,...n.order.slice(r.index)];break;case"Reload":n.order=r.fullContent;break;case"Remove":if(r.index<0||r.index>=n.order.length){Object(i.i)().assertConditionTag(!1,"Processing Remove with index out of bounds?",529138911);break}n.order.splice(r.index,1);break;case"Teardown":t.payload.filterId===e.defaultFilterId&&(Object(i.i)().assertConditionTag(!1,"Is tearing down default filter expected?",528779328),e.defaultFilterId=void 0),t.payload.filterId===e.activeFilterId&&(Object(i.i)().assertConditionTag(!!e.defaultFilterId,"Active was removed, but no default to fallback on",528779329),e.activeFilterId=e.defaultFilterId),delete e.filteredRanges[t.payload.filterId]}})}(n,t);default:return e}})}const ao=(e,t)=>(Hr(),oo(e,t));function so(){return{filteredRanges:{},filteringCapabilities:void 0,activeFilterId:"",defaultFilterId:""}}function co(e,t,n){return void 0!==e.filteredRanges[t.id]?(Object(i.i)().assertConditionTag(!1,"Should not load a filter with the same id as a previously loaded filter",528527825),!1):(n&&(e.activeFilterId=t.id),e.filteredRanges[t.id]={filter:t.getFilter(),order:t.getOrder(),canUpdateFilter:e.defaultFilterId!==t.id&&t.canBeUpdated()},!0)}function lo(e){return Object.assign(Object.assign({},ge.X()?{commentThreadIds:[],cardPostIds:{},postData:{}}:{commentData:[]}),{cardViewState:{},postViewState:{},selectedComment:void 0,expandedComments:[],pendingCommentLoad:void 0,contextState:{nextPopulatedContextDetails:In.a.Unknown,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:0},highlightedCommentId:void 0,topVisibleThreadId:void 0,createdCommentLie:void 0,selectedThreadIdBeforeCommentSession:void 0,personaIconPropertiesMap:{},draftState:Object(ve.h)(),modelCapabilities:Object(ye.s)(),localizationDetails:e,suggestionsDetails:void 0,tasks:{},historyRecordViewState:{}})}function uo(e,t,n,r){return function(e,t,n,r){return{paneState:{viewContainer:e,componentTree:new rr(Object(Gn.a)(e.containerType),r),visibilityState:t?Pn.a.Visible:Pn.a.Closed,initializationStatus:pe.a.NotInitialized,viewContainerDisplayConfiguration:void 0},contentExtensions:{extensions:{}},commentState:lo(n),filterState:{filteredRanges:{},filteringCapabilities:void 0,activeFilterId:"",defaultFilterId:""}}}(e,t,n,r)}const po={isRightToLeft:!1,dataCulture:"",uiCulture:""};function ho(e=lo(po),t=Hn.a){const n=function(e,t){switch(t.type){case"HIGHLIGHT_COMMENT":return function(e,t){const n=ye.P(t.payload.commentId);if(n===e.highlightedCommentId)return e;return Object.assign(Object.assign({},e),{highlightedCommentId:n})}(e,t);case"APPLY_COMMENT_CHANGES":return function(e,t){var n,o;if(Object(tn.e)(e))return e;if(!t.payload.changes.length)return e;const a={commentData:[...e.commentData],cardViewState:Object.assign({},e.cardViewState),postViewState:Object.assign({},e.postViewState),highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,selectedComment:e.selectedComment,expandedComments:e.expandedComments,selectedThreadIdBeforeCommentSession:e.selectedThreadIdBeforeCommentSession,draftState:e.draftState};let{createdCommentLie:s}=e;const c=!!ye.G(e.draftState,!0);let d,l=null==s?void 0:s.index;for(d of t.payload.changes)if(d.type===mt.b.Load&&(d=void 0!==a.postViewState[d.model.commentId]?Object.assign(Object.assign({},d),{type:mt.b.Modify}):Object.assign(Object.assign({},d),{type:mt.b.Insert})),d.type===mt.b.Insert){const t=d.model.parentId;if(t&&(!ge.O()||a.cardViewState[t]?a.cardViewState[t]=Object.assign(Object.assign({},a.cardViewState[t]),{pending:Qt.a.None}):Object(i.i)().assertConditionTag(!1,`Inserting orphaned reply without root post? CommentId: ${d.model.commentId} | ParentId: ${t}`,528021316)),a.commentData.splice(d.index,0,d.model),d.tempId){if(!t){const e={};e[d.model.commentId]=ye.j(d.tempId),a.cardViewState=Object.assign(Object.assign({},ye.T(a.cardViewState,[d.tempId])),e)}a.postViewState=Object.assign(Object.assign({},ye.U(a.postViewState,[d.tempId])),ye.y([d.model],a.expandedComments,e.localizationDetails)),a.draftState.committedLieId===d.tempId&&(a.draftState=Object.assign(Object.assign({},a.draftState),{committedLieId:void 0}),l=void 0),a.selectedComment&&a.selectedComment.selectedCardId===d.tempId&&(a.selectedComment=ye.n(Object(rt.b)(d.model)),d.model.parentId||(a.expandedComments=ye.a(a.expandedComments,a.selectedComment,a.draftState)))}else{if(Object(i.i)().assertConditionTag(!a.postViewState[d.model.commentId],"Received insert for existing comment "+d.model.commentId,594122589),!ge.O()||!t){const e={};e[d.model.commentId]=ye.j(void 0),a.cardViewState=Object.assign(Object.assign({},a.cardViewState),e)}a.postViewState=Object.assign(Object.assign({},a.postViewState),ye.y([d.model],a.expandedComments,e.localizationDetails))}c&&void 0!==l&&d.index<=l&&l++}else if(d.type===mt.b.Modify){const t=a.commentData[d.index];if(t.commentId===d.model.commentId){a.commentData[d.index]=d.model;const n=Object(rt.b)(d.model);ge.O()&&!a.cardViewState[n]?(Object(i.i)().assertConditionTag(!1,`Received Modify change without existing card state? Creating default. CommentId: ${d.model.commentId} | ParentId: ${n}`,527962186),a.cardViewState[n]=ye.j(void 0)):a.cardViewState[n]=Object.assign(Object.assign({},a.cardViewState[n]),{pending:Qt.a.None,loadState:{state:tr.a.Loaded}});const r=t.displayDate===d.model.displayDate&&t.date===d.model.date?a.postViewState[d.model.commentId].displayDate:ye.o(d.model.date,d.model.displayDate,e.localizationDetails.dataCulture);if(a.postViewState=Object.assign(Object.assign({},a.postViewState),{[d.model.commentId]:Object.assign(Object.assign({},a.postViewState[d.model.commentId]),{pending:nr.a.None,displayDate:r})}),d.model.commentFlags&Rn.a.Resolved&&!(t.commentFlags&Rn.a.Resolved)){const e=a.draftState;a.selectedComment&&a.selectedComment.selectedCardId===d.model.commentId&&(a.selectedComment=ye.n(a.selectedComment.selectedCardId)),a.draftState=ye.S(a.draftState,d.model.commentId,a.commentData),Object(Yn.b)(e,a.draftState,1,2,539297114),a.expandedComments=ye.W(d.model.commentId,a.expandedComments,a.draftState,a.selectedComment)}}else Object(i.i)().assertConditionTag(!1,"Found changeIndex mismatch",593762526),Object(r.i)("changeIndex did not match comment for "+d.model.commentId)}else if(d.type===mt.b.Delete){if(a.commentData[d.index].commentId===d.model.commentId&&a.commentData.splice(d.index,1),a.highlightedCommentId===d.model.commentId&&(a.highlightedCommentId=void 0),a.topVisibleThreadId===d.model.commentId&&(a.topVisibleThreadId=void 0),a.cardViewState=Object.assign({},ye.T(a.cardViewState,[d.model.commentId])),a.postViewState=Object.assign({},ye.U(a.postViewState,[d.model.commentId])),d.model.commentId===a.selectedThreadIdBeforeCommentSession){let e=d.index;a.commentData.length?(e>=a.commentData.length&&(e=a.commentData.length-1),a.selectedThreadIdBeforeCommentSession=Object(rt.b)(a.commentData[e])):a.selectedThreadIdBeforeCommentSession=void 0}c&&void 0!==l&&d.index<l&&l--}c&&(void 0===l?s=void 0:s&&l!==s.index&&(s=Object.assign(Object.assign({},s),{index:l})));a.draftState=ye.db(a.draftState,e.cardViewState,a.cardViewState,e.postViewState,a.postViewState,2),a.selectedComment&&!Object(ve.l)(a.draftState)&&(a.cardViewState[a.selectedComment.selectedCardId]?Object(Xt.j)(a.selectedComment.selectionDetails)&&!a.postViewState[a.selectedComment.selectionDetails.selectedPostId]&&(a.selectedComment=ye.n(a.selectedComment.selectedCardId)):a.selectedComment=void 0);const u=Qn(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return Object.assign(Object.assign({},e),{createdCommentLie:s,draftState:a.draftState,selectedComment:a.selectedComment,expandedComments:ye.X(a.expandedComments,a.cardViewState,a.draftState),commentData:a.commentData,cardViewState:a.cardViewState,postViewState:a.postViewState,highlightedCommentId:a.highlightedCommentId,topVisibleThreadId:a.topVisibleThreadId,selectedThreadIdBeforeCommentSession:a.selectedThreadIdBeforeCommentSession,tasks:null!==(n=null==u?void 0:u.updatedTasks)&&void 0!==n?n:e.tasks,historyRecordViewState:null!==(o=null==u?void 0:u.updatedHistoryRecordViewState)&&void 0!==o?o:e.historyRecordViewState})}(e,t);case"LOAD_COMMENT":return function(e,t){var n,r;const o=ye.l(t.payload.commentData,e),i=e.modelCapabilities.virtualized,{pendingCommentLoad:a,selectedComment:s,expandedComments:c}=ye.Q(e,o,i);let d={};d=ye.k(t.payload.commentData,i?tr.a.Placeholder:tr.a.Loaded);const l=function(e,t){if(!e||!ge.b())return;const n={},r={};for(const o of e){if(ge.q())Xn({},r,o,t);else for(const e of o.history)for(const n of e.records)r[kn.a(o.id,n.recordId)]=Object(ye.t)(Object(ye.o)(n.time,void 0,t.dataCulture));n[o.commentId]=o}return{updatedTasks:n,updatedHistoryRecordViewState:r}}(t.payload.tasks,e.localizationDetails);return Object.assign(Object.assign(Object.assign({},e),o),{pendingCommentLoad:a,selectedComment:s,expandedComments:c,cardViewState:Object.assign(Object.assign({},e.cardViewState),d),postViewState:Object.assign(Object.assign({},e.postViewState),ye.y(t.payload.commentData,c,e.localizationDetails)),tasks:null!==(n=null==l?void 0:l.updatedTasks)&&void 0!==n?n:e.tasks,historyRecordViewState:null!==(r=null==l?void 0:l.updatedHistoryRecordViewState)&&void 0!==r?r:e.historyRecordViewState})}(e,t);case"VIRTUALIZE_COMMENTS":return function(e,t){if(!e.modelCapabilities.virtualized)throw new u.a("virtualizeCommentsReducer requires virtualization",589103643,-2130957500);const n=Object(qn.c)(t.payload.threadInfo.map(e=>e.threadId)),r=ye.l(n,e),{pendingCommentLoad:o,selectedComment:i,expandedComments:a}=ye.Q(e,r,!0);return Object.assign(Object.assign(Object.assign({},e),r),{pendingCommentLoad:o,selectedComment:i,expandedComments:a,cardViewState:Object.assign(Object.assign({},e.cardViewState),ye.M(t.payload.threadInfo)),postViewState:Object.assign(Object.assign({},e.postViewState),ye.y(n,a,e.localizationDetails))})}(e,t);case"CANCEL_COMMENT_CREATE_THREAD":return function(e,t){var n;if(!Object(ve.c)(e.draftState))return e;const r=ye.G(e.draftState);if(!r)return e;const o=ye.T(e.cardViewState,[r]),i=ye.U(e.postViewState,[r]);let a,s=!1;(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)!==r?a=e.selectedComment:e.selectedThreadIdBeforeCommentSession&&(a={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}},s=!0);const c=ye.V(e.draftState,r);return Object.assign(Object.assign({},e),{createdCommentLie:void 0,selectedComment:a,expandedComments:a&&s?ye.a(e.expandedComments,a,c):ye.R(e.expandedComments,a,c),cardViewState:o,postViewState:i,selectedThreadIdBeforeCommentSession:void 0,draftState:c})}(e);case"CANCEL_COMMENT_POST_EDIT":return function(e,t){const n=ye.A(e,t.payload.commentId),r=ye.ab(e.draftState,t.payload.commentId);return Object.assign(Object.assign({},e),{selectedComment:n,expandedComments:ye.R(e.expandedComments,n,r),selectedThreadIdBeforeCommentSession:void 0,draftState:r})}(e,t);case"CANCEL_COMMENT_REPLY":return function(e,t){const n=ye.V(e.draftState,t.payload.commentId);return Object.assign(Object.assign({},e),{expandedComments:ye.R(e.expandedComments,e.selectedComment,n),selectedThreadIdBeforeCommentSession:void 0,draftState:n})}(e,t);case"COLLAPSE_CARD":return function(e,t){const n=ye.K(e.draftState);if((null==n?void 0:n.threadId)===t.payload.cardId)return e;const r=ye.D(t.payload.cardId,e.selectedComment,e.draftState);return Object.assign(Object.assign({},e),{selectedComment:r,expandedComments:ye.W(t.payload.cardId,e.expandedComments,e.draftState,r)})}(e,t);case"SELECT_COMMENT":return function(e,t){const n=e.selectedComment;if(!ye.bb(e.draftState,n,t))return e;if(!t.payload.selectedCard)throw new u.a(p.f,589103644,-2130957536);const r=ye.fb(e.selectedComment,t),o=Object(Yt.R)(t.payload.selectType)?ye.a(e.expandedComments,r,e.draftState):ye.R(e.expandedComments,r,e.draftState);return Object.assign(Object.assign({},e),{selectedComment:r,expandedComments:o})}(e,t);case"REQUEST_THREAD_RESOLVE":return function(e,t){return Object.assign(Object.assign({},e),{cardViewState:Object.assign(Object.assign({},e.cardViewState),{[t.payload.commentId]:Object.assign(Object.assign({},e.cardViewState[t.payload.commentId]),{pending:Qt.a.Card,loadState:{state:tr.a.Loaded}})}),selectedComment:ye.B(e.selectedComment,t)})}(e,t);case"RELOAD_COMMENTS":return function(e,t){var n,r,o;if(Object(tn.e)(e))return e;const a={},s={};let c=e.selectedComment,d=void 0,l=e.expandedComments;const u=c&&Object(Xt.j)(c.selectionDetails);let p=!1,h=!1,f=!1,m=e.selectedThreadIdBeforeCommentSession,g=e.draftState;const b=e.modelCapabilities.virtualized,C=null===(n=ye.K(g))||void 0===n?void 0:n.threadId,y={};e.commentData.forEach(e=>{y[e.commentId]=e});let v=!1,T=!1;t.payload.comments.forEach(n=>{if(n.commentId===e.highlightedCommentId&&(v=!0),n.commentId===e.topVisibleThreadId&&(T=!0),c&&(n.commentId===c.selectedCardId&&(h=!0),c.selectedCardId===Object(rt.b)(n)&&Object(Xt.j)(c.selectionDetails)&&c.selectionDetails.selectedPostId===n.commentId&&(p=!0)),n.commentId in y){if(""===n.parentId){e.cardViewState[n.commentId]&&Object(i.i)().assertConditionTag(e.cardViewState[n.commentId].pending!==Qt.a.Delete,"Card pending delete remained after a reload.",593762527);const t=e.cardViewState[n.commentId];if(ge.O())if(t)if(t.pending!==Qt.a.None||b){const e=t.loadState;s[n.commentId]=Object.assign(Object.assign({},t),{pending:Qt.a.None,loadState:e.state===tr.a.Placeholder?e:{state:b?tr.a.NeedsReload:tr.a.Loaded}})}else s[n.commentId]=t;else Object(i.i)().assertConditionTag(!1,"Card state missing for existing card on reload? Creating default. Id: "+n.commentId,527958879),s[n.commentId]=ye.j(void 0,b?tr.a.NeedsReload:tr.a.Loaded);else if(!t||t.pending!==Qt.a.None||b){const e=null==t?void 0:t.loadState;s[n.commentId]=Object.assign(Object.assign({},t),{pending:Qt.a.None,loadState:e&&e.state===tr.a.Placeholder?{state:tr.a.Placeholder,initialItemCount:e.initialItemCount}:{state:tr.a.NeedsReload}})}else s[n.commentId]=t}if(Object(i.i)().assertConditionTag(!e.postViewState[n.commentId]||e.postViewState[n.commentId].pending!==nr.a.Delete,"Post pending delete remained after a reload.",593762528),ge.O()?e.postViewState[n.commentId]?e.postViewState[n.commentId].pending!==nr.a.None?a[n.commentId]=Object.assign(Object.assign({},e.postViewState[n.commentId]),{pending:nr.a.None}):a[n.commentId]=e.postViewState[n.commentId]:a[n.commentId]=ye.m(void 0):e.postViewState[n.commentId]&&e.postViewState[n.commentId].pending===nr.a.None?a[n.commentId]=e.postViewState[n.commentId]:a[n.commentId]=Object.assign(Object.assign({},e.postViewState[n.commentId]),{pending:nr.a.None}),n.commentFlags&Rn.a.Resolved&&(!y[n.commentId]||!(y[n.commentId].commentFlags&Rn.a.Resolved))){if(c&&c.selectedCardId===n.commentId&&(c=ye.n(c.selectedCardId)),n.commentId===C){const e=g;g=ye.S(g,n.commentId,t.payload.comments),Object(Yn.b)(e,g,1,1,539297115)}l=ye.W(n.commentId,l,g,c)}m&&m===n.commentId&&(f=!0)}else{if(""===n.parentId){const e=n.commentId,t=b?{state:tr.a.Placeholder,initialItemCount:1}:{state:tr.a.Loaded};s[n.commentId]=ye.v(e,t)}a[n.commentId]=ye.m(!ge.X()&&l.includes(Object(rt.b)(n))?ye.o(n.date,n.displayDate,e.localizationDetails.dataCulture):n.displayDate)}}),d=ye.b(e.createdCommentLie,t.payload.comments,e.cardViewState,e.draftState),g=Object.assign(Object.assign({},g),{committedLieId:void 0});const S=ye.G(g);S&&(c&&S===c.selectedCardId&&(h=!0),s[S]=e.cardViewState[S],a[S]=e.postViewState[S]);g=ye.db(g,e.cardViewState,s,e.postViewState,a,1),Object(ve.l)(g)||(h?u&&!p&&c&&!b&&(c={selectedCardId:c.selectedCardId,selectionDetails:{lowFidelityWarningType:void 0}}):c=void 0);if(!f&&m){let n=e.commentData.findIndex(e=>e.commentId===m);if(n<0&&(Object(i.i)().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in old commentData. Falling back to first comment",593762529),n=0),t.payload.comments.length){n>=t.payload.comments.length&&(n=t.payload.comments.length-1);const e=t.payload.comments[n];m=Object(rt.b)(e)}else m=void 0}const I=function(e,t,n,r){var o;if(!ge.b())return;if(!n.tasks)return;let i=!1,a=!1;const s={},c={},d=new Set,l=Object.keys(e);n.comments.forEach(e=>{""===e.parentId&&d.add(e.commentId)});for(const e of l)if(!d.has(e)){i=!0;break}if(l.length!==(null===(o=n.tasks)||void 0===o?void 0:o.length)&&(i=!0),ge.q()){for(const e of n.tasks)i=Xn(t,c,e,r)||i,s[e.commentId]=e;if(!i)return}else{for(const e of n.tasks){0===e.history.length&&(a=!0);for(const n of e.history)for(const o of n.records){const n=kn.a(e.id,o.recordId);t[n]?c[n]=t[n]:(i=!0,c[n]=Object(ye.t)(Object(ye.o)(o.time,void 0,r.dataCulture)))}s[e.commentId]=e}if(!i&&!a)return}return{updatedTasks:s,updatedHistoryRecordViewState:c}}(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return Object.assign(Object.assign({},e),{draftState:g,commentData:[...t.payload.comments],cardViewState:s,postViewState:a,selectedComment:c,expandedComments:ye.X(l,s,g),pendingCommentLoad:void 0,highlightedCommentId:v?e.highlightedCommentId:void 0,topVisibleThreadId:T?e.topVisibleThreadId:void 0,createdCommentLie:d,selectedThreadIdBeforeCommentSession:m,tasks:null!==(r=null==I?void 0:I.updatedTasks)&&void 0!==r?r:e.tasks,historyRecordViewState:null!==(o=null==I?void 0:I.updatedHistoryRecordViewState)&&void 0!==o?o:e.historyRecordViewState})}(e,t);case"REQUEST_REOPEN_THREAD":return function(e,t){const n=Object.assign(Object.assign({},e.cardViewState),{[t.payload.commentId]:Object.assign(Object.assign({},e.cardViewState[t.payload.commentId]),{pending:Qt.a.Card})});return Object.assign(Object.assign({},e),{cardViewState:n})}(e,t);case"REQUEST_DELETE_POST":return function(e,t){const n=Object.assign(Object.assign({},e.postViewState),{[t.payload.commentId]:Object.assign(Object.assign({},e.postViewState[t.payload.commentId]),{pending:nr.a.Delete})});return Object.assign(Object.assign({},e),{postViewState:n})}(e,t);case"REQUEST_DELETE_THREAD":return function(e,t){const n=Object.assign(Object.assign({},e.cardViewState),{[t.payload.commentId]:Object.assign(Object.assign({},e.cardViewState[t.payload.commentId]),{pending:Qt.a.Delete})});return Object.assign(Object.assign({},e),{cardViewState:n})}(e,t);case"DISPATCH_LOAD_THREADS":return function(e,t){const n=Object.assign({},e.cardViewState);return t.payload.threadIds.forEach(e=>{if(ge.O())if(n[e]){const t=n[e].loadState;n[e]=Object.assign(Object.assign({},n[e]),{loadState:{state:tr.a.Loading,initialItemCount:ye.N(t)?t.initialItemCount:1}})}else Object(i.i)().assertConditionTag(!1,"Loading an unexpected thread? id: "+e,528021317);else{const t=n[e].loadState;n[e]=Object.assign(Object.assign({},n[e]),{loadState:t.state===tr.a.Placeholder?{state:tr.a.Loading,initialItemCount:t.initialItemCount}:{state:tr.a.Loading}})}}),Object.assign(Object.assign({},e),{cardViewState:n})}(e,t);case"BEGIN_DRAFTING_SUCCESS":return function(e,t){if(ye.H(e.draftState))throw new u.a("Draft already active!",589103640,-2130957551);const n=e.selectedThreadIdBeforeCommentSession,o=t.payload.draftDetails;switch(o.sessionConfiguration.sessionType){case"CREATE":{const r=Object.assign(Object.assign({},ye.e(o.sessionConfiguration.draftId)),{author:o.author,anchorHintText:o.anchorHintText}),i=ye.C(Object(tn.a)(e),o),a=Object.assign(Object.assign({},e.draftState),{drafts:Object.assign(Object.assign({},e.draftState.drafts),{[o.sessionConfiguration.draftId]:{commentDraft:o,isDraftEmpty:!0,isInCurrentContext:!0,pendingState:ve.a.None,renderContextType:t.payload.draftRenderContextType,threadId:o.sessionConfiguration.draftId}}),cardIdToDraftIdMap:Object.assign(Object.assign({},e.draftState.cardIdToDraftIdMap),{[o.sessionConfiguration.draftId]:o.sessionConfiguration.draftId}),pendingDraft:void 0});return Object.assign(Object.assign({},e),{createdCommentLie:{index:o.insertIndex,newComment:r},cardViewState:Object.assign(Object.assign({},ge.H()?e.cardViewState:ye.T(e.cardViewState,[Object(Kn.t)()])),ye.p(r)),postViewState:Object.assign(Object.assign({},ge.H()?e.postViewState:ye.U(e.postViewState,[Object(Kn.t)()])),ye.q(r)),selectedComment:i,expandedComments:ye.a(e.expandedComments,i,a),selectedThreadIdBeforeCommentSession:n,draftState:a})}case"EDIT":case"REPLY":if(!Object(zn.b)(o.sessionConfiguration)&&!Object(zn.c)(o.sessionConfiguration))throw Object(i.i)().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit in beginDraftingSuccessReducer",593762523),new u.a(p.e,589103642,-2130957532);let a;a=!e.selectedComment||Object(zn.c)(o.sessionConfiguration)&&o.sessionConfiguration.threadId!==e.selectedComment.selectedCardId||Wn.e(o.sessionConfiguration)&&(!Object(Xt.j)(e.selectedComment.selectionDetails)||o.sessionConfiguration.commentId!==e.selectedComment.selectionDetails.selectedPostId)?ye.C(Object(tn.a)(e),o):Object.assign(Object.assign({},e.selectedComment),{selectionDetails:Object.assign(Object.assign({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})});let s=e.draftState.cardIdToDraftIdMap,c=e.draftState.postIdToDraftIdMap,d="",l=!1,h=!1;if(Wn.f(o.sessionConfiguration))s=Object.assign(Object.assign({},s),{[o.sessionConfiguration.threadId]:o.sessionConfiguration.draftId}),d=o.sessionConfiguration.threadId,h=!0;else if(Wn.e(o.sessionConfiguration)){const t=o.sessionConfiguration.commentId;if(c=Object.assign(Object.assign({},c),{[t]:o.sessionConfiguration.draftId}),l=!0,Object(tn.e)(e)){const n=e.postData[t],r=Object($n.b)(n.commentBody);h=0===r.length||!1,d=Object(rt.b)(n)}else e.commentData.some(e=>{if(e.commentId===t){const t=Object($n.b)(e.commentBody);return h=0===t.length||!1,d=Object(rt.b)(e),!0}return!1})}else Object(r.m)(o.sessionConfiguration);const f=Object.assign(Object.assign({},e.draftState),{drafts:Object.assign(Object.assign({},e.draftState.drafts),{[o.sessionConfiguration.draftId]:{commentDraft:o,isDraftEmpty:h,isInCurrentContext:!0,pendingState:ve.a.None,renderContextType:t.payload.draftRenderContextType,threadId:d}}),cardIdToDraftIdMap:s,postIdToDraftIdMap:c,pendingDraft:void 0});let m=e.cardViewState,g=e.postViewState;return ge.H()||(m=ye.T(e.cardViewState,[Object(Kn.t)()]),g=ye.U(e.postViewState,[Object(Kn.t)()])),Object.assign(Object.assign({},e),{selectedComment:a,expandedComments:l?ye.a(e.expandedComments,a,f):ye.R(e.expandedComments,a,f),selectedThreadIdBeforeCommentSession:n,draftState:f,cardViewState:m,postViewState:g,createdCommentLie:void 0});default:return e}}(e,t);case"BEGIN_DRAFTING_FAILURE":return function(e,t){if(void 0===e.selectedComment)return Object(i.i)().assertConditionTag(!1,"SelectedComment already undefined when failing selected comment",593762525),e;let n=void 0;"CREATE"!==t.payload.beginDraftingParams.sessionType?n=Object.assign(Object.assign({},e.selectedComment),{selectionDetails:Object.assign(Object.assign({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):e.selectedThreadIdBeforeCommentSession&&(n={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}});let r=e.cardViewState,o=e.postViewState;ge.H()||(r=ye.T(e.cardViewState,[Object(Kn.t)()]),o=ye.U(e.postViewState,[Object(Kn.t)()]));const a=Object.assign(Object.assign({},e.draftState),{pendingDraft:void 0});return Object.assign(Object.assign({},e),{selectedComment:n,expandedComments:ye.R(e.expandedComments,n,a),selectedThreadIdBeforeCommentSession:void 0,cardViewState:r,postViewState:o,createdCommentLie:void 0,draftState:a})}(e,t);case"SESSION_REQUEST_STARTED":return function(e,t){let n,r=void 0,o=e.cardViewState,a=e.postViewState;if(e.createdCommentLie)return Object(i.i)().assertConditionTag(!1,"SessionRequestStartedAndLockSelection unexpected defined comment lie in state",593764356),e;if(Wn.f(t.payload.params))n=t.payload.params.threadId;else if(Wn.e(t.payload.params)){const r=t.payload.params.commentId,o=Object(tn.b)(Object(tn.a)(e),r);if(!o)return Object(i.i)().assertConditionTag(!1,"Could not lock selection on missing comment "+r,593764357),e;n=Object(rt.b)(o)}else if(n=Object(Kn.t)(),!ge.H()){const e=ye.e(n);r={index:-1,newComment:e},o[n]&&Object(i.i)().assertConditionTag(!1,"Unexpectedly already found card view state for lie when starting session request",593764358),o=Object.assign(Object.assign({},o),ye.p(e)),a[n]&&Object(i.i)().assertConditionTag(!1,"Unexpectedly already found post view state for lie when starting session request",593764359),a=Object.assign(Object.assign({},a),ye.q(e))}let s=void 0;t.payload.captureSelectedThreadIdBeforeSession&&e.selectedComment&&(s=e.selectedComment.selectedCardId);const c=Object.assign(Object.assign({},e.draftState),{pendingDraft:t.payload.params,committedLieId:void 0}),d=ye.F(e.selectedComment,t,n),l=Object(Xt.j)(d.selectionDetails)||!ge.H()&&d.selectedCardId===Object(Kn.t)()?ye.a(e.expandedComments,d,c):e.expandedComments;return Object.assign(Object.assign({},e),{postViewState:a,cardViewState:o,selectedThreadIdBeforeCommentSession:s,selectedComment:d,expandedComments:l,draftState:c,createdCommentLie:r})}(e,t);case"COMMENT_CONTEXT_CHANGED":return function(e,t){let n,r=Object(ve.h)(),o={},a={},s=void 0,c=void 0,d=void 0;const l=ye.G(e.draftState);let u=!!e.createdCommentLie;n=t.payload.contextDetails?Object.assign(Object.assign({},er(t.payload.contextDetails)),{lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1}):{nextPopulatedContextDetails:In.a.Unknown,isReadOnly:ge.x()&&e.contextState.isReadOnly,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1};const p=t.payload.contextDrafts;if(p){const n=ye.Y(e.draftState);if(Object(ve.e)(n)>0){const d={};let h=void 0,f=void 0,m=!ge.Y();if(Object(ve.f)(n).forEach(r=>{var o,i;const a=p.find(e=>e.draftId===r);d[r]=Object.assign(Object.assign({},n.drafts[r]),{isInCurrentContext:!!a}),l===r&&(u=!!a,a&&(h=a.insertIndex,f=a.anchorHintText,ge.F()&&(null===(o=t.payload.contextDetails)||void 0===o?void 0:o.selectedCommentId)===l&&(s=ye.n(l)))),m||s||!a||d[r].threadId!==(null===(i=e.selectedComment)||void 0===i?void 0:i.selectedCardId)||(m=!0)}),r=Object.assign(Object.assign({},e.draftState),{drafts:d}),c=e.createdCommentLie,m&&(s=e.selectedComment),c&&l&&u){Object(i.i)().assertConditionTag(void 0!==h,"Index unknown for lie in latest context",587309136);const e=null!=h?h:0;e!==c.index&&(c=Object.assign(Object.assign({},c),{index:e})),void 0!==f&&f!==c.newComment.anchorHintText&&(c=Object.assign(Object.assign({},c),{newComment:Object.assign(Object.assign({},c.newComment),{anchorHintText:f})})),o=ye.w(l),a=ye.x(l),c.index>-1&&(o[l].pending=Qt.a.None,a[l].pending=nr.a.None)}}else d=null!=d?d:-1}else d=null!=d?d:4;n.isReadOnly&&(u&&(c=void 0),r=ye.Z(r),d=null!=d?d:5);return Object(Yn.b)(e.draftState,r,d,4,539297116),Object.assign(Object.assign(Object.assign({},e),Object(tn.e)(e)?{commentThreadIds:[],cardPostIds:{},postData:c&&l&&e.postData[l]?{lieId:e.postData[l]}:{}}:{commentData:[]}),{cardViewState:o,postViewState:a,selectedComment:s,expandedComments:ye.R(e.expandedComments,s,r),pendingCommentLoad:0===t.payload.numberOfComments?void 0:{numberOfComments:t.payload.numberOfComments,numberOfThreads:t.payload.numberOfThreads,selectedThreadIndex:t.payload.selectedThreadIndex},contextState:n,highlightedCommentId:void 0,topVisibleThreadId:t.payload.contextDetails?ye.P(t.payload.contextDetails.topVisibleThreadId):void 0,createdCommentLie:c,selectedThreadIdBeforeCommentSession:void 0,draftState:r,tasks:{},historyRecordViewState:{}})}(e,t);case"NEXT_POPULATED_CONTEXT_DETAILS_UPDATED":return function(e,t){return Object.assign(Object.assign({},e),{contextState:{nextPopulatedContextDetails:t.payload.nextPopulatedContextDetails,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement}})}(e,t);case"SHOW_LOW_FIDELITY_WARNING":return function(e,t){const{commentId:n,lowFidelityWarningType:r}=t.payload,o=Object(tn.b)(Object(tn.a)(e),n);if(!o)return Object(i.i)().assertConditionTag(!1,"Comment not found",593762530),e;if(Object(ve.d)(e.draftState))return Object(i.i)().assertConditionTag(!1,"Cannot show warning with pending or active session",593762531),e;let a,s=e.expandedComments;r===Xt.a.DeleteThread?a={selectedCardId:n,selectionDetails:{lowFidelityWarningType:r}}:(a={selectedCardId:Object(rt.b)(o),selectionDetails:{selectedPostId:n,lowFidelityWarningType:r}},s=ye.a(s,a,e.draftState));return Object.assign(Object.assign({},e),{selectedComment:a,expandedComments:s})}(e,t);case"CLEAR_LOW_FIDELITY_WARNING":return function(e,t){const{selectedComment:n}=e;if(!n||void 0===n.selectionDetails.lowFidelityWarningType)return e;return Object.assign(Object.assign({},e),{selectedComment:Object.assign(Object.assign({},n),{selectionDetails:{lowFidelityWarningType:void 0}})})}(e);case"CLEAR_COMMENT_SELECTION":return function(e,t){if(!ye.bb(e.draftState,e.selectedComment,t))return e;return Object.assign(Object.assign({},e),{selectedComment:void 0})}(e,t);case"CLEAR_COMMENT_HIGHLIGHT":return function(e,t){if(void 0!==t.payload.commentId&&t.payload.commentId!==e.highlightedCommentId)return e;return Object.assign(Object.assign({},e),{highlightedCommentId:void 0})}(e,t);case"TOP_VISIBLE_THREAD_CHANGED":return function(e,t){return Object.assign(Object.assign({},e),{topVisibleThreadId:t.payload.threadId})}(e,t);case"UPDATE_CONTEXT_DETAILS":return function(e,t){let n=!1;const r=Object.assign({},e.contextState);let o=e.createdCommentLie,i=e.draftState,a=void 0;void 0!==t.payload.contextState.commentThreadCounts&&(n=!0,r.commentThreadCounts=t.payload.contextState.commentThreadCounts);void 0!==t.payload.contextState.nextPopulatedContextDetails&&(n=!0,r.nextPopulatedContextDetails=t.payload.contextState.nextPopulatedContextDetails);void 0!==t.payload.contextState.isReadOnly&&(n=!0,r.isReadOnly=t.payload.contextState.isReadOnly,r.isReadOnly&&(i=ye.Z(e.draftState),a=null!=a?a:5,ye.G(e.draftState,!0)&&(o=void 0)));if(!n)return e;return Object(Yn.b)(e.draftState,i,a,5,539297117),Object.assign(Object.assign({},e),{draftState:i,contextState:r,createdCommentLie:o})}(e,t);case"BEGIN_PROCESSING_COMMIT":return function(e,t){if(!Object(ve.b)(e.draftState))return Object(i.i)().assertConditionTag(!1,"BeginProcessingCommitAction unexpected",593764352),e;let n=e.draftState;const r=ye.K(e.draftState);r&&(n=Object.assign(Object.assign({},n),{drafts:Object.assign(Object.assign({},n.drafts),{[r.commentDraft.sessionConfiguration.draftId]:Object.assign(Object.assign({},r),{pendingState:ve.a.Commit})})}));return Object.assign(Object.assign({},e),{draftState:n})}(e);case"COMMIT_FAILURE":return function(e,t){if(!Object(ve.i)(e.draftState))return Object(i.i)().assertConditionTag(!1,"CommitFailureAction unexpected",593764353),e;let n=e.draftState;const r=ye.K(e.draftState);r&&(n=Object.assign(Object.assign({},n),{drafts:Object.assign(Object.assign({},n.drafts),{[r.commentDraft.sessionConfiguration.draftId]:Object.assign(Object.assign({},r),{pendingState:ve.a.None,savedDraftContent:void 0!==t.payload.commitText?{editorContent:Promise.resolve(t.payload.commitText),editorCursorPosition:Promise.resolve(void 0)}:r.savedDraftContent})})}));return Object.assign(Object.assign({},e),{draftState:n})}(e,t);case"BEGIN_PROCESSING_DISCARD":return function(e){if(!Object(ve.b)(e.draftState)&&!Object(Xt.g)(e.selectedComment))return Object(i.i)().assertConditionTag(!1,"BeginProcessingDiscardAction unexpected",593764355),e;let t=e.draftState;const n=ye.K(e.draftState);n&&(t=Object.assign(Object.assign({},t),{drafts:Object.assign(Object.assign({},t.drafts),{[n.commentDraft.sessionConfiguration.draftId]:Object.assign(Object.assign({},n),{pendingState:ve.a.Discard})})}));return Object.assign(Object.assign({},e),{draftState:t})}(e);case"CANCEL_DISCARD":return function(e){if(!Object(ve.j)(e.draftState))return Object(i.i)().assertConditionTag(!1,"CancelDiscardAction unexpected",593764354),e;let t=e.draftState;const n=ye.K(e.draftState);n&&(t=Object.assign(Object.assign({},t),{drafts:Object.assign(Object.assign({},t.drafts),{[n.commentDraft.sessionConfiguration.draftId]:Object.assign(Object.assign({},n),{pendingState:ve.a.None})})}));return Object.assign(Object.assign({},e),{draftState:t})}(e);case"LOAD_PERSONA_ICON_PROPERTIES":return function(e,t){if(0===Object.keys(t.payload.personaIconPropertiesMap).length)return e;const n=Object.assign(Object.assign({},e.personaIconPropertiesMap),t.payload.personaIconPropertiesMap);return Object.assign(Object.assign({},e),{personaIconPropertiesMap:n})}(e,t);case"COMMIT_DRAFT":return function(e,t){const n=ye.H(e.draftState);if(void 0===n)return Object(i.i)().assertConditionTag(!1,"Invalid number of drafts during commit.",593762521),e;if(n.sessionConfiguration.sessionType!==t.payload.sessionType)return e;switch(t.payload.sessionType){case"CREATE":return function(e,t){if(!e.createdCommentLie)return e;const n=ye.G(e.draftState);if(!n)return e;const r=t.temporaryCommentId;if(!r)throw Object(i.i)().assertConditionTag(!1,"Expected middleware to set temporaryCommentId",593762520),new u.a(p.e,589103637,-2130957545);const o=Object.assign(Object.assign({},e.createdCommentLie.newComment),{commentId:r,commentBody:t.commentBody}),a=Object.assign(Object.assign({},e.cardViewState),ye.w(r)),s=Object.assign(Object.assign({},e.postViewState),ye.x(r)),c=e.selectedComment&&{selectedCardId:r,selectionDetails:{lowFidelityWarningType:void 0}},d=ye.V(e.draftState,n);return Object.assign(Object.assign({},e),{selectedComment:c,expandedComments:ye.a(e.expandedComments,c,d),createdCommentLie:Object.assign(Object.assign({},e.createdCommentLie),{newComment:o}),cardViewState:a,postViewState:s,selectedThreadIdBeforeCommentSession:void 0,draftState:Object.assign(Object.assign({},d),{committedLieId:r})})}(e,t.payload.data);case"REPLY":return function(e,t){if(!t.parentId)throw new u.a(p.f,589103638,-2130957536);const n=Object.assign(Object.assign({},e.cardViewState),{[t.parentId]:Object.assign(Object.assign({},e.cardViewState[t.parentId]),{pending:Qt.a.Editor,loadState:{state:tr.a.Loaded}})}),r=ye.n(t.parentId),o=ye.V(e.draftState,t.parentId);return Object.assign(Object.assign({},e),{cardViewState:n,selectedComment:r,expandedComments:ye.R(e.expandedComments,r,o),selectedThreadIdBeforeCommentSession:void 0,draftState:o})}(e,t.payload.data);case"EDIT":return function(e,t){const n=ye.A(e,t.commentId),r=Object.assign(Object.assign({},e.postViewState[t.commentId]),{pending:nr.a.Post}),o=ye.ab(e.draftState,t.commentId);return Object.assign(Object.assign({},e),{postViewState:Object.assign(Object.assign({},e.postViewState),{[t.commentId]:r}),selectedComment:n,expandedComments:ye.R(e.expandedComments,n,o),selectedThreadIdBeforeCommentSession:void 0,draftState:o})}(e,t.payload.data);default:throw new u.a("Unexpected session type for commit",589103639,-2130957532)}}(e,t);case"RESOLVE_ATMENTION_CAPABILITY":return function(e,t){return Object.assign(Object.assign({},e),{modelCapabilities:Object.assign(Object.assign({},e.modelCapabilities),{atMention:t.payload.capability})})}(e,t);case"SAVE_DRAFT":return function(e,t){const n=e.draftState.drafts;if(void 0===n[t.payload.draftId])return Object(i.i)().assertConditionTag(!Object(ve.c)(e.draftState),"saveDraftReducer called with an invalid draft id while a draft is active",587531107),e;const r=Object.assign(Object.assign({},n),{[t.payload.draftId]:Object.assign(Object.assign({},n[t.payload.draftId]),{savedDraftContent:t.payload.draftContent})});return Object.assign(Object.assign({},e),{draftState:Object.assign(Object.assign({},e.draftState),{drafts:r})})}(e,t);case"DRAFT_EMPTINESS_CHANGED":return function(e,t){const n=e.draftState.drafts;if(void 0===n[t.payload.draftId])return Object(i.i)().assertConditionTag(!1,"draftEmptinessChangedReducer called with an invalid draft id",592213846),e;const r=Object.assign(Object.assign({},n),{[t.payload.draftId]:Object.assign(Object.assign({},n[t.payload.draftId]),{isDraftEmpty:t.payload.isEmpty})});return Object.assign(Object.assign({},e),{draftState:Object.assign(Object.assign({},e.draftState),{drafts:r})})}(e,t);case"UPDATE_DRAFT_RENDER_CONTEXT":return function(e,t){const n=ye.eb(e.draftState,n=>{const r=e.draftState.drafts[n];return void 0!==t.payload.draftId&&t.payload.draftId!==n?r.renderContextType:t.payload.isClaimingLock&&r.renderContextType===an.a.None?t.actionDetail.renderContextType:t.payload.isClaimingLock||r.renderContextType!==t.actionDetail.renderContextType?r.renderContextType:an.a.None});return Object.assign(Object.assign({},e),{draftState:n})}(e,t);case"VIEW_CONTAINER_CHANGED":return function(e,t){const n=ye.eb(e.draftState,n=>{const r=e.draftState.drafts[n];return Object(cn.c)(r.renderContextType)?Object(Gn.a)(t.payload.viewContainer.containerType):r.renderContextType});return Object.assign(Object.assign({},e),{draftState:n})}(e,t);case"DISPLAY_DRAFT_WARNING":return function(e,t){var n;const r=ye.H(e.draftState);if(void 0===r)return Object(i.i)().assertConditionTag(!1,"Expected active draft to be present",593764360),e;const o=r.sessionConfiguration.draftId,a=e.draftState.drafts;if(!a[o])return Object(i.i)().assertConditionTag(!1,"Expected draft to be present on display draft warning",593764361),e;const s=a[o].draftWarningState,c=Object.assign(Object.assign({},a[o]),{draftWarningState:{warningCounter:s?s.warningCounter+1:0,type:t.payload.draftWarningType}}),d=Object.assign(Object.assign({},a),{[o]:c}),l=ge.Y()&&(Object(zn.b)(c.commentDraft.sessionConfiguration)||(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)!==c.threadId)?ye.E(c):e.selectedComment,u=Object.assign(Object.assign({},e.draftState),{drafts:d});return Object.assign(Object.assign({},e),{draftState:u,selectedComment:l,expandedComments:ye.R(e.expandedComments,l,u)})}(e,t);case"UPDATE_MODEL_STATE":return function(e,t){const n={atMention:t.payload.modelCapabilityFlags&Ge.AtMentionKnown?t.payload.modelCapabilityFlags&Ge.AtMentionEnabled?Un.b.Enabled:Un.b.Disabled:Un.b.Unknown,newThread:!!(t.payload.modelCapabilityFlags&Ge.NewThread),resolve:!!(t.payload.modelCapabilityFlags&Ge.Resolve),richTextCapabilities:t.payload.richTextCapabilityFlags,virtualized:!!(t.payload.modelCapabilityFlags&Ge.Virtualized),tasks:t.payload.modelCapabilityFlags&Ge.TasksKnown?t.payload.modelCapabilityFlags&Ge.TasksEnabled?Vn.a.Enabled:Vn.a.Disabled:Vn.a.Unknown,presentLinkToComment:!!(t.payload.modelCapabilityFlags&Ge.PresentLinkToComment),UIAAnnotationPattern:!!(t.payload.modelCapabilityFlags&Ge.UIAAnnotationPattern)};return Object.assign(Object.assign({},e),{modelCapabilities:n})}(e,t);case"UPDATE_MENTIONEES_STILL_IN_DRAFT":return function(e,t){const n=ye.H(e.draftState);if(void 0===n)return Object(i.i)().assertConditionTag(!1,"Expected active draft to be present",593764366),e;const r=n.sessionConfiguration;if(Object(zn.b)(r))return e;const o=e.draftState.drafts[r.draftId];if(!o)return Object(i.i)().assertConditionTag(!1,"Missing draft for updating mentionees",593764367),e;const a=o.currentMentionees,s={};for(const e in a)s[e]={mentionee:Object.assign({},a[e].mentionee),stillInDraft:t.payload.emailsStillInDraft.has(e)};let c=o.selectedTaskAssignee;if(c){const e=Object(Be.h)(c);s[e]&&s[e].stillInDraft||(c=void 0)}const d=Object.assign(Object.assign({},e.draftState),{drafts:Object.assign(Object.assign({},e.draftState.drafts),{[r.draftId]:Object.assign(Object.assign({},e.draftState.drafts[r.draftId]),{currentMentionees:s,selectedTaskAssignee:c})})});return Object.assign(Object.assign({},e),{draftState:d})}(e,t);case"ADD_TO_CURRENT_MENTIONEES":return function(e,t){const n=ye.H(e.draftState);if(void 0===n)return Object(i.i)().assertConditionTag(!1,"Expected active draft to be present",593764364),e;const r=n.sessionConfiguration;if(Object(zn.b)(r))return e;const o=e.draftState.drafts[r.draftId];if(!o)return Object(i.i)().assertConditionTag(!1,"Missing draft for adding mentionees",593764365),e;const a=o.currentMentionees,s=Object(Be.h)(t.payload.mentionee);if(a&&a[s])return e;const c={};for(const e in a)c[e]={mentionee:Object.assign({},a[e].mentionee),stillInDraft:a[e].stillInDraft};c[s]={mentionee:Object.assign({},t.payload.mentionee),stillInDraft:!0};let d=void 0;e.draftState.drafts[r.draftId].selectedTaskAssignees&&(d=Object.assign({},e.draftState.drafts[r.draftId].selectedTaskAssignees),Object(Be.b)(d,{[s]:{mentionee:Object.assign({},t.payload.mentionee),stillInDraft:!0}}));const l=Object.assign(Object.assign({},e.draftState),{drafts:Object.assign(Object.assign({},e.draftState.drafts),{[r.draftId]:Object.assign(Object.assign({},e.draftState.drafts[r.draftId]),{currentMentionees:c,selectedTaskAssignees:d})})});return Object.assign(Object.assign({},e),{draftState:l})}(e,t);case"TOGGLE_TASK_ASSIGNER_TYPE":return function(e){if(!ge.g())return Object(i.i)().assertConditionTag(!1,"toggleTaskAssigner should not be called unless CommentTasksWithMultiAssign is enabled.",529143576),e;const t=ye.K(e.draftState);if(void 0===t)return Object(i.i)().assertConditionTag(!1,"No draft available while initializing selected task assignees.",529143577),e;const n=t.commentDraft,r=t.selectedTaskAssignees;let o={};if(void 0===r){if(Object(zn.c)(n.sessionConfiguration)){const t=e.tasks[n.sessionConfiguration.threadId];Object(i.i)().assertConditionTag(!!t,"Task not found.",529143616),Object(Be.a)(o,t.currentState.assignees)}void 0!==t.currentMentionees&&Object(Be.b)(o,t.currentMentionees)}else o=void 0;const a=n.sessionConfiguration.draftId,s=Object.assign(Object.assign({},e.draftState),{drafts:Object.assign(Object.assign({},e.draftState.drafts),{[a]:Object.assign(Object.assign({},e.draftState.drafts[a]),{selectedTaskAssignees:o})})});return Object.assign(Object.assign({},e),{draftState:s})}(e);case"UPDATE_SELECTED_TASK_ASSIGNEE":return function(e,t){if(ge.g())return Object(i.i)().assertConditionTag(!1,"Should not update selectedTaskAssignee if CommentTasksWithMultiAssign is on.",529096909),e;const n=ye.H(e.draftState);if(void 0===n)return Object(i.i)().assertConditionTag(!1,"Expected active draft to be present",593764368),e;const r=n.sessionConfiguration;if(Object(zn.b)(r))return e;const o=r.draftId,a=e.draftState.drafts;if(!a[o])return Object(i.i)().assertConditionTag(!1,"Expected draft to be present on update selected task assignee",593764369),e;const s=Object.assign(Object.assign({},a),{[o]:Object.assign(Object.assign({},a[o]),{selectedTaskAssignee:t.payload.selectedAssignee})});return Object.assign(Object.assign({},e),{draftState:Object.assign(Object.assign({},e.draftState),{drafts:s})})}(e,t);case"UPDATE_SELECTED_TASK_ASSIGNEES":return function(e,t){var n;if(!ge.g())return Object(i.i)().assertConditionTag(!1,"Should not update selectedTaskAssignees if CommentTasksWithMultiAssign is off.",529096910),e;const r=ye.H(e.draftState);if(void 0===r)return Object(i.i)().assertConditionTag(!1,"Expected active draft to be present",529143574),e;const o=r.sessionConfiguration;if(Object(zn.b)(o))return e;const a=o.draftId,s=e.draftState.drafts;if(!s[a])return Object(i.i)().assertConditionTag(!1,"Expected draft to be present on update selected task assignees",529143575),e;const c=null!==(n=s[a].selectedTaskAssignees)&&void 0!==n?n:{},d=Object.assign({},c);Object(Be.n)(d,t.payload.selectedAssignee);const l=Object.assign(Object.assign({},s),{[a]:Object.assign(Object.assign({},s[a]),{selectedTaskAssignees:d})});return Object.assign(Object.assign({},e),{draftState:Object.assign(Object.assign({},e.draftState),{drafts:l})})}(e,t);case"POPULATE_SMART_REPLY":return function(e,t){return Object.assign(Object.assign({},e),{draftState:ye.r(e.draftState,t.payload)})}(e,t);case"SHOW_POST_ERROR_STATE":return function(e,t){const n=Object.assign(Object.assign({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!0}),r=Object.assign({},e.postViewState);return r[t.payload.commentId]=n,Object.assign(Object.assign({},e),{postViewState:r})}(e,t);case"CLEAR_POST_ERROR_STATE":return function(e,t){const n=Object.assign(Object.assign({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!1}),r=Object.assign({},e.postViewState);return r[t.payload.commentId]=n,Object.assign(Object.assign({},e),{postViewState:r})}(e,t);case"UPDATE_DRAFT_THREAD":return function(e,t){if(!e.createdCommentLie)return e;if(ye.G(e.draftState)!==t.payload.draftId)return Object(i.i)().assertConditionTag(!1,"Unexpected draft ID in updateDraftThread payload",593844429),e;if(void 0===t.payload.anchorHintText&&void 0===t.payload.insertIndex)return e;let n=e.createdCommentLie;void 0!==t.payload.insertIndex&&t.payload.insertIndex!==n.index&&(n=Object.assign(Object.assign({},n),{index:t.payload.insertIndex}));void 0!==t.payload.anchorHintText&&t.payload.anchorHintText!==n.newComment.anchorHintText&&(n=Object.assign(Object.assign({},n),{newComment:Object.assign(Object.assign({},n.newComment),{anchorHintText:t.payload.anchorHintText})}));return Object.assign(Object.assign({},e),{createdCommentLie:n})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){let n=e.draftState,r=e.selectedComment,o=e.expandedComments;if(t.payload.visibilityState!==Pn.a.Visible&&!ge.m()&&(n=ye.Y(n),e.selectedComment&&0===Object.keys(n.drafts).length&&Object.keys(e.draftState.drafts).length>0)){const t=ye.I(e.draftState);t&&(r=ye.n(t),o=ye.R(e.expandedComments,r,n))}return n=ye.eb(n,n=>{const r=e.draftState.drafts[n];return ye.cb(r.renderContextType,t.payload.visibilityState)}),Object.assign(Object.assign({},e),{selectedComment:r,expandedComments:o,draftState:n})}(e,t);case"UPDATE_SUGGESTIONS_DETAILS":return function(e,t){return Object.assign(Object.assign({},e),{suggestionsDetails:t.payload.details})}(e,t);default:return e}}(e,t);return function(e,t){var n;let r=t;const o=null===(n=r.selectedComment)||void 0===n?void 0:n.selectedCardId,i=ye.G(r.draftState);if(Object(tn.e)(r)){const e=r.expandedComments,t=r.cardPostIds,n=r.postData;let o=void 0;e.forEach(e=>{e!==i&&(o=ye.g(t[e],null!=o?o:r.postViewState,n,r.localizationDetails))}),o&&(r=Object.assign(Object.assign({},r),{postViewState:o}))}else{if(o&&o!==i&&r.expandedComments.includes(o)&&!e.expandedComments.includes(o)){const e=ye.h(o,r.postViewState,r.commentData,r.localizationDetails);e&&(r=Object.assign(Object.assign({},r),{postViewState:e}))}const t=ye.G(e.draftState);if(t&&t!==i&&r.expandedComments.includes(t)){const e=ye.h(t,r.postViewState,r.commentData,r.localizationDetails);e&&(r=Object.assign(Object.assign({},r),{postViewState:e}))}}return r}(e,n)}function fo(){Object(i.i)().assertConditionTag(!1,"Must specify initial pane state!",595918942)}function mo(e=function(){return{viewContainer:{closeView:fo,openView:fo,containerType:Z.b.FullPane,moveFocusToCanvas_donotuse:fo},componentTree:new rr(an.a.FullPane,F.a),visibilityState:Pn.a.Closed,initializationStatus:pe.a.NotInitialized,viewContainerDisplayConfiguration:void 0}}(),t=Yt.a){switch(t.type){case"VIEW_CONTAINER_CHANGED":return function(e,t){const n=e.viewContainer.containerType!==t.payload.viewContainer.containerType;return Object.assign(Object.assign({},e),{viewContainer:t.payload.viewContainer,componentTree:n?new rr(Object(Gn.a)(t.payload.viewContainer.containerType),e.componentTree.componentTreeId.contextIdentifier,e.componentTree):e.componentTree})}(e,t);case"VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED":return function(e,t){if(t.payload.displayConfiguration===e.viewContainerDisplayConfiguration)return e;return Object.assign(Object.assign({},e),{viewContainerDisplayConfiguration:t.payload.displayConfiguration})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){return Object.assign(Object.assign({},e),{initializationStatus:t.payload.visibilityState!==Pn.a.Closed||ge.p()?e.initializationStatus:pe.a.NotInitialized,visibilityState:t.payload.visibilityState})}(e,t);case"VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED":return function(e,t){const n=Object.assign(Object.assign({},e.viewContainer),{foldableLayoutState:t.payload.foldableLayoutState});return Object.assign(Object.assign({},e),{viewContainer:n})}(e,t);case"BEGIN_VIEW_INIT":return function(e){return Object.assign(Object.assign({},e),{initializationStatus:pe.a.Initializing})}(e);case"END_VIEW_INIT":return function(e){return Object.assign(Object.assign({},e),{initializationStatus:pe.a.Initialized})}(e);default:return e}}let go=void 0;function bo(e,t=Hn.a){go||(go=Object(jn.combineReducers)({paneState:mo,contentExtensions:or,commentState:ho,filterState:io}));const n=go(e,t);return n}var Co=n(68),yo=n(427);const vo=()=>({threadIdRequests:new Map,sequenceId:0});function To(e){return e&&(e.loadState.state===tr.a.Placeholder||e.loadState.state===tr.a.NeedsReload)}const So=(e,t,n=20)=>Object(yo.a)((e=>(t,n)=>{const r=Zt.b(e.getState());for(const e of n)To(r[e])&&t.threadIdRequests.set(e,t.sequenceId++);return t})(e),((e,t,n)=>r=>{const o=Array.from(r.threadIdRequests.entries()).sort(([e,t],[n,r])=>t-r),i=[],a=Zt.b(e.getState());for(let e=o.pop();e&&i.length<n;e=o.pop()){const[t]=e;r.threadIdRequests.delete(t),To(a[t])&&i.push(t)}if(i.length&&e.dispatch(Object(Yt.p)({renderContextType:an.a.None,telemetryVisitor:t,trackback:594888212},{threadIds:i})),r.threadIdRequests.size>0)return r})(e,t,n),vo,500);var Io=n(103);var Oo=n(185);function Eo(e,t,n){const r=e.getState(),o=Oo.a(r)[A.d.Isolated];return!!o&&(n(t),o.controller.triggerUpdate(),!0)}function Po(e,t,n,r){return"CREATE"===r&&Eo(e,t,n)}function ko(e,t){return 0===Zt.f(t).lastContextChangeIncrement?A.c.Disabled:e===A.d.TaskPane||e===A.d.TaskPaneItem?en.a(t)?A.c.Primary:A.c.Disabled:Zt.o(t)?A.c.Disabled:ko(A.d.TaskPane,t)!==A.c.Primary?A.c.Primary:e===A.d.Integrated?A.c.Disabled:A.c.Secondary}function Ro(e,t){const n=Oo.a(e)[t];n&&(n.controller.priority=n.priority)}var xo=n(217),Do=n(265);function wo(e){switch(e.type){case"APPLY_COMMENT_CHANGES":return{name:"ApplyCommentChangesAction",aggregationMode:i.a.OnSuccess,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"BEGIN_PROCESSING_COMMIT":return{name:"BeginProcessingCommitAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_CREATE_THREAD":return{name:"CancelCommentCreateThreadAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_POST_EDIT":return{name:"CancelCommentPostEditAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_REPLY":return{name:"CancelCommentReplyAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"CLEAR_COMMENT_SELECTION":return{name:"ClearCommentSelectionAction",aggregationMode:i.a.OnSuccess,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"COLLAPSE_CARD":return{name:"CollapseCardAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"COMMIT_DRAFT":return{name:"CommitDraftAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"DISPLAY_DRAFT_WARNING":return{name:"DisplayDraftWarningAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"RELOAD_COMMENTS":return{name:"ReloadCommentsAction",aggregationMode:i.a.OnSuccess,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"REQUEST_DELETE_POST":return{name:"DeletePostAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"REQUEST_DELETE_THREAD":return{name:"DeleteThreadAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent,logDocumentMetadata:i.f.Basic};case"DISPATCH_LOAD_THREADS":return{name:"LoadThreadsAction",aggregationMode:i.a.OnSuccess,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"REQUEST_REOPEN_THREAD":return{name:"ReopenThreadAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"REQUEST_THREAD_RESOLVE":return{name:"ResolveThreadAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent,logDocumentMetadata:i.f.Basic};case"SELECT_COMMENT":return{name:"SelectCommentAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":return{name:"SelectFirstThreadInNextCommentContextAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":return{name:"SelectLastThreadInPreviousCommentContextAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"SESSION_REQUEST_STARTED":return{name:"SessionRequestStartedAndLockSelectionAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"SHOW_LOW_FIDELITY_WARNING":return{name:"ShowLowFidelityWarningAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"CLEAR_LOW_FIDELITY_WARNING":return{name:"ClearLowFidelityWarningAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"UPDATE_DRAFT_RENDER_CONTEXT":return{name:"UpdateDraftRenderContext",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};case"PRESENT_LINK_TO_COMMENT":return{name:"PresentLinkToCommentAction",aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent};default:return}}const Ao=()=>e=>t=>{try{return e(t)}catch(e){if(void 0===wo(t)){const n=Object(i.i)().createActivityObject("ExceptionMiddlewareCatch",t.actionDetail.telemetryVisitor,i.a.None,i.b.NecessaryServiceDataEvent);n.addDataField("OperationType",t.type,i.d.SystemMetadata),n.addDataField("Trackback",t.actionDetail.trackback,i.d.SystemMetadata),n.failTag(593278723,Object(_t.a)(e))}!function(e){if(Object(xo.a)(e))throw e;if(!Object(u.b)(e))throw Object(i.i)().assertConditionTag(!1,"Unknown error encountered, rethrowing: "+Object(r.l)(e),593278724),e;switch(e.errorCode){case-2130957565:case-2130957551:throw e;case-2130957536:return;default:Object(i.i)().assertConditionTag(!1,`Unexpected error: Name: ${e.name} errorCode: ${e.errorCode} Tag: ${e.tag} internalDetails: ${Object(r.l)(e)}`,e.tag)}}(e)}};var jo=n(87);const _o={mentionsToCurrentUser:!1,CommentThread:{resolutionStatus:ke.a.All},TrackedChange:{stubField:""},contentOrder:ke.c.HostDefaultOrder,includeAllDocumentContexts:!1,userFilter:void 0},Fo=(e,t)=>n=>{const r=new Map;return o=>a=>{let s;const c=Object(jo.a)(n.getState());switch(a.type){case"LOAD_DEFAULT_FILTER":case"LOAD_FILTER":s=Object(jo.e)(n.getState(),a.payload.filteredRange.id);break;case"UPDATE_FILTER_RANGE":s=Object(jo.e)(n.getState(),a.payload.filterId)}const d=o(a);switch(a.type){case"LOAD_DEFAULT_FILTER":case"LOAD_FILTER":!function(e,t,n,r,o,a,s){void 0===a&&Object(jo.e)(n.getState(),r.payload.filteredRange.id)&&(o.set(r.payload.filteredRange.id,{filter:r.payload.filteredRange,changeToken:r.payload.filteredRange.onRangeUpdated.subscribe(e=>{((e,t,n,r,o,a)=>{o.get(n)?t(Yt.Y({renderContextType:r,telemetryVisitor:e,trackback:528779331},{filterId:n,changes:a.changes})):Object(i.i)().assertConditionTag(!1,"How did we receive an update, when we aren't tracking a filter? Did you forget to teardown an old filter?",528779330)})(t,n.dispatch,r.payload.filteredRange.id,r.actionDetail.renderContextType,o,e)})}),"LOAD_DEFAULT_FILTER"!==r.type&&!r.payload.shouldSetActive||Object(jo.a)(n.getState())!==r.payload.filteredRange.id||(e.setActiveFilteredRange(r.payload.filteredRange.id),s&&s!==Object(jo.a)(n.getState())&&s!==Object(jo.d)(n.getState())&&n.dispatch(Yt.Y({renderContextType:r.actionDetail.renderContextType,telemetryVisitor:t,trackback:528779332},{filterId:s,changes:[{type:"Teardown"}]}))))}(e,t,n,a,r,s,c);break;case"UPDATE_FILTER_RANGE":!function(e,t,n,r,o,a,s){Object(jo.a)(n.getState())!==s&&e.setActiveFilteredRange(Object(jo.a)(n.getState()));const c=Object(jo.e)(n.getState(),r.payload.filterId);if(a&&c&&a.filter!==c.filter){const a=o.get(r.payload.filterId);a&&a.filter.canBeUpdated()?a.filter.updateFilter(c.filter)||(Object(i.i)().assertConditionTag(!1,"The filter should have been able to update",528527826),Mo(e,t,n,c.filter,s===r.payload.filterId)):Mo(e,t,n,c.filter,s===r.payload.filterId)}const d=()=>r.payload.changes.findIndex(e=>"Teardown"===e.type)>=0;if(!Object(jo.e)(n.getState(),r.payload.filterId)){Object(i.i)().assertConditionTag(d(),"Range should not be removed unless there was a Teardown",528749966);const e=o.get(r.payload.filterId);e&&(e.filter.teardown(),e.changeToken.unsubscribe(),o.delete(r.payload.filterId))}Object(jo.d)(n.getState())||(Object(i.i)().assertConditionTag(d(),"Default filter should not be removed unless there was a Teardown",528749967),No(e,t,n))}(e,t,n,a,r,s,c)}return d}};const Mo=(e,t,n,r,o)=>{e.createFilteredRange({contentTypes:[A.b.CommentThread],filters:r,supportsFilterUpdates:!1}).then(e=>{n.dispatch(Yt.u({renderContextType:an.a.None,telemetryVisitor:t,trackback:528532107},{filteredRange:e,shouldSetActive:o}))}).catch(Object(jt.a)(528532108))},No=(e,t,n)=>{e.createFilteredRange({contentTypes:[A.b.CommentThread],filters:_o,supportsFilterUpdates:!1}).then(e=>{n.dispatch(Yt.t({renderContextType:an.a.None,telemetryVisitor:t,trackback:528779333},{filteredRange:e}))}).catch(e=>{Object(i.i)().assertConditionTag(!1,"Error creating new filter: "+Object(r.l)(e),528779334)})};var Lo=n(91);var Bo=n(54);var Ho=n(139);var Uo;function Vo(e){e.timerHandle&&clearTimeout(e.timerHandle)}!function(e){e[e.Yes=0]="Yes",e[e.No=1]="No",e[e.Unknown=2]="Unknown"}(Uo||(Uo={}));class Wo{constructor(e){this.telemetryVisitor=e,this.trackerActivityName="E2EPerfTracker",this.performanceActivities={},this.failTracker=(e,t,n)=>{const r=this.performanceActivities[e];r&&(r.activity.failTag(t,null!=n?n:-2130957541),Vo(r),delete this.performanceActivities[e])},this.timeoutTracker=(e,t,n)=>{const r=this.performanceActivities[e];r&&(Vo(r),r.activity.addDataField("Timeout",!0,i.d.SystemMetadata),t.failOnTimeout?r.activity.failTag(n,-2130957491):r.activity.successTag(n),delete this.performanceActivities[e])}}beginTracking(e,t,n,r,o={timeout:1e3,failOnTimeout:!0}){const a=r||Object(i.i)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,i.a.None,i.b.NecessaryServiceDataEvent);a.addDataField("OperationType",n,i.d.SystemMetadata),this.performanceActivities.hasOwnProperty(e)&&(Object(i.i)().assertConditionTag(!1,"Duplicate ID used for PerfActivity. Overwriting initial perf tracker with failure.",595132703),this.failTracker(e,595907678));const s={activity:a,expectedChangeType:t};s.timerHandle=setTimeout(()=>this.timeoutTracker(e,o,575484417),o.timeout),this.performanceActivities[e]=s}updateTrackerId(e,t){if(e===t)return;this.performanceActivities.hasOwnProperty(t)&&(Object(i.i)().assertConditionTag(!1,"Duplicate ID used for updateTrackerId. Overwriting initial perf tracker with failure.",595132704),this.failTracker(t,595132705));const n=this.performanceActivities[e];n&&(this.performanceActivities[t]=n,delete this.performanceActivities[e])}failAllTrackers(e,t){Object.keys(this.performanceActivities).forEach(n=>{const r=this.performanceActivities[n];Vo(r),r.activity.failTag(e,null!=t?t:-2130957541)}),this.performanceActivities={}}endTracker(e,t,n){const r=this.performanceActivities[e];r&&(Vo(r),r.activity.addDataField("ExpectedChangeArrived",r.expectedChangeType===t?Uo.Yes:Uo.No,i.d.SystemMetadata),r.activity.successTag(n),delete this.performanceActivities[e])}endAllTrackers(e){for(const t in this.performanceActivities){const n=this.performanceActivities[t];Vo(n),n.activity.addDataField("ExpectedChangeArrived",Uo.Unknown,i.d.SystemMetadata),n.activity.successTag(e)}this.performanceActivities={}}getTracker(e,t){const n=this.performanceActivities[e];if(n&&n.expectedChangeType===t)return n}}class zo{constructor(e){this.telemetryVisitor=e,this.trackerActivityName="LowFidelityScenarioTracker"}beginTracking(e){const t=Object(Xt.b)(e);this.activity&&t!==this.selectedCommentId&&(this.activity.addDataField("OperationType","SHOW_LOW_FIDELITY_WARNING",i.d.SystemMetadata),this.activity.successTag(593098840),this.activity=void 0,this.selectedCommentId=void 0),this.activity||this.selectedCommentId||(this.activity=Object(i.i)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,i.a.None,i.b.NecessaryServiceDataEvent),this.selectedCommentId=t)}endTrackingIfWarningDismissed(e,t){const n=Object(Xt.b)(t);!this.activity||n===this.selectedCommentId&&Object(Xt.h)(t)||(this.activity.addDataField("OperationType",e.type,i.d.SystemMetadata),this.activity.successTag(593098841),this.activity=void 0,this.selectedCommentId=void 0)}}function Ko(e,t){t?e.addDataField("AffectingTaskMetadata",!0,i.d.SystemMetadata):e.addDataField("AffectingTaskMetadata",!1,i.d.SystemMetadata)}function Go(e,t,n,r){const o=Object(tn.b)(t,r);if(!o)return;const a=Object(Un.j)(o);let s;if(Object(tn.c)(t))s=n[a].some(e=>0!=(t[e].commentFlags&Un.e.IsNew));else if(s=t.some(e=>(e.commentId===a||e.parentId===a)&&0!=(e.commentFlags&Un.e.IsNew)),!s)return;e.addDataField("CommentIsNew",a,i.d.SystemMetadata)}const qo=e=>{const t=new Wo(e),n=new zo(e),o=Object(w.a)(e=>{Object(i.i)().createActivityObject("PostButtonTeachingCallout",e.actionDetail.telemetryVisitor,i.a.None,i.b.NecessaryServiceDataEvent).successTag(573687565)});return e=>a=>s=>{const c=()=>{var t,n,r,o,c,d;const l=wo(s);if(!l)return Object(i.i)().assertConditionTag(!1,"Event name not defined for action type: "+s.type,595616738),a(s);const u=Object(i.i)().createActivityObject(l.name,s.actionDetail.telemetryVisitor,l.aggregationMode,l.diagnosticLevel);u.addDataField("Trackback",s.actionDetail.trackback,i.d.SystemMetadata),u.addDataField("RenderContextType",s.actionDetail.renderContextType,i.d.SystemMetadata),l.logDocumentMetadata&&u.addDocumentMetadata(l.logDocumentMetadata);const p=(e,t,n)=>{u.addDataField("CommentId",n,i.d.SystemMetadata);const r=Object(ye.i)(e,n);r.valid&&(u.addDataField("MatchesCommentAuthor",r.matchesCurrentUser,i.d.SystemMetadata),u.addDataField("ThreadCreationDeltaMs",r.timeElapsed,i.d.SystemMetadata)),Go(u,e,t,n)},h=e.getState(),f=Io.b(h);switch(s.type){case"COMMENT_CONTEXT_CHANGED":u.addDataField("NumberOfThreads",s.payload.numberOfThreads,i.d.SystemMetadata),Zt.n(h).virtualized||u.addDataField("NumberOfComments",s.payload.numberOfComments,i.d.SystemMetadata);break;case"COMMIT_DRAFT":const e=function(e){if("COMMIT_DRAFT"===e.type)return{name:`CommitDraft${Object(Do.b)(e.payload)}Action`,aggregationMode:i.a.None,diagnosticLevel:i.b.NecessaryServiceDataEvent}}(s);if(!e)return Object(i.i)().assertConditionTag(!1,"Event name not defined for given draft action type",595903002),a(s);const l=Object(i.i)().createActivityObject(e.name,s.actionDetail.telemetryVisitor,i.a.None,i.b.NecessaryServiceDataEvent);l.addDataField("RenderContextType",s.actionDetail.renderContextType,i.d.SystemMetadata),l.successTag(595903074);const m=Wn.b[s.payload.sessionType];u.addDataField("SessionType",m,i.d.SystemMetadata),"REPLY"===s.payload.sessionType&&Go(u,Zt.c(h),Zt.a(h),s.payload.data.parentId);break;case"DISPLAY_DRAFT_WARNING":u.addDataField("DraftWarningType",s.payload.draftWarningType,i.d.SystemMetadata),u.addDataField("DraftWarningReason",s.payload.draftWarningReason,i.d.SystemMetadata);const g=Object(ye.K)(h.commentState.draftState);g&&(u.addDataField("IsDraftInCurrentContext",g.isInCurrentContext,i.d.SystemMetadata),u.addDataField("DraftId",g.commentDraft.sessionConfiguration.draftId,i.d.SystemMetadata));break;case"UPDATE_DRAFT_RENDER_CONTEXT":u.addDataField("IsClaimingDraftLock",s.payload.isClaimingLock,i.d.SystemMetadata),u.addDataField("IsUpdatingAllDraftLocks",!s.payload.draftId,i.d.SystemMetadata);break;case"SELECT_COMMENT":u.addDataField("SelectType",Yt.b[s.payload.selectType],i.d.SystemMetadata),u.addDataField("ActionSource",be.a[s.payload.source],i.d.SystemMetadata);const b=Zt.r(h),C=!(!b||b.selectedCardId!==s.payload.selectedCard);u.addDataField("IsCurrentCard",C,i.d.SystemMetadata),C||Go(u,Zt.c(h),Zt.a(h),s.payload.selectedCard),Object(Ho.b)(s.payload.source)&&Object(Ho.c)(s.payload.selectType)&&Object(Ho.d)(u,Object(Ho.a)(Zt.d(h,s.payload.selectedCard)));break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":Ko(u,s.payload.isTask),p(Zt.c(h),Zt.a(h),s.payload.commentId);let y=void 0;if(s.payload.isTask){y="REQUEST_THREAD_RESOLVE"===s.type?"ResolveThreadWithTask":"ReopenThreadWithTask",u.addDataField(y,!0,i.d.SystemMetadata,i.e.Critical);const e=null===(r=null===(n=null===(t=f[s.payload.commentId])||void 0===t?void 0:t.history[0])||void 0===n?void 0:n.records[0])||void 0===r?void 0:r.time;u.addDataField("TaskCreationTimeDeltaMs",e?Date.now()-e.getTime():0,i.d.SystemMetadata,i.e.Critical)}Object(Ho.d)(u,Object(Ho.a)(Zt.d(h,s.payload.commentId)));break;case"REQUEST_DELETE_THREAD":if(Ko(u,s.payload.isTask),s.payload.isTask){u.addDataField("DeleteThreadWithTask",!0,i.d.SystemMetadata,i.e.Critical);const e=null===(d=null===(c=null===(o=f[s.payload.commentId])||void 0===o?void 0:o.history[0])||void 0===c?void 0:c.records[0])||void 0===d?void 0:d.time;u.addDataField("TaskCreationTimeDeltaMs",e?Date.now()-e.getTime():0,i.d.SystemMetadata,i.e.Critical)}Object(Ho.d)(u,Object(Ho.a)(Zt.d(h,s.payload.commentId))),p(Zt.c(h),Zt.a(h),s.payload.commentId);break;case"REQUEST_DELETE_POST":p(Zt.c(h),Zt.a(h),s.payload.commentId)}try{const t=e.getState(),n=a(s),r=e.getState(),o=Zt.h(t),c=Zt.h(r);switch(s.type){case"UPDATE_DRAFT_RENDER_CONTEXT":const e=s.payload.draftId?o.drafts[s.payload.draftId]:Object(ye.K)(o),t=s.payload.draftId?c.drafts[s.payload.draftId]:Object(ye.K)(c),n=void 0!==e&&void 0!==t&&e.renderContextType!==t.renderContextType;u.addDataField("DidDraftLockUpdate",n,i.d.SystemMetadata)}return u.successTag(595616739),n}catch(e){throw u.failTag(595616768,Object(_t.a)(e,-2130957541)),e}};switch(s.type){case"BEGIN_PROCESSING_COMMIT":{const n=Object(i.i)().createActivityObject(t.trackerActivityName,s.actionDetail.telemetryVisitor,i.a.None,i.b.NecessaryServiceDataEvent);try{c()}catch(e){throw n.failTag(595687567,Object(_t.a)(e,-2130957541)),e}const r=Zt.t(e.getState());if(!r){n.failTag(595687569,-2130957541);break}const o=r.commentDraft.sessionConfiguration;t.beginTracking(o.draftId,Wn.a[o.sessionType],o.sessionType,n);break}case"COMMIT_FAILURE":{const n=Zt.t(e.getState());Object(i.i)().assertConditionTag(!!n,"Draft should exist when failing a commit.",595132701),n&&t.failTracker(n.commentDraft.sessionConfiguration.draftId,595132702),a(s);break}case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":t.beginTracking(s.payload.commentId,mt.a.Modify,s.type);try{c()}catch(e){throw t.failTracker(s.payload.commentId,595907670,Object(_t.a)(e,-2130957541)),e}break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":t.beginTracking(s.payload.commentId,mt.a.Delete,s.type);try{c()}catch(e){throw t.failTracker(s.payload.commentId,595907671,Object(_t.a)(e,-2130957541)),e}break;case"COMMENT_CONTEXT_CHANGED":try{a(s)}catch(e){throw t.failAllTrackers(595731294,Object(_t.a)(e,-2130957541)),e}break;case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":if(("LOAD_COMMENT"===s.type?s.payload.commentData:s.payload.threadInfo).length>0&&!t.getTracker("LoadCommentTracker",mt.a.Load)){const e=Object(i.i)().createActivityObject(t.trackerActivityName,s.actionDetail.telemetryVisitor,i.a.None,i.b.NecessaryServiceDataEvent);t.beginTracking("LoadCommentTracker",mt.a.Load,s.type,e,{timeout:5e3,failOnTimeout:!1})}a(s);break;case"RELOAD_COMMENTS":try{c()}catch(e){throw t.failAllTrackers(595907672,Object(_t.a)(e,-2130957541)),e}t.endAllTrackers(595907673);break;case"ON_INITIAL_RENDER":const d=t.getTracker("LoadCommentTracker",mt.a.Load);d&&(s.payload.commentId&&d.activity.addDataField("AssociatedCommentId",s.payload.commentId,i.d.SystemMetadata),d.activity.addDataField("RenderContextType",s.payload.renderContextType,i.d.SystemMetadata),t.endTracker("LoadCommentTracker",mt.a.Load,595646476)),a(s);break;case"APPLY_COMMENT_CHANGES":try{c()}catch(e){throw t.failAllTrackers(595907674,Object(_t.a)(e,-2130957541)),e}for(const e of s.payload.changes){if(e.type===mt.a.Load||e.type===mt.a.Unknown)break;if(e.type!==mt.a.Delete&&e.type!==mt.a.Modify){if(e.type===mt.a.Insert){void 0!==e.tempId&&""===e.model.parentId&&Object(Yn.a)(e.tempId,e.model.commentId,s.actionDetail.telemetryVisitor);const n=e.tempId||e.model.parentId;void 0!==n&&t.endTracker(n,e.type,595857620)}}else t.endTracker(e.model.commentId,e.type,595907675)}break;case"COMMIT_DRAFT":{const n=Zt.t(e.getState());if(c(),s.payload.data.temporaryCommentId&&n){let e;const o=n.commentDraft.sessionConfiguration;switch(o.sessionType){case"CREATE":o.draftId,s.payload.data.temporaryCommentId,s.actionDetail.telemetryVisitor,e=s.payload.data.temporaryCommentId;break;case"REPLY":e=s.payload.data.temporaryCommentId;break;case"EDIT":e=o.commentId;break;case"METADATA":e=o.threadId;break;default:Object(r.m)(o)}e&&t.updateTrackerId(o.draftId,e)}break}case"DISPATCH_LOAD_THREADS":case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":case"PRESENT_LINK_TO_COMMENT":case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":case"SESSION_REQUEST_STARTED":case"UPDATE_DRAFT_RENDER_CONTEXT":case"CLEAR_COMMENT_SELECTION":case"SELECT_COMMENT":case"DISPLAY_DRAFT_WARNING":case"CLEAR_LOW_FIDELITY_WARNING":c();break;case"SHOW_LOW_FIDELITY_WARNING":c();const l=Zt.r(e.getState());l&&n.beginTracking(l);break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":{let e="";switch(s.payload.visibilityState){case Pn.a.Closed:e="ViewContainerClosed";break;case Pn.a.Hidden:e="ViewContainerHidden";break;case Pn.a.Visible:e="ViewContainerVisible";break;default:Object(r.m)(s.payload.visibilityState)}const t=Object(i.i)().createActivityObject(e,s.actionDetail.telemetryVisitor,i.a.Always,i.b.NecessaryServiceDataEvent);a(s),t.successTag(592241220);break}case"DRAFT_EMPTINESS_CHANGED":const u=Zt.h(e.getState()).drafts[s.payload.draftId].commentDraft.sessionConfiguration.sessionType;u!==Un.c&&u!==Un.h||o(s),a(s);break;default:a(s)}const d=Zt.r(e.getState());d&&n.endTrackingIfWarningDismissed(s,d)}};var $o=n(253),Yo=n(171),Jo=n(180),Qo=n(204);const Xo=(e,t)=>e=>n=>r=>{switch(r.type){case"REQUEST_SHOW_PANE":en.d(e.getState()).openView();break;case"REQUEST_CLOSE_PANE":en.d(e.getState()).closeView();break;case"MOVE_FOCUS_TO_CANVAS":if(!ge.U()){en.d(e.getState()).moveFocusToCanvas_donotuse()}break;case"REQUEST_MODAL_CONFIRMATION":{const t=en.d(e.getState());t.invokeModalConfirmationDialog?t.invokeModalConfirmationDialog(r.payload.onConfirm,r.payload.onCancel,r.payload.displayStrings):(Object(i.i)().assertConditionTag(!1,"Host does not have modal dialog implemented",593278688),t.closeView());break}case"READY_TO_RENDER":{const t=en.d(e.getState());t.onReadyToRender&&t.onReadyToRender();break}case"RESOLVE_ATMENTION_CAPABILITY":if(ge.r()){const e=r.payload.capability===$o.a.Enabled;t.initializeController(e)}break;case"BEGIN_DRAFTING_SUCCESS":{const t=en.d(e.getState());Object(Yo.a)(t)&&"CREATE"===r.payload.draftDetails.sessionConfiguration.sessionType&&ei(e.dispatch,r.actionDetail,{displayMode:Vt.a.Variable,desiredHeight:0}),Zo(e.getState(),t);break}case"DISPLAY_DRAFT_WARNING":Zo(e.getState());break;case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":if(r.payload.closeOnDiscard){const t=en.d(e.getState());return n(r),void t.closeView()}break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":ge.p(),0}const o=e.getState(),a=n(r),s=e.getState();return function(e,t,n,r){const o=en.d(r);if(!Object(Yo.a)(o))return;const i=Zt.h(r),a=Zt.h(n),s=Object(ve.c)(i),c=Object(ve.c)(a),d=Zt.g(r),l=Zt.g(n);if(s!==c||!Object(Yo.a)(en.d(n))||!d&&l){if(!s)return d?void ei(e,t,{displayMode:Vt.a.Variable,desiredHeight:0}):void ei(e,t,{displayMode:Vt.a.Normal});const n=Zt.r(r);if(n&&n.selectedCardId===Object(ye.G)(i))return;ei(e,t,{displayMode:Vt.a.FullScreen})}}(e.dispatch,r.actionDetail,o,s),a};function Zo(e,t){if(function(e){const t=en.e(e);return ge.p()&&(ge.m()?t===Pn.a.Hidden:t!==Pn.a.Visible)}(e)){(t||en.d(e)).openView()}}function ei(e,t,n){e(Object(Qo.a)(t,n)).catch(Object(jt.a)(578426776))}function ti(e,t,n,r,o,a,s,c,d){const l=d?[Fo(d,r)]:[],u=Object(jn.compose)(Object(jn.applyMiddleware)(Bn,Ln,Mn,Ao,qo(r),((e,t)=>n=>{const r=So(n,t);return t=>o=>{const a=n.getState();switch(o.type){case"COMMENT_CONTEXT_CHANGED":case"RELOAD_COMMENTS":r.reset();break;case"COMMIT_DRAFT":const t=Io.b(a),n=Zt.t(a);if(void 0!==n){const e=n.commentDraft;if(o.payload.metadataUpdates&&o.payload.metadataUpdates.Task){let n;e.sessionConfiguration.sessionType!==Co.a&&e.sessionConfiguration.sessionType!==Co.b&&(n=t[e.sessionConfiguration.threadId]&&t[e.sessionConfiguration.threadId].id),o.payload.metadataUpdates.Task.taskId=n,e.updateProperties("Task",o.payload.metadataUpdates.Task)}o.payload.data.temporaryCommentId=e.commit(o.payload.data.commentBody)}break;case"QUEUE_LOAD_THREADS":return Zt.n(a).virtualized?void r(o.payload.threadIds):void Object(i.i)().assertConditionTag(!1,"Load threads should not be queued if host is not virtualizing comments.",593768920);case"DISPATCH_LOAD_THREADS":if(!Zt.n(a).virtualized)return;e.loadThreads(o.payload.threadIds);break;case"HIGHLIGHT_COMMENT":o.payload.actionSource===be.a.SharedComments&&e.highlightComment(o.payload.commentId);break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":const s=Zt.h(a);if(Object(ve.d)(s))return;e.deleteComment(o.payload.commentId);break;case"REQUEST_THREAD_RESOLVE":ge.b()?e.beginDraftingAsync({sessionType:"METADATA",threadId:o.payload.commentId}).then(e=>{const t=Io.b(a)[o.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:100,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!0}),e.commit(),e.endDrafting()}).catch(Object(jt.a)(593768922)):e.setThreadResolvedState(o.payload.commentId,!0);break;case"REQUEST_REOPEN_THREAD":ge.b()?e.beginDraftingAsync({sessionType:"METADATA",threadId:o.payload.commentId}).then(e=>{const t=Io.b(a)[o.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:0,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!1}),e.commit(),e.endDrafting()}).catch(Object(jt.a)(593768924)):e.setThreadResolvedState(o.payload.commentId,!1);break;case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":e.selectFirstThreadInNextCommentContext();break;case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":e.selectLastThreadInPreviousCommentContext();break;case"PRESENT_LINK_TO_COMMENT":e.presentLinkToComment(o.payload.commentId)}const s=t(o),c=n.getState(),d=Zt.r(a),l=Zt.r(c);let u=void 0;switch("LOAD_COMMENT"===o.type||"VIRTUALIZE_COMMENTS"===o.type||"SELECT_COMMENT"===o.type&&o.payload.source!==be.a.SharedComments||!l||l.selectedCardId===(null==d?void 0:d.selectedCardId)||l.selectedCardId===Object(Kn.t)()||(u=l.selectedCardId),o.type){case"CLEAR_COMMENT_HIGHLIGHT":o.payload.actionSource===be.a.SharedComments&&void 0!==a.commentState.highlightedCommentId&&void 0===c.commentState.highlightedCommentId&&e.highlightComment("");break;case"DISPLAY_DRAFT_WARNING":if(ge.y()&&!ge.U()){const e=Zt.t(c);e&&(u=e.threadId)}}return u&&e.selectComment(u),s}})(e,r),(e=>t=>n=>r=>{const o=t.getState().commentState.draftState.drafts;n(r);const a=t.getState().commentState.draftState.drafts;Object.keys(o).forEach(t=>{if(void 0===a[t]){const n=Object(i.i)().createActivityObject("EndDraftingCalledOnAction",e,i.a.None,i.b.NecessaryServiceDataEvent);n.addDataField("ActionName",r.type,i.d.SystemMetadata),n.successTag(539313865),o[t].commentDraft.endDrafting()}})})(r),(e=>t=>n=>r=>{var o,i;const a=t.getState(),s=n(r),c=t.getState();switch(r.type){case"BEGIN_DRAFTING_SUCCESS":{const t=Zt.h(c),n=r.payload.draftDetails.sessionConfiguration.draftId;t.drafts[n]&&e.setDeferredActiveEditorFocusCommand(n);break}case"DISPLAY_DRAFT_WARNING":{if(r.payload.draftWarningType===Lo.a.CommitFailed)break;const t=Zt.h(c),n=Object(ye.H)(t);n&&e.setDeferredActiveEditorFocusCommand(n.sessionConfiguration.draftId);break}}return(null===(o=Zt.r(c))||void 0===o?void 0:o.selectedCardId)===(null===(i=Zt.r(a))||void 0===i?void 0:i.selectedCardId)&&Zt.h(c)===Zt.h(a)||e.clearPendingOnComponentFocusedRequest(),s})(s),Xo(0,c),(e=>t=>t=>n=>{switch(n.type){case"DISPLAY_DRAFT_WARNING":{if(!ge.y())break;const t=Bo.e(e,n.payload.draftWarningType);Object(E.a)(n.payload.draftWarningType===Lo.a.ReturnToDraft?e.formatString(230,t):t);break}}return t(n)})(a),(e=>t=>n=>r=>{switch(r.type){case"ADD_CONTENT_EXTENSION":r.payload.extension.priority=ko(r.payload.extension.provider.scope.renderMode,t.getState());break;case"REMOVE_CONTENT_EXTENSION":for(const e of r.payload.renderModes){const n=Oo.a(t.getState())[e];n&&n.controller.unregisterExtension()}break;case"UPDATE_EXTENSION_PRIORITY":n(r),Ro(t.getState(),A.d.TaskPane),Ro(t.getState(),A.d.TaskPaneItem),Ro(t.getState(),A.d.Integrated),Ro(t.getState(),A.d.Isolated);break;case"APPLY_COMMENT_CHANGES":case"CANCEL_COMMENT_CREATE_THREAD":if(Eo(t,r,n))return;break;case"COMMENT_CONTEXT_CHANGED":case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":case"RELOAD_COMMENTS":case"VIEW_CONTAINER_VISIBILITY_CHANGED":return n(r),void t.dispatch(Object(Yt.X)({renderContextType:an.a.None,telemetryVisitor:e,trackback:594834319},{[A.d.TaskPane]:ko(A.d.TaskPane,t.getState()),[A.d.TaskPaneItem]:ko(A.d.TaskPaneItem,t.getState()),[A.d.Integrated]:ko(A.d.Integrated,t.getState()),[A.d.Isolated]:ko(A.d.Isolated,t.getState())}));case"BEGIN_DRAFTING_SUCCESS":if(Po(t,r,n,r.payload.draftDetails.sessionConfiguration.sessionType))return;break;case"BEGIN_DRAFTING_FAILURE":if(Po(t,r,n,r.payload.beginDraftingParams.sessionType))return;break;case"UPDATE_DRAFT_RENDER_CONTEXT":{if(r.payload.isClaimingLock||r.actionDetail.renderContextType===an.a.DiscreteIsolated)break;const e=Zt.t(t.getState());if(e&&Po(t,r,n,e.commentDraft.sessionConfiguration.sessionType))return;break}}return n(r)})(r),(e=>t=>n=>r=>{var o;if(!ge.U())return n(r);const i=t.getState(),a=n(r),s=t.getState();switch(r.type){case"DISPLAY_DRAFT_WARNING":{const t=Zt.r(i),n=Zt.r(s),r=!n||n.selectedCardId===(null==t?void 0:t.selectedCardId);if(ge.y()&&r){const t=Zt.t(s);t&&e.bringContentIntoView({contentIdentifier:{contentId:t.threadId,contentType:A.b.CommentThread}})}break}case"SELECT_COMMENT":{const t=Zt.r(s);r.payload.source===be.a.SharedComments&&r.payload.selectType!==Yt.b.Polite&&Object(cn.c)(r.actionDetail.renderContextType)&&t&&e.bringContentIntoView({contentIdentifier:{contentId:t.selectedCardId,contentType:A.b.CommentThread}});break}case"VIEW_CONTAINER_VISIBILITY_CHANGED":{if(en.a(s))break;const t=Zt.t(s),n=t&&t.isInCurrentContext&&(null===(o=Zt.r(s))||void 0===o?void 0:o.selectedCardId)===t.threadId?t.threadId:void 0;n&&e.bringContentIntoView({contentIdentifier:{contentId:n,contentType:A.b.CommentThread}});break}case"SELECT_CONTENT":e.selectNextOrPreviousContent(r.payload);break;case"MOVE_FOCUS_TO_CANVAS":e.moveFocus({region:Re.a.Canvas,resource:r.payload.resource})}return a})(o),...l)),p=Object(jn.createStore)(bo,n,u);return s.initialize(p),p}var ni=n(244),ri=n(49);class oi{constructor(e,t){this.commentStore=e,this.commandFactory=new wn(this.commentStore,t)}selectNextOrPreviousThread(e,t,n){const r=ge.m()&&!en.a(this.commentStore.getState()),o=en.c(this.commentStore.getState());return fn(this.commandFactory.selectNextOrPreviousThread(void 0,e,t,n,r),o,this.commentStore,()=>{})===$t.Handled}selectAcrossContexts(e,t){const n=en.c(this.commentStore.getState()),r=Zt.f(this.commentStore.getState()),o=ge.m()&&!en.a(this.commentStore.getState());fn(this.commandFactory.selectAcrossContexts(void 0,{direction:e,source:be.a.SharedComments,expandCard:!0,iterableContentTypes:void 0},t,r.nextPopulatedContextDetails,o),n,this.commentStore,()=>{})}}var ii=n(199),ai=n(193),si=n(152);function ci(e,t){class n extends j.PureComponent{render(){const n=Object.assign(Object.assign({},t),this.props);return j.createElement(e,n)}}return n}function di(e,t){return class extends j.PureComponent{render(){return j.createElement(_.Provider,{store:t},j.createElement(e,Object.assign({},this.props)))}}}var li=n(92),ui=n(70),pi=n(16),hi=n(231),fi=n(128);class mi{constructor(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}getId(){return this.mockId}}class gi{constructor(e,t){this.viewManager=e,this.mockUIDriver=t,this.pendingActionReason=X.None,this.pendingAction=void 0,this.startProcessingActionsPending=void 0,this.getActiveComponentTree=e=>en.a(e)?en.c(e):this.viewManager.getComponentTreeForRenderMode(A.d.Integrated),this.makeGetRenderableItemThreads=e=>Object(li.createSelector)([Zt.h,Zt.g,Zt.b,e,this.getActiveComponentTree],(e,t,n,r,o)=>kn.c(r,n,t,o.componentTreeId.renderContextType!==an.a.HalfPane,Object(hi.a)(e,o.componentTreeId.renderContextType))),this.getCompleteHostableCommentCardRendererOwnProps=e=>Object.assign(Object.assign({},this.viewManager.getHostableCommentCardRendererProps(A.d.Integrated)),{resource:{id:e},componentInstanceId:Object(D.b)()}),this.getCompletePaneOwnProps=()=>Object.assign(Object.assign({},this.viewManager.getPaneOwnProps()),{resource:{id:"CommentPane"}}),this.getDispatchProps=e=>{let t=void 0;const n=this.commentStore.getState(),r=this.commentStore.dispatch;return t=en.a(n)?Object(ue.b)(r,this.getCompletePaneOwnProps()):Object(ue.a)(r,this.getCompleteHostableCommentCardRendererOwnProps(e)),t},this.getNewThreadDraftId=()=>Object(ye.G)(Zt.h(this.commentStore.getState()),!0),this.getParentId=e=>{const t=this.commentStore.getState(),n=Zt.c(t),r=Object(tn.b)(n,e);return r?Object(ui.i)(r):void 0},this.invokeModalDialog=(e,t,n)=>{const o=this.commentStore.getState(),i={renderContextType:this.getActiveComponentTree(o).componentTreeId.renderContextType,trackback:592240791,telemetryVisitor:this.viewManager.getTelemetryVisitor()},a=this.commentStore.dispatch,s=this.getCompletePaneOwnProps(),c=Object(ue.b)(a,s),d=Zt.r(o);switch(e){case he.a.CancelNewDraft:case he.a.CancelReplyDraft:case he.a.CancelPostEdit:return c.discardDraftAsync(i,be.a.SharedComments,!1);case he.a.DeleteThread:return d&&c.requestDeleteThread(i,d.selectedCardId),Promise.resolve(h.a.Handled);case he.a.ClosePaneDraft:return pi.p({ownProps:s,dispatchProps:c,componentTree:this.getActiveComponentTree(o),draftState:Zt.h(o),invokeModalDialog:this.invokeModalDialog}),Promise.resolve(h.a.Handled);default:Object(r.m)(e)}},this.updateEventProcessingState=e=>{const t=Zt.o(this.previousStoreState),n=Zt.o(e);!t&&n&&this.pauseProcessing(),t&&!n&&this.beginProcessing()},this.handleStoreUpdate=()=>{const e=this.commentStore.getState(),t=Zt.h(e),n=Zt.h(this.previousStoreState);!Object(ve.d)(t)&&this.pendingActionReason===X.NeedNotDrafting&&this.pendingAction&&(Object(i.i)().createActivityObject("TriggerPendingActionNeedNotDrafting",this.viewManager.getTelemetryVisitor(),i.a.None,i.b.FullEvent).successTag(592269458),this.pendingAction(),this.pendingAction=void 0,this.pendingActionReason=X.None);const r=Object(ve.b)(t),o=Object(ve.b)(n);r&&!o&&this.pendingActionReason===X.NeedDrafting&&this.pendingAction&&(Object(i.i)().createActivityObject("OnNotDraftingCallback",this.viewManager.getTelemetryVisitor(),i.a.None,i.b.FullEvent).successTag(592269459),this.pendingAction(),this.pendingAction=void 0,this.pendingActionReason=X.None),this.updateEventProcessingState(e),this.previousStoreState=e},this.onDrafting=e=>{const t=Object(i.i)().createActivityObject("OnDraftingCallback",this.viewManager.getTelemetryVisitor(),i.a.None,i.b.FullEvent);Object(ve.b)(Zt.h(this.commentStore.getState()))?(t.addDataField("ActionDeferred",!1,i.d.SystemMetadata),e(),t.successTag(592269460)):(t.addDataField("ActionDeferred",!0,i.d.SystemMetadata),this.pendingAction=e,this.pendingActionReason=X.NeedDrafting,t.successTag(592269461))},this.onNotDrafting=e=>{const t=Object(i.i)().createActivityObject("OnNotDraftingCallback",this.viewManager.getTelemetryVisitor(),i.a.None,i.b.FullEvent);Object(ve.d)(Zt.h(this.commentStore.getState()))?(t.addDataField("ActionDeferred",!0,i.d.SystemMetadata),this.pendingAction=e,this.pendingActionReason=X.NeedNotDrafting,t.successTag(592269462)):(t.addDataField("ActionDeferred",!1,i.d.SystemMetadata),e(),t.successTag(592269463))},this.runAction=(e,t)=>{switch(e){case X.NeedDrafting:return this.onDrafting(t);case X.NeedNotDrafting:return this.onNotDrafting(t);case X.None:return t()}},this.onMockUIAction=new le(e=>{const t=Object(i.i)().createActivityObject("OnMockUIAction",this.viewManager.getTelemetryVisitor(),i.a.None,i.b.FullEvent);t.addDataField("MockUIActionType",e.actionType,i.d.SystemMetadata);try{switch(e.actionType){case k.CreateThread:M(e)?this.runAction(X.NeedDrafting,()=>this.onCreateOrReply(new Te(this.getNewThreadDraftId(),e.content))):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269464);break;case k.CancelCreateThread:N(e)?this.runAction(X.NeedDrafting,()=>this.onCancelCreateThread(new Te(this.getNewThreadDraftId()))):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269465);break;case k.StartReplySession:L(e)?this.runAction(X.NeedNotDrafting,()=>this.onStartReplySession(new Te(e.threadId))):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269466);break;case k.CancelReplySession:B(e)?this.runAction(X.NeedDrafting,()=>this.onCancelReplySession(new Te(e.threadId))):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269467);break;case k.PostReply:H(e)?this.runAction(X.NeedDrafting,()=>this.onCreateOrReply(new Te(e.threadId,e.content))):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269468);break;case k.DeleteComment:U(e)?this.runAction(X.NeedNotDrafting,()=>this.onDeleteComment(e.commentId)):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269469);break;case k.DeleteThread:V(e)?this.runAction(X.NeedNotDrafting,()=>this.onDeleteThread(e.threadId)):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269470);break;case k.ResolveThread:W(e)?this.runAction(X.NeedNotDrafting,()=>this.onResolveThread(e.threadId)):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269471);break;case k.ReopenThread:z(e)?this.runAction(X.NeedNotDrafting,()=>this.onReopenThread(e.threadId)):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269472);break;case k.StartEditSession:K(e)?this.runAction(X.NeedNotDrafting,()=>this.onStartEditSession(e.commentId)):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269473);break;case k.CancelEditSession:G(e)?this.runAction(X.NeedDrafting,()=>this.onCancelEditSession(new Se(e.commentId))):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269474);break;case k.PostEdit:if(q(e)){const t=new Se(e.commentId);t.setContents(e.content),this.runAction(X.NeedDrafting,()=>this.onPostEdit(t))}else Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269475);break;case k.SelectComment:$(e)?this.runAction(X.NeedNotDrafting,()=>this.onSelectComment(new mi(e.commentId))):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269504);break;case k.ClosePane:this.onClosePane();break;case k.ClickGhostCard:Y(e)?this.runAction(X.NeedNotDrafting,()=>this.onGhostCommentClicked()):Object(i.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269505);break;default:Object(r.m)(e.actionType)}}catch(e){return void t.failTag(592269507,Object(_t.a)(e))}t.successTag(592269508)}),this.onStartEditSession=e=>{const t=this.commentStore.getState();pi.E({trackback:592269509,id:e,data:this.getRenderableItems(t),selectedComment:Zt.r(t),renderContextType:this.getActiveComponentTree(t).componentTreeId.renderContextType,actionDispatchers:this.getDispatchProps(e),telemetryVisitor:this.viewManager.getTelemetryVisitor()})},this.onResolveThread=(e,t)=>{const n=this.commentStore.getState();pi.m({componentTree:this.getActiveComponentTree(n),focusManager:this.viewManager.getFocusManager(),trackback:592269510,id:e,renderContextType:this.getActiveComponentTree(n).componentTreeId.renderContextType,dispatchProps:this.getDispatchProps(e),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,isTask:t})},this.onClosePane=()=>{const e=this.commentStore.getState();if(en.b(e)){const e=this.commentStore.dispatch;Object(ue.b)(e,this.getCompletePaneOwnProps()).requestClosePane({telemetryVisitor:this.viewManager.getTelemetryVisitor(),renderContextType:an.a.None,trackback:592269511})}else Object(i.i)().assertConditionTag(!1,"Pane was already closed.",592269512)},this.onCreateOrReply=e=>{const t=e.getId(),n=this.commentStore.getState(),r=Zt.h(n),o=Object(ye.K)(r),i=o&&"CREATE"===o.commentDraft.sessionConfiguration.sessionType?{type:"CREATE"}:{type:"REPLY",parentId:t};pi.c({trackback:592269513,commentCardRef:e,draftState:r,areMentionsEnabled:Zt.n(n).atMention===ui.b.Enabled,session:i,componentTree:this.getActiveComponentTree(n),dispatchProps:this.getDispatchProps(t),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,commitSource:Ce.a.Programmatic,selectedTaskAssignee_deprecated:o&&o.selectedTaskAssignee}).catch(Object(jt.a)(592269514))},this.onCancelCreateThread=e=>{const t=e.getId(),n=this.getDispatchProps(t),r=this.commentStore.getState(),o=Zt.r(r),i=Zt.h(r),a=en.b(r),s=this.getActiveComponentTree(r).componentTreeId.renderContextType,c=Zt.s(r),d=(null==o?void 0:o.selectedCardId)===e.getId()&&Object(fi.b)(a,s,i,o,c),l=kn.g(this.getRenderableItemThreads(r),t);pi.e({trackback:592269516,showDiscardDialog:!1,invokeModalDialog:this.invokeModalDialog,componentTree:this.getActiveComponentTree(r),dispatchProps:n,closeOnDiscard:d,cardId:t,draftState:i,telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,focusManager:this.viewManager.getFocusManager(),lieIndex:l})},this.onGhostCommentClicked=()=>{const e=this.commentStore.getState();en.b(e)||Object(i.i)().assertConditionTag(!1,"There is no Ghost Card because the pane is closed.",592269517),this.viewManager.getPaneOwnProps().selectionManager.selectAcrossContexts(Re.d.Next,this.getActiveComponentTree(e).componentTreeId.renderContextType)},this.onPostEdit=e=>{const t=this.commentStore.getState(),n=this.getParentId(e.getId());n&&pi.C({trackback:592269518,id:e.getId(),data:this.getRenderableItems(t),draftState:Zt.h(t),contentPromise:e.getContentsAsync(),atMentionsEnabled:Zt.n(t).atMention===ui.b.Enabled,componentTree:this.getActiveComponentTree(t),actionDispatchers:this.getDispatchProps(n),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,commitSource:Ce.a.Programmatic}).catch(Object(jt.a)(592269519))},this.onCancelEditSession=e=>{const t=this.commentStore.getState(),n=Zt.h(t),r=Zt.r(t),o=en.b(t),i=Zt.s(t),a=Object(fi.b)(o,this.getActiveComponentTree(t).componentTreeId.renderContextType,n,r,i),s=this.getRenderableItems(t),c=this.getParentId(e.getId());if(!c)return;const d=this.getDispatchProps(c);pi.z({trackback:592269521,commentId:e.getId(),setContents:e.setContents.bind(e),data:s,draftState:n,shouldClosePaneAfterDiscardDraft:a,onWillDiscardCallback:void 0,renderContextType:this.getActiveComponentTree(t).componentTreeId.renderContextType,dispatchProps:d,telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI})},this.onCancelReplySession=e=>{const t=this.commentStore.getState(),n=Zt.r(t),r=Zt.h(t),o=e.getId(),i=this.getDispatchProps(o),a=en.b(t),s=this.getActiveComponentTree(t).componentTreeId.renderContextType,c=Zt.s(this.commentStore.getState()),d=(null==n?void 0:n.selectedCardId)===e.getId()&&Object(fi.b)(a,s,r,n,c);pi.e({trackback:592269522,showDiscardDialog:!1,invokeModalDialog:this.invokeModalDialog,componentTree:this.getActiveComponentTree(t),dispatchProps:i,closeOnDiscard:d,cardId:e.getId(),draftState:r,telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,focusManager:this.viewManager.getFocusManager(),lieIndex:-1})},this.onDeleteThread=e=>{const t=this.commentStore.getState(),n=Zt.r(t),r=this.getDispatchProps(e);pi.d({trackback:592269523,id:e,data:this.getRenderableItems(t),selectedComment:n,componentTree:this.getActiveComponentTree(t),invokeModalDialog:this.invokeModalDialog,dispatchProps:r,telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,focusManager:this.viewManager.getFocusManager(),isTask:!!Io.b(t)[e],threadIndex:kn.g(this.getRenderableItemThreads(t),e),shouldCheckForLowFidelity:!0})},this.onDeleteComment=e=>{const t=this.commentStore.getState(),n=Zt.r(t),r=this.getParentId(e);if(!r)return;const o=this.getDispatchProps(r);pi.D({trackback:592269524,id:e,data:this.getRenderableItems(t),selectedComment:n,renderContextType:this.getActiveComponentTree(t).componentTreeId.renderContextType,actionDispatchers:o,telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI})},this.onSelectComment=e=>{var t;const n=this.commentStore.getState(),r=Zt.g(n,!0),o=this.getNewThreadDraftId(),a=this.getRenderableItems(n),s=e.getId(),c=s===o?r&&{commentModel:r.newComment}:a.find(e=>kn.f(e)===s);if(!c||!Object(xn.a)(c))return void Object(i.i)().assertConditionTag(!1,"Selection coming from an unknown post?",592269525);const d=c,l=this.getDispatchProps(null!==(t=d.commentModel.parentId)&&void 0!==t?t:d.commentModel.commentId),u=Zt.r(n),p=Zt.h(n),h=this.getActiveComponentTree(n),f=Object(sn.a)(kn.j(c),Zt.j(n),h.componentTreeId.renderContextType);pi.J({trackback:592269526,renderableItem:c,selectedComment:u,cardCollapsedState:f,dispatchProps:l,telemetryVisitor:this.viewManager.getTelemetryVisitor(),shouldFocusAfter:!1,componentTree:h,draftState_deprecated:p}).catch(Object(jt.a)(590123734))},this.onStartReplySession=e=>{pi.a({trackback:592269527,threadId:e.getId(),renderContextType:this.getActiveComponentTree(this.commentStore.getState()).componentTreeId.renderContextType,dispatchProps:this.getDispatchProps(e.getId()),telemetryVisitor:this.viewManager.getTelemetryVisitor()})},this.commentStore=this.viewManager.getCommentStore(),this.previousStoreState=this.commentStore.getState(),this.unsubscribeStoreListener=this.commentStore.subscribe(this.handleStoreUpdate),this.getRenderableItems=Zt.x(),this.getRenderableItemThreads=this.makeGetRenderableItemThreads(this.getRenderableItems)}initialize(){const e=Object(i.i)().createActivityObject("InitializeMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),i.a.None,i.b.FullEvent);this.registrationToken=this.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction.handler),e.successTag(574456152)}teardown(){var e;const t=Object(i.i)().createActivityObject("TeardownMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),i.a.None,i.b.FullEvent);null===(e=this.registrationToken)||void 0===e||e.unsubscribe(),this.unsubscribeStoreListener(),t.successTag(574456153)}beginProcessing(){const e=Object(i.i)().createActivityObject("StartMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),i.a.None,i.b.FullEvent);this.startProcessingActionsPending=setTimeout(()=>{this.onMockUIAction.startProcessing(),this.startProcessingActionsPending=void 0,e.successTag(574456150)},100)}pauseProcessing(){const e=Object(i.i)().createActivityObject("PauseMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),i.a.None,i.b.FullEvent);this.startProcessingActionsPending&&(clearTimeout(this.startProcessingActionsPending),this.startProcessingActionsPending=void 0),this.onMockUIAction.pauseProcessing(),e.successTag(574456151)}onReopenThread(e,t){pi.l({trackback:592269528,id:e,renderContextType:this.getActiveComponentTree(this.commentStore.getState()).componentTreeId.renderContextType,dispatchProps:this.getDispatchProps(e),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,isTask:t})}}var bi=n(274);var Ci=n(256);function yi(e,t,n,r){return o=>Object(A.e)().registerExtension(t,n,r).then(t=>(o(Object(Ci.a)(e,t)),t))}var vi=n(237);var Ti=n(240);function Si(e,t){return`${e}-${t}`}class Ii{constructor(){this.hostableComponentRegistry=new Map}registerComponent(e,t,n){this.hostableComponentRegistry.has(e)||this.hostableComponentRegistry.set(e,new Map);const r=this.hostableComponentRegistry.get(e);n?r.set(t,n):r.delete(t)}getComponent(e,t){const n=this.hostableComponentRegistry.get(e);if(n)return n.get(t)}}class Oi extends class{constructor({apiContext:e,viewProvider:t,commentAPI:n,peopleAPI:o,localizationAPI:a,themeAPI:s,focusManager:c,lppManager:d,initializationReason:l,commentStore:u,viewStrategyFactory:p,mockUIDriver:h,contentFilteredRangeAPI:f}){this.initialized=!1,this.initialLoadComplete=!1,this.commentUIActionListeners=[],this.commentInterruptableCommandListeners=[],this.unprocessedActionPayloads=[],this.onInitialRender=e=>{this.commentStore.dispatch(Yt.x({renderContextType:an.a.None,trackback:595646478,telemetryVisitor:this.telemetryVisitor},{commentId:e.commentId,renderContextType:e.renderContextType})),Object(cn.c)(e.renderContextType)&&this.sendDataReceivedCodeMarker()},this.sendDataReceivedCodeMarker=Object(w.a)(()=>{we.sendCodeMarker({context:this.apiContext,type:De.DataReceived,assertTag:595731293})}),this.getComponentTree=e=>{switch(e){case an.a.None:Object(r.n)(!1,"Unexpected render context type:"+e,589088338);case an.a.FullPane:case an.a.HalfPane:return this.getComponentTreeForRenderMode(A.d.TaskPaneItem);case an.a.DiscreteIntegrated:return this.getComponentTreeForRenderMode(A.d.Integrated);case an.a.DiscreteIsolated:return this.getComponentTreeForRenderMode(A.d.Isolated)}},this.getCommentContainerOwnProps=()=>({commentAPI:this.commentAPI,localizationAPI:this.localizationAPI,peopleAPI:this.peopleAPI,focusManager:this.focusManager,telemetryVisitor:this.telemetryVisitor,onInitialRender:this.onInitialRender,correlationId:this.correlationId,lppManager:this.lppManager}),this.setComponentRef=(e,t,n)=>{this.viewManagerRefRegistry.registerComponent(e,t,n)},this.onSuggestionsDetailsChange=e=>{this.commentStore.dispatch(Yt.db({renderContextType:an.a.None,trackback:592492758,telemetryVisitor:this.telemetryVisitor},e))},this.internalInterruptableCommandHandler=e=>this.activeViewStrategy.handleCommentInterruptableCommand(e,this.commentStore.dispatch,this.commentStore.getState),this.createOrUpdateFilter=e=>{const t=this.contentFilteredRangeAPI;if(!t||!Object(jo.f)(this.commentStore.getState()))return void Object(i.i)().assertConditionTag(!1,"Should not request new filter with gate off",528779338);Object(i.i)().assertConditionTag(!!Object(jo.d)(this.commentStore.getState()),"We should have a default filter already",528779339);const n=function(e){if(function(e){return!(!e.filterState.activeFilterId||e.filterState.activeFilterId===e.filterState.defaultFilterId||!e.filterState.filteredRanges[e.filterState.activeFilterId])&&e.filterState.filteredRanges[e.filterState.activeFilterId].canUpdateFilter}(e))return e.filterState.activeFilterId}(this.commentStore.getState());n?this.updateFilter(n,e):this.createFilter(t,e)},this.updateFilter=(e,t)=>{this.commentStore.dispatch(Yt.Y({renderContextType:an.a.FullPane,telemetryVisitor:this.telemetryVisitor,trackback:528779344},{filterId:e,changes:[{type:"FilterUpdate",updatedFilter:t}]}))},this.createFilter=(e,t)=>{e.createFilteredRange({contentTypes:[A.b.CommentThread],filters:t,supportsFilterUpdates:!0}).then(e=>{this.commentStore.dispatch(Yt.u({renderContextType:an.a.FullPane,telemetryVisitor:this.telemetryVisitor,trackback:528779340},{filteredRange:e,shouldSetActive:!0}))}).catch(Object(jt.a)(528779341))},this.apiContext=e,this.viewProvider=t,this.commentAPI=n,this.peopleAPI=o,this.localizationAPI=a,this.themeAPI=s,this.focusManager=c,this.contentFilteredRangeAPI=f,this.lastInitializationReason=l,this.viewStrategyFactory=p,this.mockUIDriver=h,this.telemetryVisitor=Me.getTelemetryVisitor(this.apiContext),this.correlationId=Me.getCorrelationId(this.apiContext)||Object(D.b)(),this.lppManager=d,this.registerComponentUIActionListener=this.registerComponentUIActionListener.bind(this),this.registerInterruptableCommandListener=this.registerInterruptableCommandListener.bind(this),this.onCommentEventReceived=this.onCommentEventReceived.bind(this),this.onCommentUIAction=this.onCommentUIAction.bind(this),this.onCommentInterruptableCommandReceived=this.onCommentInterruptableCommandReceived.bind(this),this.unregisterComponentUIActionListener=this.unregisterComponentUIActionListener.bind(this),this.unregisterComponentInterruptableCommandListener=this.unregisterComponentInterruptableCommandListener.bind(this),this.onViewContainerEvent=this.onViewContainerEvent.bind(this),this.observeStore=this.observeStore.bind(this),this.onChange=this.onChange.bind(this),this.onFirstLoadComplete=this.onFirstLoadComplete.bind(this),this.getComponentTreeForRenderMode=this.getComponentTreeForRenderMode.bind(this),this.selectionManager=new oi(u,this.telemetryVisitor);const m=u.getState();this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(m.paneState.viewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor),this.commentStore=u,this.discreteIntegratedComponentTree=new rr(an.a.DiscreteIntegrated,this.apiContext),this.discreteIsolatedComponentTree=new rr(an.a.DiscreteIsolated,this.apiContext),this.viewManagerRefRegistry=new Ii,ge.m()&&this.registerActions(),this.observeStore(this.commentStore),this.mockUIDriver&&(this.mockCommentViewHelper=new gi(this,this.mockUIDriver)),this.registerInterruptableCommandListener(this.internalInterruptableCommandHandler)}getMockDriver(){return this.mockUIDriver}refreshAtMentionCapability(){var e,t;(0,this.commentStore.dispatch)((e={renderContextType:an.a.None,trackback:595616912,telemetryVisitor:this.telemetryVisitor},t=this.commentAPI,n=>{const r=Object(i.i)().createActivityObject("ResolveAtMentionCapabilityState",e.telemetryVisitor,i.a.None,i.b.NecessaryServiceDataEvent);return t.checkAtMentionCapability().then(t=>{r.addDataField("AtMentionsEnabled",t,i.d.SystemMetadata),r.successTag(595903522),n(Object(vi.a)(e,t?Un.b.Enabled:Un.b.Disabled))},t=>{r.failTag(595903523,Object(_t.a)(t,-2130957528)),n(Object(vi.a)(e,Un.b.Disabled))})})).catch(Object(jt.a)(595152915))}getCommentStore(){return this.commentStore}getFocusManager(){return this.focusManager}getInitializationReason(){return this.lastInitializationReason}getSelectionManager(){return this.selectionManager}beginInitialization(){var e,t,n;this.initialized||(null===(e=this.contentFilteredRangeAPI)||void 0===e||e.getCapabilities().then(e=>{this.commentStore.dispatch(Yt.Q({renderContextType:an.a.None,trackback:537421135,telemetryVisitor:this.telemetryVisitor},{capabilities:e})),e&&this.createDefaultFilter()}).catch(Object(jt.a)(528779335)),this.commentAPI.registerForCommentEvents(this.onCommentEventReceived),ge.m()||this.registerActions(),void 0!==this.commentAPI.registerForInterruptableCommands&&this.commentAPI.registerForInterruptableCommands(this.onCommentInterruptableCommandReceived),ge.m()&&this.initializeContentExtensions(),this.viewProvider.registerForViewContainerEvents(this.onViewContainerEvent),this.refreshAtMentionCapability(),this.peopleAPI.capabilities&Dt.b.GetSuggestionsDetails&&(this.commentStore.dispatch((t={renderContextType:an.a.None,trackback:592492753,telemetryVisitor:this.telemetryVisitor},n=this.peopleAPI,e=>{if(!(n.capabilities&Dt.b.GetSuggestionsDetails))return Promise.resolve();const r=Object(i.i)().createActivityObject("RefreshSuggestionsDetails",t.telemetryVisitor,i.a.OnSuccess,i.b.NecessaryServiceDataEvent);return n.getSuggestionsDetails?n.getSuggestionsDetails().then(n=>{r.successTag(592492760),e(Object(bi.a)(t,n))},e=>{r.failTag(592492761,-2130957495)}):(r.failTag(592492759,-2130957494),Promise.resolve())})).catch(Object(jt.a)(592492754)),Object(i.i)().assertConditionTag(!!this.peopleAPI.registerForSuggestionsDetailsChanges,"registerForSuggestionsDetailsChanges expected to be defined if capability is set",592492756),this.peopleAPI.registerForSuggestionsDetailsChanges&&this.peopleAPI.registerForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),this.mockCommentViewHelper&&this.mockCommentViewHelper.initialize(),this.initialized=!0)}getTelemetryVisitor(){return this.telemetryVisitor}getAtMentionAuthToken(){return Promise.resolve(void 0)}onChange(e){!this.initialLoadComplete&&e&&void 0===Zt.o(e)&&Zt.k(e)&&this.onFirstLoadComplete()}observeStore(e){let t;return e.subscribe(()=>{const n=e.getState();if(ge.m()){const e=Zt.o(n);e!==t&&(t=e,this.onChange(n))}})}onFirstLoadComplete(){Object(i.i)().assertConditionTag(!this.initialLoadComplete,"Process initial pending actions should only run once.",576570016),this.initialLoadComplete=!0,this.unprocessedActionPayloads.forEach(e=>{this.onCommentUIAction(e)}),this.unprocessedActionPayloads=[],this.mockCommentViewHelper&&this.mockCommentViewHelper.beginProcessing()}registerActions(){this.commentAPI.registerForAction(tt.a.AddComment,this.onCommentUIAction),this.commentAPI.registerForAction(tt.a.NextThread,this.onCommentUIAction),this.commentAPI.registerForAction(tt.a.PreviousThread,this.onCommentUIAction),this.commentAPI.registerForAction(tt.a.DeleteThread,this.onCommentUIAction),this.commentAPI.registerForAction(tt.a.BackKeyPressed,this.onCommentUIAction),this.commentAPI.registerForAction(tt.a.ShowHideCommentPane,this.onCommentUIAction)}createDefaultFilter(){var e;null===(e=this.contentFilteredRangeAPI)||void 0===e||e.createFilteredRange({contentTypes:[A.b.CommentThread],filters:_o,supportsFilterUpdates:!1}).then(e=>{this.commentStore.dispatch(Yt.t({renderContextType:an.a.FullPane,telemetryVisitor:this.telemetryVisitor,trackback:528779336},{filteredRange:e}))}).catch(Object(jt.a)(528779337))}getComponentTreeForRenderMode(e){switch(e){case A.d.Integrated:return this.discreteIntegratedComponentTree;case A.d.Isolated:return this.discreteIsolatedComponentTree;case A.d.TaskPane:case A.d.TaskPaneItem:return en.c(this.getCommentStore().getState())}}getPaneOwnProps(){return Object.assign(Object.assign({},this.getCommentContainerOwnProps()),{selectionManager:this.selectionManager,initializationReason:this.lastInitializationReason,registerComponentUIActionListener:this.registerComponentUIActionListener,registerComponentInterruptableCommandListener:this.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:this.unregisterComponentInterruptableCommandListener,unregisterComponentUIActionListener:this.unregisterComponentUIActionListener,correlationId:this.correlationId,createOrUpdateFilter:this.createOrUpdateFilter})}getHostableCommentCardRendererProps(e){return Object.assign(Object.assign({},this.getCommentContainerOwnProps()),{componentTree:this.getComponentTreeForRenderMode(e),setComponentRef:(t,n)=>{this.setComponentRef(e,t,n)},correlationId:this.correlationId,themeAPI:this.themeAPI})}registerCommentCardHostableComponent(e,t,n){const r=di(ci(n.HostableCommentCardRendererContainer,Object.assign({},this.getHostableCommentCardRendererProps(e))),this.commentStore),o=Si(t,this.apiContext),i=Object(ni.b)().registerComponent(o,r);return i.onComponentCommand.subscribe(t=>{this.processHostableComponentCommand(t,e)}),{componentController:i,contextAwareName:o}}initializeContentExtensions(){Object(Ti.b)("ExtensionAwareCommentPaneContainer").then(e=>{if(void 0!==e){const t=di(ci(e.ExtensionAwareCommentPane,Object.assign(Object.assign({},this.getPaneOwnProps()),{extensionRenderMode:A.d.Integrated,themeAPI:this.themeAPI})),this.commentStore),n=Si("SharedCommentPane",this.apiContext);this.commentPaneComponentController=Object(ni.b)().registerComponent(n,t),ge.C()&&this.commentStore.dispatch(yi({renderContextType:an.a.None,trackback:573384478,telemetryVisitor:this.telemetryVisitor},A.b.CommentThread,n,{renderMode:A.d.TaskPane,priority:A.c.Disabled,instanceId:this.apiContext,componentDimensions:void 0})).catch(Object(jt.a)(573384479))}let t;Object(Ti.b)("HostableCommentCardRendererContainer").then(e=>{if(t=e,void 0!==t){const{componentController:e,contextAwareName:n}=this.registerCommentCardHostableComponent(A.d.Integrated,"DiscreteIntegratedCommentCard",t);this.discreteIntegratedComponentController=e;const{componentController:r,contextAwareName:o}=this.registerCommentCardHostableComponent(A.d.Isolated,"DiscreteIsolatedCommentCard",t);this.discreteIsolatedComponentController=r;const{componentController:i,contextAwareName:a}=this.registerCommentCardHostableComponent(A.d.TaskPaneItem,"TaskPaneItemCommentCard",t);this.commentPaneItemComponentController=i,this.commentStore.dispatch(yi({renderContextType:an.a.None,trackback:574428426,telemetryVisitor:this.telemetryVisitor},A.b.CommentThread,n,{renderMode:A.d.Integrated,priority:A.c.Disabled,instanceId:this.apiContext,componentDimensions:this.getAverageCardSize()})).catch(Object(jt.a)(595645980)),this.commentStore.dispatch(yi({renderContextType:an.a.None,trackback:595616916,telemetryVisitor:this.telemetryVisitor},A.b.CommentThread,o,{renderMode:A.d.Isolated,priority:A.c.Disabled,instanceId:this.apiContext,componentDimensions:this.getAverageCardSize(),isContentAvailable:e=>{const t=this.commentStore.getState(),n=Object(ai.c)(e,Zt.e(t),Zt.b(t)),r=Zt.h(t);return Object(ai.a)(e,Object(ai.b)(e,Zt.c(t),Zt.a(t),n,Zt.g(t,!0),r.drafts[e],Object(ye.G)(r)),r,an.a.DiscreteIsolated,Object(ii.a)(e,an.a.DiscreteIsolated,r))}})).catch(Object(jt.a)(595645982)),this.commentStore.dispatch(yi({renderContextType:an.a.None,trackback:546174344,telemetryVisitor:this.telemetryVisitor},A.b.CommentThread,a,{renderMode:A.d.TaskPaneItem,priority:A.c.Disabled,instanceId:this.apiContext,componentDimensions:this.getAverageCardSize()})).catch(Object(jt.a)(546174345))}}).catch(Object(jt.a)(595645984))}).catch(Object(jt.a)(595645986))}getAverageCardSize(){return{width:si.b,height:Object(si.c)({itemCount:3,readOnly:!1,isTask:!1})}}processHostableComponentCommand(e,t){switch(e.command){case"Focus":return void setTimeout(()=>{var n;return null===(n=this.viewManagerRefRegistry.getComponent(t,e.details.componentInstanceId))||void 0===n?void 0:n.focus()});case"UpdateComponentDataProps":break;default:return void Object(i.i)().assertConditionTag(!1,"Unexpected command type",593786644)}}teardownContentExtensions(){var e,t,n,r;const o=[A.d.Integrated,A.d.Isolated,A.d.TaskPaneItem];ge.C()&&o.push(A.d.TaskPane),this.commentStore.dispatch(Yt.C({renderContextType:an.a.None,trackback:595616917,telemetryVisitor:this.telemetryVisitor},...o)),null===(e=this.commentPaneComponentController)||void 0===e||e.unregister(),null===(t=this.commentPaneItemComponentController)||void 0===t||t.unregister(),null===(n=this.discreteIntegratedComponentController)||void 0===n||n.unregister(),null===(r=this.discreteIsolatedComponentController)||void 0===r||r.unregister()}teardown(){this.initialized&&(this.viewProvider.unregisterForViewContainerEvents(this.onViewContainerEvent),this.commentAPI.unregisterForCommentEvents(this.onCommentEventReceived),this.commentAPI.unregisterForAction(tt.a.AddComment),this.commentAPI.unregisterForAction(tt.a.NextThread),this.commentAPI.unregisterForAction(tt.a.PreviousThread),this.commentAPI.unregisterForAction(tt.a.DeleteThread),this.commentAPI.unregisterForAction(tt.a.BackKeyPressed),this.commentAPI.unregisterForAction(tt.a.ShowHideCommentPane),void 0!==this.commentAPI.unregisterForInterruptableCommands&&this.commentAPI.unregisterForInterruptableCommands(this.onCommentInterruptableCommandReceived),this.peopleAPI.capabilities&Dt.b.GetSuggestionsDetails&&(Object(i.i)().assertConditionTag(!!this.peopleAPI.unregisterForSuggestionsDetailsChanges,"unregisterForSuggestionsDetailsChanges should be defined if capability is set",592492757),this.peopleAPI.unregisterForSuggestionsDetailsChanges&&this.peopleAPI.unregisterForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),ge.m()&&this.teardownContentExtensions(),this.initialized=!1)}registerComponentUIActionListener(e){this.commentUIActionListeners.push(e)}unregisterComponentUIActionListener(e){const t=this.commentUIActionListeners.indexOf(e);t>-1&&this.commentUIActionListeners.splice(t,1)}registerInterruptableCommandListener(e){this.commentInterruptableCommandListeners.push(e)}unregisterComponentInterruptableCommandListener(e){const t=this.commentInterruptableCommandListeners.indexOf(e);t>-1&&this.commentInterruptableCommandListeners.splice(t,1)}onCommentUIAction(e){if(ge.m()&&e.actionBehavior===Ot.a.Execute&&(this.initialized||this.beginInitialization(),!this.initialLoadComplete))return this.unprocessedActionPayloads.push(e),!0;for(const t of this.commentUIActionListeners){const n=t(e);if(n!==ri.a.NotHandled)return n===ri.a.Success}return this.activeViewStrategy.processCommentUIAction(e,this.commentStore.dispatch,this.commentStore.getState)===ri.a.Success}onCommentEventReceived(e,t){const n=Object(r.k)(r.c.Comments,qe.a[e]);this.activeViewStrategy.processCommentEvent(e,t,this.commentStore.dispatch,this.commentStore.getState),null==n||n.end(),ge.m()&&!this.initialLoadComplete&&e===qe.a.CommentContextChanged&&$e.b(t)&&0===t.numberOfComments&&this.onFirstLoadComplete()}onCommentInterruptableCommandReceived(e){const t=Promise.resolve(h.a.Unhandled);return this.commentInterruptableCommandListeners.reduce((t,n)=>t.then(t=>t!==h.a.Unhandled?Promise.resolve(t):n(e)),t)}onViewContainerEvent(e){const t=this.commentStore.dispatch;switch(e.eventType){case Nt.a.VisibilityChanged:return void t(Yt.gb({renderContextType:an.a.None,trackback:592241221,telemetryVisitor:this.telemetryVisitor},e.viewContainerVisibilityState));case Nt.a.ViewContainerChanged:return t(Yt.eb({renderContextType:an.a.None,trackback:595616919,telemetryVisitor:this.telemetryVisitor},e.newViewContainer)),void(this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(e.newViewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor));case Nt.a.FocusTriggered:return void(ge.C()?setTimeout(()=>{this.focusManager.focusCommentPaneCommand(en.c(this.commentStore.getState()))}):this.focusManager.focusCommentPaneCommand(en.c(this.commentStore.getState())));case Nt.a.FoldableLayoutStateChanged:t(Yt.fb({renderContextType:an.a.None,trackback:591660549,telemetryVisitor:this.telemetryVisitor},e.newFoldableLayoutState))}}}{constructor(e){super(e),e.initializeImmediately&&this.beginInitialization()}refreshAtMentionAuthToken(){}}var Ei=n(167);n(277);var Pi=n(229);const ki={android:"Android",macos:"Mac",web:"Web",win32:"Win32",ios:"iOS"},Ri={android:"OfficeAndroid",macos:void 0,web:"OfficeWebApps",win32:"OfficeWin32",ios:"OfficeiOS"};let xi={};class Di{constructor(e,t){this.online=!1,this.initialized=!1,this.refreshLPPAuthToken=()=>this.peopleAPI.getAuthToken(Dt.c.Loki),this.peopleAPI=e,this.correlationId=t,ge.V(),this.accountId=Object(D.b)()}getAccountID(){return this.accountId}getLPPController(){if(this.isInitialized())return Ei.c}ensureLPPController(){return this.isInitialized()||this.initializeController(!1),Ei.c}initializeController(e){let t=e&&!this.online;this.isInitialized()||(this.online=e||this.online,this.initializeLPP(),this.initialized=!0,t=this.online),t&&(Ei.c.switchToOnlineMode(this.accountId),this.online=!0)}isInitialized(){return this.initialized}isOnline(){return this.online}refreshLPPController(){this.online=!0,this.initialized=!0,this.initializeLPP(),Ei.c.switchToOnlineMode(this.accountId)}initializeLPP(){var e;Ei.c.start(this.accountId,Object.assign(Object.assign(Object.assign({},(e=>{const t=e.getMetadata();return{clientType:Ri.win32,hostAppName:t.appName,hostAppPlatform:ki.win32,hostAppRing:t.releaseAudienceGroup||t.ring||t.releaseAudience,hostAppVersion:t.appVersion,complianceEnvironment:t.sovereignEnvironmentName?Object(Pi.d)(t.sovereignEnvironmentName):"Prod"}})(Object(i.i)())),xi),{complianceEnvironment:ge.Q()?void 0:"Prod",clientCorrelationId:this.correlationId,hostAppSupportsLogging:!0,refreshAuthToken:this.refreshLPPAuthToken,offline:!this.online,enableVerboseLogging:ge.s(),getLokiEndpoint:null===(e=this.peopleAPI.getLokiUrl)||void 0===e?void 0:e.bind(this.peopleAPI)}))}}var wi=n(243);class Ai{constructor(){this.maxAcceptableInterval=3e3,this.lastHeartbeatReceived=0,this.timerStarted=!1}heartbeatReceived(){var e,t;this.lastHeartbeatReceived=Date.now(),null===(t=(e=Object(i.i)()).logDiagnosticTrace)||void 0===t||t.call(e,ze.a`Native HeartbeatReceived`,540361865,i.h.Info,i.c.ProductServiceUsage,Object(i.j)(i.g.ReviewedAsNotNecessary),Object(i.l)("HeartbeatTimestamp",this.lastHeartbeatReceived,i.d.SystemMetadata)),this.timerStarted||(this.timerStarted=!0,setInterval(()=>{this.checkHeartbeatInterval()},this.maxAcceptableInterval))}checkHeartbeatInterval(){const e=Date.now()-this.lastHeartbeatReceived;e>this.maxAcceptableInterval&&Object(i.i)().assertConditionTag(!1,"Max heartbeat interval exceeded: "+e,561071552)}}var ji=n(80),_i=n(164),Fi=n(202),Mi=n(165),Ni=n(141),Li=n(113);function Bi(e){return function(e){const t=ge.m()&&!en.b(e);return Zt.f(e).nextPopulatedContextDetails!==In.a.NoComments||Object(ye.d)(Zt.e(e),Zt.c(e),t)}(e)&&Hi(Zt.h(e))}function Hi(e){return ge.y()||!Object(ve.d)(e)}class Ui{constructor(e,t,n,r,o){this.localizationAPI=e,this.peopleAPI=t,this.commentAPI=n,this.selectionManager=r,this.telemetryVisitor=o,this.getDraftRenderContextType=Zt.w(),this.getRenderableItems=Zt.x()}processCommentEvent(e,t,n,r){var o;const a=r();switch(e){case qe.a.CommentContextChanged:if(!$e.b(t))return void Object(i.i)().assertConditionTag(!1,"Invalid eventPayload",595912090);n(Yt.n({renderContextType:an.a.None,trackback:595912089,telemetryVisitor:this.telemetryVisitor},t));break;case qe.a.CommentsChanged:if(!$e.h(t))return void Object(i.i)().assertConditionTag(!1,"Invalid eventPayload",595912091);break;case qe.a.LoadComments:if(!$e.i(t))return void Object(i.i)().assertConditionTag(!1,"Invalid eventPayload",595912092);break;case qe.a.CommentSelected:if(!$e.g(t))return void Object(i.i)().assertConditionTag(!1,"Invalid eventPayload",595912096);if(t.commentId){let e;if(void 0!==Zt.b(a)[t.commentId])e=Object(Mi.a)(t.commentId,be.a.Canvas,{selectType:t.selectionReason&&"ContentNavigation"===t.selectionReason.type&&t.selectionReason.contentNavigationReason===Re.c.Keyboarding?Yt.b.SelectCard:Yt.b.ExpandCard});else{const n=Object(tn.b)(Zt.c(a),t.commentId);if(void 0===n)return;e=Object(Mi.a)(n.parentId,be.a.Canvas,{selectType:Yt.b.SelectPost,selectedPost:t.commentId})}n(Object(Mi.b)(void 0,{renderContextType:an.a.None,trackback:579744149,telemetryVisitor:this.telemetryVisitor},e,!1)).catch(Object(jt.a)(579744150))}else n(Yt.j({renderContextType:an.a.None,trackback:595912095,telemetryVisitor:this.telemetryVisitor}));break;case qe.a.CommentContextReload:if(!$e.d(t))return void Object(i.i)().assertConditionTag(!1,"Invalid eventPayload",595912097);break;case qe.a.CommentHighlighted:if(!$e.f(t))return void Object(i.i)().assertConditionTag(!1,"Invalid eventPayload",595912128);t.commentId?n(Yt.s({renderContextType:an.a.None,trackback:595912098,telemetryVisitor:this.telemetryVisitor},t.commentId,be.a.Canvas)):n(Yt.i({renderContextType:an.a.None,trackback:578586723,telemetryVisitor:this.telemetryVisitor},be.a.Canvas,void 0));break;case qe.a.NextPopulatedContextDetailsUpdated:if(!$e.k(t)||!t.contextDetails.nextPopulatedContextDetails)return void Object(i.i)().assertConditionTag(!1,"Invalid eventPayload",595912130);n(Yt.w({renderContextType:an.a.None,trackback:595912129,telemetryVisitor:this.telemetryVisitor},t.contextDetails.nextPopulatedContextDetails));break;case qe.a.ModelCapabilitiesChanged:$e.j(t)?n(Yt.ab({renderContextType:an.a.None,trackback:595685376,telemetryVisitor:this.telemetryVisitor},t.modelCapabilityFlags,t.richTextCapabilityFlags)):Object(i.i)().assertConditionTag(!1,"Invalid eventPayload",595616784);break;case qe.a.CommentError:if(!$e.e(t))return void Object(i.i)().assertConditionTag(!1,"Invalid eventPayload",595912131);break;case qe.a.ReturnToDraftRequested:$e.l(t)&&n(Yt.q({draftWarningType:Lo.a.ReturnToDraft,draftWarningReason:Li.a.HostRequest},{renderContextType:an.a.None,trackback:593376912,telemetryVisitor:this.telemetryVisitor}));break;case qe.a.UpdateDraftThread:$e.n(t)?n(Yt.W({renderContextType:an.a.None,trackback:594023371,telemetryVisitor:this.telemetryVisitor},t)):Object(i.i)().assertConditionTag(!1,"Invalid eventPayload",594023372);break;case qe.a.SmartReplyPopulated:if(!$e.m(t))return void Object(i.i)().assertConditionTag(!1,"Invalid eventPayload for smart replies",590202467);n(Yt.y({renderContextType:an.a.None,trackback:590202466,telemetryVisitor:this.telemetryVisitor},t));break;case qe.a.NativeHeartbeat:this.heartbeatHelper||(this.heartbeatHelper=new Ai),null===(o=this.heartbeatHelper)||void 0===o||o.heartbeatReceived();break;default:return void Object(i.i)().assertConditionTag(!1,"Deprecated event detected.",595912132)}}processCommentUIAction(e,t,n,r){const o=n();switch(e.actionType){case tt.a.ShowHideCommentPane:return ri.c(e.actionBehavior)?en.b(o)?ri.a.Success:ri.a.Fail:(ri.d(e.actionBehavior)&&(en.b(o)?t(Yt.D({renderContextType:an.a.None,trackback:595912133,telemetryVisitor:this.telemetryVisitor})):t(Yt.J({renderContextType:an.a.None,trackback:595912134,telemetryVisitor:this.telemetryVisitor}))),ri.a.Success);case tt.a.AddComment:if(ri.b(e.actionBehavior)){if(a=Zt.h(o),!ge.y()&&(Object(ve.d)(a)||a.committedLieId))return ri.a.Fail}else if(ri.d(e.actionBehavior)){const e={renderContextType:an.a.None,trackback:595146382,telemetryVisitor:this.telemetryVisitor};return t(Object(_i.a)(e,this.commentAPI,{sessionType:"CREATE"},!(!r||!r.retainSelectionOnAddComment),this.peopleAPI)).catch(Object(jt.a)(592314376)),ri.a.Success}return ri.a.Success;case tt.a.NextThread:if(Object(i.i)().assertConditionTag(!ri.c(e.actionBehavior),"This action type does not support toggled status",595899713),ri.d(e.actionBehavior))this.handleActionOrReturnToDraft(()=>this.selectionManager.selectNextOrPreviousThread({direction:Re.d.Next,source:be.a.SharedComments,expandCard:!0,iterableContentTypes:[A.b.CommentThread]},Re.c.HostAction,an.a.None),t,ge.Y()?void 0:Li.a.NextThread,591729749);else if(ri.b(e.actionBehavior))return Bi(o)?ri.a.Success:ri.a.Fail;return ri.a.Success;case tt.a.PreviousThread:if(Object(i.i)().assertConditionTag(!ri.c(e.actionBehavior),"This action type does not support toggled status",595899714),ri.d(e.actionBehavior))this.handleActionOrReturnToDraft(()=>this.selectionManager.selectNextOrPreviousThread({direction:Re.d.Previous,source:be.a.SharedComments,expandCard:!0,iterableContentTypes:[A.b.CommentThread]},Re.c.HostAction,an.a.None),t,ge.Y()?void 0:Li.a.PreviousThread,591729750);else if(ri.b(e.actionBehavior))return Bi(o)?ri.a.Success:ri.a.Fail;return ri.a.Success;case tt.a.DeleteThread:if(Object(i.i)().assertConditionTag(!ri.c(e.actionBehavior),"This action type does not support toggled status",595899715),ri.b(e.actionBehavior)){if(!function(e){return!!e.selectedComment&&Hi(e.draftState)}(o.commentState))return ri.a.Fail}else ri.d(e.actionBehavior)&&this.handleActionOrReturnToDraft(()=>{const e=Zt.r(o);e&&t(Yt.F({renderContextType:an.a.None,trackback:591738706,telemetryVisitor:this.telemetryVisitor},e.selectedCardId))},t,Li.a.DeleteThread,591729751);return ri.a.Success}var a;return ri.a.NotHandled}beginDraftingHelper(e,t,n,r){return e(Object(_i.a)({renderContextType:an.a.None,trackback:n,telemetryVisitor:this.telemetryVisitor},this.commentAPI,t,!1,this.peopleAPI)).catch(Object(jt.a)(r)).then(()=>ui.f.Handled)}handleCommentInterruptableCommand(e,t,n){switch(e.type){case"CreateComment":return this.beginDraftingHelper(t,{sessionType:"CREATE"},574371082,574371083);case"EditComment":{const r=n(),o=this.getRenderableItems(r),a=Zt.r(r),s=Object(kn.b)(o,e.commentId);return s?Object(pi.K)({comment:s,threads:o,selectedComment:a,warningType:Xt.a.Edit})?(t(Yt.S({renderContextType:an.a.None,telemetryVisitor:this.telemetryVisitor,trackback:593000206},e.commentId,Xt.a.Edit)),Promise.resolve(ui.f.Handled)):this.beginDraftingHelper(t,{sessionType:"EDIT",commentId:e.commentId},593000207,593000208):(Object(i.i)().assertConditionTag(!1,"Comment not found",593000205),Promise.resolve(ui.f.Handled))}case"ReplyComment":return this.beginDraftingHelper(t,{sessionType:"REPLY",threadId:e.threadId},593000209,593000210);case"DiscardDraft":{const r=n();if(e.mode===wi.a.TryAutoDiscard)return t(Object(Fi.a)({renderContextType:an.a.None,telemetryVisitor:this.telemetryVisitor,trackback:575411521},be.a.Canvas)).then(e=>e.draftDiscardResult);const o=Zt.r(r);if(e.mode===wi.a.Dialog&&Object(Ni.a)(Zt.h(r))===ji.a.CannotAutoDiscard)return en.a(r)?Promise.resolve(ui.f.Unhandled):Promise.resolve(ui.f.Canceled);const i=Object(fi.b)(en.e(r)===Pn.a.Visible,Object(Gn.a)(en.d(r).containerType),Zt.h(r),o,Zt.s(r));return t(Object(Jo.a)({renderContextType:an.a.None,telemetryVisitor:this.telemetryVisitor,trackback:575411522},be.a.Canvas,i,void 0))}default:return Promise.resolve(ui.f.Unhandled)}}handleActionOrReturnToDraft(e,t,n,r){t(Object(Fi.a)({renderContextType:an.a.None,trackback:r,telemetryVisitor:this.telemetryVisitor},be.a.SharedComments,n)).then(t=>{void 0!==n&&t.draftDiscardBehavior!==ji.a.NoDraft&&t.draftDiscardResult!==ui.f.Handled||e()}).catch(Object(jt.a)(591738704))}}var Vi=n(263),Wi=n(264),zi=n(266),Ki=n(62),Gi=n(272),qi=n(273);function $i(e,t,n,r){return(o,i)=>{const a=i();r&&o(r);const s=r?r.actionDetail.telemetryVisitor:t;if(n){if(void 0!==n.topVisibleThreadId&&o(Object(Gi.a)({renderContextType:e,telemetryVisitor:s,trackback:595953696},n.topVisibleThreadId||void 0)),void 0!==n.selectedCommentId){const t=Zt.r(a);if(n.selectedCommentId)if(t&&t.selectedCardId===n.selectedCommentId)if(Object(Xt.j)(t.selectionDetails)){const r=t.selectionDetails.selectedPostId,a=i();Object(tn.b)(Zt.c(a),r)?o(Object(Ki.b)({renderContextType:e,telemetryVisitor:s,trackback:595953698},n.selectedCommentId,r,Ki.a.SelectPost,be.a.Canvas)):o(Object(Ki.b)({renderContextType:e,telemetryVisitor:s,trackback:595953699},n.selectedCommentId,void 0,Ki.a.ExpandCard,be.a.Canvas))}else o(Object(Ki.b)({renderContextType:e,telemetryVisitor:s,trackback:595953697},n.selectedCommentId,void 0,Ki.a.SelectCard,be.a.Canvas));else o(Object(Ki.b)({renderContextType:e,telemetryVisitor:s,trackback:595953728},n.selectedCommentId,void 0,Ki.a.ExpandCard,be.a.Canvas));else if(t){const n=Zt.h(a),r=n.cardIdToDraftIdMap[t.selectedCardId];r&&"CREATE"===n.drafts[r].commentDraft.sessionConfiguration.sessionType||o(Object(Wi.a)({renderContextType:e,telemetryVisitor:s,trackback:595953729}))}}void 0!==n.highlightedCommentId&&(n.highlightedCommentId?o(Object(zi.a)({renderContextType:e,telemetryVisitor:s,trackback:595953730},n.highlightedCommentId,be.a.Canvas)):o(Object(Vi.a)({renderContextType:e,telemetryVisitor:s,trackback:578586722},be.a.Canvas,void 0)));const t=er(n);t&&o(Object(qi.a)({renderContextType:e,telemetryVisitor:s,trackback:595953732},t))}}}var Yi=n(10),Ji=n(181);var Qi=n(267),Xi=n(268);function Zi(e,t,n){return r=>{$e.o(t)?r(Object(Xi.a)(Object(Yi.a)(e,595137280),t.threads)):(ge.A()&&r(Object(Ji.a)(Object(Yi.a)(e,595137282),t.comments,t.tasks,n)),r(Object(Qi.a)(Object(Yi.a)(e,595137283),t.comments,t.tasks)))}}class ea{constructor(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.focusManager=n,this.telemetryVisitor=r}processCommentEvent(e,t,n,r){switch(e){case qe.a.CommentsChanged:$e.h(t)&&n($i(an.a.None,this.telemetryVisitor,t.contextDetails,Object(Yt.d)({renderContextType:an.a.None,trackback:595937042,telemetryVisitor:this.telemetryVisitor},t.changes)));break;case qe.a.LoadComments:$e.i(t)&&n(Zi({renderContextType:an.a.None,trackback:595899532,telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI));break;case qe.a.CommentContextReload:$e.d(t)&&n((o={renderContextType:an.a.None,trackback:595899533,telemetryVisitor:this.telemetryVisitor},a=t,s=this.peopleAPI,c=this.telemetryVisitor,(e,t)=>{let n=[];Object($e.c)(a)?(Object(i.i)().assertConditionTag(!t||Zt.n(t()).virtualized,"contextReloadThunk's payload should only include comment ids when state is virtualized",595162893),n=Object(qn.a)(a.commentIds,()=>t().commentState)):n=a.comments;const r=Object($e.c)(a)?[]:a.tasks;e($i(o.renderContextType,c,a.contextDetails,Object(Yt.B)(Object(Yi.a)(o,595953694),{comments:n,tasks:r}))),ge.A()&&e(Object(Ji.a)(Object(Yi.a)(o,595932895),n,r,s)).catch(Object(jt.a)(595645974))}))}var o,a,s,c;this.commonViewStrategy.processCommentEvent(e,t,n,r)}processCommentUIAction(e,t,n){if(e.actionType===ui.d.AddComment&&e.actionBehavior!==ui.a.CheckEnabled){const e=n();en.b(e)&&this.focusManager.onUserAction(e.paneState.componentTree,{userAction:Sn.a.RequestNewCommentFromHost})}return this.commonViewStrategy.processCommentUIAction(e,t,n)}handleCommentInterruptableCommand(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)}}var ta=n(269);class na{constructor(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.lastInitializationReason=n,this.telemetryVisitor=r}processCommentEvent(e,t,n,o){switch(e){case qe.a.CommentsChanged:$e.h(t)&&n((a=t,s=this.telemetryVisitor,(e,t)=>{var n;const o=t();let c=!1,d=a.contextDetails;if(""===(null==d?void 0:d.selectedCommentId)&&(d=Object.assign(Object.assign({},d),{selectedCommentId:void 0})),e($i(an.a.None,s,d,Object(Yt.d)({renderContextType:an.a.None,trackback:595953743,telemetryVisitor:s},a.changes))),a.contextDetails&&a.contextDetails.selectedCommentId)return;const l=Zt.r(o),h=l?l.selectedCardId:void 0,f=t(),m=Zt.r(f),g=Zt.e(o),b=Zt.e(f);if(h){if(h&&a.changes.some(e=>e.type===mt.a.Delete&&e.model.commentId===h)){let t;if(Object(tn.f)(g)){const e=Zt.a(o),n=[];let i=0;t=-1;for(let r=0;r<g.length;r++)n.push(i),i+=e[g[r]].length,g[r]===h&&(t=r);for(const e of a.changes)switch(e.type){case mt.a.Insert:let o;for(o=n.length-1;o>=0&&e.index<=n[o];o--)n[o]+=1;Object(rt.a)(e.model)&&(o<t&&++t,n.splice(o+1,0,e.index));break;case mt.a.Delete:let i;for(i=n.length-1;i>=0;i--){if(!(e.index<n[i])){e.index===n[i]&&(i<t&&--t,n.splice(i,1));break}n[i]-=1}break;case mt.a.Modify:case mt.a.Unknown:case mt.a.Load:break;default:Object(r.m)(e)}}else{t=g.findIndex(e=>e.commentId===h);for(const e of a.changes)switch(e.type){case mt.a.Insert:e.index<=t&&++t;break;case mt.a.Delete:e.index<t&&--t;break;case mt.a.Modify:case mt.a.Unknown:case mt.a.Load:break;default:Object(r.m)(e)}}if(m)throw new u.a(p.m,589103626,-2130957551);if(b.length){let n=t;n===b.length&&(n-=1);const r=Object(tn.f)(b)?b[n]:Object(rt.b)(b[n]);e(Object(Yt.M)({renderContextType:an.a.None,trackback:595953744,telemetryVisitor:s},r,void 0,Ki.a.ExpandCard,be.a.SharedComments)),c=!0}}}else!g.length&&b.length&&(e(Object(Yt.M)({renderContextType:an.a.None,trackback:595947723,telemetryVisitor:s},Object(tn.f)(b)?b[0]:b[0].commentId,void 0,Ki.a.ExpandCard,be.a.SharedComments)),c=!0);Object(i.i)().assertConditionTag(c||0===b.length||""!==(null===(n=a.contextDetails)||void 0===n?void 0:n.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in applyCommentChangesAndPreserveSelectionPositionThunk",590991767)}));break;case qe.a.LoadComments:$e.i(t)&&(o().paneState.initializationStatus===pe.a.Initialized||this.lastInitializationReason!==te.a.NewThread?n(function(e,t,n,r){return(o,i)=>{o(Zi({renderContextType:e,trackback:595899530,telemetryVisitor:r},t,n));const a=i(),s=Zt.n(a).virtualized,c=Zt.c(a);!Object(tn.c)(c)&&Object(Jt.a)({commentData:c,pendingCommentLoad:Zt.o(a),virtualized:s})&&c.length&&!Zt.r(a)&&o(Object(Yt.M)({renderContextType:e,trackback:595953680,telemetryVisitor:r},c[0].commentId,void 0,Ki.a.ExpandCard,be.a.SharedComments))}}(an.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor)):n(Zi({renderContextType:an.a.None,trackback:595899531,telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI)));break;case qe.a.CommentContextReload:$e.d(t)&&n(function(e,t,n,r){return(o,a)=>{var s,c;const d=a();let l=!1,u=[];Object($e.c)(t)?(Object(i.i)().assertConditionTag(Zt.n(d).virtualized,"reloadCommentsAndPreserveSelectionPositionThunk's payload should only include comment ids when state is virtualized",595162891),u=Object(qn.a)(t.commentIds)):u=t.comments;let p=t.contextDetails;""===(null==p?void 0:p.selectedCommentId)&&(p=Object.assign(Object.assign({},p),{selectedCommentId:void 0}));const h=Object($e.c)(t)?[]:t.tasks;o($i(e,r,p,Object(ta.a)({renderContextType:e,telemetryVisitor:r,trackback:595953677},{comments:u,tasks:h}))),ge.A()&&o(Object(Ji.a)({renderContextType:e,telemetryVisitor:r,trackback:595162892},u,h,n)).catch(Object(jt.a)(595645962));const f=null===(s=Zt.r(d))||void 0===s?void 0:s.selectedCardId,m=Zt.e(d),g=a(),b=Zt.e(g);if(f){if(!Zt.r(g)){const t=Object(tn.f)(m)?m.findIndex(e=>e===f):m.findIndex(e=>e.commentId===f);if(t<0)return;if(b.length){let n=t;n===b.length&&(n-=1);const i=Object(tn.f)(b)?b[n]:Object(rt.b)(b[n]);o(Object(Yt.M)({renderContextType:e,telemetryVisitor:r,trackback:595953678},i,void 0,Ki.a.ExpandCard,be.a.SharedComments)),l=!0}}}else!m.length&&b.length&&(o(Object(Yt.M)({renderContextType:e,telemetryVisitor:r,trackback:595947722},Object(tn.f)(b)?b[0]:b[0].commentId,void 0,Ki.a.ExpandCard,be.a.SharedComments)),l=!0);Object(i.i)().assertConditionTag(l||0===b.length||""!==(null===(c=t.contextDetails)||void 0===c?void 0:c.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in reloadCommentsAndPreserveSelectionPositionThunk",590991766)}}(an.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor))}var a,s;this.commonViewStrategy.processCommentEvent(e,t,n,o)}processCommentUIAction(e,t,n){return this.commonViewStrategy.processCommentUIAction(e,t,n,{retainSelectionOnAddComment:!0})}handleCommentInterruptableCommand(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)}}class ra{createViewStrategy(e,t,n,r,o,i,a,s){const c=new Ui(t,n,r,o,s);switch(e.containerType){case Z.a.HalfPane:return new na(c,n,a,s);case Z.a.FullPane:return new ea(c,n,i,s)}}}r.d.enableStackLogging=!0,r.d.enableMessageLogging=!0,Object(R.b)(),Fe=function(e){const t=e.apiContext,n=e.peopleAPI||function(e){return new Mt(e)}(t),r=Object(Re.f)(t),o=Object(ke.e)(t)?Object(ke.d)(t):void 0,i=e.viewContainerProvider||function(e,t,n,r){return new qt(e,t,n,r)}(t,e.displayMode,e.foldableLayoutState),a=e.localizationAPI||Object(m.a)(),s=e.themeAPI||O();let c;c=e.hostCommentAPI?new We(e.hostCommentAPI):function(e){const t=Me.getTelemetryVisitor(e),n=new xt(t),r=new Qe(n,e);return new We(r)}(t);const d=Me.getTelemetryVisitor(e.apiContext),l=new An(a.getLocaleInfo().isRightToLeft,d),u=new Di(n,e.correlationId||"");ge.r()&&u.initializeController(!1);const p=ti(c,0,uo(i.getViewContainer(),e.paneVisible,a.getLocaleInfo(),t),d,r,a,l,u,o);return new Oi({apiContext:t,viewProvider:i,commentAPI:c,peopleAPI:n,localizationAPI:a,themeAPI:s,focusManager:l,lppManager:u,initializationReason:e.initializationReason,commentStore:p,viewStrategyFactory:new ra,initializeImmediately:e.initializeImmediately,mockUIDriver:e.mockDriver,contentFilteredRangeAPI:o})},c.ReactNativeReka.init(),Object(o.b)(),Object(i.k)(Le),ge.p()&&Me.ensureInitialized(),f.register(),Object(m.b)(),R.a&&Object(a.t)({logFocusDebugInfo:r.i}),s.AppRegistry.registerComponent("CommentHostNative",()=>Ne),O(),Object(E.b)({announceToScreenReader:e=>{P.AccessibilityInfo&&e&&P.AccessibilityInfo.announceForAccessibility(e)}})},function(e,t,n){"use strict";n.r(t),n.d(t,"makeMapStateToProps",(function(){return y})),n.d(t,"HostableCommentCardRendererContainer",(function(){return v}));var r=n(8),o=n(0),i=n(14),a=n(89),s=n(5),c=n(185),d=n(93),l=n(6),u=n(413),p=n(414),h=n(1),f=n(299),m=n(34),g=n(227),b=n(187);class C extends h.PureComponent{constructor(e){super(e),this.getDiagnosticDataFields=()=>{var e;return[Object(o.l)("IsResourceAvailable",this.props.isResourceAvailable,o.d.SystemMetadata),Object(o.l)("IsContentExtensionEnabled",this.props.isExtensionEnabled,o.d.SystemMetadata),Object(o.l)("RenderContextType",this.props.componentTree.componentTreeId.renderContextType,o.d.SystemMetadata),Object(o.l)("CommentId",null!==(e=this.props.threadId)&&void 0!==e?e:"",o.d.SystemMetadata)]},this.getUpdatedResource=Object(u.a)((e,t)=>Object.assign(Object.assign({},e),{id:t})),this.createTelemetryContext=Object(u.a)(b.b),this.getAccessibilitySetProperties=Object(u.b)(e=>{var t,n,r;return{accessibilityPositionInSet:null===(t=null==e?void 0:e.setItem)||void 0===t?void 0:t.positionInSet,accessibilitySetSize:null===(n=null==e?void 0:e.setItem)||void 0===n?void 0:n.setSize,accessibilitySetLevel:null===(r=null==e?void 0:e.setItem)||void 0===r?void 0:r.level}},()=>[this.props.accessibilityMetadata]),this.state={keyIter_deprecated:0}}componentDidUpdate(e){var t,n;e.isResourceAvailable!==this.props.isResourceAvailable&&(null===(n=(t=Object(o.i)()).logDiagnosticTrace)||void 0===n||n.call(t,p.a`HostableComponentResourceAvailabilityUpdated`,554717322,o.h.Info,o.c.ProductServiceUsage,this.props.telemetryVisitor,...this.getDiagnosticDataFields()))}componentDidMount(){var e,t;null===(t=(e=Object(o.i)()).logDiagnosticTrace)||void 0===t||t.call(e,p.a`HostableComponentMount`,554717323,o.h.Info,o.c.ProductServiceUsage,this.props.telemetryVisitor,...this.getDiagnosticDataFields())}componentWillUnmount(){var e,t;null===(t=(e=Object(o.i)()).logDiagnosticTrace)||void 0===t||t.call(e,p.a`HostableComponentUnmount`,554717324,o.h.Info,o.c.ProductServiceUsage,this.props.telemetryVisitor,...this.getDiagnosticDataFields())}render(){if(!this.props.isResourceAvailable||!this.props.resource||!this.props.threadId)return null;if(!this.props.isExtensionEnabled)return r.b?h.createElement(m.a,{textStylePolyester:"MediumBold"},"Debug Error: This comment card's extension is disabled."):null;const e=this.getUpdatedResource(this.props.resource,this.props.threadId),t=this.getAccessibilitySetProperties(),n=h.createElement(g.a,{api:this.props.themeAPI},h.createElement(f.a,Object.assign({commentAPI:this.props.commentAPI,focusManager:this.props.focusManager,localizationAPI:this.props.localizationAPI,peopleAPI:this.props.peopleAPI,resource:e,telemetryVisitor:this.props.telemetryVisitor,componentRef:this.props.componentRef,componentTree:this.props.componentTree,maximumDimensions:this.props.maximumDimensions,onInitialRender:this.props.onInitialRender,setComponentRef:this.props.setComponentRef,isVirtualized:this.props.isVirtualized,componentInstanceId:this.props.componentInstanceId,correlationId:this.props.correlationId,lppManager:this.props.lppManager,accessibilityMetadata:this.props.accessibilityMetadata},t)));return h.createElement(b.a.Provider,{value:this.createTelemetryContext(this.props.telemetryVisitor)},n)}}const y=()=>{const e=d.e(),t=d.c(),n=d.n(e=>s.g(e,!0),e=>s.i(e,!0),e,t),a=d.a(),u=d.g(),p=d.d(n,a),h=d.o(p);return(e,t)=>{var a;const d=n(e,t),p=d.thread.length?d.thread[0].commentId:null===(a=t.resource)||void 0===a?void 0:a.id,f=t.componentTree.componentTreeId.renderContextType;let m=void 0;switch(f){case l.a.FullPane:m={renderMode:i.d.TaskPaneItem};break;case l.a.DiscreteIntegrated:m={renderMode:i.d.Integrated};break;case l.a.DiscreteIsolated:p&&(m={renderMode:i.d.Isolated,threadId:p});break;case l.a.HalfPane:case l.a.None:Object(o.i)().assertConditionTag(!1,"Invalid RenderContextType for HostableComponent received.",593822914);break;default:Object(r.m)(f)}const g=c.c(e,m);return{isResourceAvailable:h(e,t),modelCapabilities:s.n(e),isDraftThread:u(e,t),isExtensionEnabled:g,threadId:p}}},v=Object(a.connect)(y)(C)},function(e,t,n){"use strict";n.r(t);var r,o=n(218),i=n.n(o),a=n(293),s=n.n(a),c=n(56),d=n.n(c),l=n(101),u=n.n(l),p=n(102),h=n.n(p),f=n(118),m=n.n(f),g=n(161),b=n.n(g),C=n(182),y=n.n(C),v=n(138),T=n.n(v),S=n(1),I=n.n(S),O=n(47),E=n.n(O),P=n(9);var k=function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=arguments.length>3?arguments[3]:void 0,a="number"==typeof o?i:o,s="number"==typeof o?o:-1;if(0===s)return!0;if(t===n)return!1;if("function"==typeof t&&"function"==typeof n){var c=null==a?void 0:a.unsafelyIgnoreFunctions;return null==c&&(!r||!r.onDifferentFunctionsIgnored||a&&"unsafelyIgnoreFunctions"in a||r.onDifferentFunctionsIgnored(t.name,n.name),c=!0),!c}if("object"!=typeof t||null===t)return t!==n;if("object"!=typeof n||null===n)return!0;if(t.constructor!==n.constructor)return!0;if(Array.isArray(t)){var d=t.length;if(n.length!==d)return!0;for(var l=0;l<d;l++)if(e(t[l],n[l],s-1,a))return!0}else{for(var u in t)if(e(t[u],n[u],s-1,a))return!0;for(var p in n)if(void 0===t[p]&&void 0!==n[p])return!0}return!1},R=n(316),x=n(166),D=["numColumns","columnWrapperStyle","removeClippedSubviews"],w="D:\\a\\_work\\1\\s\\packages\\experimental-rn-lists\\vendored\\Lists\\FlatList.js";function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var o=T()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y()(this,n)}}function j(e){return null!=e?e:1}var _=function(e){b()(n,e);var t=A(n);function n(e){var r;return u()(this,n),(r=t.call(this,e))._virtualizedListPairs=[],r._captureRef=function(e){r._listRef=e},r._getItem=function(e,t){var n=j(r.props.numColumns);if(n>1){for(var o=[],i=0;i<n;i++){var a=e[t*n+i];null!=a&&o.push(a)}return o}return e[t]},r._getItemCount=function(e){if(e){var t=j(r.props.numColumns);return t>1?Math.ceil(e.length/t):e.length}return 0},r._keyExtractor=function(e,t){var n,o=j(r.props.numColumns),i=null!=(n=r.props.keyExtractor)?n:x.b;return o>1?Array.isArray(e)?e.map((function(e,n){return i(e,t*o+n)})).join(":"):void E()(Array.isArray(e),"FlatList: Encountered internal consistency error, expected each item to consist of an array with 1-%s columns; instead, received a single item.",o):i(e,t)},r._renderer=function(){var e=r.props,t=e.ListItemComponent,n=e.renderItem,o=e.columnWrapperStyle,i=j(r.props.numColumns),a=t?"ListItemComponent":"renderItem",c=function(e){return t?I.a.createElement(t,d()({},e,{__self:m()(r),__source:{fileName:w,lineNumber:551,columnNumber:16}})):n?n(e):null};return s()({},a,(function(e){if(i>1){var t=e.item,n=e.index;return E()(Array.isArray(t),"Expected array of items with numColumns > 1"),I.a.createElement(P.View,{style:P.StyleSheet.compose(F.row,o),__self:m()(r),__source:{fileName:w,lineNumber:569,columnNumber:13}},t.map((function(t,o){var a=c({item:t,index:n*i+o,separators:e.separators});return null!=a?I.a.createElement(I.a.Fragment,{key:o,__self:m()(r),__source:{fileName:w,lineNumber:576,columnNumber:42}},a):null})))}return c(e)}))},r._checkProps(r.props),r.props.viewabilityConfigCallbackPairs?r._virtualizedListPairs=r.props.viewabilityConfigCallbackPairs.map((function(e){return{viewabilityConfig:e.viewabilityConfig,onViewableItemsChanged:r._createOnViewableItemsChanged(e.onViewableItemsChanged)}})):r.props.onViewableItemsChanged&&r._virtualizedListPairs.push({viewabilityConfig:r.props.viewabilityConfig,onViewableItemsChanged:r._createOnViewableItemsChanged(r.props.onViewableItemsChanged)}),r}return h()(n,[{key:"scrollToEnd",value:function(e){this._listRef&&this._listRef.scrollToEnd(e)}},{key:"scrollToIndex",value:function(e){this._listRef&&this._listRef.scrollToIndex(e)}},{key:"scrollToItem",value:function(e){this._listRef&&this._listRef.scrollToItem(e)}},{key:"scrollToOffset",value:function(e){this._listRef&&this._listRef.scrollToOffset(e)}},{key:"recordInteraction",value:function(){this._listRef&&this._listRef.recordInteraction()}},{key:"flashScrollIndicators",value:function(){this._listRef&&this._listRef.flashScrollIndicators()}},{key:"getScrollResponder",value:function(){if(this._listRef)return this._listRef.getScrollResponder()}},{key:"getNativeScrollRef",value:function(){if(this._listRef)return this._listRef.getScrollRef()}},{key:"getScrollableNode",value:function(){if(this._listRef)return this._listRef.getScrollableNode()}},{key:"setNativeProps",value:function(e){this._listRef&&this._listRef.setNativeProps(e)}},{key:"componentDidUpdate",value:function(e){E()(e.numColumns===this.props.numColumns,"Changing numColumns on the fly is not supported. Change the key prop on FlatList when changing the number of columns to force a fresh render of the component."),E()(e.onViewableItemsChanged===this.props.onViewableItemsChanged,"Changing onViewableItemsChanged on the fly is not supported"),E()(!k(e.viewabilityConfig,this.props.viewabilityConfig),"Changing viewabilityConfig on the fly is not supported"),E()(e.viewabilityConfigCallbackPairs===this.props.viewabilityConfigCallbackPairs,"Changing viewabilityConfigCallbackPairs on the fly is not supported"),this._checkProps(this.props)}},{key:"_checkProps",value:function(e){var t=e.getItem,n=e.getItemCount,r=e.horizontal,o=e.columnWrapperStyle,i=e.onViewableItemsChanged,a=e.viewabilityConfigCallbackPairs,s=j(this.props.numColumns);E()(!t&&!n,"FlatList does not support custom data formats."),s>1?E()(!r,"numColumns does not support horizontal."):E()(!o,"columnWrapperStyle not supported for single column lists"),E()(!(i&&a),"FlatList does not support setting both onViewableItemsChanged and viewabilityConfigCallbackPairs.")}},{key:"_pushMultiColumnViewable",value:function(e,t){var n,r=j(this.props.numColumns),o=null!=(n=this.props.keyExtractor)?n:x.b;t.item.forEach((function(n,i){E()(null!=t.index,"Missing index!");var a=t.index*r+i;e.push(d()({},t,{item:n,key:o(n,a),index:a}))}))}},{key:"_createOnViewableItemsChanged",value:function(e){var t=this;return function(n){var r=j(t.props.numColumns);if(e)if(r>1){var o=[],i=[];n.viewableItems.forEach((function(e){return t._pushMultiColumnViewable(i,e)})),n.changed.forEach((function(e){return t._pushMultiColumnViewable(o,e)})),e({viewableItems:i,changed:o})}else e(n)}}},{key:"render",value:function(){var e,t=this.props,n=(t.numColumns,t.columnWrapperStyle,t.removeClippedSubviews),r=i()(t,D);return I.a.createElement(R.default,d()({},r,{getItem:this._getItem,getItemCount:this._getItemCount,keyExtractor:this._keyExtractor,ref:this._captureRef,viewabilityConfigCallbackPairs:this._virtualizedListPairs,removeClippedSubviews:(e=n,null!=e?e:"android"===P.Platform.OS)},this._renderer(),{__self:this,__source:{fileName:w,lineNumber:591,columnNumber:7}}))}}]),n}(I.a.PureComponent),F=P.StyleSheet.create({row:{flexDirection:"row"}});t.default=_},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return F}));var r=n(56),o=n.n(r),i=n(218),a=n.n(i),s=n(101),c=n.n(s),d=n(102),l=n.n(d),u=n(161),p=n.n(u),h=n(182),f=n.n(h),m=n(138),g=n.n(m),b=n(9),C=n(1),y=n(126),v=n.n(y),T=n(118),S=n.n(T),I=n(47),O=n.n(I),E=n(166),P=["ItemSeparatorComponent","SectionSeparatorComponent","renderItem","renderSectionFooter","renderSectionHeader","sections","stickySectionHeadersEnabled"],k="D:\\a\\_work\\1\\s\\packages\\experimental-rn-lists\\vendored\\Lists\\VirtualizedSectionList.js";function R(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f()(this,n)}}function w(e){var t=e.LeadingSeparatorComponent,n=e.SeparatorComponent,r=e.cellKey,i=e.prevCellKey,a=e.setSelfHighlightCallback,s=e.updateHighlightFor,c=e.setSelfUpdatePropsCallback,d=e.updatePropsFor,l=e.item,u=e.index,p=e.section,h=e.inverted,f=C.useState(!1),m=v()(f,2),g=m[0],y=m[1],T=C.useState(!1),S=v()(T,2),I=S[0],O=S[1],E=C.useState({leadingItem:e.leadingItem,leadingSection:e.leadingSection,section:e.section,trailingItem:e.item,trailingSection:e.trailingSection}),P=v()(E,2),R=P[0],x=P[1],D=C.useState({leadingItem:e.item,leadingSection:e.leadingSection,section:e.section,trailingItem:e.trailingItem,trailingSection:e.trailingSection}),w=v()(D,2),A=w[0],j=w[1];C.useEffect((function(){return a(r,O),c(r,j),function(){c(r,null),a(r,null)}}),[r,a,j,c]);var _={highlight:function(){y(!0),O(!0),null!=i&&s(i,!0)},unhighlight:function(){y(!1),O(!1),null!=i&&s(i,!1)},updateProps:function(e,r){"leading"===e?null!=t?x(o()({},R,r)):null!=i&&d(i,o()({},R,r)):"trailing"===e&&null!=n&&j(o()({},A,r))}},F=e.renderItem({item:l,index:u,section:p,separators:_}),M=null!=t&&C.createElement(t,o()({highlighted:g},R,{__self:this,__source:{fileName:k,lineNumber:527,columnNumber:5}})),N=null!=n&&C.createElement(n,o()({highlighted:I},A,{__self:this,__source:{fileName:k,lineNumber:530,columnNumber:5}}));return M||N?C.createElement(b.View,{__self:this,__source:{fileName:k,lineNumber:533,columnNumber:5}},!1===h?M:N,F,!1===h?N:M):F}var A=function(e){p()(n,e);var t=D(n);function n(){var e;c()(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i)))._keyExtractor=function(t,n){var r=e._subExtractor(n);return r&&r.key||String(n)},e._convertViewable=function(t){var n;O()(null!=t.index,"Received a broken ViewToken");var r=e._subExtractor(t.index);if(!r)return null;var i=r.section.keyExtractor,a=e.props.keyExtractor||E.b,s=null!=i?i(t.item,r.index):a(t.item,null!=(n=r.index)?n:0);return o()({},t,{index:r.index,key:s,section:r.section})},e._onViewableItemsChanged=function(t){var n=t.viewableItems,r=t.changed,o=e.props.onViewableItemsChanged;null!=o&&o({viewableItems:n.map(e._convertViewable,S()(e)).filter(Boolean),changed:r.map(e._convertViewable,S()(e)).filter(Boolean)})},e._renderItem=function(t){return function(n){var r=n.item,o=n.index,i=e._subExtractor(o);if(!i)return null;var a=i.index;if(null==a){var s=i.section;if(!0===i.header){var c=e.props.renderSectionHeader;return c?c({section:s}):null}var d=e.props.renderSectionFooter;return d?d({section:s}):null}var l=i.section.renderItem||e.props.renderItem,u=e._getSeparatorComponent(o,i,t);return O()(l,"no renderItem!"),C.createElement(w,{SeparatorComponent:u,LeadingSeparatorComponent:0===a?e.props.SectionSeparatorComponent:void 0,cellKey:i.key,index:a,item:r,leadingItem:i.leadingItem,leadingSection:i.leadingSection,prevCellKey:(e._subExtractor(o-1)||{}).key,setSelfHighlightCallback:e._setUpdateHighlightFor,setSelfUpdatePropsCallback:e._setUpdatePropsFor,updateHighlightFor:e._updateHighlightFor,updatePropsFor:e._updatePropsFor,renderItem:l,section:i.section,trailingItem:i.trailingItem,trailingSection:i.trailingSection,inverted:!!e.props.inverted,__self:S()(e),__source:{fileName:k,lineNumber:341,columnNumber:11}})}},e._updatePropsFor=function(t,n){var r=e._updatePropsMap[t];null!=r&&r(n)},e._updateHighlightFor=function(t,n){var r=e._updateHighlightMap[t];null!=r&&r(n)},e._setUpdateHighlightFor=function(t,n){null!=n?e._updateHighlightMap[t]=n:delete e._updateHighlightFor[t]},e._setUpdatePropsFor=function(t,n){null!=n?e._updatePropsMap[t]=n:delete e._updatePropsMap[t]},e._updateHighlightMap={},e._updatePropsMap={},e._captureRef=function(t){e._listRef=t},e}return l()(n,[{key:"scrollToLocation",value:function(e){for(var t=e.itemIndex,n=0;n<e.sectionIndex;n++)t+=this.props.getItemCount(this.props.sections[n].data)+2;var r=e.viewOffset||0;if(null!=this._listRef){if(e.itemIndex>0&&this.props.stickySectionHeadersEnabled)r+=this._listRef._getFrameMetricsApprox(t-e.itemIndex).length;var i=o()({},e,{viewOffset:r,index:t});this._listRef.scrollToIndex(i)}}},{key:"getListRef",value:function(){return this._listRef}},{key:"render",value:function(){for(var e,t=this,n=this.props,r=(n.ItemSeparatorComponent,n.SectionSeparatorComponent,n.renderItem,n.renderSectionFooter,n.renderSectionHeader,n.sections,n.stickySectionHeadersEnabled,a()(n,P)),i=this.props.ListHeaderComponent?1:0,s=this.props.stickySectionHeadersEnabled?[]:void 0,c=0,d=R(this.props.sections);!(e=d()).done;){var l=e.value;null!=s&&s.push(c+i),c+=2,c+=this.props.getItemCount(l.data)}var u=this._renderItem(c);return C.createElement(b.VirtualizedList,o()({},r,{keyExtractor:this._keyExtractor,stickyHeaderIndices:s,renderItem:u,data:this.props.sections,getItem:function(e,n){return t._getItem(t.props,e,n)},getItemCount:function(){return c},onViewableItemsChanged:this.props.onViewableItemsChanged?this._onViewableItemsChanged:void 0,ref:this._captureRef,__self:this,__source:{fileName:k,lineNumber:184,columnNumber:7}}))}},{key:"_getItem",value:function(e,t,n){if(!t)return null;for(var r=n-1,o=0;o<t.length;o++){var i=t[o],a=i.data,s=e.getItemCount(a);if(-1===r||r===s)return i;if(r<s)return e.getItem(a,r);r-=s+2}return null}},{key:"_subExtractor",value:function(e){for(var t=e,n=this.props,r=n.getItem,o=n.getItemCount,i=n.keyExtractor,a=n.sections,s=0;s<a.length;s++){var c=a[s],d=c.data,l=c.key||String(s);if(!((t-=1)>=o(d)+1))return-1===t?{section:c,key:l+":header",index:null,header:!0,trailingSection:a[s+1]}:t===o(d)?{section:c,key:l+":footer",index:null,header:!1,trailingSection:a[s+1]}:{section:c,key:l+":"+(c.keyExtractor||i||E.b)(r(d,t),t),index:t,leadingItem:r(d,t-1),leadingSection:a[s-1],trailingItem:r(d,t+1),trailingSection:a[s+1]};t-=o(d)+1}}},{key:"_getSeparatorComponent",value:function(e,t,n){if(!(t=t||this._subExtractor(e)))return null;var r=t.section.ItemSeparatorComponent||this.props.ItemSeparatorComponent,o=this.props.SectionSeparatorComponent,i=e===n-1,a=t.index===this.props.getItemCount(t.section.data)-1;return o&&a?o:!r||a||i?null:r}}]),n}(C.PureComponent),j=["stickySectionHeadersEnabled"];function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f()(this,n)}}var F=function(e){p()(n,e);var t=_(n);function n(){var e;c()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o)))._captureRef=function(t){e._wrapperListRef=t},e}return l()(n,[{key:"scrollToLocation",value:function(e){null!=this._wrapperListRef&&this._wrapperListRef.scrollToLocation(e)}},{key:"recordInteraction",value:function(){var e=this._wrapperListRef&&this._wrapperListRef.getListRef();e&&e.recordInteraction()}},{key:"flashScrollIndicators",value:function(){var e=this._wrapperListRef&&this._wrapperListRef.getListRef();e&&e.flashScrollIndicators()}},{key:"getScrollResponder",value:function(){var e=this._wrapperListRef&&this._wrapperListRef.getListRef();if(e)return e.getScrollResponder()}},{key:"getScrollableNode",value:function(){var e=this._wrapperListRef&&this._wrapperListRef.getListRef();if(e)return e.getScrollableNode()}},{key:"setNativeProps",value:function(e){var t=this._wrapperListRef&&this._wrapperListRef.getListRef();t&&t.setNativeProps(e)}},{key:"render",value:function(){var e=this.props,t=e.stickySectionHeadersEnabled,n=a()(e,j),r=null!=t?t:"ios"===b.Platform.OS;return C.createElement(A,o()({},n,{stickySectionHeadersEnabled:r,ref:this._captureRef,getItemCount:function(e){return e.length},getItem:function(e,t){return e[t]},__self:this,__source:{fileName:"D:\\a\\_work\\1\\s\\packages\\experimental-rn-lists\\vendored\\Lists\\SectionList.js",lineNumber:232,columnNumber:7}}))}}]),n}(C.PureComponent)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}));var r=n(3);function o(e){var t,n=[{}];return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return n.every((function(e,t){return e===o[t]}))?t:(n=o,t=e.apply(void 0,Object(r.g)([],Object(r.e)(o),!1)))}}function i(e,t){var n=o(e);return function(){return n.apply(void 0,Object(r.g)([],Object(r.e)(t()),!1))}}function a(e,t,n){var i=o(t);return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.apply(void 0,Object(r.g)(Object(r.g)([],Object(r.e)(e),!1),Object(r.e)(n()),!1))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),o=n(341);function i(e){var t=Object(r.e)(e,1)[0];return Object(o.a)(t)}},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(343),o=n.n(r).a,i="00000000-0000-0000-0000-000000000000"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);function o(e){var t=e;return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t&&t.apply(void 0,Object(r.g)([],Object(r.e)(e),!1)),t=void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(t.AWTUserIdType||(t.AWTUserIdType={})),function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(t.AWTSessionState||(t.AWTSessionState={}))},function(e,t,n){"use strict";function r(e,t,n,r,o){var i,a=n(),s=function e(){var o=t(a);o?(a=o,i=setTimeout(e,r)):(a=n(),i=void 0)},c=function(t){a=e(a,t),i||o||(i=setTimeout(s,0)),i||(i=setTimeout(s,o||r))};return c.reset=function(){void 0!==i&&(clearTimeout(i),a=n(),i=void 0)},c}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);function o(e){return null==e?"9FA40DC1-775B-46F7-B124-3E10E131B835":e}function i(e,t,n){void 0===t&&(t=100);var i=new Map,a=0;return function(){for(var s,c,d=[],l=0;l<arguments.length;l++)d[l]=arguments[l];if(0===d.length){var u=e.apply(void 0,Object(r.g)([],Object(r.e)(d),!1));return u}a>t&&(i.clear(),a=0,null==n||n());var p=o(d[0]),h=null!==(s=i.get(p))&&void 0!==s?s:{nextArgMap:new Map};i.has(p)||i.set(p,h);for(var f=1;f<d.length;f++){var m=o(d[f]),g=null!==(c=h.nextArgMap.get(m))&&void 0!==c?c:{nextArgMap:new Map};h.nextArgMap.has(g)||h.nextArgMap.set(m,g),h=g}return void 0!==h.value||(a++,h.value={storedResult:e.apply(void 0,Object(r.g)([],Object(r.e)(d),!1))}),h.value.storedResult}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(1),o=n(9),i=n(306),a=n(221),s=n(196),c=n(303),d=[{tokens:{borderColor:"menuItemText",color:"menuItemText",backgroundColor:"menuBackground",textBorderColor:"transparent"},root:{style:{display:"flex",alignItems:"center",flexDirection:"row",minHeight:14,marginTop:0,position:"relative"}},checkbox:{style:{borderStyle:"solid",borderWidth:1,minHeight:14,minWidth:14,marginEnd:4}},checkmark:{style:{aspectRatio:1,position:"relative",opacity:0,fontSize:10,textAlign:"center",textAlignVertical:"center",top:-1}},content:{variant:"bodyStandard",style:{borderStyle:"solid",borderWidth:2,marginTop:3}},_precedence:["disabled","boxAtEnd","hovered","focused","pressed","checked"],_overrides:{focused:{tokens:{backgroundColor:"menuItemBackgroundHovered",textBorderColor:"focusBorder",checkmarkColor:"menuItemTextHovered"}},checked:{checkmark:{style:{opacity:1}}},hovered:{tokens:{backgroundColor:"menuItemBackgroundHovered",checkmarkColor:"menuItemTextHovered"}},disabled:{tokens:{borderColor:"buttonBorderDisabled",color:"disabledBodyText",backgroundColor:"background"}},boxAtEnd:{checkbox:{style:{marginStart:4,marginEnd:0}}},pressed:{tokens:{backgroundColor:"menuItemBackgroundPressed"}}}},"Checkbox"],l=n(124),u=n(108),p=n(195),h=function(){return(h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},f=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},m=Object(a.a)({displayName:"Checkbox",usePrepareProps:function(e,t){var n=r.useRef(null),o=e.accessible,i=e.accessibilityLabel,a=e.accessibilityRole,s=(e.ariaLabel,e.checked),c=e.defaultChecked,d=e.boxSide,u=e.label,m=e.onChange,g=e.componentRef,b=void 0===g?n:g,C=f(e,["accessible","accessibilityLabel","accessibilityRole","ariaLabel","checked","defaultChecked","boxSide","label","onChange","componentRef"]);null!=c&&null!=s&&console.warn("defaultChecked and checked are mutually exclusive to one another. Use one or the other.");var y=Object(p.b)(c,s,m),v=y[0],T=y[1],S=Object(p.d)(b,T),I=Object(p.a)(h({onPress:S},C)),O=Object(p.e)(b),E=Object(p.c)(T," "),P=h(h({},I.state),{disabled:!!e.disabled,checked:v,boxAtEnd:null!=d&&"start"!=d}),k=t(e,(function(t){return P[t]||e[t]})),R=r.useCallback((function(e){switch(e.nativeEvent.actionName){case"Toggle":T()}}),[T,e,P,I.props]);return{slotProps:Object(l.b)(k,{root:h(h(h({rest:C,ref:O},I.props),{accessible:null==o||o,accessibilityRole:null!=a?a:"checkbox",accessibilityLabel:null!=i?i:u,accessibilityState:{disabled:P.disabled,checked:P.checked},accessibilityActions:[{name:"Toggle",label:"Toggle the Checkbox"}],focusable:!P.disabled,onAccessibilityAction:R}),E),checkmark:{children:"✓"},content:{children:u}}),state:P}},render:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return Object(s.b)(e.root,null,(null==t?void 0:t.state.boxAtEnd)&&Object(s.b)(e.content,null),Object(s.b)(e.checkbox,null,Object(s.b)(e.checkmark,null)),!(null==t?void 0:t.state.boxAtEnd)&&Object(s.b)(e.content,null),n)},settings:d,slots:{root:o.View,checkbox:{slotType:o.View,filter:c.b},checkmark:i.a,content:i.a},styles:{root:[],checkbox:[u.a,u.b,[{source:"checkboxBackgroundColor",lookup:u.d,target:"backgroundColor"},{source:"checkboxBorderColor",lookup:u.d,target:"borderColor"}]],checkmark:[u.c,[{source:"checkmarkColor",lookup:u.d,target:"color"},{source:"checkmarkVisibility",target:"opacity"}]],content:[u.c,u.e,[{source:"textBorderColor",lookup:u.d,target:"borderColor"}]]}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(195),o=n(108),i=n(221),a=n(124),s=n(1),c=n(9),d=[{tokens:{backgroundColor:"bodyStandoutBackground",beakWidth:20,borderColor:"bodyFrameBackground",borderWidth:1,directionalHint:"bottonLeftEdge",gapSpace:0,minPadding:0}},"Callout"],l=n(321),u=function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},p=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},h=c.Platform.select({macos:Object(l.a)("FRNCallout"),default:Object(l.a)("RCTCallout")}),f=Object(i.a)({displayName:"Callout",usePrepareProps:function(e,t){var n=e.componentRef,o=e.target,i=p(e,["componentRef","target"]),d=Object(r.e)(n),l=s.useState(null),h=l[0],f=l[1];return s.useLayoutEffect((function(){"string"==typeof o?f(o):(null==o?void 0:o.current)&&f(Object(c.findNodeHandle)(o.current))}),[o]),{slotProps:Object(a.b)(t(e),{root:u(u({ref:d},h&&{target:h}),i)})}},settings:d,slots:{root:h},styles:{root:[o.a,o.b]}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),o=n(1),i=!1;var a=void 0;try{a=window}catch(e){}function s(e){if(!i&&void 0!==a){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:a}}var c=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isRendered:void 0===s()},n}return Object(r.c)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props.delay;this._timeoutId=window.setTimeout((function(){e.setState({isRendered:!0})}),t)},t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},t.prototype.render=function(){return this.state.isRendered?o.Children.only(this.props.children):null},t.defaultProps={delay:0},t}(o.Component)}]);
//# sourceMappingURL=Comments.win32.bundle.map