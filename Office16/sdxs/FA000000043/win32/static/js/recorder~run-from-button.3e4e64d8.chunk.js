(this["webpackJsonpmaker-code-editor"]=this["webpackJsonpmaker-code-editor"]||[]).push([[2],{656:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"a",(function(){return s})),r.d(t,"f",(function(){return n})),r.d(t,"g",(function(){return a})),r.d(t,"h",(function(){return L})),r.d(t,"i",(function(){return M})),r.d(t,"j",(function(){return o})),r.d(t,"k",(function(){return N})),r.d(t,"m",(function(){return B})),r.d(t,"n",(function(){return V})),r.d(t,"o",(function(){return W})),r.d(t,"p",(function(){return H})),r.d(t,"l",(function(){return G}));var n={};r.r(n),r.d(n,"show",(function(){return d})),r.d(n,"dismiss",(function(){return f})),r.d(n,"hide",(function(){return p})),r.d(n,"reset",(function(){return b}));var a={};r.r(a),r.d(a,"openScript",(function(){return g})),r.d(a,"openScriptInDetailsPage",(function(){return h})),r.d(a,"openScriptInEditor",(function(){return m})),r.d(a,"monacoInitialized",(function(){return S})),r.d(a,"setActive",(function(){return O})),r.d(a,"createNewScript",(function(){return v})),r.d(a,"importScript",(function(){return T})),r.d(a,"makeACopyOfScript",(function(){return y})),r.d(a,"onMount",(function(){return R})),r.d(a,"onOpenNewScript",(function(){return w})),r.d(a,"hideDetailsPage",(function(){return j})),r.d(a,"showDetailsPage",(function(){return E})),r.d(a,"contentExternallyUpdated",(function(){return A})),r.d(a,"updateMonacoMarkers",(function(){return _})),r.d(a,"updateProblemsLogs",(function(){return I})),r.d(a,"setNavigationSourcePage",(function(){return C})),r.d(a,"setIsMakingACopy",(function(){return k})),r.d(a,"setIsEditingScriptName",(function(){return P})),r.d(a,"setMostRecentRecorderHeartbeatReceived",(function(){return D})),r.d(a,"setDetailsNavigateSource",(function(){return F})),r.d(a,"recorderHeartbeat",(function(){return U}));var o={};r.r(o),r.d(o,"initialize",(function(){return x}));var i=r(765),c=r(742),u=r(743),s=r(744),l=r(657),d=Object(l.createAction)("DIALOG_SHOW",(function(e){return function(t){var r=t.title,n=t.subText,a=t.buttons,o=t.style,i=t.isBlocking;return e({title:r,subText:n,buttons:a,style:o,isBlocking:void 0===i||i})}})),f=Object(l.createAction)("DIALOG_DISMISS"),p=Object(l.createAction)("DIALOG_HIDE"),b=Object(l.createAction)("DIALOG_RESET"),g=Object(l.createAction)("EDITOR_OPEN_SCRIPT",(function(e){return function(t){return e(t)}})),h=Object(l.createAction)("EDITOR_OPEN_SCRIPT_IN_DETAILS_PAGE",(function(e){return function(t){return e(t)}})),m=Object(l.createAction)("EDITOR_OPEN_SCRIPT_IN_EDITOR",(function(e){return function(t){return e(t)}})),S=Object(l.createAction)("EDITOR_MONACO_INITIALIZED"),O=Object(l.createAction)("EDITOR_SET_ACTIVE",(function(e){return function(t){return e(t)}})),v=Object(l.createAction)("EDITOR_CREATE_NEW_SCRIPT"),T=Object(l.createStandardAction)("EDITOR_IMPORT_AND_OPEN")(),y=Object(l.createAction)("EDITOR_MAKE_COPY",(function(e){return function(t){return e(t)}})),R=Object(l.createAction)("EDITOR_ON_MOUNT",(function(e){return function(t){return e(t)}})),w=Object(l.createAction)("EDITOR_ON_OPEN_NEW_SCRIPT"),j=Object(l.createAction)("EDITOR_HIDE_DETAILS_PAGE"),E=Object(l.createAction)("EDITOR_SHOW_DETAILS_PAGE"),A=Object(l.createAction)("EDITOR_CONTENT_EXTERNALLY_UPDATED"),_=Object(l.createAction)("EDITOR_UPDATE_MONACO_MARKERS"),I=Object(l.createAction)("EDITOR_UPDATE_PROBLEMS_LOGS"),C=Object(l.createAction)("EDITOR_SET_NAVIGATION_SOURCE_PAGE",(function(e){return function(t){return e(t)}})),k=Object(l.createAction)("EDITOR_SET_IS_MAKING_A_COPY",(function(e){return function(t){return e(t)}})),P=Object(l.createAction)("EDITOR_SET_IS_EDITING_SCRIPT_NAME",(function(e){return function(t){return e(t)}})),D=Object(l.createAction)("EDITOR_SET_LAST_KNOWN_RECORDING_HEARTBEAT"),F=Object(l.createAction)("EDITOR_SET_DETAILS_NAVIGATE_SOURCE",(function(e){return function(t){return e(t)}})),U=Object(l.createAction)("MACRO_RECORDER_HEARTBEAT"),L=r(766),M=r(767),x=Object(l.createAction)("INITIALIZING"),N=r(745),B=r(746),V=r(730),W=r(768),H=r(769),G=r(747),K={backstage:i,bottomPanel:c,consentDialog:u,authDialog:s,dialog:n,editor:a,macroRecorder:L,messageBar:M,misc:o,run:N,scripts:B,settings:V,shareDialog:W,unshareDialog:H,runFromButton:G};t.e=K},659:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return o})),r.d(t,"a",(function(){return i})),r.d(t,"l",(function(){return c})),r.d(t,"m",(function(){return u})),r.d(t,"f",(function(){return E})),r.d(t,"g",(function(){return s})),r.d(t,"h",(function(){return l})),r.d(t,"j",(function(){return P})),r.d(t,"k",(function(){return D})),r.d(t,"i",(function(){return d}));var n={};r.r(n),r.d(n,"getIsVisible",(function(){return f})),r.d(n,"getCurrentPivot",(function(){return p})),r.d(n,"getIsReactMonacoLoaded",(function(){return b}));var a={};r.r(a),r.d(a,"getIsVisible",(function(){return g})),r.d(a,"getCurrentPivot",(function(){return h})),r.d(a,"getOutputLogs",(function(){return m})),r.d(a,"getProblemsLogs",(function(){return S})),r.d(a,"getHelpLinks",(function(){return O}));var o={};r.r(o),r.d(o,"getIsVisible",(function(){return v}));var i={};r.r(i),r.d(i,"getIsVisible",(function(){return T})),r.d(i,"getAcceptFn",(function(){return y})),r.d(i,"getCancelFn",(function(){return R}));var c={};r.r(c),r.d(c,"getIsVisible",(function(){return w}));var u={};r.r(u),r.d(u,"getIsVisible",(function(){return j}));var s={};r.r(s),r.d(s,"getRecordingStatus",(function(){return A})),r.d(s,"getIntents",(function(){return _}));var l={};r.r(l),r.d(l,"getIsRunning",(function(){return C})),r.d(l,"getRunningStatus",(function(){return k}));var d={};r.r(d),r.d(d,"getActiveScript",(function(){return F})),r.d(d,"getActiveScriptId",(function(){return U})),r.d(d,"getFetchErrorText",(function(){return L})),r.d(d,"getIsViewingScript",(function(){return M}));var f=function(e){return e.backstage.isVisible},p=function(e){return e.backstage.currentPivot},b=function(e){return e.backstage.isReactMonacoLoaded},g=function(e){return e.bottomPanel.isVisible},h=function(e){return e.bottomPanel.currentPivot},m=function(e){return e.bottomPanel.outputLogs},S=function(e){return e.bottomPanel.problemsLogs},O=function(e){return e.bottomPanel.helpLinks},v=function(e){return e.consentDialog.isVisible},T=function(e){return e.authDialog.isVisible},y=function(e){return e.authDialog.acceptFn},R=function(e){return e.authDialog.cancelFn},w=function(e){return e.shareDialog.isVisible},j=function(e){return e.unshareDialog.isVisible},E=r(748),A=function(e){return e.macroRecorder.recordingStatus},_=function(e){return e.macroRecorder.intents},I=r(723),C=function(e){return"InProgress"===e[I.c].runningStatus},k=function(e){return e[I.c].runningStatus},P=r(761),D=r(731),F=function(e){return e.runFromButton.activeScript||void 0},U=function(e){var t;return(null==(t=e.runFromButton.activeScript)?void 0:t.storageScript.id)||null},L=function(e){return e.runFromButton.fetchErrorText||void 0},M=function(e){return e.runFromButton.isViewingScript};t.e={backstage:n,bottomPanel:a,consentDialog:o,authDialog:i,shareDialog:c,unshareDialog:u,editor:E,macroRecorder:s,run:l,scripts:P,settings:D,runFromButton:d}},660:function(e,t,r){"use strict";function n(e){return"testId-"+e}r.d(t,"a",(function(){return n}))},662:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return!!e&&e.storageScript.isCreator}},663:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"g",(function(){return s})),r.d(t,"d",(function(){return l})),r.d(t,"f",(function(){return d})),r.d(t,"e",(function(){return f}));var n=r(715),a=r(978);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var i=function(e){return{rootDisabled:{backgroundColor:e.colors.neutralLight},rootFocused:{backgroundColor:e.colors.neutralQuaternaryAlt},rootHovered:{backgroundColor:e.colors.neutralQuaternaryAlt},rootPressed:{backgroundColor:e.colors.neutralTertiaryAlt}}},c=function(e){return{content:{backgroundColor:e.colors.neutralLighterAlt}}},u=function(){return Object(n.a)()?{main:{position:"absolute",top:"10vh",transform:"translate(-50%, 0px)"}}:{main:{position:"absolute",top:"10vh"}}},s=function(e,t){return e==a.a.large?{circle:{border:"2px solid "+t.colors.primaryLightest,borderTop:"2px solid "+t.colors.primary,width:"30px",height:"30px",animation:"loading-animation 1s linear infinite"}}:{circle:{border:"2px solid "+t.colors.primaryLightest,borderTop:"2px solid "+t.colors.primary,animation:"loading-animation 1s linear infinite"}}},l=function(e){return{root:{color:e.colors.primary}}},d=function(e,t){var r={root:{width:"100%",maxWidth:"100%",borderRadius:"2px",transition:".1s linear",boxShadow:"0 4px 4px 0 rgb(0 0 0 / 8%)",backgroundColor:e.colors.neutralLighterAlt}};return t?r:o({},r,{root:o({},r.root,{selectors:{":hover":{transform:"scale(1.05)",boxShadow:"0 8px 16px rgb(0 0 0/ 10%)"}}})})},f=function(e,t,r){return{root:{fontSize:r||e.fontSizes.medium,fontWeight:t||e.fontWeights.semibold}}}},672:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(2),a=r(26);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function i(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function c(e){i(o,n,a,c,u,"next",e)}function u(e){i(o,n,a,c,u,"throw",e)}c(void 0)}))}}var u=new Map;function s(e,t){return l.apply(this,arguments)}function l(){return(l=c(regeneratorRuntime.mark((function e(t,r){var i,c,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=!u.has(t),u.set(t,!0),c=i?new n.b("LoadChunk","System"):void 0,s={numFailures:0},l=void 0,e.prev=5,e.next=8,Object(a.c)(r,(function(){return!0}),(function(){return s.numFailures++,!1}),3,s);case 8:l=e.sent,e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(5),c&&c.fail(n.a.Debug,o({firstLoad:i,chunk:t},s),e.t0),e.t0;case 15:return c&&c.succeed(n.a.Information,o({firstLoad:i,chunk:t},s)),e.abrupt("return",l);case 17:case"end":return e.stop()}}),e,null,[[5,11]])})))).apply(this,arguments)}},675:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(705),a=function(e){return e.storageScript.creatorId===n.c}},679:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return!e.storageScript.dateFirstPublished}},684:function(e,t,r){"use strict";r.d(t,"c",(function(){return p})),r.d(t,"b",(function(){return h})),r.d(t,"a",(function(){return S}));var n=r(5),a=r(102),o=r(26),i=r(2),c=r(166),u={token:null},s=function(e){var t,r=u;r.token=e,t=r,Object(n.setUserAccessInfo)({currentUserToken:t.token,currentUserMlapiToken:null})};function l(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){l(o,n,a,i,c,"next",e)}function c(e){l(o,n,a,i,c,"throw",e)}i(void 0)}))}}var f=function(){return!0},p=new(function(){function e(){Object.defineProperty(this,"successes",{configurable:!0,enumerable:!0,writable:!0,value:0}),Object.defineProperty(this,"authFails",{configurable:!0,enumerable:!0,writable:!0,value:0}),Object.defineProperty(this,"networkFails",{configurable:!0,enumerable:!0,writable:!0,value:0}),Object.defineProperty(this,"allFails",{configurable:!0,enumerable:!0,writable:!0,value:0}),Object.defineProperty(this,"disabledFails",{configurable:!0,enumerable:!0,writable:!0,value:0}),Object.defineProperty(this,"listeners",{configurable:!0,enumerable:!0,writable:!0,value:[]})}var t=e.prototype;return t.success=function(){this.successes++,this.broadcast()},t.failure=function(e){this.allFails++,Object(c.m)(e)?this.networkFails++:Object(c.c)(e)?this.authFails++:Object(c.e)(e)&&this.disabledFails++,this.broadcast()},t.listen=function(e){this.listeners.push(e)},t.broadcast=function(){var e=this.buildReport();this.listeners.forEach((function(t){return t(e)}))},t.buildReport=function(){return{callCount:this.allFails+this.successes,fails:{callCount:this.allFails,authFailures:this.authFails,networkFailures:this.networkFails,disabledFailures:this.disabledFails}}},e}());function b(e,t){return g.apply(this,arguments)}function g(){return(g=d(regeneratorRuntime.mark((function e(t,r){var o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new i.b(r.rootName+".Internal","System"),e.prev=1,e.next=4,t(o.id);case 4:return c=e.sent,o.succeed(i.a.Information,{parentCallId:r.id}),p.success(),e.abrupt("return",c);case 10:throw e.prev=10,e.t0=e.catch(1),o.fail(i.a.Warning,{parentCallId:r.id},e.t0),e.t0 instanceof n.StorageServiceError&&401===e.t0.status&&(Object(n.setAccessToken)(null),a.a.instance().clearStorageToken()),p.failure(e.t0),e.t0;case 16:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function h(e,t,r){return m.apply(this,arguments)}function m(){return(m=d(regeneratorRuntime.mark((function e(t,r,n){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(){var e=d(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(r);case 2:return e.abrupt("return",t(r));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.abrupt("return",Object(o.c)(d(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",b(a,r));case 1:case"end":return e.stop()}}),e)}))),f,Object(o.b)(c.n,n),3));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return O.apply(this,arguments)}function O(){return(O=d(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.instance().authorizeStorageService(t);case 2:r=e.sent,s(r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},685:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r(47),a=r(672),o=r(5),i=r(2),c=r(684),u=r(706),s=r(166),l=r(679),d=r(839),f=r(695),p=r(26),b=r(59),g=r(29),h=r(688),m=r(752),S=r(171);function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function v(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function T(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){v(o,n,a,i,c,"next",e)}function c(e){v(o,n,a,i,c,"throw",e)}i(void 0)}))}}var y=function(){var e=this;Object.defineProperty(this,"getScripts",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=T(regeneratorRuntime.mark((function e(){var t,r,n,a,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new i.b("FetchMetadataFromStorage","System",[{level:i.a.ASHA,timeout:i.c.UserUnsatisfied}]),e.prev=1,r=Object(c.b)(o.getScripts,t,s.e),e.next=5,r;case 5:return n=e.sent,a=n.map((function(e){return Object(u.a)(O({},e,{isCreator:!0}))})),t.succeed(i.a.Information,{scriptCount:a.length}),e.abrupt("return",a);case 11:throw e.prev=11,e.t0=e.catch(1),l=Object(p.b)(s.e,s.a)(e.t0),t.fail(l||Object(s.b)(e.t0)||"MacroRecorder"===Object(b.b)()?i.a.Warning:i.a.Error,{},e.t0),e.t0;case 16:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"getRecentScripts",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=T(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new i.b("FetchRecentMetadataFromStorage","System",[{level:i.a.ASHA,timeout:i.c.UserUnsatisfied}]),e.prev=1,e.next=4,Object(c.b)((function(e){return Object(o.getRecentScripts)(Object(S.a)(),e)}),t,s.e);case 4:return r=e.sent,n=r.map((function(e){return Object(u.a)(O({},e,{isCreator:!0}))})),t.succeed(i.a.Information,{scriptCount:n.length}),e.abrupt("return",n);case 10:throw e.prev=10,e.t0=e.catch(1),a=Object(p.b)(s.e,s.a)(e.t0),t.fail(a||Object(s.b)(e.t0)?i.a.Warning:i.a.Error,{},e.t0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"saveScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=T(regeneratorRuntime.mark((function e(t,r){var n,a,f,b,h,v,T,y,R,w,j,E,A,_,I;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new i.b("PublishScript","User",[{level:i.a.ASHA,timeout:i.c.UserUnsatisfied}]),a=Object(l.a)(t),f=Object.keys(r),b=1===f.length&&"name"===f[0]&&!a,h=1==f.length&&"description"===f[0],v=Object(d.a)(t,r),T=t.localUpdates.body!==t.storageScript.body,y=a||T&&b,R=function(e){return Object(s.l)(e)?(v.name=Object(m.c)(strings.Editor.NewScriptNameText),!1):Object(p.b)(s.k,s.e)(e)},e.prev=9,w=y?function(e){return Object(o.saveScript)(v,Object(S.a)(),e,Object(g.a)("PopulateRecentScripts"))}:b?function(e){return Object(o.updateScriptName)(v,e,Object(g.a)("PopulateRecentScripts"))}:function(e){return Object(o.updateScriptContents)(v,e,Object(g.a)("PopulateRecentScripts"))},e.next=13,Object(c.b)(w,n,a?R:Object(p.b)(s.g,s.e));case 13:return j=e.sent,E=b?O({},j,v):y?j:O({},j,{mruItemId:v.mruItemId}),A=Object(u.a)(E,{shareId:t.localUpdates.shareId}),b&&!y||(A.storageScript.lastModifiedByInfo=void 0),n.succeed(i.a.Information,{draftId:Object(l.a)(t)?t.storageScript.id:void 0,storageId:A.storageScript.id,apiInfo:t.storageScript.apiInfo,isDraft:a,operationType:a?"PublishNew":h?"UpdateDescription":y?"UpdateNameAndContent":b?"UpdateName":"UpdateContent",isPopulatingMRU:Object(g.a)("PopulateRecentScripts")}),e.abrupt("return",A);case 21:throw e.prev=21,e.t0=e.catch(9),_=Object(s.e)(e.t0),I=Object(s.g)(e.t0)||Object(s.b)(e.t0)||Object(s.i)(e.t0)||_||Object(g.a)("RecentScripts")&&Object(s.a)(e.t0)?i.a.Warning:i.a.Error,n.fail(I,{storageId:t.storageScript.id,apiInfo:t.storageScript.apiInfo,isDraft:a,operationType:a?"PublishNew":h?"UpdateDescription":y?"UpdateNameAndContent":b?"UpdateName":"UpdateContent"},e.t0),e.t0;case 27:case"end":return e.stop()}}),e,null,[[9,21]])})));return function(t,r){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"getGraphScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=T(regeneratorRuntime.mark((function e(t,r){var n,a,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new i.b("GetGraphScriptFromStorage","System",[{level:i.a.ASHA,timeout:i.c.UserUnsatisfied}]),e.prev=1,e.next=4,Object(c.b)((function(e){return Object(o.getGraphScript)(t,r,Object(S.a)(),e,!0)}),n,s.f);case 4:return a=e.sent,l=Object(u.a)(O({},a,{isCreator:!0})),n.succeed(i.a.Information,{storageId:a.id}),e.abrupt("return",l);case 10:throw e.prev=10,e.t0=e.catch(1),d=Object(s.f)(e.t0)||Object(s.b)(e.t0)||Object(s.a)(e.t0)?i.a.Warning:i.a.Error,n.fail(d,{driveId:t,itemId:r},e.t0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,r){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"getScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=T(regeneratorRuntime.mark((function t(r){var n,a,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new i.b("FetchScriptFromStorage","System",[{level:i.a.ASHA,timeout:i.c.UserUnsatisfied}]),t.prev=1,t.next=4,Object(c.b)((function(e){return Object(o.getScript)(r,e,Object(g.a)("PopulateRecentScripts"))}),n,s.f);case 4:return a=t.sent,l=Object(u.a)(O({},a,{isCreator:!0}),{shareId:r.shareId}),n.succeed(i.a.Information,{storageId:r.id,writeMRU:Object(g.a)("PopulateRecentScripts")}),t.abrupt("return",l);case 10:throw t.prev=10,t.t0=t.catch(1),Object(s.k)(t.t0)&&(Object(g.a)("RecentScripts")||Object(g.a)("PopulateRecentScripts"))&&r.mruItemId&&e.removeRecentScript(r.id,r.mruItemId),d=Object(s.f)(t.t0)||Object(s.b)(t.t0)||Object(g.a)("RecentScripts")&&Object(s.a)(t.t0)?i.a.Warning:i.a.Error,n.fail(d,{storageId:r.id,writeMRU:Object(g.a)("PopulateRecentScripts")},t.t0),t.t0;case 16:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}()}),Object.defineProperty(this,"removeRecentScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=T(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new i.b("RemoveRecentScript","System"),e.prev=1,e.next=4,Object(c.b)((function(e){return Object(o.removeRecentScript)(r,e)}),n,Object(p.b)(s.n,s.b));case 4:n.succeed(i.a.Information,{storageId:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),n.fail(i.a.Warning,{storageId:t},e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,r){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"removeScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=T(regeneratorRuntime.mark((function t(r){var n,a,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=new i.b("DeleteScript","User",[{level:i.a.ASHA,timeout:i.c.UserUnsatisfied}]),t.prev=1,!Object(f.a)(r)){t.next=6;break}return a=Object(h.a)(r),t.next=6,Object(c.b)((function(e){return Object(o.removeScript)(a,e)}),n,Object(p.b)(s.k,s.o));case 6:return n.succeed(i.a.Information,{storageId:r.storageScript.id}),t.abrupt("return",r);case 10:if(t.prev=10,t.t0=t.catch(1),Object(s.k)(t.t0)&&(Object(g.a)("RecentScripts")||Object(g.a)("PopulateRecentScripts"))&&r.storageScript.mruItemId&&e.removeRecentScript(r.storageScript.id,r.storageScript.mruItemId),u=Object(s.k)(t.t0)?i.a.Information:Object(s.o)(t.t0)||Object(s.b)(t.t0)||Object(g.a)("RecentScripts")&&Object(s.a)(t.t0)?i.a.Warning:i.a.Error,n.fail(u,{storageId:r.storageScript.id},t.t0),u!==i.a.Information){t.next=17;break}return t.abrupt("return",r);case 17:throw t.t0;case 18:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}()})};function R(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}var w=function(){};Object.defineProperty(w,"_instance",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(w,"instance",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e,t=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w._instance){e.next=2;break}return e.abrupt("return",w._instance);case 2:e.t0=Object(n.d)(),e.next=e.t0===n.b.makerserviceprodnew||e.t0===n.b.makerserviceint||e.t0===n.b.makerservicetest||e.t0===n.b.makerservicelocal?5:e.t0===n.b.localstorage?6:7;break;case 5:return e.abrupt("return",w._instance=new y);case 6:return e.abrupt("return",Object(a.a)("LocalStorageScript",(function(){return r.e(9).then(r.bind(null,1533))})).then((function(e){return w._instance=new e.LocalStorageScript})));case 7:throw new Error(n.a);case 8:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){R(o,n,a,i,c,"next",e)}function c(e){R(o,n,a,i,c,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}()})},687:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return!!e&&!!e.localUpdates.shareId}},688:function(e,t,r){"use strict";function n(e){return{id:e.storageScript.id,shareId:e.localUpdates.shareId||e.storageScript.shareId,mruItemId:e.storageScript.mruItemId}}r.d(t,"a",(function(){return n}))},690:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o}));var n=r(751),a=function(e){return o(e.storageScript)},o=function(e){return!Object(n.a)(e.body)&&!Object(n.a)(e.description)}},691:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(679);function a(e){return!!e&&(!!Object(n.a)(e)||e.storageScript.body!==e.localUpdates.body)}},693:function(e,t,r){"use strict";r.d(t,"g",(function(){return d})),r.d(t,"c",(function(){return b})),r.d(t,"b",(function(){return g})),r.d(t,"f",(function(){return S})),r.d(t,"d",(function(){return T})),r.d(t,"a",(function(){return y})),r.d(t,"e",(function(){return R}));var n=r(771),a=r.n(n),o=r(755),i=r(2),c=r(29);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var s=function(e,t){return e.lastWrite-t.lastWrite},l=new o.a("script_v2",2e6,6048e5,{canPurge:function(e){var t=Object(o.b)(e);return!t.localUpdates.body||t.storageScript.body===t.localUpdates.body},compare:s});function d(e){return function(e,t){var r={storageScript:u({},t.storageScript,{shareId:void 0}),localUpdates:u({},t.localUpdates,{shareId:void 0})};p(r.storageScript),p(r.localUpdates);var n=t.storageScript.id,o=e.read(n);if(r&&(!o||!a()(r,o))){if(!e.write(n,r)&&!f){var c=o?i.a.Warning:i.a.Information;Object(i.g)(new Error("Failed to write script to localstorage"),c,{newEntry:!o}),f=!0}}return!1}(l,e)}var f=!1;function p(e){Object.keys(e).forEach((function(t){void 0===e[t]&&delete e[t]}))}var b=function(){var e=l.keys().map((function(e){return l.read(e)}));return{mruScripts:Object(c.a)("RecentScripts")?O():[],scripts:e.reduce((function(e,t){var r;return u({},e,((r={})[t.storageScript.id]=t,r))}),{}),hasLoadedAttachedScripts:!1,hasReceivedMetadata:!1,hasReceivedMRUMetadata:!1,scriptsSavingStatus:{},scriptsAttachingStatus:{},scriptsIsStorageCallInProgress:{},scriptsIsAnyStorageCallInProgress:!1,scriptsIsConsented:{}}},g=function(e){l.purge(e)},h="all",m=new o.a("mruscripts",3e4,6048e5,{canPurge:function(){return!0},compare:function(){return 0}});function S(e){!function(e,t){var r=t.map((function(e){return function(e){var t=e.storageScript,r=t.id,n=t.dateFirstPublished,a=t.name,o=t.path,i=t.dateLastPublished,c=t.isCreator,u=t.mruItemId;return{id:r,dateFirstPublished:n,name:a,path:o,dateLastModified:e.localUpdates.dateLastModified,dateLastPublished:i,isCreator:c,mruItemId:u}}(e)})),n=new i.b("LocalStorage","System");e.write(h,r)?n.succeed(i.a.Information,{content:"mru"}):n.fail(i.a.Warning,{content:"mru"},new Error("Failed to write to local storage"))}(m,e)}function O(){try{var e=m.read(h);return e?e.reduce((function(e,t){var r=l.read(t.id);if(r)return[].concat(e,[r]);if(!t.dateFirstPublished)return e;var n=t.id,a=t.dateFirstPublished,o=t.name,i=t.path,c=t.dateLastModified,u=t.dateLastPublished,s=t.isCreator,d=t.mruItemId;return[].concat(e,[{storageScript:{id:n,dateFirstPublished:a,name:o,path:i,dateLastPublished:u,isCreator:s,mruItemId:d},localUpdates:{dateLastModified:c}}])}),[]):[]}catch(t){return[]}}var v=new o.a("storageidshareidpairs",4e4,0,{canPurge:function(){return!0},compare:s});function T(){return v.keys().map((function(e){return{shareId:e,storageId:v.read(e)}}))}function y(e){v.write(e.shareId,e.storageId)}function R(e){return v.purge(e)}},694:function(e,t,r){"use strict";var n=r(656),a={backstage:n.b,bottomPanel:n.c,consentDialog:n.d,authDialog:n.a,shareDialog:n.o,unshareDialog:n.p,dialog:n.f,editor:n.g,messageBar:n.i,misc:n.j,run:n.k,scripts:n.m,settings:n.n};t.a=a},695:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e&&!!e.storageScript.dateLastPublished}},696:function(e,t,r){"use strict";var n=r(89),a=r(0),o=r.n(a),i=r(983),c=r.n(i),u=r(1491),s=r(1448);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}t.a=Object(n.e)((function(e){var t=e.theme,r=e.styles,n=e.primary,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,["theme","styles","primary"]);return n?o.a.createElement(u.a,l({styles:c()(d(t),r)},a)):o.a.createElement(s.a,l({styles:c()(f(t),r)},a))}));var d=function(e){return{root:{borderRadius:"2px",fontSize:e.fontSizes.small,fontWeight:e.fontWeights.semibold,height:"2.6rem"}}},f=function(e){return{root:{borderRadius:"2px",fontSize:e.fontSizes.small,fontWeight:e.fontWeights.semibold,height:"2.6rem",backgroundColor:""+e.colors.neutralLighterAlt,border:"1px solid "+e.colors.neutralTertiary}}}},697:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(e){Object.defineProperty(this,"initFn",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cachedPromise",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),this.initFn=e}var t=e.prototype;return t.promise=function(){return this.cachedPromise||(this.cachedPromise=this.initFn()),this.cachedPromise},t.forget=function(){this.cachedPromise=void 0},t.get=function(){var e=this;return function(){return e.promise()}},e}()},703:function(e,t,r){"use strict";var n=r(694);r.d(t,"a",(function(){return n.a}));var a=r(704);r.d(t,"b",(function(){return a.a}))},704:function(e,t,r){"use strict";var n=r(659);t.a={backstage:n.b,bottomPanel:n.c,consentDialog:n.d,authDialog:n.a,shareDialog:n.l,unshareDialog:n.m,editor:n.f,run:n.h,scripts:n.j,settings:n.k}},705:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return i}));var n="scripts",a="samples-",o="Microsoft",i="Microsoft Corporation"},706:function(e,t,r){"use strict";function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}r.d(t,"a",(function(){return a}));var a=function(e,t){return{storageScript:n({},e,{shareId:void 0}),localUpdates:n({shareId:e.shareId,dateLastModified:e.dateLastPublished?Math.min(e.dateLastPublished,Date.now()):Date.now(),body:e.body,parameterInfo:e.parameterInfo,apiInfo:e.apiInfo},t)}}},708:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return f})),r.d(t,"d",(function(){return p})),r.d(t,"c",(function(){return b})),r.d(t,"e",(function(){return g}));var n=r(705),a=r(793),o=r(20),i=r(706),c=r(19),u=r(15);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function l(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}var d=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=Object(u.j)("Script"))){e.next=19;break}if(e.prev=2,(r=JSON.parse(t)).id){e.next=6;break}throw new Error("Object does not contain an 'id'.");case 6:if(!r.id.startsWith(n.d)){e.next=12;break}return e.next=9,Object(a.a)(r.id);case 9:return e.abrupt("return",e.sent);case 12:return c=Object(i.a)(r,{shareId:r.shareId}),e.abrupt("return",c);case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(2),new o.b("Unable to parse initial active script",e.t0);case 19:return e.abrupt("return",void 0);case 20:case"end":return e.stop()}}),e,null,[[2,16]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){l(o,n,a,i,c,"next",e)}function c(e){l(o,n,a,i,c,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}(),f=function(){var e=Object(u.j)("DocumentHostInfo");if(e){var t;try{t=JSON.parse(e)}catch(r){throw new Error("Unable to parse InitialDocumentHostInfo.")}if(!t.ServerDocId)throw new Error("Object does not contain a 'ServerDocId'.");if(!t.TenantId)throw new Error("Object does not contain a 'TenantId'.");return t}throw new Error("DocumentHostInfo is undefined")},p=function(){var e=Object(c.i)();if(e)return e.recentScripts?e.recentScripts.map((function(e){return Object(i.a)(s({},e,{isCreator:!0}))})):void 0},b=function(){var e=Object(c.i)();if(e)return e.publishedScripts?e.publishedScripts.map((function(e){return Object(i.a)(s({},e,{isCreator:!0}))})):void 0},g=function(){var e=Object(c.i)();if(e)return e.workbookScripts?e.workbookScripts.map((function(e){return Object(i.a)(e)})):void 0}},710:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"e",(function(){return a})),r.d(t,"f",(function(){return o})),r.d(t,"d",(function(){return i})),r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return u}));var n={recordedScriptsKey:"recorded-maker-scripts",sharedScriptsKey:"shared-maker-scripts",attachedIdsKey:"workbook-attached-ids"},a="0a088C17MOCKPUID",o="Name",i="name@contoso.com",c="Tenant-guid",u="Contoso"},712:function(e,t,r){"use strict";r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return c})),r.d(t,"e",(function(){return s})),r.d(t,"a",(function(){return l})),r.d(t,"d",(function(){return d}));var n=r(98),a=r(25),o=r(15);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var c,u="settings";function s(){return Object.keys(l).reduce((function(e,t){var r;return i({},e,((r={})[t]=l[t].defaultValue,r))}),{})}!function(e){e.VS="vs",e.VSDark="vs-dark",e.HCBlack="hc-black"}(c||(c={}));var l={"editor.theme":{userFacingName:strings.Editor.SettingsThemeLabel,defaultValue:function(){if(!Object(a.a)())return"Office";var e=Object(o.g)();return function(e){switch(e){case"Black":case"Dark Gray":return"Dark";case"High Contrast":return"High Contrast";case"Colorful":case"White":return"Light";default:return"Office"}}(Object(n.a)(e))}(),enum:["Office","Dark","Light","High Contrast"],displayText:{EditorTheme:strings.Editor.SettingsThemeNameOffice,Dark:strings.Editor.SettingsThemeNameDark,Light:strings.Editor.SettingsThemeNameLight,"High Contrast":strings.Editor.SettingsThemeNameHighContrast}},"editor.fontSize":{userFacingName:strings.Editor.SettingsFontSizeLabel,defaultValue:12,enum:[4,8,10,12,14,16,18,20,22,24,28,32,36]},"editor.wordWrap":{userFacingName:strings.Editor.SettingsWordWrapLabel,defaultValue:"Bounded",enum:["On","Off","Bounded"],displayText:{On:strings.Editor.SettingsWordWrapOptionOn,Off:strings.Editor.SettingsWordWrapOptionOff,Bounded:strings.Editor.SettingsWordWrapOptionBounded}},"editor.tabSize":{userFacingName:strings.Editor.SettingsTabSizeLabel,defaultValue:2,enum:[2,4]},"editor.minimap":{userFacingName:strings.Editor.SettingsMinimapLabel,defaultValue:!1},"editor.folding":{userFacingName:strings.Editor.SettingsFoldingLabel,defaultValue:!0},"editor.extension":{userFacingName:"Visual Studio Code online",defaultValue:!1,flightName:"OfficeScriptConnection"}};function d(){return{storageId:"",isOwner:!0,groupSectionStatus:{descriptionGroup:!1,scriptAccessGroup:!0,scriptActivityGroup:!0,securityGroup:!0},runCount:0,promptShare:!0}}},715:function(e,t,r){"use strict";function n(){return/MSIE|Trident/.test(window.navigator.userAgent)}r.d(t,"a",(function(){return n}))},716:function(e,t,r){"use strict";t.a=function(e){var t=e.when,r=e.children;return t?r:null}},718:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(794);function a(e){if(e){var t=e.storageScript.apiInfo;return!!t&&JSON.parse(t).variant===n.a}return!0}},723:function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"d",(function(){return c}));var n=r(47),a="run",o="main",i=2e3;function c(){var e=Object(n.d)();switch(e){case n.b.makerservicetest:return u("https://test.arbitraryrunner.com");case n.b.makerserviceint:return u("https://runtime.arbitraryrunner.com");case n.b.makerservicelocal:return u("http://localhost:30002");case n.b.localstorage:case n.b.makerserviceprodnew:return u("https://officescripts.microsoftusercontent.com");default:throw new Error("Unexpected environment "+e+" passed to getRuntimeUrl")}}function u(e){return e+"/eed0a086-3498-4f91-a377-1e0265ecc0cc"}},730:function(e,t,r){"use strict";r.r(t),r.d(t,"edit",(function(){return a})),r.d(t,"apply",(function(){return o}));var n=r(657),a=Object(n.createAsyncAction)("SETTINGS_EDIT_REQUEST","SETTINGS_EDIT_SUCCESS","SETTINGS_EDIT_FAILURE")(),o=Object(n.createAction)("SETTINGS_APPLY")},731:function(e,t,r){"use strict";r.r(t),r.d(t,"get",(function(){return a})),r.d(t,"getAll",(function(){return o}));var n=r(712),a=function(e,t){if(!Object.keys(e[n.b].settings).includes(t))throw new Error("Unable to select setting '"+t+"' from settings.");return e[n.b].settings[t]},o=function(e){return e[n.b].settings}},737:function(e,t,r){"use strict";function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e){return n({},e.storageScript,{shareId:e.localUpdates.shareId})}r.d(t,"a",(function(){return a}))},742:function(e,t,r){"use strict";r.r(t),r.d(t,"show",(function(){return a})),r.d(t,"hide",(function(){return o})),r.d(t,"addOutputLogs",(function(){return i})),r.d(t,"clearOutputLogs",(function(){return c})),r.d(t,"setProblemsLogs",(function(){return u})),r.d(t,"clearProblemsLogs",(function(){return s})),r.d(t,"setCurrentPivot",(function(){return l})),r.d(t,"setHelpLinks",(function(){return d}));var n=r(657),a=Object(n.createAction)("BOTTOM_PANEL_SHOW"),o=Object(n.createAction)("BOTTOM_PANEL_HIDE"),i=Object(n.createAction)("BOTTOM_PANEL_ADD_OUTPUT_LOGS",(function(e){return function(t){return e(t)}})),c=Object(n.createAction)("BOTTOM_PANEL_CLEAR_OUTPUT_LOGS"),u=Object(n.createAction)("BOTTOM_PANEL_SET_PROBLEMS_LOGS",(function(e){return function(t){return e(t)}})),s=Object(n.createAction)("BOTTOM_PANEL_CLEAR_PROBLEMS_LOGS"),l=Object(n.createStandardAction)("BOTTOM_PANEL_SET_CURRENT_PIVOT")(),d=Object(n.createStandardAction)("BOTTOM_PANEL_SET_HELP_LINKS")()},743:function(e,t,r){"use strict";r.r(t),r.d(t,"show",(function(){return a})),r.d(t,"hide",(function(){return o}));var n=r(657),a=Object(n.createAction)("CONSENT_DIALOG_SHOW"),o=Object(n.createAction)("CONSENT_DIALOG_HIDE")},744:function(e,t,r){"use strict";r.r(t),r.d(t,"show",(function(){return a})),r.d(t,"hide",(function(){return o}));var n=r(657),a=Object(n.createAction)("AUTH_DIALOG_SHOW",(function(e){return function(t){return e(t)}})),o=Object(n.createAction)("AUTH_DIALOG_HIDE")},745:function(e,t,r){"use strict";r.r(t),r.d(t,"start",(function(){return a})),r.d(t,"success",(function(){return o})),r.d(t,"failure",(function(){return i})),r.d(t,"unsupported",(function(){return c})),r.d(t,"cancel",(function(){return u})),r.d(t,"consentDenied",(function(){return s})),r.d(t,"clearPreviousRun",(function(){return l}));var n=r(657),a=Object(n.createAction)("RUN_SCRIPT_START"),o=Object(n.createAction)("RUN_COMPLETE_SUCCESS",(function(e){return function(t){return e(t)}})),i=Object(n.createAction)("RUN_COMPLETE_FAILURE",(function(e){return function(t){return e(t)}})),c=Object(n.createAction)("RUN_COMPLETE_UNSUPPORTED"),u=Object(n.createAction)("RUN_CANCEL"),s=Object(n.createAction)("RUN_CONSENT_DENIED"),l=Object(n.createAction)("RUN_CLEAR_PREVIOUS")},746:function(e,t,r){"use strict";r.r(t),r.d(t,"publishedScriptMetadataReceived",(function(){return a})),r.d(t,"storageCallInProgress",(function(){return o})),r.d(t,"storageCallComplete",(function(){return i})),r.d(t,"mergeMetadataFromRibbon",(function(){return c})),r.d(t,"mergeSharedMetadataFromRibbon",(function(){return u})),r.d(t,"fetchMetadataFromStorage",(function(){return s})),r.d(t,"fetchScriptsFromDocument",(function(){return l})),r.d(t,"fetchSamples",(function(){return d})),r.d(t,"fetchScriptFromStorage",(function(){return f})),r.d(t,"fetchSharedScriptFromStorage",(function(){return p})),r.d(t,"editBody",(function(){return b})),r.d(t,"partialUpdate",(function(){return g})),r.d(t,"update",(function(){return h})),r.d(t,"remove",(function(){return m})),r.d(t,"updateConsent",(function(){return S})),r.d(t,"addButtonToWorkbook",(function(){return O})),r.d(t,"addScriptToWorkbook",(function(){return v})),r.d(t,"removeScriptFromWorkbook",(function(){return T})),r.d(t,"unshareScriptFromAllWorkbooks",(function(){return y})),r.d(t,"revertToLastSaved",(function(){return R})),r.d(t,"updateSavingStatus",(function(){return w})),r.d(t,"updateAttachingStatus",(function(){return j})),r.d(t,"fetchMRUMetadataFromStorage",(function(){return E})),r.d(t,"updateMRUScriptsIfShared",(function(){return A})),r.d(t,"moveMRUScriptToTop",(function(){return _})),r.d(t,"mruScriptMetadataReceived",(function(){return I})),r.d(t,"removeMRUScript",(function(){return C})),r.d(t,"invokeFilePicker",(function(){return k}));var n=r(657),a=Object(n.createAction)("SCRIPTS_PUBLISHED_METADATA_RECEIVED"),o=Object(n.createStandardAction)("SCRIPTS_STORAGE_CALL_IN_PROGRESS")(),i=Object(n.createStandardAction)("SCRIPTS_STORAGE_CALL_COMPLETE")(),c=Object(n.createStandardAction)("SCRIPTS_MERGE_METADATA_FROM_RIBBON")(),u=Object(n.createStandardAction)("SCRIPTS_MERGE_SHARED_METADATA_FROM_RIBBON")(),s=Object(n.createAsyncAction)("SCRIPTS_FETCH_METADATA_FROM_STORAGE_REQUEST","SCRIPTS_FETCH_METADATA_FROM_STORAGE_SUCCESS","SCRIPTS_FETCH_METADATA_FROM_STORAGE_FAILURE")(),l=Object(n.createAsyncAction)("SCRIPTS_FETCH_METADATA_FROM_DOCUMENT_REQUEST","SCRIPTS_FETCH_METADATA_FROM_DOCUMENT_SUCCESS","SCRIPTS_FETCH_METADATA_FROM_DOCUMENT_FAILURE")(),d=Object(n.createAsyncAction)("SCRIPTS_FETCH_SAMPLES_REQUEST","SCRIPTS_FETCH_SAMPLES_SUCCESS","SCRIPTS_FETCH_SAMPLES_FAILURE")(),f=Object(n.createAsyncAction)("SCRIPTS_FETCH_REQUEST","SCRIPTS_FETCH_SUCCESS","SCRIPTS_FETCH_FAILURE")(),p=Object(n.createAsyncAction)("SCRIPTS_SHARED_FETCH_REQUEST","SCRIPTS_SHARED_FETCH_SUCCESS","SCRIPTS_SHARED_FETCH_FAILURE")(),b=Object(n.createStandardAction)("SCRIPTS_EDIT")(),g=Object(n.createStandardAction)("SCRIPTS_PARTIAL_UPDATE")(),h=Object(n.createStandardAction)("SCRIPTS_UPDATE")(),m=Object(n.createAsyncAction)("SCRIPTS_REMOVE_REQUEST","SCRIPTS_REMOVE_SUCCESS","SCRIPTS_REMOVE_FAILURE")(),S=Object(n.createStandardAction)("SCRIPTS_UPDATE_CONSENT")(),O=Object(n.createAsyncAction)("SCRIPTS_ADD_BUTTON_TO_WORKBOOK_REQUEST","SCRIPTS_ADD_BUTTON_TO_WORKBOOK_SUCCESS","SCRIPTS_ADD_BUTTON_TO_WORKBOOK_FAILURE")(),v=Object(n.createAsyncAction)("SCRIPTS_ADD_TO_WORKBOOK_REQUEST","SCRIPTS_ADD_TO_WORKBOOK_SUCCESS","SCRIPTS_ADD_TO_WORKBOOK_FAILURE")(),T=Object(n.createAsyncAction)("SCRIPTS_REMOVE_FROM_WORKBOOK_REQUEST","SCRIPTS_REMOVE_FROM_WORKBOOK_SUCCESS","SCRIPTS_REMOVE_FROM_WORKBOOK_FAILURE")(),y=Object(n.createAsyncAction)("SCRIPTS_UNSHARE_FROM_ALL_WORKBOOKS_REQUEST","SCRIPTS_UNSHARE_FROM_ALL_WORKBOOKS_SUCCESS","SCRIPTS_UNSHARE_FROM_ALL_WORKBOOKS_FAILURE")(),R=Object(n.createStandardAction)("SCRIPTS_REVERT_TO_SAVED")(),w=Object(n.createStandardAction)("SCRIPTS_UPDATE_SAVING_STATUS")(),j=Object(n.createStandardAction)("SCRIPTS_UPDATE_ATTACHING_STATUS")(),E=Object(n.createAsyncAction)("SCRIPTS_MRU_FETCH_METADATA_FROM_STORAGE_REQUEST","SCRIPTS_MRU_FETCH_METADATA_FROM_STORAGE_SUCCESS","SCRIPTS_MRU_FETCH_METADATA_FROM_STORAGE_FAILURE")(),A=Object(n.createStandardAction)("SCRIPTS_MRU_UPDATE_SHARED")(),_=Object(n.createStandardAction)("SCRIPTS_MRU_MOVE_TO_TOP")(),I=Object(n.createAction)("SCRIPTS_MRU_METADATA_RECEIVED"),C=Object(n.createStandardAction)("SCRIPTS_MRU_REMOVE")(),k=Object(n.createStandardAction)("SCRIPTS_MRU_INVOKE_FILE_PICKER")()},747:function(e,t,r){"use strict";r.r(t),r.d(t,"setActiveScript",(function(){return a})),r.d(t,"attemptToRunScriptFromLink",(function(){return o})),r.d(t,"viewScript",(function(){return i})),r.d(t,"setFetchErrorText",(function(){return c}));var n=r(657),a=Object(n.createAction)("RFB_SET_ACTIVE_SCRIPT",(function(e){return function(t){return e(t)}})),o=Object(n.createAction)("RFB_ATTEMPT_TO_RUN",(function(e){return function(t){return e(t)}})),i=Object(n.createAction)("RFB_VIEW_SCRIPT",(function(e){return function(t){return e(t)}})),c=Object(n.createAction)("RFB_SET_FETCH_ERROR_TEXT",(function(e){return function(t){return e(t)}}))},748:function(e,t,r){"use strict";r.r(t),r.d(t,"getIsLoading",(function(){return a})),r.d(t,"getActiveScriptId",(function(){return o})),r.d(t,"getIsDetailsPageVisible",(function(){return i})),r.d(t,"getExternalContentUpdateCounter",(function(){return c})),r.d(t,"getNavigationSourcePage",(function(){return u})),r.d(t,"getIsMakingACopy",(function(){return s})),r.d(t,"getIsEditingScriptName",(function(){return l})),r.d(t,"getMostRecentRecorderHeartbeatReceived",(function(){return d})),r.d(t,"getDetailsNavigateSource",(function(){return f}));var n=r(828),a=function(e){return e[n.b].isLoading},o=function(e){return e[n.b].active},i=function(e){return e[n.b].isDetailsPageVisible},c=function(e){return e[n.b].externalContentUpdateCounter},u=function(e){return e[n.b].navigationSourcePage},s=function(e){return e[n.b].isMakingACopy},l=function(e){return e[n.b].isEditingScriptName},d=function(e){return e[n.b].mostRecentRecorderHeartbeatReceived},f=function(e){return e[n.b].detailsNavigateSource}},751:function(e,t,r){"use strict";function n(e){return void 0===e||null===e}r.d(t,"a",(function(){return n}))},752:function(e,t,r){"use strict";function n(e,t){var r=1,n="",a=e.map((function(e){return e.toLowerCase()}));do{n=t+" "+r++}while(a.includes(n.toLowerCase()));return n}function a(e){for(var t=Math.pow(16,6),r=Math.pow(16,5),n=Math.floor(Math.random()*t);n<r;)n+=r;return e+" "+n.toString(16)}function o(e,t){var r=1,n=t.match(/ \(([0-9]+)\)$/);for(n&&(t=t.replace(n[0],""),r=Number(n[1])+1);e.includes(t+" ("+r+")");)r++;return t+" ("+r+")"}r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return o}))},755:function(e,t,r){"use strict";function n(e){return JSON.parse(e.data)}r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return o}));var a=function(e,t){return e.lastWrite-t.lastWrite},o=function(){function e(e,t,r,n){if(Object.defineProperty(this,"_rootKey",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_maxSpace",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_expire",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_allValues",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_evaluator",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),!e||!t||t>3e6||!n)throw new Error("Invalid param");this._rootKey=e+".",this._maxSpace=t,this._expire=r,this._evaluator=n}var t=e.prototype;return t.keys=function(){this.ensureInitialized();var e=this._rootKey.length;return Object.keys(this._allValues).map((function(t){return t.substring(e)}))},t.read=function(e){this.ensureInitialized();var t=this.fullKey(e);this.purgeExpired();var r=this._allValues[t];return r?n(r):void 0},t.write=function(e,t){this.ensureInitialized();var r=this.fullKey(e),n={data:JSON.stringify(t),lastWrite:Date.now()};try{return this.purgeOversize(this._maxSpace-n.data.length),this.totalSize()>this._maxSpace-n.data.length?!1:(this.doStorageWrite(r,JSON.stringify(n)),this._allValues[r]=n,!0)}catch(a){return!1}},t.purge=function(e){this.ensureInitialized();var t=this.keys().indexOf(e)>=0;if(t){var r=this.fullKey(e);this.removeKey(r)}return t},t.purgeOversize=function(e){var t=0,r=this.sortByValue();for(e=Math.max(0,e);this.totalSize()>e;){var n=r.shift();if(!n)throw new Error("Ran out of keys before we ran out of size.");this.canPurgeKey(n)&&(this.removeKey(n),t++)}return t},t.purgeExpired=function(){var e=this,t=0,r=Date.now();return Object.keys(this._allValues).forEach((function(n){var a=e._allValues[n];e._expire>0&&r-e._expire>a.lastWrite&&e.canPurgeKey(n)&&(e.removeKey(n),delete e._allValues[n],t++)})),t},t.canPurgeKey=function(e){return this.canPurgeEntry(this._allValues[e])},t.canPurgeEntry=function(e){return this._evaluator.canPurge(e)},t.readAll=function(){var e=this,t={},r=this.tryOrDefault((function(){return e.doStorageValueOf()}),{});return Object.keys(r).filter((function(t){return 0===t.indexOf(e._rootKey)})).forEach((function(n){try{var a=JSON.parse(r[n]);t[n]=a}catch(o){e.doStorageRemove(n)}})),t},t.totalSize=function(){var e=this,t=Object.keys(this._allValues),r=0;return t.forEach((function(t){r+=e._allValues[t].data.length})),r},t.sortByValue=function(){var e=this,t=Object.keys(this._allValues);return t.sort((function(t,r){var n=e._allValues[t],a=e._allValues[r];return e._evaluator.compare(n,a)})),t},t.fullKey=function(e){return this._rootKey+e},t.removeKey=function(e){try{delete this._allValues[e],this.doStorageRemove(e)}catch(t){return!1}return!0},t.ensureInitialized=function(){this._allValues||(this._allValues=this.readAll(),this.purgeExpired())},t.doStorageWrite=function(e,t){localStorage.setItem(e,t)},t.doStorageRemove=function(e){localStorage.removeItem(e)},t.doStorageValueOf=function(){return localStorage.valueOf()},t.tryOrDefault=function(e,t){try{return e()}catch(r){return t}},e}()},761:function(e,t,r){"use strict";r.r(t),r.d(t,"get",(function(){return p})),r.d(t,"getMRU",(function(){return b})),r.d(t,"getAllMRUScripts",(function(){return g})),r.d(t,"getAll",(function(){return h})),r.d(t,"getAllMyScripts",(function(){return m})),r.d(t,"getAllDocAttachedScripts",(function(){return S})),r.d(t,"getAllNonOwnedScripts",(function(){return O})),r.d(t,"getAllSampleScripts",(function(){return v})),r.d(t,"getAllPotentialOrphanScripts",(function(){return T})),r.d(t,"getAllMyScriptsInLastModifiedOrder",(function(){return y})),r.d(t,"getAllSampleScriptsInSortIndexOrder",(function(){return R})),r.d(t,"getScriptNames",(function(){return w})),r.d(t,"getOwnedScriptNames",(function(){return j})),r.d(t,"getOtherScriptNames",(function(){return E})),r.d(t,"getOtherOwnedScriptNames",(function(){return A})),r.d(t,"getOtherNonOwnedScriptNames",(function(){return _})),r.d(t,"getAllUnpublished",(function(){return I})),r.d(t,"getAllPublished",(function(){return C})),r.d(t,"getHasReceivedMetadata",(function(){return k})),r.d(t,"getHasReceivedMRUMetadata",(function(){return P})),r.d(t,"getHasLoadedAttachedScripts",(function(){return D})),r.d(t,"getSavingStatus",(function(){return F})),r.d(t,"getAttachingStatus",(function(){return U})),r.d(t,"getIsStorageCallInProgress",(function(){return L})),r.d(t,"getIsAnyStorageCallInProgress",(function(){return M})),r.d(t,"getIsConsented",(function(){return x}));var n=r(705),a=r(981),o=r(695),i=r(662),c=r(691),u=r(687),s=r(675),l=r(29);function d(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}function f(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var p=function(e,t){if(t){var r=Object(l.a)("RecentScripts")?b(e,t):void 0,a=e[n.a].scripts[t];return r||a}},b=function(e,t){return t?e[n.a].mruScripts.find((function(e){return e.storageScript.id===t})):void 0},g=function(e){return e[n.a].mruScripts.slice(0,30)},h=function(e){return Object.values(e[n.a].scripts)},m=function(e){return Object.values(e[n.a].scripts).filter((function(e){return Object(i.a)(e)}))},S=function(e){return Object.values(e[n.a].scripts).filter((function(e){return Object(u.a)(e)}))},O=function(e){return Object.values(e[n.a].scripts).filter((function(e){return!Object(i.a)(e)}))},v=function(e){return Object.values(e[n.a].scripts).filter((function(e){return Object(s.a)(e)}))},T=function(e,t){return Object.values(e[n.a].scripts).filter((function(e){return-1===t.findIndex((function(t){return t.storageScript.id===e.storageScript.id}))}))},y=Object(a.a)([m],(function(e){return e.sort((function(e,t){return t.localUpdates.dateLastModified-e.localUpdates.dateLastModified}))})),R=Object(a.a)([v],(function(e){return e.sort((function(e,t){return e.storageScript.sortIndex-t.storageScript.sortIndex}))})),w=function(e){return Object.values(e[n.a].scripts).map((function(e){return e.storageScript.name}))},j=function(e){return Object.values(e[n.a].scripts).filter((function(e){return Object(i.a)(e)})).map((function(e){return e.storageScript.name}))},E=function(e,t){var r=e[n.a].scripts,a=(r[t],d(r,[t].map(f)));return Object.values(a).map((function(e){return e.storageScript.name}))},A=function(e,t){var r=e[n.a].scripts,a=(r[t],d(r,[t].map(f))),o=Object.values(a).filter((function(e){return Object(i.a)(e)}));return Object.values(o).map((function(e){return e.storageScript.name}))},_=function(e,t){var r=e[n.a].scripts,a=(r[t],d(r,[t].map(f))),o=Object.values(a).filter((function(e){return!Object(i.a)(e)}));return Object.values(o).map((function(e){return e.storageScript.name}))},I=Object(a.a)([m],(function(e){return e.filter((function(e){return!Object(o.a)(e)}))})),C=Object(a.a)([m],(function(e){return e.filter((function(e){return Object(o.a)(e)}))})),k=function(e){return e[n.a].hasReceivedMetadata},P=function(e){return e[n.a].hasReceivedMRUMetadata},D=function(e){return e[n.a].hasLoadedAttachedScripts},F=function(e,t){if(!t)return"None";var r=e[n.a].scriptsSavingStatus[t],a=p(e,t);return r&&a?function(e,t){var r=Object(c.a)(e);return"Succeeded"===t&&r?"None":t}(a,r):"None"},U=function(e,t){if(!t)return"None";var r=e[n.a].scriptsAttachingStatus[t];return r||"None"},L=function(e,t){return!!t&&!!e[n.a].scriptsIsStorageCallInProgress[t]},M=function(e){return!!e[n.a].scriptsIsAnyStorageCallInProgress},x=function(e,t){return!!t&&!!e[n.a].scriptsIsConsented[t]}},764:function(e,t,r){"use strict";var n=r(89).c.div.withConfig({displayName:"TaskpaneWrapper",componentId:"sc-1kkkq32-0"})(["height:100vh;min-height:100vh;width:100%;overflow:hidden;display:flex;flex-direction:column;background:",";"],(function(e){return e.theme.colors.neutralLight}));t.a=n},765:function(e,t,r){"use strict";r.r(t),r.d(t,"show",(function(){return a})),r.d(t,"hide",(function(){return o})),r.d(t,"setCurrentPivot",(function(){return i})),r.d(t,"setIsReactMonacoLoaded",(function(){return c}));var n=r(657),a=Object(n.createAction)("BACKSTAGE_SHOW"),o=Object(n.createAction)("BACKSTAGE_HIDE"),i=Object(n.createStandardAction)("BACKSTAGE_SET_CURRENT_PIVOT")(),c=Object(n.createAction)("BACKSTAGE_SET_REACTMONACO_LOADED")},766:function(e,t,r){"use strict";r.r(t),r.d(t,"setRecordingState",(function(){return a})),r.d(t,"updateIntentList",(function(){return o}));var n=r(657),a=Object(n.createStandardAction)("MACRO_RECORDER_SETSTATE")(),o=Object(n.createAction)("MACRO_RECORDER_UPDATE_INTENT_LIST",(function(e){return function(t){return e(t)}}))},767:function(e,t,r){"use strict";r.r(t),r.d(t,"show",(function(){return i})),r.d(t,"dismiss",(function(){return c})),r.d(t,"reset",(function(){return u}));var n=r(657),a=r(827);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var i=Object(n.createAction)("MESSAGE_BAR_SHOW",(function(e){return function(t){var r=o({},a.b,{isVisible:!0},t);return e(r)}})),c=Object(n.createAction)("MESSAGE_BAR_HIDE"),u=Object(n.createAction)("MESSAGE_BAR_RESET_STATE")},768:function(e,t,r){"use strict";r.r(t),r.d(t,"show",(function(){return a})),r.d(t,"hide",(function(){return o}));var n=r(657),a=Object(n.createAction)("SHARE_DIALOG_SHOW"),o=Object(n.createAction)("SHARE_DIALOG_HIDE")},769:function(e,t,r){"use strict";r.r(t),r.d(t,"show",(function(){return a})),r.d(t,"hide",(function(){return o}));var n=r(657),a=Object(n.createAction)("UNSHARE_DIALOG_SHOW"),o=Object(n.createAction)("UNSHARE_DIALOG_HIDE")},782:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return l}));var n=r(690),a=r(691),o=r(2),i=r(29),c=function(e){return!!e.storageScript.path&&e.storageScript.path.length>0};function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e){var t=e.incomingScript,r=e.existingScript;if(!r)return{selectedScript:t,isLocalBodyUpdated:!1,hasConflict:!1};if(!r.storageScript.dateLastPublished||!t.storageScript.dateLastPublished){var s=new Error("Unable to compare scripts that have not been published.");return Object(o.g)(s,o.a.EngineeringError,{storageId:r.storageScript.id}),{selectedScript:t,isLocalBodyUpdated:!1,hasConflict:!1}}if(!c(t)&&c(r)&&(t={storageScript:u({},t.storageScript,{path:r.storageScript.path}),localUpdates:t.localUpdates}),Object(i.a)("RecentScripts")||Object(i.a)("PopulateRecentScripts")){var b=t.storageScript.mruItemId||r.storageScript.mruItemId;r.storageScript=u({},r.storageScript,{mruItemId:b}),t.storageScript=u({},t.storageScript,{mruItemId:b})}var g=t.localUpdates.shareId||r.localUpdates.shareId;return t.localUpdates.shareId=g,r.localUpdates.shareId=g,r.localUpdates.shareId=t.localUpdates.shareId,void 0===r.storageScript.isCreator&&(r.storageScript=u({},r.storageScript,{isCreator:t.storageScript.isCreator}),Object(o.g)(new Error("Did not find isCreator on cached script."),o.a.Information,{storageId:r.storageScript.id})),f(t,r)&&(r.storageScript=u({},r.storageScript,{path:t.storageScript.path})),Object(n.a)(r)&&!d(t,r)?{selectedScript:r,isLocalBodyUpdated:!1,hasConflict:!1}:Object(a.a)(r)&&d(t,r)?p(t,r)?{selectedScript:r,isLocalBodyUpdated:!1,hasConflict:!0}:{selectedScript:l(t,r),isLocalBodyUpdated:!1,hasConflict:!1}:{selectedScript:t,isLocalBodyUpdated:p(t,r),hasConflict:!1}}var l=function(e,t){return{storageScript:e.storageScript,localUpdates:t.localUpdates}},d=function(e,t){return e.storageScript.dateLastPublished>t.storageScript.dateLastPublished},f=function(e,t){return e.storageScript.path!==t.storageScript.path},p=function(e,t){return!!t&&e.storageScript.body!==t.storageScript.body}},783:function(e,t,r){"use strict";r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return d}));var n=r(926),a=r(78),o=r.n(a),i=r(794);function c(){var e={variant:i.a,variantVersion:2};return JSON.stringify(e)}var u=r(710);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var l=function(e){var t=s({},d(),e);return{storageScript:t,localUpdates:{dateLastModified:Date.now(),body:t.body,parameterInfo:t.parameterInfo}}},d=function(){return{id:o()(),name:strings.Editor.NewScriptNameText,body:n.newScriptBody,description:"",apiInfo:c(),isCreator:!0,creatorId:u.e,creatorDisplayName:u.f,creatorEmail:u.d,mruItemId:o()()}}},793:function(e,t,r){"use strict";r.d(t,"b",(function(){return f})),r.d(t,"a",(function(){return b}));var n=r(705),a=r(2),o=r(706),i=r(890),c=r(718);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){s(o,n,a,i,c,"next",e)}function c(e){s(o,n,a,i,c,"throw",e)}i(void 0)}))}}var d=void 0;function f(){return p.apply(this,arguments)}function p(){return(p=l(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d){e.next=2;break}return e.abrupt("return",d);case 2:return t=new a.b("FetchSamples","System"),e.prev=3,r=h(),d=r.map((function(e){return Object(o.a)(e)})).filter((function(e){return Object(c.a)(e)})),t.succeed(a.a.Information,{}),e.abrupt("return",d);case 10:throw e.prev=10,e.t0=e.catch(3),t.fail(a.a.Error,{},e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[3,10]])})))).apply(this,arguments)}function b(e){return g.apply(this,arguments)}function g(){return(g=l(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:return r=e.sent,e.abrupt("return",r.find((function(e){return e.storageScript.id===t})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return i.map((function(e){var t=e.id,r=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,["id"]),a=strings.Samples[t];return u({},r,{id:n.d+t,creatorId:n.c,creatorDisplayName:n.b,isCreator:!1,name:a.name,description:a.description})}))}},794:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n="synchronous"},808:function(e,t,r){"use strict";function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}r.d(t,"a",(function(){return a}));var a=function(e,t){return{storageScript:e.storageScript,localUpdates:n({},e.localUpdates,t)}}},827:function(e,t,r){"use strict";r.d(t,"b",(function(){return u}));var n=r(656),a=r(657),o=r(166);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var c={style:1,isVisible:!0,urlLink:null,actionLink:null,isBlocking:!0,forceSingleLine:!0},u={isVisible:!1,style:0,text:"",urlLink:null,actionLink:null,isBlocking:!1,forceSingleLine:!1};t.a=function(e,t){void 0===e&&(e=u);var r=i({},c,{buttons:[{isPrimary:!0,text:strings.General.DismissButtonText,actions:[n.e.messageBar.dismiss()]}]});switch(t.type){case Object(a.getType)(n.e.scripts.remove.failure):return i({},r,{text:Object(o.a)(t.payload.error)?strings.Message.AccessDeniedForScriptAction:strings.Message.DeleteFailed});case Object(a.getType)(n.e.scripts.addScriptToWorkbook.failure):return Object(o.k)(t.payload.error)?i({},c,{text:strings.Message.FailedToOpenDeletedScriptMessage,buttons:[{isPrimary:!0,text:strings.General.OKButtonText,actions:[n.e.messageBar.dismiss(),n.e.backstage.setCurrentPivot("Recent"),n.e.backstage.show()]}]}):i({},r,{text:strings.Message.SharingFailed});case Object(a.getType)(n.e.scripts.removeScriptFromWorkbook.failure):return i({},r,{text:strings.Message.UnsharingFailed});case Object(a.getType)(n.e.scripts.unshareScriptFromAllWorkbooks.failure):return i({},r,{text:strings.Message.BlockingAccessFailed});case Object(a.getType)(n.e.run.unsupported):return i({},r,{text:strings.Message.ScriptUnsupportedError});case Object(a.getType)(n.e.editor.onOpenNewScript):return u;case Object(a.getType)(n.e.messageBar.show):return t.payload;case Object(a.getType)(n.e.messageBar.dismiss):return i({},e,{isVisible:!1});case Object(a.getType)(n.e.messageBar.reset):return u;default:return e}}},828:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a}));var n="editor",a=1.35},829:function(e,t,r){"use strict";var n=r(669),a=r(982),o=r(1078),i=r(48);t.a=function(e){var t=Object(o.a)({onError:function(e){return Object(i.c)(e)}}),r=Object(n.createStore)(e.rootReducer,e.initialState,Object(a.composeWithDevTools)(Object(n.applyMiddleware)(t)));return t.run(e.rootSaga),r}},839:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(690);function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var o=function(e,t){return function(e){if(!Object(n.b)(e))throw new Error("Trying to convert an incomplete CombinedStorageScript script to a StorageScript");return e}(a({},e.storageScript,e.localUpdates,t))}},848:function(e,t,r){"use strict";var n=r(89),a=r(0),o=r.n(a),i=r(24),c=r(47),u=r(716);t.a=function(){return o.a.createElement(u.a,{when:["local","alpha"].includes(Object(i.b)())},o.a.createElement(s,null,o.a.createElement("span",null,Object(i.b)()+" editor using "+Object(c.d)())))};var s=n.c.footer.withConfig({displayName:"EnvironmentFooter__Footer",componentId:"sc-1euq4le-0"})(["background-color:black;color:limegreen;height:",";width:100%;padding:0 1rem;display:flex;justify-content:flex-end;font-size:1.2rem;"],(function(e){return e.theme.spacing.medium}))},849:function(e,t,r){"use strict";var n=r(669),a=r(657),o=r(744);t.a=Object(n.combineReducers)({isVisible:function(e,t){switch(void 0===e&&(e=!1),t.type){case Object(a.getType)(o.show):return!0;case Object(a.getType)(o.hide):return!1;default:return e}},acceptFn:function(e,t){switch(void 0===e&&(e=function(){}),t.type){case Object(a.getType)(o.show):return t.payload.acceptFn;default:return e}},cancelFn:function(e,t){switch(void 0===e&&(e=function(e){}),t.type){case Object(a.getType)(o.show):return t.payload.cancelFn;default:return e}}})},850:function(e,t,r){"use strict";var n=r(656),a=r(657),o=r(1010);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var c={isVisible:!1,style:o.a.normal,title:"",subText:"",isBlocking:!0,buttons:[]};t.a=function(e,t){switch(void 0===e&&(e=c),t.type){case Object(a.getType)(n.e.dialog.show):return{isVisible:!0,style:t.payload.style||o.a.normal,title:t.payload.title,subText:t.payload.subText,isBlocking:t.payload.isBlocking,buttons:t.payload.buttons};case Object(a.getType)(n.e.dialog.hide):return i({},e,{isVisible:!1});case Object(a.getType)(n.e.dialog.reset):return c;default:return e}}},851:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(713),a=r(657),o=r(90),i=r(656),c=regeneratorRuntime.mark(l),u=regeneratorRuntime.mark(d),s=regeneratorRuntime.mark(f);function l(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(n.f)(d);case 2:return e.next=4,Object(n.k)(Object(a.getType)(i.f.dismiss),f);case 4:case"end":return e.stop()}}),c)}function d(){var e,t;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=3,Object(n.j)(Object(a.getType)(i.f.show));case 3:return r.next=6,Object(n.h)({show:Object(n.j)(Object(a.getType)(i.f.show)),dismiss:Object(n.j)(Object(a.getType)(i.f.dismiss))});case 6:if(e=r.sent,t=e.show,!e.dismiss){r.next=13;break}return r.abrupt("break",16);case 13:t&&(logger.error("A show was called while a dialog was already visible"),logger.error("Offending action: "+JSON.stringify(t,null,4)));case 14:r.next=3;break;case 16:r.next=0;break;case 18:case"end":return r.stop()}}),u)}function f(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(n.g)(i.f.hide());case 2:return e.next=4,Object(o.a)(500);case 4:return e.next=6,Object(n.g)(i.f.reset());case 6:case"end":return e.stop()}}),s)}},852:function(e,t,r){"use strict";var n=r(89),a=r(0),o=r.n(a),i=r(1511),c=r(1449),u=r(696),s=r(703),l=r(771),d=r.n(l),f=r(663);t.a=Object(n.e)((function(e){var t=e.dialogProps,r=e.dispatch,n=e.dismiss,a=e.theme;return o.a.createElement(i.a,{hidden:!t.isVisible,onDismiss:n,styles:{main:{backgroundColor:a.colors.neutralLighterAlt}},dialogContentProps:{type:t.style,title:t.title,subText:t.subText,styles:Object(f.c)(a)},modalProps:{isBlocking:t.isBlocking,styles:Object(f.b)()}},o.a.createElement(c.a,null,t.buttons.map((function(e){return o.a.createElement(u.a,{key:e.key,"data-testid":e.key,text:e.text,onClick:function(){e.lambda&&e.lambda(),Array.isArray(e.action)?e.action.forEach((function(e){return r(e)})):r(e.action),d()(e.action,s.a.dialog.dismiss())||r(s.a.dialog.dismiss())},primary:e.isPrimary})}))))}))},870:function(e,t,r){"use strict";var n=r(669),a=r(657),o=r(746),i=r(2),c=r(693),u=r(782);var s=r(679),l=r(691),d=r(29),f=r(687);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var b=r(662),g=r(808);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var m={};t.a=Object(n.combineReducers)({mruScripts:function(e,t){switch(void 0===e&&(e=[]),t.type){case Object(a.getType)(o.updateMRUScriptsIfShared):return function(e,t){return t.forEach((function(t){var r=e.findIndex((function(e){return e.storageScript.id===t.storageScript.id}));if(-1!=r){var n=Object(u.a)({incomingScript:t,existingScript:e[r]}).selectedScript;e[r]=n}})),e}([].concat(e),t.payload.scripts);case Object(a.getType)(o.fetchMRUMetadataFromStorage.success):return Object(d.a)("RecentScripts")?function(e,t){var r=e.reduce((function(e,t){var r;return h({},e,((r={})[t.storageScript.id]=t,r))}),{});t.forEach((function(e,n){var a=r[e.storageScript.id];if(a){var o=function(e,t){return{storageScript:p({},e.storageScript,{name:t.storageScript.name,fileUrl:t.storageScript.fileUrl,mruItemId:t.storageScript.mruItemId,path:t.storageScript.path}),localUpdates:e.localUpdates}}(a,e);t[n]=o,delete r[e.storageScript.id]}}));var n=[];Object.values(r).forEach((function(e){Object(s.a)(e)||Object(l.a)(e)?n.push(e):Object(c.b)(e.storageScript.id)}));var a=[].concat(n,t);return Object(c.f)(a.slice(0,30)),a}([].concat(e),t.payload.scripts):e;case Object(a.getType)(o.moveMRUScriptToTop):return function(e,t){var r=e.findIndex((function(e){return e.storageScript.id===t}));if(-1!=r){var n=e.splice(r,1),a=[].concat(n,e);return Object(c.f)(a.slice(0,30)),a}return e}([].concat(e),t.payload.id);case Object(a.getType)(o.update):return Object(d.a)("RecentScripts")&&Object(b.a)(t.payload)?y([].concat(e),t.payload):e;case Object(a.getType)(o.remove.request):return Object(d.a)("RecentScripts")?T([].concat(e),t.payload):e;case Object(a.getType)(o.remove.failure):return Object(d.a)("RecentScripts")?y([].concat(e),t.payload.fallbackValue):e;case Object(a.getType)(o.removeMRUScript):return T([].concat(e),t.payload);case Object(a.getType)(o.partialUpdate):var r=e.findIndex((function(e){return e.storageScript.id===t.payload.id}));if(Object(d.a)("RecentScripts")&&-1!=r){var n=e[r],i=Object(g.a)(n,t.payload.updatedFields);return y([].concat(e),i)}return e;default:return e}},scripts:function(e,t){switch(void 0===e&&(e=m),t.type){case Object(a.getType)(o.fetchScriptsFromDocument.success):return O(h({},e),t.payload.scripts,!0);case Object(a.getType)(o.mergeMetadataFromRibbon):return S(h({},e),t.payload.scripts,"Ribbon"),O(h({},e),t.payload.scripts);case Object(a.getType)(o.mergeSharedMetadataFromRibbon):return O(h({},e),t.payload.scripts,!0);case Object(a.getType)(o.fetchMetadataFromStorage.success):return S(h({},e),t.payload.scripts,"Service"),O(h({},e),t.payload.scripts);case Object(a.getType)(o.fetchSamples.success):return O(h({},e),t.payload.scripts,!0);case Object(a.getType)(o.update):return v(h({},e),t.payload);case Object(a.getType)(o.remove.request):var r=h({},e);return delete r[t.payload.storageScript.id],r;case Object(a.getType)(o.remove.success):var n=h({},e);return delete n[t.payload.script.storageScript.id],n;case Object(a.getType)(o.remove.failure):return v(h({},e),t.payload.fallbackValue);case Object(a.getType)(o.partialUpdate):var u=e[t.payload.id];if(Object(i.h)({eventName:"PartiallyUpdateScript",eventType:"User",data:{logLevel:i.a.Information,storageId:t.payload.id,updatedFields:Object.keys(t.payload.updatedFields),hasMatchingScript:!!u}}),u){var s=Object(g.a)(u,t.payload.updatedFields);return Object(c.g)(s),v(h({},e),s)}return e;default:return e}},hasLoadedAttachedScripts:function(e,t){switch(void 0===e&&(e=!1),t.type){case Object(a.getType)(o.fetchScriptsFromDocument.success):case Object(a.getType)(o.fetchScriptsFromDocument.failure):case Object(a.getType)(o.mergeSharedMetadataFromRibbon):return!0;default:return e}},hasReceivedMetadata:function(e,t){switch(void 0===e&&(e=!1),t.type){case Object(a.getType)(o.publishedScriptMetadataReceived):return!0;default:return e}},hasReceivedMRUMetadata:function(e,t){switch(void 0===e&&(e=!1),t.type){case Object(a.getType)(o.mruScriptMetadataReceived):return!0;default:return e}},scriptsSavingStatus:function(e,t){switch(void 0===e&&(e={}),t.type){case Object(a.getType)(o.updateSavingStatus):var r=h({},e);return r[t.payload.id]=t.payload.status,r;default:return e}},scriptsAttachingStatus:function(e,t){switch(void 0===e&&(e={}),t.type){case Object(a.getType)(o.updateAttachingStatus):var r=h({},e);return r[t.payload.id]=t.payload.status,r;default:return e}},scriptsIsStorageCallInProgress:function(e,t){switch(void 0===e&&(e={}),t.type){case Object(a.getType)(o.storageCallInProgress):var r=h({},e);return r[t.payload.id]=!0,r;case Object(a.getType)(o.storageCallComplete):var n=h({},e);return n[t.payload.id]=!1,n;default:return e}},scriptsIsAnyStorageCallInProgress:function(e,t){switch(void 0===e&&(e=!1),t.type){case Object(a.getType)(o.storageCallInProgress):return!0;case Object(a.getType)(o.storageCallComplete):return!1;default:return e}},scriptsIsConsented:function(e,t){switch(void 0===e&&(e={}),t.type){case Object(a.getType)(o.updateConsent):var r=h({},e);return r[t.payload.id]=t.payload.value,r;default:return e}}});function S(e,t,r){var n=function(e,t){var r=t.filter((function(e){return!!e.dateLastPublished})),n=0,a=e.filter((function(e){var t=r.find((function(t){return e.id===t.id}));return!!t&&(n+=e.name===t.name?0:1,!0)})),o=e.length-a.length,i=r.length-a.length;return{sameScripts:a.length,renamed:n,deleted:i,added:o,match:0===i&&0===o&&0===n}}(t.map((function(e){return e.storageScript})),Object.values(e).map((function(e){return e.storageScript})));Object(i.h)({eventName:"LocalMetaCache",eventType:"System",data:h({dataSource:r},n)})}function O(e,t,r){var n=h({},e),a=new Set;return t.forEach((function(t){var r=e[t.storageScript.id],o=Object(u.a)({incomingScript:t,existingScript:r}).selectedScript;e=v(e,o),delete n[t.storageScript.id],t.storageScript.isCreator&&a.add(t.storageScript.name)})),r||Object.values(n).forEach((function(t){t.storageScript.dateLastPublished&&!Object(f.a)(t)&&t.storageScript.isCreator&&delete e[t.storageScript.id],a.has(t.storageScript.name)&&t.storageScript.isCreator&&(delete e[t.storageScript.id],Object(c.b)(t.storageScript.id))})),e}function v(e,t){var r=e[t.storageScript.id];return r?(e[t.storageScript.id]={localUpdates:t.localUpdates,storageScript:h({},t.storageScript,{path:r.storageScript.path})},e):(e[t.storageScript.id]=t,e)}function T(e,t){var r=e.filter((function(e){return e.storageScript.id!==t.storageScript.id}));return Object(c.f)(r.slice(0,30)),r}function y(e,t,r){if(void 0===r&&(r=!0),!t)return e;var n=e.findIndex((function(e){return e.storageScript.id===t.storageScript.id}));if(-1!=n){var a=e[n];return e[n]={localUpdates:t.localUpdates,storageScript:h({},t.storageScript,{path:a.storageScript.path})},Object(c.f)(e.slice(0,30)),e}var o=r?[t].concat(e):[].concat(e,[t]);return Object(c.f)(o.slice(0,30)),o}},890:function(e){e.exports=JSON.parse('[{"id":"2","sortIndex":1,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1588809600000,"dateLastPublished":1592179200000,"body":"/**\\n * This sample script creates a sorted table.\\n * It also highlights a couple rows to demonstrate formatting.\\n * It does not affect any pre-existing data in your workbook.\\n *\\n * It is based off of this Office Scripts tutorial:\\n * https://docs.microsoft.com/office/dev/scripts/tutorials/excel-tutorial\\n */\\nfunction main(workbook: ExcelScript.Workbook) {\\n  // This function sets up a separate worksheet with sample data.\\n  let sampleSheet = setUpSample(workbook);\\n\\n  /*****************************\\n   * Begin Create Table sample *\\n   *****************************/\\n\\n  // Set fill color to FFC000 (the hex value for orange).\\n  sampleSheet\\n    .getRange(\\"A2:C2\\")\\n    .getFormat()\\n    .getFill()\\n    .setColor(\\"FFC000\\");\\n\\n  // Set fill color to yellow using the string literal.\\n  sampleSheet\\n    .getRange(\\"A3:C3\\")\\n    .getFormat()\\n    .getFill()\\n    .setColor(\\"yellow\\");\\n\\n  // Create a table using the data range.\\n  let newTable = workbook.addTable(sampleSheet.getRange(\\"A1:C5\\"), true);\\n\\n  // Sort the table based on the first column.\\n  newTable.getSort().apply([\\n    {\\n      key: 0 /* \'0\' refers to the index, not the column name. */,\\n      ascending: true\\n    }\\n  ]);\\n}\\n\\n/*\\n * This setup function is only for the sample.\\n * It creates a new worksheet with sample data,\\n * separate from anything that you\'re working on.\\n *\\n * @param workbook - The currently open workbook.\\n * @returns - A new worksheet with the sample data.\\n */\\nfunction setUpSample(workbook: ExcelScript.Workbook): ExcelScript.Worksheet {\\n  // Create a new worksheet.\\n  let sheet = workbook.addWorksheet();\\n\\n  // Add sample data.\\n  let range = sheet.getRange(\\"A1:C5\\");\\n  range.setValues([\\n    [\\"Fruit\\", \\"2018\\", \\"2019\\"],\\n    [\\"Oranges\\", \\"1000\\", \\"1200\\"],\\n    [\\"Lemons\\", \\"800\\", \\"900\\"],\\n    [\\"Limes\\", \\"600\\", \\"500\\"],\\n    [\\"Grapefruits\\", \\"900\\", \\"700\\"]\\n  ]);\\n  range.select();\\n\\n  return sheet;\\n}\\n"},{"id":"4","sortIndex":2,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1588809600000,"dateLastPublished":1592179200000,"body":"/**\\n * This sample script creates a PivotTable and\\n * returns the grand totals from that PivotTable.\\n * It does not affect any pre-existing data in your workbook.\\n */\\nfunction main(workbook: ExcelScript.Workbook) {\\n  // This function sets up a separate worksheet with sample data.\\n  let sampleSheet = setUpSample(workbook);\\n\\n  /**********************************\\n   * Begin Create PivotTable sample *\\n   **********************************/\\n\\n  // Get the data to create a PivotTable.\\n  let rangeToAnalyze = sampleSheet.getRange(\\"A1:E21\\");\\n\\n  // Create a new worksheet.\\n  let pivotSheet = workbook.addWorksheet();\\n\\n  // Place the PivotTable on the new worksheet.\\n  let rangeToPlacePivot = pivotSheet.getRange(\\"A2\\");\\n  let pivotTable = pivotSheet.addPivotTable(\\n    \\"Farm Sales\\",\\n    rangeToAnalyze,\\n    rangeToPlacePivot\\n  );\\n\\n  // Add row hierarchies to the PivotTable.\\n  pivotTable.addRowHierarchy(pivotTable.getHierarchy(\\"Farm\\"));\\n  pivotTable.addRowHierarchy(pivotTable.getHierarchy(\\"Type\\"));\\n\\n  // Add data hierarchies to the PivotTable.\\n  pivotTable.addDataHierarchy(pivotTable.getHierarchy(\\"Crates Sold at Farm\\"));\\n  pivotTable.addDataHierarchy(\\n    pivotTable.getHierarchy(\\"Crates Sold Wholesale\\")\\n  );\\n\\n  // Print each of the \\"Grand Totals\\" to the console.\\n  let pivotDataRange = pivotTable.getLayout().getBodyAndTotalRange();\\n  let grandTotalRange = pivotDataRange.getLastRow();\\n  console.log(\\n    `Sum of Crates Sold at Farm: ${grandTotalRange.getValues()[0][0]}`\\n  );\\n  console.log(\\n    `Sum of Crates Sold Wholesale: ${grandTotalRange.getValues()[0][1]}`\\n  );\\n\\n  // Bring the PivotTable into view.\\n  pivotDataRange.select();\\n}\\n\\n/*\\n * This setup function is only for the sample.\\n * It creates a new worksheet with sample data,\\n * separate from anything that you\'re working on.\\n *\\n * @param workbook - The currently open workbook.\\n * @returns - A new worksheet with the sample data.\\n */\\nfunction setUpSample(workbook: ExcelScript.Workbook): ExcelScript.Worksheet {\\n  // Create a new worksheet.\\n  let sheet = workbook.addWorksheet();\\n\\n  // Add sample data.\\n  let range = sheet.getRange(\\"A1:E21\\");\\n  range.setValues([\\n    [\\n      \\"Farm\\",\\n      \\"Type\\",\\n      \\"Classification\\",\\n      \\"Crates Sold at Farm\\",\\n      \\"Crates Sold Wholesale\\"\\n    ],\\n    [\\"A Farms\\", \\"Lime\\", \\"Organic\\", 300, 2000],\\n    [\\"A Farms\\", \\"Lemon\\", \\"Organic\\", 250, 1800],\\n    [\\"A Farms\\", \\"Orange\\", \\"Organic\\", 200, 2200],\\n    [\\"B Farms\\", \\"Lime\\", \\"Conventional\\", 80, 1000],\\n    [\\"B Farms\\", \\"Lemon\\", \\"Conventional\\", 75, 1230],\\n    [\\"B Farms\\", \\"Orange\\", \\"Conventional\\", 25, 800],\\n    [\\"B Farms\\", \\"Orange\\", \\"Organic\\", 20, 500],\\n    [\\"B Farms\\", \\"Lemon\\", \\"Organic\\", 10, 770],\\n    [\\"B Farms\\", \\"Kiwi\\", \\"Conventional\\", 30, 300],\\n    [\\"B Farms\\", \\"Lime\\", \\"Organic\\", 50, 400],\\n    [\\"C Farms\\", \\"Apple\\", \\"Organic\\", 275, 220],\\n    [\\"C Farms\\", \\"Kiwi\\", \\"Organic\\", 200, 120],\\n    [\\"D Farms\\", \\"Apple\\", \\"Conventional\\", 100, 3000],\\n    [\\"D Farms\\", \\"Apple\\", \\"Organic\\", 80, 2800],\\n    [\\"E Farms\\", \\"Lime\\", \\"Conventional\\", 160, 2700],\\n    [\\"E Farms\\", \\"Orange\\", \\"Conventional\\", 180, 2000],\\n    [\\"E Farms\\", \\"Apple\\", \\"Conventional\\", 245, 2200],\\n    [\\"E Farms\\", \\"Kiwi\\", \\"Conventional\\", 200, 1500],\\n    [\\"F Farms\\", \\"Kiwi\\", \\"Organic\\", 100, 150],\\n    [\\"F Farms\\", \\"Lemon\\", \\"Conventional\\", 150, 270]\\n  ]);\\n  range.select();\\n\\n  return sheet;\\n}\\n"},{"id":"5","sortIndex":3,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1597190400000,"dateLastPublished":1597190400000,"body":"/**\\r\\n * This sample finds overdue work items in a project management table\\r\\n * and lets their owners know with a comment that uses an @mention.\\r\\n * It does not affect any pre-existing data in your workbook.\\r\\n */\\r\\nfunction main(workbook: ExcelScript.Workbook) {\\r\\n  // This function sets up a separate worksheet with sample data.\\r\\n  let sampleSheet = setUpSample(workbook);\\r\\n\\r\\n  /**************************\\r\\n   * Begin @Mentions sample *\\r\\n   **************************/\\r\\n\\r\\n  // Get the \\"Owner\\" column range and values.\\r\\n  let table = sampleSheet.getTables()[0];\\r\\n  let ownerColumnRange = table\\r\\n    .getColumn(\\"Owner\\")\\r\\n    .getRangeBetweenHeaderAndTotal();\\r\\n  let ownerColumnValues = ownerColumnRange.getValues();\\r\\n\\r\\n  // Get the \\"Due Date\\" column range and values.\\r\\n  let dueDateColumnRange = table\\r\\n    .getColumn(\\"Due Date\\")\\r\\n    .getRangeBetweenHeaderAndTotal();\\r\\n  let dueDateColumnValues = dueDateColumnRange.getValues();\\r\\n\\r\\n  // Look for overdue work items.\\r\\n  for (let row = 0; row < dueDateColumnValues.length; row++) {\\r\\n    /* Convert the Excel date into a JavaScript date.\\r\\n     * This is necessary because Excel and JavaScript store\\r\\n     * their dates as different numerical values.\\r\\n     */\\r\\n    console.log(dueDateColumnValues[row][0]);\\r\\n    let dueDate = new Date(\\r\\n      Math.round((dueDateColumnValues[row][0] - 25569) * 86400 * 1000)\\r\\n    );\\r\\n\\r\\n    // Check if the current date is greater than the due date.\\r\\n    if (Date.now() > dueDate.valueOf()) {\\r\\n      /* Create a CommentMention object for the comment,\\r\\n       * based on the work item\'s owner.\\r\\n       *\\r\\n       * A CommentMention\'s properties are:\\r\\n       * `name`: The name of the person being mentioned.\\r\\n       * `id`: The index of this mention in the comment\\r\\n       *       (since multiple mentions can be in a single comment).\\r\\n       * `email`: The email address of the person being mentioned.\\r\\n       *          In this sample, \\"Owner\\" is also the user name for the email.\\r\\n       */\\r\\n      let mention = {\\r\\n        name: ownerColumnValues[row][0],\\r\\n        id: 0,\\r\\n        email: ownerColumnValues[row][0] + \\"@contoso.com\\"\\r\\n      };\\r\\n\\r\\n      /* Create the comment.\\r\\n       * The `<at id=\\"0\\">` block embeds the mention in the comment text.\\r\\n       * The name is displayed in the comment,\\r\\n       * while an email is sent to the given address.\\r\\n       *\\r\\n       * The addComment parameters are:\\r\\n       * `cellAddress`: The location of the comment.\\r\\n       * `content`: The text of the comment and any embedded mentions.\\r\\n       * `contentType`: The type of comment (\\"Mention\\" or \\"Plain\\").\\r\\n       */\\r\\n      sampleSheet.addComment(\\r\\n        dueDateColumnRange.getCell(row, 0),\\r\\n        {\\r\\n          richContent:\\r\\n            \'<at id=\\"0\\">\' +\\r\\n            mention.name +\\r\\n            \\"</at> - Your work item is overdue.\\",\\r\\n          mentions: [mention]\\r\\n        },\\r\\n        ExcelScript.ContentType.mention\\r\\n      );\\r\\n    }\\r\\n  }\\r\\n}\\r\\n/*\\r\\n * This setup function is only for the sample.\\r\\n * It creates a new worksheet with sample data,\\r\\n * separate from anything that you\'re working on.\\r\\n *\\r\\n * @param workbook - The currently open workbook.\\r\\n * @returns - A new worksheet with the sample data.\\r\\n */\\r\\nfunction setUpSample(workbook: ExcelScript.Workbook): ExcelScript.Worksheet {\\r\\n  // Create and switch to a new worksheet.\\r\\n  let sheet = workbook.addWorksheet();\\r\\n  sheet.activate();\\r\\n\\r\\n  // Add sample data.\\r\\n  let sampleRange = sheet.getRange(\\"A1:D5\\");\\r\\n\\r\\n  // Set range A1:D5 on selectedSheet\\r\\n  sampleRange.setValues([\\r\\n    [\\"Work Item\\", \\"Project\\", \\"Owner\\", \\"Due Date\\"],\\r\\n    [\\"Complete Sell Sheet\\", \\"GrammarBuddies\\", \\"Alex\\", \\"5/13/2020\\"],\\r\\n    [\\"Write Social Media Plan\\", \\"Mathpocalypse\\", \\"Emily\\", \\"6/22/2020\\"],\\r\\n    [\\"Concept Art\\", \\"Mathpocalypse\\", \\"Jules\\", \\"10/30/2020\\"],\\r\\n    [\\"Schedule Retail Demo\\", \\"GrammarBuddies\\", \\"Anne\\", \\"7/13/2021\\"]\\r\\n  ]);\\r\\n\\r\\n  // Create a table\\r\\n  sheet.addTable(sampleRange, true);\\r\\n  sampleRange.getFormat().autofitColumns();\\r\\n\\r\\n  return sheet;\\r\\n}\\r\\n"},{"id":"6","sortIndex":4,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1634263984850,"dateLastPublished":1634263984850,"body":"/*\\nExcel table data can be represented as an array of objects in the form of JSON. Each object represents a row in the table. This helps extract the data from Excel in a consistent format that is visible to the user. The data can then be given to other systems through Power Automate flows.\\n*/\\n\\n\\nfunction main(workbook: ExcelScript.Workbook): TableData[] {\\n  // Get the first table in the \\"PlainTable\\" worksheet.\\n  // If you know the table name, use `workbook.getTable(\'TableName\')` instead.\\n  const table = workbook.getWorksheet(\'PlainTable\').getTables()[0];\\n\\n  // Get all the values from the table as text.\\n  const texts = table.getRange().getTexts();\\n\\n  // Create an array of JSON objects that match the row structure.\\n  let returnObjects: TableData[] = [];\\n  if (table.getRowCount() > 0) {\\n    returnObjects = returnObjectFromValues(texts);\\n  }\\n\\n  // Log the information and return it for a Power Automate flow.\\n  console.log(JSON.stringify(returnObjects));\\n  return returnObjects\\n}\\n\\n// This function converts a 2D array of values into a generic JSON object.\\n// In this case, we have defined the TableData object, but any similar interface would work.\\nfunction returnObjectFromValues(values: string[][]): TableData[] {\\n  let objectArray: TableData[] = [];\\n  let objectKeys: string[] = [];\\n  for (let i = 0; i < values.length; i++) {\\n    if (i === 0) {\\n      objectKeys = values[i]\\n      continue;\\n    }\\n\\n    let object = {}\\n    for (let j = 0; j < values[i].length; j++) {\\n      object[objectKeys[j]] = values[i][j]\\n    }\\n\\n    objectArray.push(object as TableData);\\n  }\\n\\n  return objectArray;\\n}\\n\\ninterface TableData {\\n  \\"Event ID\\": string\\n  Date: string\\n  Location: string\\n  Capacity: string\\n  Speakers: string\\n}"},{"id":"7","sortIndex":5,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1634263984850,"dateLastPublished":1634263984850,"body":"/*\\nThis script removes all hyperlinks in the specified sheet.\\n*/\\n\\nfunction main(workbook: ExcelScript.Workbook, sheetName: string = \'Sheet1\') {\\n  // Get the active worksheet. \\n  let sheet = workbook.getWorksheet(sheetName);\\n\\n  // Get the used range to operate on.\\n  // For large ranges (over 10000 entries), consider splitting the operation into batches for performance.\\n  const targetRange = sheet.getUsedRange(true);\\n  console.log(`Target Range to clear hyperlinks from: ${targetRange.getAddress()}`);\\n\\n  const rowCount = targetRange.getRowCount();\\n  const colCount = targetRange.getColumnCount();\\n  console.log(`Searching for hyperlinks in ${targetRange.getAddress()} which contains ${(rowCount * colCount)} cells`);\\n\\n  // Go through each individual cell looking for a hyperlink.  \\n  // This allows us to limit the formatting changes to only the cells with hyperlink formatting.\\n  let clearedCount = 0;\\n  for (let i = 0; i < rowCount; i++) {\\n    for (let j = 0; j < colCount; j++) {\\n      const cell = targetRange.getCell(i, j);\\n      const hyperlink = cell.getHyperlink();\\n      if (hyperlink) {\\n        cell.clear(ExcelScript.ClearApplyTo.hyperlinks);\\n        cell.getFormat().getFont().setUnderline(ExcelScript.RangeUnderlineStyle.none);\\n        cell.getFormat().getFont().setColor(\'Black\');\\n        clearedCount++;\\n      }\\n    }\\n  }\\n\\n  console.log(`Done. Cleared hyperlinks from ${clearedCount} cells`);\\n}"},{"id":"8","sortIndex":6,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1634263984850,"dateLastPublished":1634263984850,"body":"/*\\nThis script does the following:\\n\\nSelects rows from the source table where the value in a column is equal to some value (FILTER_VALUE in the script).\\nMoves all selected rows into the target table in another worksheet.\\nReapplies the relevant filters to the source table.\\n*/\\n\\nfunction main(workbook: ExcelScript.Workbook) {\\n\\n  // You can change these names to match the data in your workbook.\\n  const TARGET_TABLE_NAME = \'Table1\';\\n  const SOURCE_TABLE_NAME = \'Table2\';\\n\\n  // Select what will be moved between tables.\\n  const FILTER_COLUMN_INDEX = 1;\\n  const FILTER_VALUE = \'Clothing\';\\n\\n  // Get the Table objects.\\n  let targetTable = workbook.getTable(TARGET_TABLE_NAME);\\n  let sourceTable = workbook.getTable(SOURCE_TABLE_NAME);\\n\\n  // If either table is missing, report that information and stop the script.\\n  if (!targetTable || !sourceTable) {\\n    console.log(`Tables missing - Check to make sure both source (${TARGET_TABLE_NAME}) and target table (${SOURCE_TABLE_NAME}) are present before running the script. `);\\n    return;\\n  }\\n\\n  // Save the filter criteria currently on the source table.\\n  const originalTableFilters = {};\\n  // For each table column, collect the filter criteria on that column.\\n  sourceTable.getColumns().forEach((column) => {\\n    let originalColumnFilter = column.getFilter().getCriteria();\\n    if (originalColumnFilter) {\\n      originalTableFilters[column.getName()] = originalColumnFilter;\\n    }\\n  });\\n\\n  // Get all the data from the table.\\n  const sourceRange = sourceTable.getRangeBetweenHeaderAndTotal();\\n  const dataRows: (number | string | boolean)[][] = sourceTable.getRangeBetweenHeaderAndTotal().getValues();\\n\\n  // Create variables to hold the rows to be moved and their addresses.\\n  let rowsToMoveValues: (number | string | boolean)[][] = [];\\n  let rowAddressToRemove: string[] = [];\\n\\n  // Get the data values from the source table.\\n  for (let i = 0; i < dataRows.length; i++) {\\n    if (dataRows[i][FILTER_COLUMN_INDEX] === FILTER_VALUE) {\\n      rowsToMoveValues.push(dataRows[i]);\\n\\n      // Get the intersection between table address and the entire row where we found the match. This provides the address of the range to remove.\\n      let address = sourceRange.getIntersection(sourceRange.getCell(i, 0).getEntireRow()).getAddress();\\n      rowAddressToRemove.push(address);\\n    }\\n  }\\n\\n  // If there are no data rows to process, end the script.\\n  if (rowsToMoveValues.length < 1) {\\n    console.log(\'No rows selected from the source table match the filter criteria.\');\\n    return;\\n  }\\n\\n  console.log(`Adding ${rowsToMoveValues.length} rows to target table.`);\\n\\n  // Insert rows at the end of target table.\\n  targetTable.addRows(-1, rowsToMoveValues)\\n\\n  // Remove the rows from the source table.\\n  const sheet = sourceTable.getWorksheet();\\n\\n  // Remove all filters before removing rows.\\n  sourceTable.getAutoFilter().clearCriteria();\\n\\n  // Important: Remove the rows starting at the bottom of the table.\\n  // Otherwise, the lower rows change position before they are deleted.\\n  console.log(`Removing ${rowAddressToRemove.length} rows from the source table.`);\\n  rowAddressToRemove.reverse().forEach((address) => {\\n    sheet.getRange(address).delete(ExcelScript.DeleteShiftDirection.up);\\n  });\\n\\n  // Reapply the original filters. \\n  Object.keys(originalTableFilters).forEach((columnName) => {\\n    sourceTable.getColumnByName(columnName).getFilter().apply(originalTableFilters[columnName]);\\n  });\\n}"},{"id":"9","sortIndex":7,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1634263984850,"dateLastPublished":1634263984850,"body":"/*\\nThis script counts the empty rows on a given worksheet, and can return them to a Power Automate Flow.\\n*/\\n\\nfunction main(workbook: ExcelScript.Workbook, sheetName:string = \'Sheet1\'): number {\\n  // Get the worksheet named \\"Sheet1\\".\\n  const sheet = workbook.getWorksheet(sheetName);\\n\\n  // Get the entire data range.\\n  const range = sheet.getUsedRange(true);\\n\\n  // If the used range is empty, end the script.\\n  if (!range) {\\n    console.log(`No data on this sheet.`);\\n    return;\\n  }\\n\\n  // Log the address of the used range.\\n  console.log(`Used range for the worksheet: ${range.getAddress()}`);\\n\\n  // Look through the values in the range for blank rows.\\n  const values = range.getValues();\\n  let emptyRows = 0;\\n  for (let row of values) {\\n    let emptyRow = true;\\n\\n    // Look at every cell in the row for one with a value.\\n    for (let cell of row) {\\n      if (cell.toString().length > 0) {\\n        emptyRow = false\\n      }\\n    }\\n\\n    // If no cell had a value, the row is empty.\\n    if (emptyRow) {\\n      emptyRows++;\\n    }\\n  }\\n\\n  // Log the number of empty rows.\\n  console.log(`Total empty rows: ${emptyRows}`);\\n\\n  // Return the number of empty rows for use in a Power Automate flow.\\n  return emptyRows;\\n}\\r\\n"}]')},926:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.newScriptBody=void 0,t.newScriptBody="function main(workbook: ExcelScript.Workbook) {\n    // Your code here\n}"}}]);
//# sourceMappingURL=recorder~run-from-button.3e4e64d8.chunk.js.map