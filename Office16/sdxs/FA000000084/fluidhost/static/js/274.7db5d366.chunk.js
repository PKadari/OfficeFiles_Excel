/*! For license information please see 274.7db5d366.chunk.js.LICENSE.txt */
(this.webpackJsonpfluidhost=this.webpackJsonpfluidhost||[]).push([[274],{1266:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return s})),t.d(n,"c",(function(){return u}));var r=t(826),i=t(906),o=((Object(i.a)()||{}).Symbol,(Object(i.a)()||{}).Reflect,r.a||function(e){for(var n,t=1,i=arguments.length;t<i;t++)for(var o in n=arguments[t])r.f[r.i].call(n,o)&&(e[o]=n[o]);return e}),a=function(e,n){return a=r.b.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n[r.i](t)&&(e[t]=n[t])},a(e,n)};function s(e,n){function t(){this.constructor=e}typeof n!==r.h&&null!==n&&Object(i.c)("Class extends value "+String(n)+" is not a constructor or null"),a(e,n),e[r.k]=null===n?Object(i.b)(n):(t[r.k]=n[r.k],new t)}function u(e,n){for(var t=0,r=n.length,i=e.length;t<r;t++,i++)e[i]=n[t];return e}},1271:function(e,n,t){"use strict";t.r(n),t.d(n,"OfficeFluidOneDsSink",(function(){return Fr}));var r,i=t(3),o=t(2),a=t(31),s=t(57),u=t(1266);!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(r||(r={}));var c={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103,FailedAddingCustomDefinedRequestContext:104,InMemoryStorageBufferFull:105},l=t(826),f=t(906),d=l.d;l.b.freeze,l.b.seal;function v(e){return l.f.toString.call(e)}function p(e,n){return typeof e===n}function h(e){return void 0===e||typeof e===l.l}function g(e){return null===e||h(e)}function y(e){return!g(e)}function m(e,n){return e&&l.e.call(e,n)}function C(e){return typeof e===l.j}function b(e){return typeof e===l.h}function T(e,n,t,r){void 0===r&&(r=!1);var i=!1;if(!g(e))try{g(e.addEventListener)?g(e.attachEvent)||(e.attachEvent("on"+n,t),i=!0):(e.addEventListener(n,t,r),i=!0)}catch(o){}return i}function S(e,n){if(e)for(var t in e)l.e.call(e,t)&&n.call(e,t,e[t])}function x(e,n){if(e&&n){var t=n.length,r=e.length;if(e===n)return!0;if(r>=t){for(var i=r-1,o=t-1;o>=0;o--){if(e[i]!=n[o])return!1;i--}return!0}}return!1}function w(e,n){var t=!1;if(e&&n){var r=n.length;if(e===n)return!0;if(e.length>=r){for(var i=0;i<r;i++)if(e[i]!==n[i])return!1;t=!0}}return t}function I(e,n){return!(!e||!n)&&-1!==e.indexOf(n)}function P(e){return"[object Date]"===v(e)}function E(e){return"[object Array]"===v(e)}function _(e){return"[object Error]"===v(e)}function k(e){return"string"===typeof e}function O(e){return"number"===typeof e}function N(e){return"boolean"===typeof e}function M(e){if(P(e)){var n=function(e){var n=String(e);return 1===n.length&&(n="0"+n),n};return e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+"T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function D(e,n,t){var r=e.length;try{for(var i=0;i<r&&(!(i in e)||-1!==n.call(t||e,e[i],i,e));i++);}catch(o){}}function L(e,n,t){var r=e.length,i=t||0;try{for(var o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in e&&e[o]===n)return o}catch(a){}return-1}function F(e,n,t){var r=e.length,i=t||e,o=new Array(r);try{for(var a=0;a<r;a++)a in e&&(o[a]=n.call(i,e[a],e))}catch(s){}return o}function A(e,n,t){var r,i=e.length,o=0;if(arguments.length>=3)r=arguments[2];else{for(;o<i&&!(o in e);)o++;r=e[o++]}for(;o<i;)o in e&&(r=n(r,e[o],o,e)),o++;return r}function R(e){return"string"!==typeof e?e:e.replace(/^\s+|\s+$/g,"")}var j=!{toString:null}.propertyIsEnumerable("toString"),B=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function U(e){var n=typeof e;n===l.h||n===l.j&&null!==e||Object(f.c)("objKeys called on non-object");var t=[];for(var r in e)e&&l.e.call(e,r)&&t.push(r);if(j)for(var i=B.length,o=0;o<i;o++)e&&l.e.call(e,B[o])&&t.push(B[o]);return t}function K(e,n,t,r){if(d)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),r&&(i.set=r),d(e,n,i),!0}catch(o){}return!1}function z(){var e=Date;return e.now?e.now():(new e).getTime()}function q(e,n,t,r,i){var o=t;return e&&((o=e[n])===t||i&&!i(o)||r&&!r(t)||(o=t,e[n]=o)),o}function H(e){return!e}function V(e){return!!e}function G(e){throw new Error(e)}function W(e){return e&&(e=Object(l.b)(l.a?Object(l.a)({},e):e)),e}var J="window",Q="JSON",X="msie",Z="trident/",$=null,Y=null,ee=!1,ne=null,te=null;function re(e,n){var t=!1;if(e){try{if(!(t=n in e)){var r=e[l.k];r&&(t=n in r)}}catch(i){}if(!t)try{t=!h((new e)[n])}catch(i){}}return t}function ie(e){var n=Object(f.a)();return n&&n[e]?n[e]:e===J&&oe()?window:null}function oe(){return Boolean(typeof window===l.j&&window)}function ae(){return oe()?window:ie(J)}function se(){return Boolean(typeof document===l.j&&document)?document:ie("document")}function ue(){return Boolean(typeof navigator===l.j&&navigator)}function ce(){return ue()?navigator:ie("navigator")}function le(e){if(e&&ee){var n=ie("__mockLocation");if(n)return n}return typeof location===l.j&&location?location:ie("location")}function fe(){return Boolean(typeof JSON===l.j&&JSON||null!==ie(Q))}function de(){return fe()?JSON||ie(Q):null}function ve(){var e=ce();return!(!e||!e.product)&&"ReactNative"===e.product}function pe(){var e=ce();if(e&&(e.userAgent!==Y||null===$)){var n=((Y=e.userAgent)||"").toLowerCase();$=I(n,X)||I(n,Z)}return $}function he(e){var n=Object[l.k].toString.call(e),t="";return"[object Error]"===n?t="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":fe()&&(t=de().stringify(e)),n+t}function ge(){return null===te&&(te=ue()&&Boolean(ce().sendBeacon)),te}function ye(e){var n=!1;try{n=!!ie("fetch");var t=ie("Request");n&&e&&t&&(n=re(t,"keepalive"))}catch(r){}return n}function me(){return null===ne&&(ne=void 0!==typeof XDomainRequest)&&Ce()&&(ne=ne&&!re(ie("XMLHttpRequest"),"withCredentials")),ne}function Ce(){var e=!1;try{e=!!ie("XMLHttpRequest")}catch(n){}return e}var be="constructor",Te="prototype",Se="function",xe="_dynClass",we="_unknown_",Ie=Object,Pe=Ie.getPrototypeOf,Ee=0;function _e(e,n){return e&&Ie.prototype.hasOwnProperty.call(e,n)}function ke(e){return e&&(e===Ie.prototype||e===Array.prototype)}function Oe(e){return ke(e)||e===Function.prototype}function Ne(e){if(e){if(Pe)return Pe(e);var n=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);if(n)return n}return null}function Me(e,n){var t=[],r=Ie.getOwnPropertyNames;if(r)t=r(e);else for(var i in e)"string"===typeof i&&_e(e,i)&&t.push(i);if(t&&t.length>0)for(var o=0;o<t.length;o++)n(t[o])}function De(e,n,t){return n!==be&&typeof e[n]===Se&&(t||_e(e,n))}function Le(e){throw new TypeError("DynamicProto: "+e)}function Fe(e,n){for(var t=e.length-1;t>=0;t--)if(e[t]===n)return!0;return!1}function Ae(e,n,t,r){var i=null;if(e&&_e(t,xe)){var o=e._dynInstFuncs||{};if((i=(o[t._dynClass]||{})[n])||Le("Missing ["+n+"] "+Se),!i._dynInstChk&&!1!==o._dynInstChk){for(var a=!_e(e,n),s=Ne(e),u=[];a&&s&&!Oe(s)&&!Fe(u,s);){var c=s[n];if(c){a=c===r;break}u.push(s),s=Ne(s)}try{a&&(e[n]=i),i._dynInstChk=1}catch(l){o._dynInstChk=!1}}}return i}function Re(e,n,t){var r=n[e];return r===t&&(r=Ne(n)[e]),typeof r!==Se&&Le("["+e+"] is not a "+Se),r}function je(e,n,t,r,i){if(!ke(e)){var o=t._dynInstFuncs=t._dynInstFuncs||{},a=o[n]=o[n]||{};!1!==o._dynInstChk&&(o._dynInstChk=!!i),Me(t,(function(n){De(t,n,!1)&&t[n]!==r[n]&&(a[n]=t[n],delete t[n],(!_e(e,n)||e[n]&&!e[n]._isDynProxy)&&(e[n]=function(e,n){var t=function t(){return(Ae(this,n,e,t)||Re(n,e,t)).apply(this,arguments)};return t._isDynProxy=1,t}(e,n)))}))}}function Be(e,n){return _e(e,Te)?e.name||n||we:((e||{}).constructor||{}).name||n||we}function Ue(e,n,t,r){_e(e,Te)||Le("theClass is an invalid class definition.");var i=e.prototype;(function(e,n){if(Pe)for(var t=[],r=Ne(n);r&&!Oe(r)&&!Fe(t,r);){if(r===e)return!0;t.push(r),r=Ne(r)}return!1})(i,n)||Le("["+Be(e)+"] is not in class hierarchy of ["+Be(n)+"]");var o=null;_e(i,xe)?o=i._dynClass:(o="_dynCls$"+Be(e,"_")+"$"+Ee,Ee++,i._dynClass=o);var a=Ue._dfOpts,s=!!a.useBaseInst;s&&r&&void 0!==r.useBaseInst&&(s=!!r.useBaseInst);var u=function(e){var n={};return Me(e,(function(t){!n[t]&&De(e,t,!1)&&(n[t]=e[t])})),n}(n),c=function(e,n,t,r){function i(e,n,t){var i=n[t];if(i._isDynProxy&&r){var o=e._dynInstFuncs||{};!1!==o._dynInstChk&&(i=(o[n._dynClass]||{})[t]||i)}return function(){return i.apply(e,arguments)}}var o={};Me(t,(function(e){o[e]=i(n,t,e)}));for(var a=Ne(e),s=[];a&&!Oe(a)&&!Fe(s,a);)Me(a,(function(e){!o[e]&&De(a,e,!Pe)&&(o[e]=i(n,a,e))})),s.push(a),a=Ne(a);return o}(i,n,u,s);t(n,c);var l=!!Pe&&!!a.setInstFuncs;l&&r&&(l=!!r.setInstFuncs),je(i,o,n,u,!1!==l)}Ue._dfOpts={setInstFuncs:!0,useBaseInst:!0};var Ke=Ue;function ze(e){return e?'"'+e.replace(/\"/g,"")+'"':""}function qe(e,n){var t=typeof console!==l.l?console:ie("console");if(t){var r="log";t[e]&&(r=e),b(t[r])&&t[r](n)}}var He=function(){function e(e,n,t,r){void 0===t&&(t=!1);var i=this;i.messageId=e,i.message=(t?"AI: ":"AI (Internal): ")+e;var o="";fe()&&(o=de().stringify(r));var a=(n?" message:"+ze(n):"")+(r?" props:"+ze(o):"");i.message+=a}return e.dataType="MessageData",e}();var Ve=function e(n){this.identifier="DiagnosticLogger",this.queue=[];var t=0,i={};Ke(e,this,(function(e){function o(e,t){var r=n[e];return g(r)?t:r}g(n)&&(n={}),e.consoleLoggingLevel=function(){return o("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return o("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return o("maxMessageLimit",25)},e.enableDebugExceptions=function(){return o("enableDebugExceptions",!1)},e.throwInternal=function(n,t,o,a,s){void 0===s&&(s=!1);var u=new He(t,o,s,a);if(e.enableDebugExceptions())throw u;var c=n===r.CRITICAL?"errorToConsole":"warnToConsole";if(!h(u.message)){var l=e.consoleLoggingLevel();if(s){var f=+u.messageId;!i[f]&&l>=n&&(e[c](u.message),i[f]=!0)}else l>=n&&e[c](u.message);e.logInternalMessage(n,u)}},e.warnToConsole=function(e){qe("warn",e)},e.errorToConsole=function(e){qe("error",e)},e.resetInternalMessageCount=function(){t=0,i={}},e.logInternalMessage=function(n,r){if(!(t>=e.maxInternalMessageLimit())){var o=!0,a="AITR_"+r.messageId;if(i[a]?o=!1:i[a]=!0,o&&(n<=e.telemetryLoggingLevel()&&(e.queue.push(r),t++),t===e.maxInternalMessageLimit())){var s="Internal events throttle limit per PageView reached for this app.",u=new He(c.MessageLimitPerPVExceeded,s,!1);e.queue.push(u),e.warnToConsole(s)}}}}))},Ge=null,We=function(){function e(n,t,r){var i,o=this,a=!1;(o.start=z(),o.name=n,o.isAsync=r,o.isChildEvt=function(){return!1},b(t))&&(a=K(o,"payload",(function(){return!i&&b(t)&&(i=t(),t=null),i})));o.getCtx=function(n){return n?n===e.ParentContextKey||n===e.ChildrenContextKey?o[n]:(o.ctx||{})[n]:null},o.setCtx=function(n,t){if(n)if(n===e.ParentContextKey)o[n]||(o.isChildEvt=function(){return!0}),o[n]=t;else if(n===e.ChildrenContextKey)o[n]=t;else{(o.ctx=o.ctx||{})[n]=t}},o.complete=function(){var n=0,r=o.getCtx(e.ChildrenContextKey);if(E(r))for(var i=0;i<r.length;i++){var s=r[i];s&&(n+=s.time)}o.time=z()-o.start,o.exTime=o.time-n,o.complete=function(){},!a&&b(t)&&(o.payload=t())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Je=function e(n){this.ctx={},Ke(e,this,(function(e){e.create=function(e,n,t){return new We(e,n,t)},e.fire=function(e){e&&(e.complete(),n&&b(n.perfEvent)&&n.perfEvent(e))},e.setCtx=function(n,t){n&&((e.ctx=e.ctx||{})[n]=t)},e.getCtx=function(n){return(e.ctx||{})[n]}}))},Qe="CoreUtils.doPerf";function Xe(e,n,t,r,i){if(e){var o=e;if(b(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx(Qe);try{if(a=o.create(n(),r,i)){if(s&&a.setCtx&&(a.setCtx(We.ParentContextKey,s),s.getCtx&&s.setCtx)){var u=s.getCtx(We.ChildrenContextKey);u||(u=[],s.setCtx(We.ChildrenContextKey,u)),u.push(a)}return o.setCtx(Qe,a),t(a)}}catch(c){a&&a.setCtx&&a.setCtx("exception",c)}finally{a&&o.fire(a),o.setCtx(Qe,s)}}}return t()}var Ze=function(e,n){var t=this,i=null,o=b(e.processTelemetry),a=b(e.setNextPlugin);t._hasRun=!1,t.getPlugin=function(){return e},t.getNext=function(){return i},t.setNext=function(e){i=e},t.processTelemetry=function(s,u){u||(u=n);var l=e?e.identifier:"TelemetryPluginChain";Xe(u?u.core():null,(function(){return l+":processTelemetry"}),(function(){if(e&&o){t._hasRun=!0;try{u.setNext(i),a&&e.setNextPlugin(i),i&&(i._hasRun=!1),e.processTelemetry(s,u)}catch(l){var n=i&&i._hasRun;i&&n||u.diagLog().throwInternal(r.CRITICAL,c.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+he(l)),i&&!n&&i.processTelemetry(s,u)}}else i&&(t._hasRun=!0,i.processTelemetry(s,u))}),(function(){return{item:s}}),!s.sync)}};function $e(e,n){var t=[];if(e&&e.length>0)for(var r=null,i=0;i<e.length;i++){var o=e[i];if(o&&b(o.processTelemetry)){var a=new Ze(o,n);t.push(a),r&&r.setNext(a),r=a}}return t.length>0?t[0]:null}var Ye=function e(n,t,r,i){var o=this,a=null;null!==i&&(n&&b(n.getPlugin)?a=function(e,n,t){var r=[],i=!t;if(e)for(;e;){var o=e.getPlugin();(i||o===t)&&(i=!0,r.push(o)),e=e.getNext()}return i||r.push(t),$e(r,n)}(n,o,i||n.getPlugin()):i?a=function(e,n,t){var r=e,i=!1;return t&&e&&(r=[],D(e,(function(e){(i||e===t)&&(i=!0,r.push(e))}))),t&&!i&&(r||(r=[]),r.push(t)),$e(r,n)}(n,o,i):h(i)&&(a=$e(n,o))),o.core=function(){return r},o.diagLog=function(){return function(e,n){return(e||{}).logger||new Ve(n)}(r,t)},o.getCfg=function(){return t},o.getExtCfg=function(e,n){var r;if(void 0===n&&(n={}),t){var i=t.extensionConfig;i&&e&&(r=i[e])}return r||n},o.getConfig=function(e,n,r){var i;void 0===r&&(r=!1);var a=o.getExtCfg(e,null);return a&&!g(a[n])?i=a[n]:t&&!g(t[n])&&(i=t[n]),g(i)?r:i},o.hasNext=function(){return null!=a},o.getNext=function(){return a},o.setNext=function(e){a=e},o.processNext=function(e){var n=a;n&&(a=n.getNext(),n.processTelemetry(e,o))},o.createNew=function(n,i){return void 0===n&&(n=null),new e(n||a,t,r,i)}},en="extensionConfig",nn=function(){function e(){var e=this,n=!1,t=null,r=null;e.core=null,e.diagLog=function(n){return e._getTelCtx(n).diagLog()},e.isInitialized=function(){return n},e.setInitialized=function(e){n=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,n){n?n.processNext(e):r&&b(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(n){void 0===n&&(n=null);var i=n;if(!i){var o=t||new Ye(null,{},e.core);i=r&&r.getPlugin?o.createNew(null,r.getPlugin):o.createNew(null,r)}return i},e._baseTelInit=function(i,o,a,s){i&&q(i,en,[],null,g),!s&&o&&(s=o.getProcessTelContext().getNext());var u=r;r&&r.getPlugin&&(u=r.getPlugin()),e.core=o,t=new Ye(s,i,o,u),n=!0}}return e.prototype.initialize=function(e,n,t,r){this._baseTelInit(e,n,t,r)},e}();function tn(e,n){for(var t=[],r=null,i=e.getNext();i;){var o=i.getPlugin();o&&(r&&b(r.setNextPlugin)&&b(o.processTelemetry)&&r.setNextPlugin(o),b(o.isInitialized)&&o.isInitialized()||t.push(o),r=o,i=i.getNext())}D(t,(function(t){t.initialize(e.getCfg(),e.core(),n,e.getNext())}))}function rn(e){return e.sort((function(e,n){var t=0,r=b(n.processTelemetry);return b(e.processTelemetry)?t=r?e.priority-n.priority:1:r&&(t=-1),t}))}var on=500,an=function(e){function n(){var t,r=e.call(this)||this;function i(e){e&&e.length>0&&(function(e){D(e,(function(e){e.priority<on&&G("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,n){return e.priority-n.priority}))),t.push(e))}return r.identifier="ChannelControllerPlugin",r.priority=500,Ke(n,r,(function(e,n){e.setNextPlugin=function(e){},e.processTelemetry=function(e,n){t&&D(t,(function(t){t.length>0&&r._getTelCtx(n).createNew(t).processNext(e)}))},e.getChannelControls=function(){return t},e.initialize=function(r,o,a){e.isInitialized()||(n.initialize(r,o,a),function(e,n){t=[],e&&D(e,(function(e){return i(e)}));if(n){var r=[];D(n,(function(e){e.priority>on&&r.push(e)})),i(r)}}((r||{}).channels,a),D(t,(function(e){return tn(new Ye(e,r,o),a)})))}})),r}return Object(u.b)(n,e),n._staticInit=function(){var e=n.prototype;K(e,"ChannelControls",e.getChannelControls),K(e,"channelQueue",e.getChannelControls)}(),n}(nn),sn="toGMTString",un="toUTCString",cn="expires",ln="",fn=null,dn=null,vn=null,pn=se(),hn={},gn={};function yn(e,n){var t=Cn._ckMgr||gn._ckMgr;return t||(t=Cn._ckMgr=Cn(e,n),gn._ckMgr=t),t}function mn(e){return!e||e.isEnabled()}function Cn(e,n){var t=function(e){var n=e.cookieCfg=e.cookieCfg||{};if(q(n,"domain",e.cookieDomain,y,g),q(n,"path",e.cookiePath||"/",null,g),g(n.enabled)){var t=void 0;h(e.isCookieUseDisabled)||(t=!e.isCookieUseDisabled),h(e.disableCookiesUsage)||(t=!e.disableCookiesUsage),n.enabled=t}return n}(e||gn),r=t.path||"/",i=t.domain,o=!1!==t.enabled,a={isEnabled:function(){var e=o&&bn(n),t=gn._ckMgr;return e&&t&&a!==t&&(e=mn(t)),e},setEnabled:function(e){o=!1!==e},set:function(e,n,o,s,u){var c=!1;if(mn(a)){var l={},f=R(n||ln),d=f.indexOf(";");if(-1!==d&&(f=R(n.substring(0,d)),l=Tn(n.substring(d+1))),q(l,"domain",s||i,V,h),!g(o)){var v=pe();if(h(l.expires)){var p=z()+1e3*o;if(p>0){var y=new Date;y.setTime(p),q(l,cn,Sn(y,v?sn:un)||Sn(y,v?sn:un)||ln,V)}}v||q(l,"max-age",ln+o,null,h)}var m=le();m&&"https:"===m.protocol&&(q(l,"secure",null,null,h),null===dn&&(dn=!Pn((ce()||{}).userAgent)),dn&&q(l,"SameSite","None",null,h)),q(l,"path",u||r,null,h),(t.setCookie||In)(e,xn(f,l)),c=!0}return c},get:function(e){var n=ln;return mn(a)&&(n=(t.getCookie||wn)(e)),n},del:function(e,n){var t=!1;return mn(a)&&(t=a.purge(e,n)),t},purge:function(e,r){var i,o=!1;if(bn(n)){var a=((i={}).path=r||"/",i.expires="Thu, 01 Jan 1970 00:00:01 GMT",i);pe()||(a["max-age"]="0"),(t.delCookie||In)(e,xn(ln,a)),o=!0}return o}};return a._ckMgr=a,a}function bn(e){if(null===fn){fn=!1;try{fn=void 0!==(pn||{}).cookie}catch(t){e&&e.throwInternal(r.WARNING,c.CannotAccessCookie,"Cannot access document.cookie - "+(_(n=t)?n.name:""),{exception:he(t)})}}var n;return fn}function Tn(e){var n={};e&&e.length&&D(R(e).split(";"),(function(e){if(e=R(e||ln)){var t=e.indexOf("=");-1===t?n[e]=null:n[R(e.substring(0,t))]=R(e.substring(t+1))}}));return n}function Sn(e,n){return b(e[n])?e[n]():null}function xn(e,n){var t=e||ln;return S(n,(function(e,n){t+="; "+e+(g(n)?ln:"="+n)})),t}function wn(e){var n=ln;if(pn){var t=pn.cookie||ln;vn!==t&&(hn=Tn(t),vn=t),n=R(hn[e]||ln)}return n}function In(e,n){pn&&(pn.cookie=e+"="+n)}function Pn(e){return!!k(e)&&(!(!I(e,"CPU iPhone OS 12")&&!I(e,"iPad; CPU OS 12"))||(!!(I(e,"Macintosh; Intel Mac OS X 10_14")&&I(e,"Version/")&&I(e,"Safari"))||(!(!I(e,"Macintosh; Intel Mac OS X 10_14")||!x(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!I(e,"Chrome/5")&&!I(e,"Chrome/6"))||(!(!I(e,"UnrealEngine")||I(e,"Chrome"))||!(!I(e,"UCBrowser/12")&&!I(e,"UCBrowser/11")))))))}function En(e,n){return new Je(n)}var _n=0,kn=1,On=2,Nn=4,Mn=5,Dn=function e(n){this.listeners=[];var t=!!(n||{}).perfEvtsSendAll;Ke(e,this,(function(e){e.addNotificationListener=function(n){e.listeners.push(n)},e.removeNotificationListener=function(n){for(var t=L(e.listeners,n);t>-1;)e.listeners.splice(t,1),t=L(e.listeners,n)},e.eventsSent=function(n){D(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(n)}),0)}))},e.eventsDiscarded=function(n,t){D(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(n,t)}),0)}))},e.eventsSendRequest=function(n,t){D(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(t)setTimeout((function(){return e.eventsSendRequest(n,t)}),0);else try{e.eventsSendRequest(n,t)}catch(r){}}))},e.perfEvent=function(n){n&&(!t&&n.isChildEvt()||D(e.listeners,(function(e){if(e&&e.perfEvent)if(n.isAsync)setTimeout((function(){return e.perfEvent(n)}),0);else try{e.perfEvent(n)}catch(t){}})))}}))},Ln=function(e){function n(){var t=e.call(this)||this,r=0;return Ke(n,t,(function(e,n){function t(n){var t=e.getNotifyMgr();t&&t.eventsDiscarded([n],On)}e.initialize=function(e,t,r,i){n.initialize(e,t,r||new Ve(e),i||new Dn(e))},e.track=function(r){Xe(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===r&&(t(r),G("Invalid telemetry item")),function(e){if(g(e.name))throw t(e),Error("telemetry name required")}(r),n.track(r)}),(function(){return{item:r}}),!r.sync)},e.addNotificationListener=function(n){var t=e.getNotifyMgr();t&&t.addNotificationListener(n)},e.removeNotificationListener=function(n){var t=e.getNotifyMgr();t&&t.removeNotificationListener(n)},e.pollInternalLogs=function(n){var t=e.config.diagnosticLogInterval;return t&&t>0||(t=1e4),r&&e.stopPollingInternalLogs(),r=setInterval((function(){var t=e.logger?e.logger.queue:[];D(t,(function(t){var r={name:n||"InternalMessageId: "+t.messageId,iKey:e.config.instrumentationKey,time:M(new Date),baseType:He.dataType,baseData:{message:t.message}};e.track(r)})),t.length=0}),t)},e.stopPollingInternalLogs=function(){r&&(clearInterval(r),r=0)}})),t}return Object(u.b)(n,e),n}((function e(){var n,t,i,o,a,s=!1;Ke(e,this,(function(e){e._extensions=new Array,t=new an,e.logger=new Ve({loggingLevelConsole:r.CRITICAL}),n=[],e.isInitialized=function(){return s},e.initialize=function(n,r,o,a){e.isInitialized()&&G("Core should not be initialized more than once"),n&&!g(n.instrumentationKey)||G("Please provide instrumentation key"),i=a,e._notificationManager=a,e.config=n||{},e.config.enablePerfMgr&&q(e.config,"createPerfMgr",En),n.extensions=g(n.extensions)?[]:n.extensions,(function(e,n,t){var r;return e?!(r=e[n])&&g(r)&&(r=h(t)?{}:t,e[n]=r):r=h(t)?{}:t,r}(n,en)).NotificationManager=a,o&&(e.logger=o);var c=[];c.push.apply(c,Object(u.c)(Object(u.c)([],r,!1),n.extensions,!1)),c=rn(c);var l=[],f=[],d={};D(c,(function(e){(g(e)||g(e.initialize))&&G("Extensions must provide callback to initialize");var n=e.priority,r=e.identifier;e&&n&&(g(d[n])?d[n]=r:o.warnToConsole("Two extensions have same priority #"+n+" - "+d[n]+", "+r)),!n||n<t.priority?l.push(e):f.push(e)})),c.push(t),l.push(t),c=rn(c),e._extensions=c,tn(new Ye([t],n,e),c),tn(new Ye(l,n,e),c),e._extensions=l,0===e.getTransmissionControls().length&&G("No channels available"),s=!0,e.releaseQueue()},e.getTransmissionControls=function(){return t.getChannelControls()},e.track=function(t){q(t,"iKey",e.config.instrumentationKey,null,H),q(t,"time",M(new Date),null,H),q(t,"ver","4.0",null,g),e.isInitialized()?e.getProcessTelContext().processNext(t):n.push(t)},e.getProcessTelContext=function(){var n=e._extensions,r=n;return n&&0!==n.length||(r=[t]),new Ye(r,e.config,e)},e.getNotifyMgr=function(){return i||(i=Object(f.b)({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,n){},eventsSendRequest:function(e,n){}}),e._notificationManager=i),i},e.getCookieMgr=function(){return a||(a=Cn(e.config,e.logger)),a},e.setCookieMgr=function(e){a=e},e.getPerfMgr=function(){return o||e.config&&e.config.enablePerfMgr&&b(e.config.createPerfMgr)&&(o=e.config.createPerfMgr(e,e.getNotifyMgr())),o||Ge},e.setPerfMgr=function(e){o=e},e.eventCnt=function(){return n.length},e.releaseQueue=function(){n.length>0&&(D(n,(function(n){e.getProcessTelContext().processNext(n)})),n=[])}}))})),Fn=0,An=13,Rn=32,jn=1,Bn=2,Un=3,Kn=4,zn=0,qn=1,Hn=6,Vn=7,Gn=Object(u.a)(Object(u.a)({},c),{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520}),Wn=4294967296,Jn=4294967295,Qn=!1,Xn=123456789,Zn=987654321;function $n(e){e<0&&(e>>>=0),Xn=123456789+e&Jn,Zn=987654321-e&Jn,Qn=!0}function Yn(){try{var e=2147483647&z();$n((Math.random()*Wn^e)+e)}catch(n){}}function et(e){return e>0?Math.floor(nt()/Jn*(e+1))>>>0:0}function nt(e){var n,t=ie("crypto")||ie("msCrypto");return t&&t.getRandomValues?n=t.getRandomValues(new Uint32Array(1))[0]&Jn:pe()?(Qn||Yn(),n=rt()&Jn):n=Math.floor(Wn*Math.random()|0),e||(n>>>=0),n}function tt(e){e?$n(e):Yn()}function rt(e){var n=((Zn=36969*(65535&Zn)+(Zn>>16)&Jn)<<16)+(65535&(Xn=18e3*(65535&Xn)+(Xn>>16)&Jn))>>>0&Jn|0;return e||(n>>>=0),n}var it,ot="visibilitychange",at="pagehide",st="pageshow",ut=null;l.l;function ct(e,n){var t=!1,r=ae();r&&(t=T(r,e,n),t=T(r.body,e,n)||t);var i=se();return i&&(t=T(i,e,n)||t),t}function lt(e,n,t){var r=!1;if(n&&e&&E(e)){var i=[];D(e,(function(e){k(e)&&(t&&-1!==L(t,e)?i.push(e):r=ct(e,n)||r)})),!r&&i.length>0&&(r=lt(i,n))}return r}function ft(e,n){return lt(["beforeunload","unload","pagehide"],e,n)}function dt(e,n){var t=!1;return n&&-1!==L(n,at)||(t=ct(at,e)),n&&-1!==L(n,ot)||(t=ct(ot,(function(n){var t=se();e&&t&&"hidden"===t.visibilityState&&e(n)}))||t),!t&&n&&(t=dt(e)),t}function vt(e,n){var t=!1;return n&&-1!==L(n,st)||(t=ct(st,e)),n&&-1!==L(n,ot)||(t=ct(ot,(function(n){var t=se();e&&t&&"visible"===t.visibilityState&&e(n)}))||t),!t&&n&&(t=vt(e)),t}function pt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(bt,(function(e){var n=0|et(15);return("x"===e?n:3&n|8).toString(16)}))}function ht(){var e=ie("performance");return e&&e.now?e.now():z()}function gt(e){void 0===e&&(e=22);for(var n=nt()>>>0,t=0,r="";r.length<e;)t++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&n),n>>>=6,5===t&&(n=(nt()<<2&4294967295|3&n)>>>0,t=0);return r}function yt(){for(var e,n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],t="",r=0;r<4;r++)t+=n[15&(e=nt())]+n[e>>4&15]+n[e>>8&15]+n[e>>12&15]+n[e>>16&15]+n[e>>20&15]+n[e>>24&15]+n[e>>28&15];var i=n[8+(3&nt())|0];return t.substr(0,8)+t.substr(9,4)+"4"+t.substr(13,3)+i+t.substr(16,3)+t.substr(19,12)}var mt,Ct={_canUseCookies:void 0,isTypeof:p,isUndefined:h,isNullOrUndefined:g,hasOwnProperty:m,isFunction:b,isObject:C,isDate:P,isArray:E,isError:_,isString:k,isNumber:O,isBoolean:N,toISOString:M,arrForEach:D,arrIndexOf:L,arrMap:F,arrReduce:A,strTrim:R,objCreate:f.b,objKeys:U,objDefineAccessors:K,addEventHandler:ct,dateNow:z,isIE:pe,disableCookies:function(){Tt().setEnabled(!1)},newGuid:pt,perfNow:ht,newId:gt,randomValue:et,random32:nt,mwcRandomSeed:tt,mwcRandom32:rt,generateW3CId:yt},bt=/[xy]/g;function Tt(e,n){var t=yn(e,n),r=Ct._canUseCookies;return null===ut&&(ut=[],it=r,K(Ct,"_canUseCookies",(function(){return it}),(function(e){it=e,D(ut,(function(n){n.setEnabled(e)}))}))),-1===L(ut,t)&&ut.push(t),N(r)&&t.setEnabled(r),N(it)&&t.setEnabled(it),t}var St="1DS-Web-JS-3.1.9",xt="withCredentials",wt=((mt={})[0]=zn,mt[2]=Hn,mt[1]=qn,mt[3]=Vn,mt[4098]=Hn,mt[4097]=qn,mt[4099]=Vn,mt),It=(Boolean(se()),Boolean(ae()));function Pt(e){return!(""===e||g(e))}function Et(e){if(e){var n=e.indexOf("-");if(n>-1)return e.substring(0,n)}return""}function _t(e){return!!(e&&O(e)&&e>=jn&&e<=Kn)}function kt(e,n,t){if(!n&&!Pt(n)||"string"!==typeof e)return null;var r=typeof n;if("string"===r||"number"===r||"boolean"===r||E(n))n={value:n};else if("object"!==r||n.hasOwnProperty("value")){if(g(n.value)||""===n.value||!k(n.value)&&!O(n.value)&&!N(n.value)&&!E(n.value))return null}else n={value:t?JSON.stringify(n):n};if(E(n.value)&&!Ft(n.value))return null;if(!g(n.kind)){if(E(n.value)||!Lt(n.kind))return null;n.value=n.value.toString()}return n}function Ot(e,n,t){var r=-1;if(!h(e))if(n>0&&(32===n?r=8192:n<=13&&(r=n<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(t))-1===r&&(r=0),r|=t;else{var i=wt[Rt(e)]||-1;-1!==r&&-1!==i?r|=i:i===Hn&&(r=i)}return r}function Nt(e){void 0===e&&(e="D");var n=pt();return"B"===e?n="{"+n+"}":"P"===e?n="("+n+")":"N"===e&&(n=n.replace(/-/g,"")),n}function Mt(e,n,t,r,i){var o={},a=!1,s=0,u=arguments.length,c=Object[l.k],f=arguments;for("[object Boolean]"===c.toString.call(f[0])&&(a=f[0],s++);s<u;s++){S(e=f[s],(function(e,n){a&&n&&C(n)?E(n)?(o[e]=o[e]||[],D(n,(function(n,t){n&&C(n)?o[e][t]=Mt(!0,o[e][t],n):o[e][t]=n}))):o[e]=Mt(!0,o[e],n):o[e]=n}))}return o}var Dt=ht;function Lt(e){return e===Fn||e>Fn&&e<=An||e===Rn}function Ft(e){return e.length>0}function At(e,n){var t=e;t.timings=t.timings||{},t.timings.processTelemetryStart=t.timings.processTelemetryStart||{},t.timings.processTelemetryStart[n]=Dt()}function Rt(e){var n=0;if(null!==e&&void 0!==e){var t=typeof e;"string"===t?n=1:"number"===t?n=2:"boolean"===t?n=3:t===l.j&&(n=4,E(e)?(n=4096,e.length>0&&(n|=Rt(e[0]))):m(e,"value")&&(n=8192|Rt(e.value)))}return n}l.l,l.j,l.l,f.b;var jt=function(e){function n(){var t=e.call(this)||this;return t.pluginVersionStringArr=[],t.pluginVersionString="",Ke(n,t,(function(e,n){e.logger&&e.logger.queue||(e.logger=new Ve({loggingLevelConsole:r.CRITICAL})),e.initialize=function(t,i,o,a){Xe(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(t){t.endpointUrl||(t.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var s=t.propertyStorageOverride;if(s&&(!s.getProperty||!s.setProperty))throw new Error("Invalid property storage override passed.");t.channels&&D(t.channels,(function(n){n&&D(n,(function(n){if(n.identifier&&n.version){var t=n.identifier+"="+n.version;e.pluginVersionStringArr.push(t)}}))}))}e.getWParam=function(){return"undefined"!==typeof document?0:-1},i&&D(i,(function(n){if(n&&n.identifier&&n.version){var t=n.identifier+"="+n.version;e.pluginVersionStringArr.push(t)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{n.initialize(t,i,o,a),e.pollInternalLogs("InternalLog")}catch(l){var u=e.logger,c=he(l);-1!==c.indexOf("channels")&&(c+="\n - Channels must be provided through config.channels only!"),u.throwInternal(r.CRITICAL,Gn.FailedToInitializeSDK,"SDK Initialization Failed - no telemetry will be sent: "+c)}}),(function(){return{config:t,extensions:i,logger:o,notificationManager:a}}))},e.track=function(t){Xe(e,(function(){return"AppInsightsCore.track"}),(function(){var r=t;if(r){r.timings=r.timings||{},r.timings.trackStart=Dt(),_t(r.latency)||(r.latency=jn);var i=r.ext=r.ext||{};i.sdk=i.sdk||{},i.sdk.ver=St;var o=r.baseData=r.baseData||{};o.properties||(o.properties={});var a=o.properties;a.version||(a.version=""),""!==e.pluginVersionString&&(a.version=e.pluginVersionString)}n.track(r)}),(function(){return{item:t}}),!t.sync)}})),t}return Object(u.b)(n,e),n}(Ln),Bt="REAL_TIME",Ut=function(){function e(n,t){var r=t?[].concat(t):[],i=this;i.iKey=function(){return n},i.count=function(){return r.length},i.events=function(){return r},i.addEvents=function(e,n){return void 0===n&&(n=!0),e&&e.length>0?(r=n?r.concat(e):e.concat(r),e.length):0},i.split=function(t,i){var o=new e(n);if(t<r.length){var a=r.length-t;g(i)||(a=i<a?i:a),o.addEvents(r.splice(t,a),!0)}return o}}return e.create=function(n,t){return new e(n,t)},e}(),Kt=2e6,zt=Math.min(Kt,65e3),qt=/\./,Ht=function e(n,t,r,i){var o="data",a="baseData",s=!!i,u=t,c={};Ke(e,this,(function(e){function t(e,n,i,o,a,l,f){S(e,(function(e,d){var v=null;if(d||Pt(d)){var p=i,h=e,g=a,y=n;if(s&&!o&&qt.test(e)){var m=e.split("."),C=m.length;if(C>1){g&&(g=g.slice());for(var b=0;b<C-1;b++){var T=m[b];y=y[T]=y[T]||{},p+="."+T,g&&g.push(T)}h=m[C-1]}}var S=o&&function(e,n){var t=c[e];return void 0===t&&(e.length>=7&&(t=w(e,"ext.metadata")||w(e,"ext.web")),c[e]=t),t}(p);if(v=!S&&u&&u.handleField(p,h)?u.value(p,h,d,r):kt(h,d,r)){var x=v.value;if(y[h]=x,l&&l(g,h,v),f&&"object"===typeof x&&!E(x)){var I=g;I&&(I=I.slice()).push(h),t(d,x,p+"."+h,o,I,l,f)}}}}))}e.createPayload=function(e,n,t,r,i,o){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:n,isSync:t,isBeacon:r,sendType:o,sendReason:i}},e.appendPayload=function(t,r,i){var o=t&&r&&!t.overflow;return o&&Xe(n,(function(){return"Serializer:appendPayload"}),(function(){for(var n=r.events(),o=t.payloadBlob,a=t.numEvents,s=!1,u=[],c=[],l=t.isBeacon,f=l?65e3:3984588,d=l?zt:Kt,v=0,p=0;v<n.length;){var h=n[v];if(h){if(a>=i){t.overflow=r.split(v);break}var g=e.getEventBlob(h);if(g&&g.length<=d){var y=g.length;if(o.length+y>f){t.overflow=r.split(v);break}o&&(o+="\n"),o+=g,++p>20&&(o.substr(0,1),p=0),s=!0,a++}else g?u.push(h):c.push(h),n.splice(v,1),v--}v++}if(u&&u.length>0&&t.sizeExceed.push(Ut.create(r.iKey(),u)),c&&c.length>0&&t.failedEvts.push(Ut.create(r.iKey(),c)),s){t.batches.push(r),t.payloadBlob=o,t.numEvents=a;var m=r.iKey();-1===L(t.apiKeys,m)&&t.apiKeys.push(m)}}),(function(){return{payload:t,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),o},e.getEventBlob=function(e){try{return Xe(n,(function(){return"Serializer.getEventBlob"}),(function(){var n={};n.name=e.name,n.time=e.time,n.ver=e.ver,n.iKey="o:"+Et(e.iKey);var r={},i=e.ext;i&&(n.ext=r,S(i,(function(e,n){t(n,r[e]={},"ext."+e,!0,null,null,!0)})));var s=n.data={};s.baseType=e.baseType;var u=s.baseData={};return t(e.baseData,u,a,!1,[a],(function(e,n,t){Vt(r,e,n,t)}),!0),t(e.data,s,o,!1,[],(function(e,n,t){Vt(r,e,n,t)}),!0),JSON.stringify(n)}),(function(){return{item:e}}))}catch(r){return null}}}))};function Vt(e,n,t,r){if(r&&e){var i=Ot(r.value,r.kind,r.propertyType);if(i>-1){var o=e.metadata;o||(o=e.metadata={f:{}});var a=o.f;if(a||(a=o.f={}),n)for(var s=0;s<n.length;s++){var u=n[s];a[u]||(a[u]={f:{}});var c=a[u].f;c||(c=a[u].f={}),a=c}a=a[t]={},E(r.value)?a.a={t:i}:a.t=i}}}var Gt,Wt=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!=e&&429!=e||501==e||505==e)},e.getMillisToBackoffForRetry=function(e){var n,t=Math.floor(1200*Math.random())+2400;return n=Math.pow(2,e)*t,Math.min(n,6e5)},e}(),Jt=function e(){var n={};Ke(e,this,(function(e){e.setKillSwitchTenants=function(e,t){if(e&&t)try{var r=function(e){var n=[];return e&&D(e,(function(e){n.push(R(e))})),n}(e.split(","));if("this-request-only"===t)return r;for(var i=1e3*parseInt(t,10),o=0;o<r.length;++o)n[r[o]]=z()+i}catch(a){return[]}return[]},e.isTenantKilled=function(e){var t=n,r=R(e);return void 0!==t[r]&&t[r]>z()||(delete t[r],!1)}}))},Qt=function e(){var n=!0,t=!0,r=!0,i="use-collector-delta",o=!1;Ke(e,this,(function(e){e.allowRequestSending=function(){return n},e.firstRequestSent=function(){r&&(r=!1,o||(n=!1))},e.shouldAddClockSkewHeaders=function(){return t},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){o||(e?(i=e,t=!0,o=!0):t=!1,n=!0)}}))},Xt="POST",Zt="drop",$t="send",Yt="requeue",er="rspFail",nr="application/x-json-stream",tr="cache-control",rr="content-type",ir="kill-duration",or="time-delta-millis",ar=((Gt={})[1]=Yt,Gt[100]=Yt,Gt[200]="sent",Gt[8004]=Zt,Gt[8003]=Zt,Gt);function sr(e){try{return e.responseText}catch(n){}return""}function ur(e,n){var t=!1;if(e&&n){var r=U(e);if(r&&r.length>0)for(var i=n.toLowerCase(),o=0;o<r.length;o++){var a=r[o];if(a&&m(n,a)&&a.toLowerCase()===i){t=!0;break}}}return t}var cr=function e(n,t,i,o){this._responseHandlers=[];var a,s,u,c,f="?cors=true&"+rr.toLowerCase()+"="+nr+"&client-id=NO_AUTH&client-version="+St,d=new Jt,v=!1,p=new Qt,y=!1,m=0,C=!0,b=[],T={},x=[],w=null,I=!1,P=!1;Ke(e,this,(function(e){var _=!0;function N(e,n){for(var t=0,r=null,i=0;null==r&&i<e.length;)1===(t=e[i])?me()?r=M:Ce()&&(r=F):2===t&&ye(n)?r=L:y&&3===t&&ge()&&(r=j),i++;return r?{_transport:t,_isSync:n,sendPOST:r}:null}function M(e,n,t){var r=new XDomainRequest;r.open(Xt,e.urlString),r.onload=function(){var e=sr(r);A(n,200,{},e),$(e)},r.onerror=function(){A(n,400,{})},r.ontimeout=function(){A(n,500,{})},r.onprogress=function(){},t?r.send(e.data):a._setTimeoutOverride((function(){r.send(e.data)}),0)}function L(e,n,t){var r,i=((r={body:e.data,method:Xt}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,r);t&&(i.keepalive=!0),_&&(i.credentials="include"),e.headers&&U(e.headers).length>0&&(i.headers=e.headers),fetch(e.urlString,i).then((function(e){var t={},r="";e.headers&&e.headers.forEach((function(e,n){t[n]=e})),e.body&&e.text().then((function(e){r=e})),A(n,e.status,t,r),$(r)})).catch((function(e){A(n,0,{})}))}function F(e,n,t){function r(e,n,t){if(!e[t]&&n&&n.getResponseHeader){var r=n.getResponseHeader(t);r&&(e[t]=R(r))}return e}function i(e){var n={};return e.getAllResponseHeaders?n=function(e){var n={};return k(e)&&D(R(e).split(/[\r\n]+/),(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var r=R(e.substring(0,t)).toLowerCase(),i=R(e.substring(t+1));n[r]=i}else n[R(e)]=1}})),n}(e.getAllResponseHeaders()):(n=r(n,e,or),n=r(n,e,ir),n=r(n,e,"kill-duration-seconds")),n}function o(e,t){A(n,e.status,i(e),t)}var a=function(e,n,t,r,i){function o(e,n,t){try{e[n]=t}catch(r){}}void 0===r&&(r=!1),void 0===i&&(i=!1);var a=new XMLHttpRequest;return r&&o(a,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",r),t&&o(a,xt,t),a.open(e,n,!i),t&&o(a,xt,t),a}(Xt,e.urlString,_,!0,t);S(e.headers,(function(e,n){a.setRequestHeader(e,n)})),a.onload=function(){var e=sr(a);o(a,e),$(e)},a.onerror=function(){o(a)},a.ontimeout=function(){o(a)},a.send(e.data)}function A(e,n,t,i){try{e(n,t,i)}catch(o){a.diagLog().throwInternal(r.WARNING,Gn.SendPostOnCompleteFailure,he(o))}}function j(e,n,t){var r=200,i=e._thePayload;try{var o=ce();if(!o.sendBeacon(e.urlString,e.data))if(i){var s=[];D(i.batches,(function(n){if(s&&n&&n.count()>0){for(var t=n.events(),r=0;r<t.length;r++)if(!o.sendBeacon(e.urlString,w.getEventBlob(t[r]))){s.push(n.split(r));break}}else s.push(n.split(0))})),Y(s,8003,i.sendType,!0)}else r=0}catch(u){a.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+u),r=0}finally{A(n,r,{},"")}}function B(e){return 2===e||3===e}function K(e){return P&&B(e)&&(e=2),e}function q(){return!v&&m<t}function H(){var e=x;return x=[],e}function V(e,n,t){var r=!1;return e&&e.length>0&&!v&&s[n]&&w&&(r=0!==n||q()&&(t>0||p.allowRequestSending())),r}function G(e){var n={};return e&&D(e,(function(e,t){n[t]={iKey:e.iKey(),evts:e.events()}})),n}function W(e,t,i,o,c){if(e&&0!==e.length)if(v)Y(e,1,o);else{o=K(o);try{var l=e,f=0!==o;Xe(u,(function(){return"HttpManager:_sendBatches"}),(function(r){r&&(e=e.slice(0));for(var a=[],u=null,l=Dt(),v=s[o]||(f?s[1]:s[0]),p=(P||B(o)||v&&3===v._transport)&&!C&&y&&ge();V(e,o,t);){var h=e.shift();h&&h.count()>0&&(d.isTenantKilled(h.iKey())?a.push(h):(u=u||w.createPayload(t,i,f,p,c,o),w.appendPayload(u,h,n)?null!==u.overflow&&(e=[u.overflow].concat(e),u.overflow=null,X(u,l,Dt(),c),l=Dt(),u=null):(X(u,l,Dt(),c),l=Dt(),e=[h].concat(e),u=null)))}u&&X(u,l,Dt(),c),e.length>0&&(x=e.concat(x)),Y(a,8004,o)}),(function(){return{batches:G(l),retryCount:t,isTeardown:i,isSynchronous:f,sendReason:c,useSendBeacon:B(o),sendType:o}}),!f)}catch(p){a.diagLog().throwInternal(r.WARNING,Gn.CannotSerializeObject,"Unexpected Exception sending batch: "+he(p))}}}function J(e){var n=f,t="";D(e.apiKeys,(function(e){t.length>0&&(t+=","),t+=e})),t.length>0&&(n+="&apikey="+t),n+="&upload-time="+z().toString();var r=function(e){for(var n=0;n<e.batches.length;n++)for(var t=e.batches[n].events(),r=0;r<t.length;r++){var i=(t[r].ext||{}).intweb||{};if(Pt(i.msfpc))return encodeURIComponent(i.msfpc)}return""}(e);if(Pt(r)&&(n=n+"&ext.intweb.msfpc="+r),p.shouldAddClockSkewHeaders()&&(n+="&time-delta-to-apply-millis="+p.getClockSkewHeaderValue()),u.getWParam){var i=u.getWParam();i>=0&&(n+="&w="+i)}for(var o=0;o<b.length;o++)n+="&"+b[o].name+"="+b[o].value;return n}function Q(e,n,t){e[n]=e[n]||{},e[n][a.identifier]=t}function X(n,t,r,o){if(n&&n.payloadBlob&&n.payloadBlob.length>0){var c=J(n),f=Dt();Xe(u,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var v=0;v<n.batches.length;v++)for(var h=n.batches[v].events(),g=0;g<h.length;g++){var y=h[g];if(I){var b=y.timings=y.timings||{};Q(b,"sendEventStart",f),Q(b,"serializationStart",t),Q(b,"serializationCompleted",r)}y.sendAttempt>0?y.sendAttempt++:y.sendAttempt=1}Y(n.batches,1e3+(o||0),n.sendType,!0);var S={data:n.payloadBlob,urlString:c,headers:Mt({},T),_thePayload:n,_sendReason:o};ur(S.headers,tr)||(S.headers[tr]="no-cache, no-store"),ur(S.headers,rr)||(S.headers["content-type"]=nr);var x=null,w=!!e.sendHook,E=s[n.sendType];!B(n.sendType)&&n.isBeacon&&2===n.sendReason&&(E=s[2]||s[3]||E),E&&(x=function(t){p.firstRequestSent();var r=function(t,r){!function(n,t,r,o){var s=9e3,u=null,c=!1,f=!1;try{var v=!0;if(typeof n!==l.l){if(t){p.setClockSkew(t[or]);var h=t["kill-duration"]||t["kill-duration-seconds"];D(d.setKillSwitchTenants(t["kill-tokens"],h),(function(e){D(r.batches,(function(n){if(n.iKey()===e){u=u||[];var t=n.split(0);r.numEvents-=t.count(),u.push(t)}}))}))}if(200==n)return void(s=200);(!Wt.shouldRetryForStatus(n)||r.numEvents<=0)&&(v=!1),s=9e3+n%1e3}if(v){s=100;var g=r.retryCnt;0===r.sendType&&(g<i?(c=!0,Z((function(){0===r.sendType&&m--,W(r.batches,g+1,r.isTeardown,P?2:r.sendType,5)}),P,Wt.getMillisToBackoffForRetry(g))):f=!0)}}finally{c||(p.setClockSkew(),function(n,t,r,i){try{i&&a._backOffTransmission(),200===t&&(i||n.isSync||a._clearBackOff(),function(e){if(I){var n=Dt();D(e,(function(e){e&&e.count()>0&&function(e,n){I&&D(e,(function(e){Q(e.timings=e.timings||{},"sendEventCompleted",n)}))}(e.events(),n)}))}}(n.batches)),Y(n.batches,t,n.sendType,!0)}finally{0===n.sendType&&(m--,5!==r&&e.sendQueuedRequests(n.sendType,r))}}(r,s,o,f)),Y(u,8004,r.sendType)}}(t,r,n,o)},s=n.isTeardown||n.isSync;try{E.sendPOST(t,r,s),e.sendListener&&e.sendListener(S,t,s,n.isBeacon)}catch(u){a.diagLog().warnToConsole("Unexpected exception sending payload. Ex:"+he(u)),A(r,0,{})}}),Xe(u,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(x)if(0===n.sendType&&m++,w&&!n.isBeacon&&3!==E._transport){var t={data:S.data,urlString:S.urlString,headers:Mt({},S.headers)},r=!1;Xe(u,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(t,(function(e){r=!0,C||e._thePayload||(e._thePayload=e._thePayload||S._thePayload,e._sendReason=e._sendReason||S._sendReason),x(e)}),n.isSync||n.isTeardown)}catch(i){r||x(S)}}))}else x(S)}))}),(function(){return{thePayload:n,serializationStart:t,serializationCompleted:r,sendReason:o}}),n.isSync)}n.sizeExceed&&n.sizeExceed.length>0&&Y(n.sizeExceed,8003,n.sendType),n.failedEvts&&n.failedEvts.length>0&&Y(n.failedEvts,8002,n.sendType)}function Z(e,n,t){n?e():a._setTimeoutOverride(e,t)}function $(n){var t=e._responseHandlers;try{for(var i=0;i<t.length;i++)try{t[i](n)}catch(s){a.diagLog().throwInternal(r.CRITICAL,Gn.PostResponseHandler,"Response handler failed: "+s)}if(n){var o=JSON.parse(n);Pt(o.webResult)&&Pt(o.webResult.msfpc)&&c.set("MSFPC",o.webResult.msfpc,31536e3)}}catch(u){}}function Y(e,n,t,i){if(e&&e.length>0&&o){var s=o[function(e){var n=ar[e];return Pt(n)||(n="oth",e>=9e3&&e<=9999?n=er:e>=8e3&&e<=8999?n=Zt:e>=1e3&&e<=1999&&(n=$t)),n}(n)];if(s){var c=0!==t;Xe(u,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){Z((function(){try{s.call(o,e,n,c,t)}catch(i){a.diagLog().throwInternal(r.CRITICAL,Gn.NotificationException,"send request notification failed: "+i)}}),i||c,0)}),(function(){return{batches:G(e),reason:n,isSync:c,sendSync:i,sendType:t}}),!c)}}}e.initialize=function(e,n,t,r,i){var o;i||(i={}),f=e+f,u=n,c=n.getCookieMgr(),I=!u.config.disableEventTimings;var l=!!u.config.enableCompoundKey;a=t;var d=i.valueSanitizer,v=i.stringifyObjects;h(i.enableCompoundKey)||(l=!!i.enableCompoundKey),y=!ve(),w=new Ht(u,d,v,l);var p=r;if(!r){C=!1;var g=le();g&&g.protocol&&"file:"===g.protocol.toLowerCase()&&(_=!1);var m=[];m=ve()?[2,1]:[1,2,3];var b=i.transports;b&&(O(b)?m=[b].concat(m):E(b)&&(m=b.concat(m))),r=N(m,!1),p=N(m,!0),r||a.diagLog().warnToConsole("No available transport to send events")}(o={})[0]=r,o[1]=p||N([1,2,3],!0),o[2]=N([3,2,1],!0)||p,o[3]=N([2,3,1],!0)||p,s=o},e._getDbgPlgTargets=function(){return[s[0],d,w,s]},e.addQueryStringParameter=function(e,n){for(var t=0;t<b.length;t++)if(b[t].name===e)return void(b[t].value=n);b.push({name:e,value:n})},e.addHeader=function(e,n){T[e]=n},e.canSendRequest=function(){return q()&&p.allowRequestSending()},e.sendQueuedRequests=function(e,n){h(e)&&(e=0),P&&(e=K(e),n=2),V(x,e,0)&&W(H(),0,!1,e,n||0)},e.isCompletelyIdle=function(){return!v&&0===m&&0===x.length},e.setUnloading=function(e){P=e},e.addBatch=function(e){if(e&&e.count()>0){if(d.isTenantKilled(e.iKey()))return!1;x.push(e)}return!0},e.teardown=function(){x.length>0&&W(H(),0,!0,2,2)},e.pause=function(){v=!0},e.resume=function(){v=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,n,t){e&&e.count()>0&&(g(n)&&(n=1),P&&(n=K(n),t=2),W([e],0,!1,n,t||0))}}))},lr=It?window:void 0,fr="eventsDiscarded",dr=function(e){function n(){var t,i=e.call(this)||this;i.identifier="PostChannel",i.priority=1011,i.version="3.1.9";var o,a,s,u,c,l=!1,f=[],d=null,v=!1,p=0,h=500,g=0,y=1e4,m={},C=Bt,b=null,T=null,x=0,w=0,I={},P=-1,E=!0,_=!1;return Ke(n,i,(function(e,n){function i(e,n){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=jn),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,E&&(e.ext=W(e.ext),e.baseData&&(e.baseData=W(e.baseData)),e.data&&(e.data=W(e.data))),e.sync)if(x||v)e.latency=Un,e.sync=!1;else if(a)return E&&(e=W(e)),void a.sendSynchronousBatch(Ut.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var t=e.latency,r=g,i=y;t===Kn&&(r=p,i=h);var o=!1;if(r<i)o=!j(e,n);else{var s=jn,u=20;t===Kn&&(s=Kn,u=1),o=!0,function(e,n,t,r){for(;t<=n;){var i=A(e,n,!0);if(i&&i.count()>0){var o=i.split(0,r),a=o.count();if(a>0)return t===Kn?p-=a:g-=a,G(fr,[o],Mn),!0}t++}return B(),!1}(e.iKey,e.latency,s,u)&&(o=!j(e,n))}o&&V(fr,[e],Mn)}function k(e,n,t){var r=U(e,n,t);return a.sendQueuedRequests(n,t),r}function O(){return g>0}function N(){if(P>=0&&U(P,0,c)&&a.sendQueuedRequests(0,c),p>0&&!T&&!v){var e=m[C][2];e>=0&&(T=M((function(){T=null,k(Kn,0,1),N()}),e))}var n=m[C][1];!b&&!d&&n>=0&&!v&&(O()?b=M((function(){b=null,k(0===w?Un:jn,0,1),w++,w%=2,N()}),n):w=0)}function M(n,t){0===t&&x&&(t=1);var r=1e3;return x&&(r=Wt.getMillisToBackoffForRetry(x-1)),e._setTimeoutOverride(n,t*r)}function L(){null!==b&&(e._clearTimeoutOverride(b),b=null,w=0)}function F(n,t){L(),d&&(e._clearTimeoutOverride(d),d=null),v||k(jn,n,t)}function A(e,n,t){var r=I[n];r||(r=I[n=jn]);var i=r.iKeyMap[e];return!i&&t&&(i=Ut.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function R(n,t){a.canSendRequest()&&!x&&(s>0&&g>s&&(t=!0),t&&null==d&&e.flush(n,null,20))}function j(e,n){E&&(e=W(e));var t=e.latency,r=A(e.iKey,t,!0);return!!r.addEvents([e],n)&&(t!==Kn?(g++,n&&0===e.sendAttempt&&R(!e.sync,u>0&&r.count()>=u)):p++,!0)}function B(){for(var e=0,n=0,t=function(t){var r=I[t];r&&r.batches&&D(r.batches,(function(r){t===Kn?e+=r.count():n+=r.count()}))},r=jn;r<=Kn;r++)t(r);g=n,p=e}function U(n,t,r){var i=!1,o=0===t;return!o||a.canSendRequest()?Xe(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],t=Kn;t>=n;){var r=I[t];r&&r.batches&&r.batches.length>0&&(D(r.batches,(function(n){a.addBatch(n)?i=i||n&&n.count()>0:e=e.concat(n.events()),t===Kn?p-=n.count():g-=n.count()})),r.batches=[],r.iKeyMap={}),t--}e.length>0&&V(fr,e,Nn),i&&P>=n&&(P=-1,c=0)}),(function(){return{latency:n,sendType:t,sendReason:r}}),!o):(P=P>=0?Math.min(P,n):n,c=Math.max(c,r)),i}function K(e,n){k(jn,0,n),z((function(){e&&e(),f.length>0?d=M((function(){return K(f.shift(),n)}),0):(d=null,O()&&N())}))}function z(e){a.isCompletelyIdle()?e():d=M((function(){z(e)}),.25)}function q(){(m={}).REAL_TIME=[2,1,0],m.NEAR_REAL_TIME=[6,3,0],m.BEST_EFFORT=[18,9,0]}function H(n,t){var i=e._notificationManager||{},o=i[n];if(o)try{o.apply(i,t)}catch(a){e.diagLog().throwInternal(r.CRITICAL,Gn.NotificationException,n+" notification failed: "+a)}}function V(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&H(e,[n].concat(t))}function G(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&D(n,(function(n){n&&n.count()>0&&H(e,[n.events()].concat(t))}))}function J(){u=t&&t.disableAutoBatchFlushLimit?0:Math.max(1500,y/6)}q(),I[Kn]={batches:[],iKeyMap:{}},I[Un]={batches:[],iKeyMap:{}},I[Bn]={batches:[],iKeyMap:{}},I[jn]={batches:[],iKeyMap:{}},J(),a=new cr(500,2,1,{requeue:function(n,t){var r=[];D(n,(function(n){n&&n.count()>0&&D(n.events(),(function(n){n&&(n.sync&&(n.latency=Kn,n.sync=!1),n.sendAttempt<6?(At(n,e.identifier),i(n,!1)):r.push(n))}))})),r.length>0&&V(fr,r,kn);_&&F(2,2)},send:function(e,n,t){e&&e.length>0&&H("eventsSendRequest",[n>=1e3&&n<=1999?n-1e3:0,!0!==t])},sent:function(e,n){G("eventsSent",e,n),N()},drop:function(e,n){G(fr,e,n>=8e3&&n<=8999?n-8e3:_n)},rspFail:function(e){G(fr,e,kn),N()},oth:function(e,n){G(fr,e,_n),N()}}),e._getDbgPlgTargets=function(){return[a]},e.initialize=function(r,i,u){Xe(i,(function(){return"PostChannel:initialize"}),(function(){var c=i;n.initialize(r,i,u),e.setInitialized(!1);var l=e._getTelCtx();r.extensionConfig[e.identifier]=r.extensionConfig[e.identifier]||{},t=l.getExtCfg(e.identifier),e._setTimeoutOverride=t.setTimeoutOverride?t.setTimeoutOverride:setTimeout.bind(lr),e._clearTimeoutOverride=t.clearTimeoutOverride?t.clearTimeoutOverride:clearTimeout.bind(lr),E=!t.disableOptimizeObj&&!!ie("chrome");var f=c.getWParam;c.getWParam=function(){var e=0;return t.ignoreMc1Ms0CookieProcessing&&(e|=2),e|f()},t.eventsLimitInMem>0&&(y=t.eventsLimitInMem),t.immediateEventLimit>0&&(h=t.immediateEventLimit),t.autoFlushEventsLimit>0&&(s=t.autoFlushEventsLimit),J(),t.httpXHROverride&&t.httpXHROverride.sendPOST&&(o=t.httpXHROverride),Pt(r.anonCookieName)&&a.addQueryStringParameter("anoncknm",r.anonCookieName),a.sendHook=t.payloadPreprocessor,a.sendListener=t.payloadListener;var d=t.overrideEndpointUrl?t.overrideEndpointUrl:r.endpointUrl;function v(e){"beforeunload"!==(e||ae().event).type&&(_=!0,a.setUnloading(_)),F(2,2)}e._notificationManager=r.extensionConfig.NotificationManager,a.initialize(d,e.core,e,o,t);var p=r.disablePageUnloadEvents||[];ft(v,p),dt(v,p),vt((function(e){_=!1,a.setUnloading(_)}),r.disablePageShowEvents),e.setInitialized(!0)}),(function(){return{coreConfig:r,core:i,extensions:u}}))},e.processTelemetry=function(n,r){At(n,e.identifier);var o=(r=e._getTelCtx(r)).getExtCfg(e.identifier),a=!!t.disableTelemetry;o&&(a=a||!!o.disableTelemetry);var s=n;a||l||(t.overrideInstrumentationKey&&(s.iKey=t.overrideInstrumentationKey),o&&o.overrideInstrumentationKey&&(s.iKey=o.overrideInstrumentationKey),i(s,!0),_?F(2,2):N()),e.processNext(s,r)},e.setEventQueueLimits=function(e,n){y=e>0?e:1e4,s=n>0?n:0,J();var t=g>e;if(!t&&u>0)for(var r=jn;!t&&r<=Un;r++){var i=I[r];i&&i.batches&&D(i.batches,(function(e){e&&e.count()>=u&&(t=!0)}))}R(!0,t)},e.teardown=function(){F(2,2),l=!0,a.teardown()},e.pause=function(){L(),v=!0,a.pause()},e.resume=function(){v=!1,a.resume(),N()},e.addResponseHandler=function(e){a._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){L(),q(),C=Bt,N(),S(e,(function(e,n){var t=n.length;if(t>=2){var r=t>2?n[2]:0;if(n.splice(0,t-2),n[1]<0&&(n[0]=-1),n[1]>0&&n[0]>0){var i=n[0]/n[1];n[0]=Math.ceil(i)*n[1]}r>=0&&n[1]>=0&&r>n[1]&&(r=n[1]),n.push(r),m[e]=n}}))},e.flush=function(e,n,t){void 0===e&&(e=!0),v||(L(),t=t||1,e?(U(jn,0,t),B(),null==d?d=M((function(){K(n,t)}),0):f.push(n)):(k(jn,1,t),null!==n&&void 0!==n&&n()))},e.setMsaAuthTicket=function(e){a.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=O,e._setTransmitProfile=function(e){C!==e&&void 0!==m[e]&&(L(),C=e,N())},e._backOffTransmission=function(){x<4&&(x++,L(),N())},e._clearBackOff=function(){x&&(x=0,L(),N())}})),i}return Object(u.b)(n,e),n}(nn),vr=dr,pr=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return Object(a.f)(n,e),n.prototype.initialize=function(n,t){this._postChannel=new vr;var r=[];t&&(r=r.concat(t)),n.channels=[[this._postChannel]],n.extensionConfig=n.extensionConfig||[],n.extensionConfig[this._postChannel.identifier]=Object(a.a)(Object(a.a)({},n.channelConfiguration),n.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,n,r)}catch(i){this.logger.warnToConsole("Failed to initialize SDK."+i)}},n.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var n=e/1e3,t=n/2,r={};r.OTelCustomTransmissionProfile=[n,t],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},n.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},n.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},n}(jt),hr="Data.",gr="f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",yr="b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121";function mr(e,n,t){n&&n.forEach((function(n){if(!n.classification||4===n.classification||1===n.classification||t.customerContentEnabled&&32===n.classification){var r,i;switch(r=t.prependDataToken?"zC."===n.name.substr(0,3)?"zC.Data."+n.name.substr(3):hr+n.name:n.name,n.dataType){case 3:i=6;break;case 2:i=4;break;case 4:i=8;break;case 0:return void(e[r]="string"===typeof n.value?n.value.substr(0,25e3):n.value);default:return void(e[r]=n.value)}var o={value:n.value,propertyType:i};e[r]=o}}))}function Cr(e,n){try{return e()}catch(t){return Object(s.a)(1,"1DS Sink",t),n}}var br,Tr=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.identifier="PartAPlugin",n.priority=3,n._properties={},n}return Object(a.f)(n,e),n.prototype.initialize=function(n,t,r){e.prototype.initialize.call(this,n,t,r)},n.prototype.processTelemetry=function(e,n){e.data=Mt(this._properties,e.data);var t=this._getTelCtx(n);this.processNext(e,t)},n.prototype.addDataFields=function(e){mr(this._properties,e,{prependDataToken:!1,customerContentEnabled:!1})},n}(nn),Sr="HttpManager:_sendBatches",xr="HttpManager:_sendBatchesNotification",wr=function(){function e(e,n,t){this.start=Date.now(),this.name=e,this.isAsync=!0===t,this.payload=n}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),Ir=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,n,t){return e===Sr||e===xr?new wr(e,n,t):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case Sr:this.handleSendBatches(e);break;case xr:this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,n){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var n=e.payload();if(n.batches&&n.reason&&n.reason>=1e3&&n.reason<=1999){var t=0;for(var r in n.batches)t+=n.batches[r].evts.length;this._callbacks.requestProcessingStats(0,t)}}},e}();!function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="https://office-c.events.data.microsoft.com/OneCollector/1.0/",e.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/"}(br||(br={}));var Pr=t(154),Er=void 0,_r=function(e){function n(n,t){var r,i,o=e.call(this,n,t)||this;o.usePartAPlugin=!0;var u=new Tr,c=function(e){e&&e.addNotificationListener({eventsSent:function(e){Object(s.b)(2,2,(function(){return"Successfully sent "+e.length+" event(s)"})),Object(s.b)(3,2,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),o.eventsSent+=e.length},eventsDiscarded:function(e,n){Object(s.b)(0,2,(function(){return"Discarded "+e.length+" event(s) because "+n})),Object(s.b)(3,2,(function(){return"Discarded event(s) details : "+JSON.stringify(e,null,2)})),o.eventsDiscarded+=e.length}})};function l(e,n,t,r){var i={instrumentationKey:n,endpointUrl:t,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:e.httpXHROverride,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},disableCookiesUsage:!0,extensionConfig:Object(a.a)({},e.extensionConfig)};e.stats&&e.stats.networkStats&&i.channelConfiguration&&(i.channelConfiguration.payloadListener=function(n,t){var r,i=t||n;i.data&&(null===(r=e.stats)||void 0===r||r.networkStats(i.data.length))});var o=new pr;return o.initialize(i,r),o.setUploadFrequency(e.uploadFrequency),e.notificationListener&&o.addNotificationListener(e.notificationListener),e.stats&&o.setPerfMgr(new Ir(e.stats)),o}o.sendTelemetryEvent=function(e){return Cr((function(){var n=o.getOneDSTelemetryEvent(e);n&&r&&r.track(n)}),Er)},o.sendCustomerContent=function(e){return Cr((function(){var n=o.getOneDSCustomerContent(e);n&&i&&i.track(n)}),Er)},o.addPersistentDataFields=function(e){u.addDataFields(e)},o.flush=function(e){r&&r.flush(e)},o.shutdown=function(){try{r&&r.shutdown()}catch(e){Object(s.b)(0,2,(function(){return"An error occurred on shutdown"}))}};var f=[u];if(t.plugins&&f.push.apply(f,t.plugins),!t.endpointUrl)throw new Error("Missing Endpoint Url");return r=l(t,gr,t.endpointUrl,f),t.enableCustomerContent&&t.endpointUrl===br.PUBLIC&&(i=l(t,yr,br.CUSTOMER_CONTENT,f)),t.disableStatsTracking||(c(r),c(i)),o.addPersistentDataFields(n),o}return Object(a.f)(n,e),n}((function(e,n){var t=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this.usePartAPlugin=!1;var r=[],i=!1,o={name:"DiagnosticLevel",processEvent:function(e){var n=e.eventFlags.diagnosticLevel;return i||10===n||110===n||120===n}},u={},c=Nt(),l=(new Date).getTime().toString(),f=function(e,n){if(1===n.eventType)return yr;if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");return e.telemetryProperties.ariaTenantToken},d=function(e,n){var i,o=Object(Pr.c)(e);if(function(e){for(var n=function(n){var t=r[n];if(!t.processEvent(e))return Object(s.b)(2,1,(function(){return e.eventName+" suppressed by "+t.name})),{value:!1}},t=0;t<r.length;t++){var i=n(t);if("object"===typeof i)return i.value}return!0}(o)){t.eventsProcessed++;var d=((i=o.timestamp)?new Date(i):new Date).toISOString(),v={"Event.Sequence":{value:t.eventsProcessed,propertyType:4},"Event.Name":o.eventName,"Event.Source":"OTelJS","Event.Time":{value:d,propertyType:9}};mr(v,o.dataFields,{prependDataToken:!0,customerContentEnabled:1===n.eventType}),v["Event.Id"]=c+"."+t.eventsProcessed;var p="custom";o.eventContract&&(o.eventContract.name&&(v["Event.Contract"]=o.eventContract.name,p+="."+o.eventContract.name.toLowerCase().replace(/\./g,"_")),mr(v,o.eventContract.dataFields,{prependDataToken:!1,customerContentEnabled:1===n.eventType}));var h={iKey:f(o,n),name:o.eventName,data:v,time:d,baseType:p,ext:{sdk:{seq:t.eventsProcessed,epoch:l}}};return t.usePartAPlugin||(h.data=Object(a.a)(Object(a.a)({},h.data),u)),h}};this.getOneDSTelemetryEvent=function(e){return d(e,{eventType:0})},this.getOneDSCustomerContent=function(e){if(n.enableCustomerContent&&e.telemetryProperties.customerContentVersion&&Math.floor(e.telemetryProperties.customerContentVersion)<=1&&1===e.telemetryProperties.customerContentType)return d(e,{eventType:1})},this.addPreprocessor=function(e){r.push(e)},this.addPersistentDataFields=function(e){mr(u,e,{prependDataToken:!1,customerContentEnabled:!1})},this.setOptionalEventsEnabled=function(e){i=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,n.enableOptionalEvents&&(i=!0),this.addPersistentDataFields(e),this.addPreprocessor(o)})),kr=t(25),Or="Office.Telemetry.OTelJS.EventThrottled";function Nr(e){return"number"===typeof e}var Mr,Dr=function(){function e(e,n){this._sinkName=e,this._telemetrySink=n,this.name="EventThrottler",this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this._eventThrottleReported={},this._lastIntervalStart=Date.now(),this._maxNamedEventsPerSecond={}}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.setNamedEventThrottle=function(e,n){this._maxNamedEventsPerSecond[e]=n},e.prototype.processEvent=function(e){var n=e.eventName;if(n===Or)return!0;var t=!0;return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[n]=this._singleEventInLastInterval[n]+1||1,n in this._maxNamedEventsPerSecond?t=this.applyThrottle(this._singleEventInLastInterval[n],this._maxNamedEventsPerSecond[n],"MaxNamedEventsPerSecond",n):Nr(this._maxSingleEventPerSecond)&&(t=this.applyThrottle(this._singleEventInLastInterval[n],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",n)),Nr(this._maxTotalEventsPerSecond)&&(this._totalEventsInLastInterval++,t&&(t=this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",n))),t},e.prototype.applyThrottle=function(e,n,t,r){return!(e>n)||(e===n+1&&this._telemetrySink&&!this._eventThrottleReported[r]&&(this._eventThrottleReported[r]=!0,this._telemetrySink.sendTelemetryEvent({eventName:Or,telemetryProperties:{ariaTenantToken:gr,nexusTenantToken:1723},eventFlags:{diagnosticLevel:110},dataFields:[Object(kr.d)("SinkName",this._sinkName||""),Object(kr.d)("ThrottledEvent.Name",r),Object(kr.c)(t,n)]})),Object(s.b)(2,1,(function(){return"1DS Sink Event Throttle: Exceeded "+n+" "+t+": "+r})),!1)},e}(),Lr=t(313),Fr=function(){function e(n){var t=this;Object(i.a)(this,e),this.context=n,this.createOneDsSink=function(){if(!Mr){(Mr=new _r([],{endpointUrl:t.getOneDsEndpointUrl()})).setFullEventsEnabled(!0);var e=new Dr("_",Mr);e.setSingleEventThrottle(100),e.setTotalEventThrottle(1e3),Mr.addPreprocessor(e),t.setPartADataFields(t.context)}return Mr},this.shutdown=function(){Mr.shutdown()},this.setPartADataFields=function(e){var n=t.extractPartADataFields(e);Mr.addPersistentDataFields(n)},this.getOneDsEndpointUrl=function(){switch(t.audience){case"Automation":case"SyntheticTraffic":case"Local":case"Development":case"Staging":case"Dogfood":case"Preview":case"Microsoft":case"Production":case"GCC":return br.PUBLIC;case"GCC-High":return br.USGOV_DOJ;case"DoD":return br.USGOV_DOD;default:throw new Error("Unexpected audience value provided")}},this.audience=n.audience}return Object(o.a)(e,[{key:"getReleaseAudienceGroup",value:function(e){if(e)switch(e){case"Automation":case"SyntheticTraffic":case"Local":case"Development":case"Staging":case"Dogfood":case"Preview":case"Microsoft":case"Production":return e;case"GCC":case"GCC-High":case"DoD":return"Production"}}},{key:"isGuid",value:function(e){return e&&!!e.match(/(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}/g)}},{key:"isOrgIdPuid",value:function(e){return e&&e.match(/[1-2]{1}[0-9a-fA-F]{15}/g)}},{key:"determineIdentitySpace",value:function(e,n){return n||(this.isGuid(e)?"UserObjectId":this.isOrgIdPuid(e)?"OrgIdPuid":void 0)}},{key:"addDataFieldIfNeeded",value:function(e,n,t){var r=Object(Lr.a)(t,n);r&&e.push(r)}},{key:"extractPartADataFields",value:function(e){var n=[];this.addDataFieldIfNeeded(n,"App.Platform",e.appPlatform||"Web"),this.addDataFieldIfNeeded(n,"App.Name",e.appName||"Fluid"),this.addDataFieldIfNeeded(n,"App.Version",e.appVersion),this.addDataFieldIfNeeded(n,"Release.AudienceGroup",this.getReleaseAudienceGroup(e.audience)),this.addDataFieldIfNeeded(n,"Session.Id",e.sessionId),this.addDataFieldIfNeeded(n,"Culture.UiLanguage",e.uiLanguage),this.addDataFieldIfNeeded(n,"User.IsAnonymous",!e.user),this.addDataFieldIfNeeded(n,"User.TenantId",e.user&&e.user.tenantId),this.addDataFieldIfNeeded(n,"User.TenantGroup",e.user&&"Commercial");var t=e.user&&(e.user.id?e.user.id:e.user.oid);return this.addDataFieldIfNeeded(n,"User.PrimaryIdentityHash",t),this.addDataFieldIfNeeded(n,"User.PrimaryIdentitySpace",e.user&&this.determineIdentitySpace(t,e.user.userIdSpace)),n}}]),e}()},826:function(e,n,t){"use strict";t.d(n,"h",(function(){return r})),t.d(n,"j",(function(){return i})),t.d(n,"l",(function(){return o})),t.d(n,"k",(function(){return a})),t.d(n,"i",(function(){return s})),t.d(n,"g",(function(){return u})),t.d(n,"b",(function(){return c})),t.d(n,"f",(function(){return l})),t.d(n,"a",(function(){return f})),t.d(n,"c",(function(){return d})),t.d(n,"d",(function(){return v})),t.d(n,"e",(function(){return p}));var r="function",i="object",o="undefined",a="prototype",s="hasOwnProperty",u="default",c=Object,l=c[a],f=c.assign,d=c.create,v=c.defineProperty,p=l[s]},906:function(e,n,t){"use strict";(function(e){t.d(n,"a",(function(){return i})),t.d(n,"c",(function(){return o})),t.d(n,"b",(function(){return a}));var r=t(826);function i(){return typeof globalThis!==r.l&&globalThis?globalThis:typeof self!==r.l&&self?self:typeof window!==r.l&&window?window:typeof e!==r.l&&e?e:null}function o(e){throw new TypeError(e)}function a(e){var n=r.c;if(n)return n(e);if(null==e)return{};var t=typeof e;function i(){}return t!==r.j&&t!==r.h&&o("Object prototype may only be an Object:"+e),i[r.k]=e,new i}}).call(this,t(32))}}]);
//# sourceMappingURL=274.7db5d366.chunk.js.map