(this.webpackJsonpfluidhost=this.webpackJsonpfluidhost||[]).push([[276],{1278:function(e,t,n){"use strict";n.r(t),n.d(t,"SharepointNotificationService",(function(){return nt}));var o={};n.r(o),n.d(o,"ignoreUnused",(function(){return b})),n.d(o,"isValid",(function(){return m})),n.d(o,"Lazy",(function(){return y})),n.d(o,"Int8$",(function(){return T})),n.d(o,"UInt8$",(function(){return I})),n.d(o,"Int16$",(function(){return P})),n.d(o,"UInt16$",(function(){return w})),n.d(o,"Int32$",(function(){return V})),n.d(o,"UInt32$",(function(){return C})),n.d(o,"Int64$",(function(){return A})),n.d(o,"UInt64$",(function(){return k})),n.d(o,"Float32$",(function(){return S})),n.d(o,"Float64$",(function(){return U})),n.d(o,"Bool$",(function(){return F})),n.d(o,"String$",(function(){return D})),n.d(o,"DateTime$",(function(){return $})),n.d(o,"Guid",(function(){return N})),n.d(o,"Guid$",(function(){return R})),n.d(o,"isJsonValue",(function(){return x})),n.d(o,"isJsonElement",(function(){return E})),n.d(o,"isJsonObject",(function(){return M})),n.d(o,"cloneJsonValue",(function(){return W})),n.d(o,"Json$",(function(){return L})),n.d(o,"Version",(function(){return K})),n.d(o,"Version$",(function(){return z})),n.d(o,"enumToJsonValue",(function(){return G})),n.d(o,"bitFieldToJsonValue",(function(){return _})),n.d(o,"JsonFlags",(function(){return B})),n.d(o,"Facet$",(function(){return Q})),n.d(o,"Classification",(function(){return q})),n.d(o,"using",(function(){return Y})),n.d(o,"SerializationContext",(function(){return Z})),n.d(o,"createJsonObjectForStructure",(function(){return ee})),n.d(o,"addJsonProperty",(function(){return te})),n.d(o,"StructBase",(function(){return re})),n.d(o,"StructBase$",(function(){return ae})),n.d(o,"ActivityBase",(function(){return ie})),n.d(o,"ActivityBase$",(function(){return se}));var r={};n.r(r),n.d(r,"Facet",(function(){return be})),n.d(r,"Unified",(function(){return fe})),n.d(r,"SIGS",(function(){return de})),n.d(r,"Base",(function(){return pe})),n.d(r,"Common",(function(){return ve})),n.d(r,"Vroom",(function(){return he})),n.d(r,"Transport",(function(){return Oe}));var a=n(1),i=n(3),s=n(2),u=n(0),c=n.n(u),l=n(223),f=n(892),d=n(334),p=n(333),v=n(4),h=n(5),O=n(8);function b(){}function m(e){return null!==e&&"undefined"!==typeof e}var y=function(){function e(t){Object(i.a)(this,e),this.factory=t}return Object(s.a)(e,[{key:"Value",get:function(){return m(this.data)||(this.data=this.factory()),this.data}}],[{key:"create",value:function(t){return new e(t)}}]),e}();function j(e,t,n){return m(t)?Array.isArray(t)?X(t,n,(function(t,n){return j(e,t,n)})):function(e,t){return(t|=0)<e.Min?e.Min:t>e.Max?e.Max:t}(e,t):null}function J(e){return Object.freeze({toJsonValue:j.bind(null,e),DefaultValue:0})}var T=J({Min:-128,Max:127}),I=J({Min:0,Max:255}),P=J({Min:-32768,Max:32767}),w=J({Min:0,Max:65535}),V=J({Min:-2147483648,Max:2147483647}),C=J({Min:0,Max:4294967295}),A=J({Min:Number.MIN_SAFE_INTEGER,Max:Number.MAX_SAFE_INTEGER}),k=J({Min:0,Max:Number.MAX_SAFE_INTEGER});function g(e,t){return m(e)?Array.isArray(e)?X(e,t,g):e:null}var S=Object.freeze({toJsonValue:g,DefaultValue:0}),U=S,F=Object.freeze({toJsonValue:function(e,t){return m(e)?Array.isArray(e)?X(e,t,F.toJsonValue):e:null},DefaultValue:!1}),D=Object.freeze({toJsonValue:function(e,t){return m(e)?Array.isArray(e)?X(e,t,D.toJsonValue):m(e)&&""!==e?e:null:null}}),$=Object.freeze({toJsonValue:function(e,t){return m(e)?Array.isArray(e)?X(e,t,$.toJsonValue):D.toJsonValue(e.toISOString(),t):null},DefaultValue:new Date(0)}),N=function(){function e(t){Object(i.a)(this,e),this.value=t}return Object(s.a)(e,[{key:"toString",value:function(){return this.value}}],[{key:"createNew",value:function(){return new e("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})))}},{key:"toJsonValue",value:function(t,n){return m(t)?Array.isArray(t)?X(t,n,e.toJsonValue):t!==e.Empty?D.toJsonValue(t.toString(),n):null:null}}]),e}();N.Empty=new N("00000000-0000-0000-0000-000000000000"),N.DefaultValue=N.Empty;var R=N;function x(e){return null!==e&&["number","string","boolean","object"].indexOf(typeof e)>=0}function E(e){return x(e)&&!Array.isArray(e)}function M(e){return null!==e&&"object"===typeof e&&!Array.isArray(e)}function W(e){if(M(e)){var t={};for(var n in e)t[n]=W(e[n]);return t}if(Array.isArray(e)){for(var o=[],r=0;r<e.length;++r){var a=e[r];E(a)&&o.push(a)}return o}return e}var L=Object.freeze({toJsonValue:function(e,t){return m(e)?Array.isArray(e)?X(e,t,L.toJsonValue):W(e):null}}),K=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(i.a)(this,e),this.Major=t,this.Minor=n,this.Build=o,this.Revision=r}return Object(s.a)(e,[{key:"toString",value:function(){var e=this.Major+"."+this.Minor;return(this.Build>0||this.Revision>0)&&(e+="."+this.Build,this.Revision>0&&(e+="."+this.Revision)),e}}],[{key:"toJsonValue",value:function(t,n){return m(t)?Array.isArray(t)?X(t,n,e.toJsonValue):D.toJsonValue(t.toString(),n):null}}]),e}();K.DefaultValue=new K;var B,z=K;function G(e,t,n,o){if(!m(e))return null;if(Array.isArray(e))return X(e,o,(function(e,o){return G(e,t,n,o)}));if(o&B.EnumAsUnderlyingType)return C.toJsonValue(e,o);for(var r=Math.min(t.length,n.length),a=0;a<r;++a)if(t[a]===e)return D.toJsonValue(n[a],o);return D.toJsonValue(e.toString(),o)}function _(e,t,n,o){if(!m(e))return null;if(Array.isArray(e))return X(e,o,(function(e,o){return _(e,t,n,o)}));if(o&B.EnumAsUnderlyingType)return C.toJsonValue(e,o);for(var r=[],a=Math.min(t.length,n.length),i=0;i<a;++i){var s=t[i];if(e&s&&(r.push(n[i]),(e&=~s)<1))break}return e>0&&r.push(e.toString()),r.length<1?D.toJsonValue("None",o):D.toJsonValue(r.join(","),o)}function X(e,t,n){if(!m(e)||e.length<1)return null;var o,r=[],a=Object(O.a)(e);try{for(a.s();!(o=a.n()).done;){var i=n(o.value,t);m(i)&&!Array.isArray(i)&&r.push(i)}}catch(s){a.e(s)}finally{a.f()}return r}!function(e){e[e.None=0]="None",e[e.OmitTypeInfo=1]="OmitTypeInfo",e[e.UseSharePointTypeInfo=2]="UseSharePointTypeInfo",e[e.UseFacetEncoding=4]="UseFacetEncoding",e[e.EnumAsUnderlyingType=8]="EnumAsUnderlyingType",e[e.FacetMask=-16777216]="FacetMask"}(B||(B={}));var q,H,Q=Object.freeze({toFlags:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B.None;return t&~B.FacetMask|(255&e)<<24|B.UseFacetEncoding},fromFlags:function(e){return(e&B.FacetMask)>>24}});function Y(e,t){try{return t(e)}finally{e.exit()}}(H=q||(q={}))[H.Unspecified=0]="Unspecified",H[H.AccessControlData=1]="AccessControlData",H[H.CustomerContent=2]="CustomerContent",H[H.EUII=3]="EUII",H[H.SupportData=4]="SupportData",H[H.AccountData=5]="AccountData",H[H.PublicPersonalData=6]="PublicPersonalData",H[H.EUPI=7]="EUPI",H[H.OII=8]="OII",H[H.SystemMetadata=9]="SystemMetadata",H[H.PublicNonPersonalData=10]="PublicNonPersonalData",H[H.Count=11]="Count";var Z=function(){function e(){Object(i.a)(this,e),this.artifacts=new Map,this.parent=e.current,e.current=this}return Object(s.a)(e,[{key:"exit",value:function(){e.current=this.parent}}],[{key:"getOrCreateArtifact",value:function(t,n){for(var o=e.current;o;o=o.parent){var r=o.artifacts.get(n);if(r)return r}var a=t();return m(e.current)&&e.current.artifacts.set(n,a),a}}]),e}();function ee(e,t){return t&B.OmitTypeInfo||t&B.UseFacetEncoding?{}:t&B.UseSharePointTypeInfo?{__metadata:{type:e}}:{__type:e}}function te(e,t,n,o){if(m(n)){var r,a=Object(O.a)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value,s=e[i];M(s)||(e[i]=s={}),e=s}}catch(u){a.e(u)}finally{a.f()}}m(o)&&(e[t]=o)}Z.current=null;var ne,oe,re=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,[{key:"update",value:function(e){}},{key:"toFacetJsonValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B.None;return this.toJsonValue(Q.toFlags(e,t))}},{key:"toJson",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B.None;return JSON.stringify(this.toJsonValue(e))}},{key:"toFacetJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B.None;return this.toJson(Q.toFlags(e,t))}},{key:"writeToJsonObject",value:function(e,t){}},{key:"writeToFacetJsonObject",value:function(e,t){}},{key:"processJsonObject",value:function(e,t,n,o){var r=this;Y(new Z,(function(){t&B.UseFacetEncoding?o.call(r,e,t):n.call(r,e,t)}))}}],[{key:"toJsonValue",value:function(t,n){return m(t)?Array.isArray(t)?X(t,n,e.toJsonValue):t.toJsonValue(n):null}},{key:"toPolymorphicJsonValue",value:function(t,n,o){return m(t)?Array.isArray(t)?X(t,n,(function(t,n){return e.toPolymorphicJsonValue(t,n,o)})):(n&B.OmitTypeInfo||n&B.UseFacetEncoding||t.TypeName!=o||(n|=B.OmitTypeInfo),t.toJsonValue(n)):null}}]),e}(),ae=re,ie=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeClassification=q.CustomerContent,e}return Object(s.a)(n)}(re),se=ie,ue=n(22),ce=n(15);function le(e){var t=e.TypeName,n=t.lastIndexOf(".");return n>=0?t.substring(n+1):t}!function(e){var t=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"convertTo",value:function(e,t){return le(t)}}]),e}();e.Type=t;var n=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"getOrCreate",value:function(){return Z.getOrCreateArtifact(e.create,e.artifactId)}},{key:"getPersonIndex",value:function(t){return m(t)?e.findPerson(t):-1}},{key:"addPerson",value:function(t){if(m(t)){var n=e.findAndUpdatePerson(t);m(n)||(n=new fe.Person,e.updatePerson(n,t),e.getOrCreate().push(n));for(var o=arguments.length,r=new Array(o>1?o-1:0),a=1;a<o;a++)r[a-1]=arguments[a];for(var i=0,s=r;i<s.length;i++){var u=s[i];m(n.Roles)?n.Roles.indexOf(u)<0&&n.Roles.push(u):n.Roles=[u]}}}},{key:"addPeople",value:function(t){if(m(t)){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];var a,i=Object(O.a)(t);try{for(i.s();!(a=i.n()).done;){var s=a.value;e.addPerson.apply(e,[s].concat(o))}}catch(u){i.e(u)}finally{i.f()}}}},{key:"create",value:function(){return[]}},{key:"findAndUpdatePerson",value:function(t){var n=e.findPerson(t);if(n>=0){var o=e.getOrCreate()[n];return e.updatePerson(o,t),o}return null}},{key:"findPerson",value:function(t){for(var n=e.getOrCreate(),o=0;o<n.length;++o){var r=n[o];if(m(r.Provider)&&""!==r.Provider){if(r.Provider===t.Provider&&r.Id===t.Id)return o;if(m(t.Provider)&&""!==t.Provider)continue}if(m(r.Email)&&""!==r.Email){if(r.Email===t.Email)return o;if(m(t.Email)&&""!==t.Email)continue}if(m(r.Name)&&""!==r.Name&&r.Name===t.Name)return o}return-1}},{key:"updatePerson",value:function(e,t){m(e.Provider)&&""!==e.Provider||(e.Provider=t.Provider,e.Id=t.Id),m(e.Email)&&""!==e.Email||(e.Email=t.Email),m(e.Name)&&""!==e.Name||(e.Name=t.Name)}}]),e}();n.artifactId=Symbol();var o=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"convertToArray",value:function(t,o){var r=n.getOrCreate();return o instanceof ve.CommentReply?(n.addPerson(o.Creator,"Creator","InThread"),n.addPerson(o.ParentAuthor,"RepliedTo","InThread"),n.addPeople(o.Participants,"InThread"),n.addPerson(o.TaskCreator,"TaskCreator"),n.addPeople(o.TaskAssignees,"ExistingAssignee"),e.processCommentPreview(o.Preview),r):o instanceof ve.Comment?(n.addPerson(o.Creator,"Creator"),n.addPerson(o.TaskCreator,"TaskCreator"),n.addPeople(o.TaskAssignees,"ExistingAssignee"),e.processCommentPreview(o.Preview),r):o instanceof ve.Mention?(n.addPerson(o.Creator,"Creator"),n.addPerson(o.Mentionee,"Mentioned"),n.addPerson(o.TaskCreator,"TaskCreator"),n.addPeople(o.TaskAssignees,"ExistingAssignee"),e.processCommentPreview(o.CommentPreview),r):o instanceof pe.Mention?(n.addPerson(o.Creator,"Creator"),n.addPerson(o.Mentionee,"Mentioned"),r):o instanceof ve.TaskCreation?(n.addPerson(o.Creator,"Creator"),n.addPerson(o.CommentThreadCreator,"CommentThreadCreator"),n.addPeople(o.Assignees,"NewAssignee"),e.processCommentPreview(o.CommentPreview),r):o instanceof ve.TaskReassignment?(n.addPerson(o.Creator,"Creator"),n.addPerson(o.TaskCreator,"TaskCreator"),n.addPeople(o.Assignees,"ExistingAssignee"),n.addPeople(o.NewAssignees,"NewAssignee"),e.processCommentPreview(o.CommentPreview),r):o instanceof ve.TaskUpdate?(n.addPerson(o.Creator,"Creator"),n.addPerson(o.TaskCreator,"TaskCreator"),n.addPeople(o.Assignees,"ExistingAssignee"),e.processCommentPreview(o.CommentPreview),r):o instanceof ve.CanvasTask?(n.addPerson(o.Creator,"Creator"),n.addPerson(o.TaskCreator,"TaskCreator"),n.addPeople(o.Assignees,"Assignee"),n.addPeople(o.PreviousAssignees,"PreviousAssignee"),r):o instanceof ve.WorkspaceActivity?(n.addPerson(o.Creator,"Creator"),n.addPerson(o.WorkspaceOwner,"WorkspaceOwner"),r):r}},{key:"processCommentPreview",value:function(t){if(m(t))if(e.processPreviewFragment(t.Anchor,"AnchorCreator"),t instanceof ve.CommentReplyPreview){if(e.processPreviewFragment(t.Comment,"CommentCreator","InThread"),e.processPreviewFragment(t.RootComment,"RepliedTo","InThread"),m(t.RecentComments)){var n,o=Object(O.a)(t.RecentComments);try{for(o.s();!(n=o.n()).done;){var r=n.value;e.processPreviewFragment(r,"InThread")}}catch(a){o.e(a)}finally{o.f()}}}else e.processPreviewFragment(t.Comment,"CommentCreator")}},{key:"processPreviewFragment",value:function(e){if(m(e)){for(var t=arguments.length,o=new Array(t>1?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];n.addPerson.apply(n,[e.Creator].concat(o))}}}]),e}();e.People=o;var r=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"convertToOptional",value:function(e,t){if(m(t)){var o=n.getPersonIndex(t.Creator);if(o>=0)return o}return null}}]),e}();e.PersonIndex=r;var a=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"convertToArray",value:function(e,t){if(m(t)){var n,o=[],r=Object(O.a)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;m(a)&&o.push(a.RevisionID)}}catch(i){r.e(i)}finally{r.f()}return o}return null}}]),e}();e.RevisionIDs=a}(ne||(ne={})),function(e){var t=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"convertTo",value:function(e,t){if(t instanceof pe.ActivitySignal&&m(t.Data)){var n="Office"+le(t.Data);return t.Data instanceof pe.ContentActionActivity?n+pe.ContentAction$.toJsonValue(t.Data.Action,B.None):n}return le(t)}}]),e}();e.Type=t;var n=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"convertTo",value:function(e,t){switch(t.SourcePlatform){case pe.Platform.Win32:case pe.Platform.WinRT:case pe.Platform.Windows:return de.Platform.Windows;case pe.Platform.Android:return de.Platform.Android;case pe.Platform.Mac:return de.Platform.MacOS;case pe.Platform.iOS:return de.Platform.iOS;case pe.Platform.Linux:return de.Platform.Linux;case pe.Platform.tvOS:return de.Platform.tvOS;default:return de.Platform.Unknown}}}]),e}();e.Platform=n;var o=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"convertTo",value:function(e,t){var n;if(!m(t)||!m(t.Creator)||!m(t.Creator.RawId)&&t.Creator.RawIdKind!=pe.RawUserIdKind.Self)return null;var o=new de.Actor,r=t.Creator.RawProvider==pe.RawIdentityProvider.LiveId,a=null!==(n=t.Creator.RawId)&&void 0!==n?n:"";return o.IdKind=r?de.ActorIdKind.MSA:de.ActorIdKind.AAD,o.TenantId=t.Creator.TenantId,m(t.Creator.RawIdKind)?t.Creator.RawIdKind==pe.RawUserIdKind.OID?o.Id=r?"OID:"+a:a:t.Creator.RawIdKind==pe.RawUserIdKind.PUID?o.Id=r?a:"PUID:"+a:t.Creator.RawIdKind==pe.RawUserIdKind.CID?o.Id="CID:"+a:o.Id="Self":o.Id=r?"CID:"+a:a,o}}]),e}();e.Actor=o;var r=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"convertTo",value:function(e,t){return t.TypeClassification}}]),e}();e.Compliance=r}(oe||(oe={}));var fe,de,pe,ve,he,Oe,be=Object(s.a)((function e(){Object(i.a)(this,e)}));be.Unified=0,be.UnifiedInSignal=1,be.SIGS=2,function(e){var t=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Unified.Person",e}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"Id",null,D.toJsonValue(this.Id,t)),te(e,"Name",null,D.toJsonValue(this.Name,t)),te(e,"Email",null,D.toJsonValue(this.Email,t)),te(e,"Provider",null,D.toJsonValue(this.Provider,t)),te(e,"PictureUrl",null,D.toJsonValue(this.PictureUrl,t)),te(e,"Roles",null,D.toJsonValue(this.Roles,t))}},{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToFacetJsonObject",this).call(this,e,t);var o=Q.fromFlags(t);if(o===be.Unified||o===be.UnifiedInSignal)return te(e,"Id",null,D.toJsonValue(this.Id,t)),te(e,"Name",null,D.toJsonValue(this.Name,t)),te(e,"Email",null,D.toJsonValue(this.Email,t)),te(e,"Provider",null,D.toJsonValue(this.Provider,t)),te(e,"PictureUrl",null,D.toJsonValue(this.PictureUrl,t)),void te(e,"Roles",null,D.toJsonValue(this.Roles,t))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(re);e.Person=t,e.Person$=t}(fe||(fe={})),function(e){var t,n,o,r;!function(e){e[e.User=0]="User",e[e.System=1]="System"}(t=e.ActorKind||(e.ActorKind={})),e.ActorKind$=function(){var n=e.ActorKind,o=y.create((function(){return[0,1]})),r=y.create((function(){return[n[0],n[1]]}));return Object.freeze({toJsonValue:function(e,t){return G(e,o.Value,r.Value,t)},DefaultValue:t.User})}(),function(e){e[e.AAD=0]="AAD",e[e.MSA=1]="MSA"}(n=e.ActorIdKind||(e.ActorIdKind={})),e.ActorIdKind$=function(){var t=e.ActorIdKind,o=y.create((function(){return[0,1]})),r=y.create((function(){return[t[0],t[1]]}));return Object.freeze({toJsonValue:function(e,t){return G(e,o.Value,r.Value,t)},DefaultValue:n.AAD})}(),function(e){e[e.Unknown=0]="Unknown",e[e.Message=1]="Message",e[e.File=2]="File",e[e.Calendar=3]="Calendar"}(o=e.ItemKind||(e.ItemKind={})),e.ItemKind$=function(){var t=e.ItemKind,n=y.create((function(){return[0,1,2,3]})),r=y.create((function(){return[t[0],t[1],t[2],t[3]]}));return Object.freeze({toJsonValue:function(e,t){return G(e,n.Value,r.Value,t)},DefaultValue:o.Unknown})}(),function(e){e[e.Unknown=0]="Unknown",e[e.Windows=1]="Windows",e[e.Android=2]="Android",e[e.iOS=3]="iOS",e[e.MacOS=4]="MacOS",e[e.Linux=5]="Linux",e[e.tvOS=6]="tvOS"}(r=e.Platform||(e.Platform={})),e.Platform$=function(){var t=e.Platform,n=y.create((function(){return[0,1,2,3,4,5,6]})),o=y.create((function(){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6]]}));return Object.freeze({toJsonValue:function(e,t){return G(e,n.Value,o.Value,t)},DefaultValue:r.Unknown})}();var a=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){var t;return Object(i.a)(this,o),(t=n.apply(this,arguments)).IdKind=e.ActorIdKind$.DefaultValue,t.TypeName="SIGS.Actor",t}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"IdKind",null,e.ActorIdKind$.toJsonValue(this.IdKind,n)),te(t,"Id",null,D.toJsonValue(this.Id,n)),te(t,"TenantId",null,D.toJsonValue(this.TenantId,n))}},{key:"writeToFacetJsonObject",value:function(t,n){if(Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,t,n),Q.fromFlags(n)===be.SIGS)return te(t,"ActorIdType",null,e.ActorIdKind$.toJsonValue(this.IdKind,n)),te(t,"ActorId",null,D.toJsonValue(this.Id,n)),te(t,"AadTenantId",null,D.toJsonValue(this.TenantId,n)),void te(t,"ActorType",null,D.toJsonValue("User",n))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),o}(re);e.Actor=a,e.Actor$=a;var u=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"Url",null,D.toJsonValue(this.Url,t))}},{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToFacetJsonObject",this).call(this,e,t),Q.fromFlags(t)!==be.SIGS||te(e,"Url",null,D.toJsonValue(this.Url,t))}}]),n}(re);e.DocumentInfo=u,e.DocumentInfo$=u;var c=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="SIGS.SharePointDocumentInfo",e}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"SiteUrl",null,D.toJsonValue(this.SiteUrl,t)),te(e,"TenantId",null,R.toJsonValue(this.TenantId,t)),te(e,"SiteId",null,R.toJsonValue(this.SiteId,t)),te(e,"WebId",null,R.toJsonValue(this.WebId,t)),te(e,"ListId",null,R.toJsonValue(this.ListId,t)),te(e,"ItemId",null,R.toJsonValue(this.ItemId,t))}},{key:"writeToFacetJsonObject",value:function(e,t){if(Object(ue.a)(Object(ce.a)(n.prototype),"writeToFacetJsonObject",this).call(this,e,t),Q.fromFlags(t)===be.SIGS)return te(e,"SiteUrl",null,D.toJsonValue(this.SiteUrl,t)),te(e,"TenantId",null,R.toJsonValue(this.TenantId,t)),te(e,"SiteId",null,R.toJsonValue(this.SiteId,t)),te(e,"WebId",null,R.toJsonValue(this.WebId,t)),te(e,"ListId",null,R.toJsonValue(this.ListId,t)),void te(e,"ItemId",null,R.toJsonValue(this.ItemId,t))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(u);e.SharePointDocumentInfo=c,e.SharePointDocumentInfo$=c}(de||(de={})),function(e){var t,n,o,r,a,u,c,l;!function(e){e[e.Unknown=0]="Unknown",e[e.Word=1]="Word",e[e.Excel=2]="Excel",e[e.PowerPoint=3]="PowerPoint",e[e.Outlook=4]="Outlook",e[e.OneNote=5]="OneNote",e[e.FluidApp=6]="FluidApp",e[e.Visio=7]="Visio"}(t=e.App||(e.App={})),e.App$=function(){var n=e.App,o=y.create((function(){return[0,1,2,3,4,5,6,7]})),r=y.create((function(){return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]]}));return Object.freeze({toJsonValue:function(e,t){return G(e,o.Value,r.Value,t)},DefaultValue:t.Unknown})}(),function(e){e[e.Unknown=0]="Unknown",e[e.Win32=1]="Win32",e[e.WinRT=2]="WinRT",e[e.Android=3]="Android",e[e.Mac=4]="Mac",e[e.iOS=5]="iOS",e[e.Web=6]="Web",e[e.Server=7]="Server",e[e.Windows=8]="Windows",e[e.Linux=9]="Linux",e[e.tvOS=10]="tvOS"}(n=e.Platform||(e.Platform={})),e.Platform$=function(){var t=e.Platform,o=y.create((function(){return[0,1,2,3,4,5,6,7,8,9,10]})),r=y.create((function(){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10]]}));return Object.freeze({toJsonValue:function(e,t){return G(e,o.Value,r.Value,t)},DefaultValue:n.Unknown})}(),function(e){e[e.Unspecified=0]="Unspecified",e[e.EditSession=1]="EditSession",e[e.PreExisting=2]="PreExisting"}(o=e.ContentOrigin||(e.ContentOrigin={})),e.ContentOrigin$=function(){var t=e.ContentOrigin,n=y.create((function(){return[0,1,2]})),r=y.create((function(){return[t[0],t[1],t[2]]}));return Object.freeze({toJsonValue:function(e,t){return G(e,n.Value,r.Value,t)},DefaultValue:o.Unspecified})}(),function(e){e[e.Create=0]="Create",e[e.Update=1]="Update",e[e.Delete=2]="Delete"}(r=e.ContentAction||(e.ContentAction={})),e.ContentAction$=function(){var t=e.ContentAction,n=y.create((function(){return[0,1,2]})),o=y.create((function(){return[t[0],t[1],t[2]]}));return Object.freeze({toJsonValue:function(e,t){return G(e,n.Value,o.Value,t)},DefaultValue:r.Create})}(),function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger",e[e.Count=8]="Count"}(a=e.RawIdentityProvider||(e.RawIdentityProvider={})),e.RawIdentityProvider$=function(){var t=e.RawIdentityProvider,n=y.create((function(){return[0,1,2,3,4,5,6,7,8]})),o=y.create((function(){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}));return Object.freeze({toJsonValue:function(e,t){return G(e,n.Value,o.Value,t)},DefaultValue:a.Unknown})}(),function(e){e[e.OID=0]="OID",e[e.PUID=1]="PUID",e[e.CID=2]="CID",e[e.Self=3]="Self"}(u=e.RawUserIdKind||(e.RawUserIdKind={})),e.RawUserIdKind$=function(){var t=e.RawUserIdKind,n=y.create((function(){return[0,1,2,3]})),o=y.create((function(){return[t[0],t[1],t[2],t[3]]}));return Object.freeze({toJsonValue:function(e,t){return G(e,n.Value,o.Value,t)},DefaultValue:u.OID})}(),function(e){e[e.Unspecified=0]="Unspecified",e[e.AccessControlData=1]="AccessControlData",e[e.CustomerContent=2]="CustomerContent",e[e.EUII=3]="EUII",e[e.SupportData=4]="SupportData",e[e.AccountData=5]="AccountData",e[e.PublicPersonalData=6]="PublicPersonalData",e[e.EUPI=7]="EUPI",e[e.OII=8]="OII",e[e.SystemMetadata=9]="SystemMetadata",e[e.PublicNonPersonalData=10]="PublicNonPersonalData",e[e.Count=11]="Count"}(c=e.Classification||(e.Classification={})),e.Classification$=function(){var t=e.Classification,n=y.create((function(){return[0,1,2,3,4,5,6,7,8,9,10,11]})),o=y.create((function(){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11]]})),r=y.create((function(){return new Map([[be.SIGS,[t[0],"AccessControl",t[2],t[3],t[4],t[5],t[6],t[7],t[8],"SystemMetaData",t[10],t[11]]]])}));function a(e){return e&B.UseFacetEncoding?(t=Q.fromFlags(e),r.Value.get(t)||o.Value):o.Value;var t}return Object.freeze({toJsonValue:function(e,t){return G(e,n.Value,a(t),t)},DefaultValue:c.Unspecified})}(),function(e){e[e.Completed=0]="Completed",e[e.InProgress=1]="InProgress",e[e.CompletedMissingStart=2]="CompletedMissingStart"}(l=e.SignalStatus||(e.SignalStatus={})),e.SignalStatus$=function(){var t=e.SignalStatus,n=y.create((function(){return[0,1,2]})),o=y.create((function(){return[t[0],t[1],t[2]]}));return Object.freeze({toJsonValue:function(e,t){return G(e,n.Value,o.Value,t)},DefaultValue:l.Completed})}();var f=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){var e;return Object(i.a)(this,o),(e=n.apply(this,arguments)).TypeName="Base.UserInfo",e}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"Id",null,D.toJsonValue(this.Id,n)),te(t,"Name",null,D.toJsonValue(this.Name,n)),te(t,"Email",null,D.toJsonValue(this.Email,n)),te(t,"Provider",null,D.toJsonValue(this.Provider,n)),te(t,"TenantId",null,D.toJsonValue(this.TenantId,n)),te(t,"RawProvider",null,e.RawIdentityProvider$.toJsonValue(this.RawProvider,n)),te(t,"RawId",null,D.toJsonValue(this.RawId,n)),te(t,"RawIdKind",null,e.RawUserIdKind$.toJsonValue(this.RawIdKind,n))}},{key:"writeToFacetJsonObject",value:function(t,n){if(Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,t,n),Q.fromFlags(n)===be.SIGS)return te(t,"Id",null,D.toJsonValue(this.Id,n)),te(t,"Name",null,D.toJsonValue(this.Name,n)),te(t,"Email",null,D.toJsonValue(this.Email,n)),te(t,"Provider",null,D.toJsonValue(this.Provider,n)),te(t,"TenantId",null,D.toJsonValue(this.TenantId,n)),te(t,"RawProvider",null,e.RawIdentityProvider$.toJsonValue(this.RawProvider,n)),te(t,"RawId",null,D.toJsonValue(this.RawId,n)),void te(t,"RawIdKind",null,e.RawUserIdKind$.toJsonValue(this.RawIdKind,n))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),o}(re);e.UserInfo=f,e.UserInfo$=f;var d=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){var t;return Object(i.a)(this,o),(t=n.apply(this,arguments)).Id=R.DefaultValue,t.Created=$.DefaultValue,t.Finalized=$.DefaultValue,t.Observed=$.DefaultValue,t.SourceApp=e.App$.DefaultValue,t.SourcePlatform=e.Platform$.DefaultValue,t.SourceSessionId=R.DefaultValue,t}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"Id",null,R.toJsonValue(this.Id,n)),te(t,"Creator",null,e.UserInfo$.toJsonValue(this.Creator,n|B.OmitTypeInfo)),te(t,"Created",null,$.toJsonValue(this.Created,n)),te(t,"Finalized",null,$.toJsonValue(this.Finalized,n)),te(t,"Observed",null,$.toJsonValue(this.Observed,n)),te(t,"SourceApp",null,e.App$.toJsonValue(this.SourceApp,n)),te(t,"SourceAppVersion",null,z.toJsonValue(this.SourceAppVersion,n)),te(t,"SourcePlatform",null,e.Platform$.toJsonValue(this.SourcePlatform,n)),te(t,"SourcePlatformVersion",null,z.toJsonValue(this.SourcePlatformVersion,n)),te(t,"SourceDeviceId",null,D.toJsonValue(this.SourceDeviceId,n)),te(t,"SourceSessionId",null,R.toJsonValue(this.SourceSessionId,n)),te(t,"SourceUserAgent",null,D.toJsonValue(this.SourceUserAgent,n)),te(t,"SourceIpAddress",null,D.toJsonValue(this.SourceIpAddress,n)),te(t,"SourceAppContext",null,L.toJsonValue(this.SourceAppContext,n)),te(t,"NotifiedInBand",null,F.toJsonValue(this.NotifiedInBand,n))}},{key:"writeToFacetJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,t,n);var r=Q.fromFlags(n);return r===be.Unified?(te(t,"Id",null,R.toJsonValue(this.Id,n)),te(t,"Timestamp",null,$.toJsonValue(this.Created,n)),te(t,"HostTimestamp",null,$.toJsonValue(this.Observed,n)),te(t,"AppName",["ActivitySource"],e.App$.toJsonValue(this.SourceApp,n)),te(t,"AppVersion",["ActivitySource"],z.toJsonValue(this.SourceAppVersion,n)),te(t,"AppPlatform",["ActivitySource"],e.Platform$.toJsonValue(this.SourcePlatform,n)),te(t,"AppSessionId",["ActivitySource"],R.toJsonValue(this.SourceSessionId,n)),te(t,"AppContext",["ActivitySource"],L.toJsonValue(this.SourceAppContext,n)),void te(t,"NotifiedInBand",null,F.toJsonValue(this.NotifiedInBand,n))):r===be.UnifiedInSignal?(te(t,"Id",null,R.toJsonValue(this.Id,n)),te(t,"Timestamp",null,$.toJsonValue(this.Created,n)),void te(t,"AppSessionId",["ActivitySource"],R.toJsonValue(this.SourceSessionId,n))):r===be.SIGS?(te(t,"ActorDetails",["CustomProperties"],e.UserInfo$.toJsonValue(this.Creator,n|B.OmitTypeInfo)),te(t,"AppName",["Application"],e.App$.toJsonValue(this.SourceApp,n)),te(t,"AppVer",["Application"],z.toJsonValue(this.SourceAppVersion,n)),te(t,"Platform",["CustomProperties","DeviceDetails"],e.Platform$.toJsonValue(this.SourcePlatform,n)),te(t,"OsVer",["Device"],z.toJsonValue(this.SourcePlatformVersion,n)),te(t,"DeviceId",["Device"],D.toJsonValue(this.SourceDeviceId,n)),te(t,"UserAgent",["Device"],D.toJsonValue(this.SourceUserAgent,n)),te(t,"ClientIp",["Device"],D.toJsonValue(this.SourceIpAddress,n)),te(t,"Context",["CustomProperties","ApplicationDetails"],L.toJsonValue(this.SourceAppContext,n)),void te(t,"NotifiedInBand",["CustomProperties"],F.toJsonValue(this.NotifiedInBand,n))):void 0}}]),o}(ie);e.Activity=d,e.Activity$=d;var p=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"SuppressSendToSubstrate",null,F.toJsonValue(this.SuppressSendToSubstrate,t)),te(e,"SignalId",null,R.toJsonValue(this.SignalId,t))}},{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToFacetJsonObject",this).call(this,e,t);var o=Q.fromFlags(t);return o===be.Unified?(te(e,"SuppressSendToSubstrate",null,F.toJsonValue(this.SuppressSendToSubstrate,t)),te(e,"Type",null,D.toJsonValue(ne.Type.convertTo(D,this),t)),void te(e,"People",null,fe.Person$.toJsonValue(ne.People.convertToArray(fe.Person$,this),t|B.OmitTypeInfo))):o===be.UnifiedInSignal?(te(e,"Type",null,D.toJsonValue(ne.Type.convertTo(D,this),t)),void te(e,"People",null,fe.Person$.toJsonValue(ne.People.convertToArray(fe.Person$,this),t|B.OmitTypeInfo))):void 0}}]),n}(d);e.NormalActivity=p,e.NormalActivity$=p;var O=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n)}(p);e.ContentLevelActivity=O,e.ContentLevelActivity$=O;var b=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){var t;return Object(i.a)(this,o),(t=n.apply(this,arguments)).ContentOrigin=e.ContentOrigin$.DefaultValue,t}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"ContentId",null,D.toJsonValue(this.ContentId,n)),te(t,"ContentOrigin",null,e.ContentOrigin$.toJsonValue(this.ContentOrigin,n)),te(t,"NavigationId",null,D.toJsonValue(this.NavigationId,n))}},{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,e,t);var n=Q.fromFlags(t);if(n===be.Unified||n===be.UnifiedInSignal)return te(e,"ContentId",["Data"],D.toJsonValue(this.ContentId,t)),void te(e,"NavigationId",["Data"],D.toJsonValue(this.NavigationId,t))}}]),o}(O);e.ContentActivity=b,e.ContentActivity$=b;var m=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){var t;return Object(i.a)(this,o),(t=n.apply(this,arguments)).Action=e.ContentAction$.DefaultValue,t}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"Action",null,e.ContentAction$.toJsonValue(this.Action,n))}},{key:"writeToFacetJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,t,n);var r=Q.fromFlags(n);r!==be.Unified&&r!==be.UnifiedInSignal||te(t,"ContentAction",["Data"],e.ContentAction$.toJsonValue(this.Action,n))}}]),o}(b);e.ContentActionActivity=m,e.ContentActionActivity$=m;var j=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){return Object(i.a)(this,o),n.apply(this,arguments)}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"Mentionee",null,e.UserInfo$.toJsonValue(this.Mentionee,n|B.OmitTypeInfo))}}]),o}(m);e.Mention=j,e.Mention$=j;var J=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){var e;return Object(i.a)(this,o),(e=n.apply(this,arguments)).StartTime=$.DefaultValue,e.EndTime=$.DefaultValue,e}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"StartTime",null,$.toJsonValue(this.StartTime,n)),te(t,"EndTime",null,$.toJsonValue(this.EndTime,n)),te(t,"Status",null,e.SignalStatus$.toJsonValue(this.Status,n)),te(t,"CorrelationVector",null,D.toJsonValue(this.CorrelationVector,n)),te(t,"Locale",null,D.toJsonValue(this.Locale,n)),te(t,"AppWorkload",null,D.toJsonValue(this.AppWorkload,n)),te(t,"ItemId",null,D.toJsonValue(this.ItemId,n)),te(t,"ItemContainerKind",null,D.toJsonValue(this.ItemContainerKind,n)),te(t,"ItemContainerId",null,R.toJsonValue(this.ItemContainerId,n))}},{key:"writeToFacetJsonObject",value:function(t,n){if(Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,t,n),Q.fromFlags(n)===be.SIGS)return te(t,"StartTime",null,$.toJsonValue(this.StartTime,n)),te(t,"EndTime",null,$.toJsonValue(this.EndTime,n)),te(t,"Status",null,e.SignalStatus$.toJsonValue(this.Status,n)),te(t,"CV",null,D.toJsonValue(this.CorrelationVector,n)),te(t,"Locale",null,D.toJsonValue(this.Locale,n)),te(t,"Workload",["Application"],D.toJsonValue(this.AppWorkload,n)),te(t,"ItemId",["Item"],D.toJsonValue(this.ItemId,n)),te(t,"ContainerType",["Item"],D.toJsonValue(this.ItemContainerKind,n)),te(t,"ContainerId",["Item"],R.toJsonValue(this.ItemContainerId,n)),te(t,"SignalType",null,D.toJsonValue(oe.Type.convertTo(D,this),n)),te(t,"Actor",null,de.Actor$.toJsonValue(oe.Actor.convertTo(de.Actor$,this),n|B.OmitTypeInfo)),te(t,"Os",["Device"],de.Platform$.toJsonValue(oe.Platform.convertTo(de.Platform$,this),n)),te(t,"Compliance",null,e.Classification$.toJsonValue(oe.Compliance.convertTo(e.Classification$,this),n)),te(t,"AadAppId",["Application"],D.toJsonValue("3d9f2b8c-fab8-4011-a098-2652bdd0b55d",n)),void te(t,"ItemType",["Item"],D.toJsonValue("File",n))}}]),o}(d);e.Signal=J,e.Signal$=J;var T=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){return Object(i.a)(this,o),n.apply(this,arguments)}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"DocumentInfo",null,de.DocumentInfo$.toPolymorphicJsonValue(this.DocumentInfo,n&~B.OmitTypeInfo,"SIGS.DocumentInfo")),te(t,"Data",null,e.NormalActivity$.toPolymorphicJsonValue(this.Data,n&~B.OmitTypeInfo,"Base.NormalActivity"))}},{key:"writeToFacetJsonObject",value:function(t,n){if(Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,t,n),Q.fromFlags(n)===be.SIGS)return te(t,"FileDetails",["CustomProperties"],de.DocumentInfo$.toPolymorphicJsonValue(this.DocumentInfo,n&~B.OmitTypeInfo,"SIGS.DocumentInfo")),void te(t,"ActivityDetails",["CustomProperties"],e.NormalActivity$.toPolymorphicJsonValue(this.Data,Q.toFlags(be.UnifiedInSignal,n)&~B.OmitTypeInfo,"Base.NormalActivity"))}}]),o}(J);e.ActivitySignal=T,e.ActivitySignal$=T}(pe||(pe={})),function(e){var t,n,o,r;!function(e){e[e.UnsupportedClient=0]="UnsupportedClient",e[e.ProtectedDocument=1]="ProtectedDocument",e[e.Unnecessary=2]="Unnecessary"}(t=e.PreviewAbsenceReason||(e.PreviewAbsenceReason={})),e.PreviewAbsenceReason$=function(){var n=e.PreviewAbsenceReason,o=y.create((function(){return[0,1,2]})),r=y.create((function(){return[n[0],n[1],n[2]]})),a=y.create((function(){return new Map([[be.Unified,["Unsupported_Client","Encrypted","NotNeeded"]],[be.UnifiedInSignal,["Unsupported_Client","Encrypted","NotNeeded"]]])}));function i(e){return e&B.UseFacetEncoding?(t=Q.fromFlags(e),a.Value.get(t)||r.Value):r.Value;var t}return Object.freeze({toJsonValue:function(e,t){return G(e,o.Value,i(t),t)},DefaultValue:t.UnsupportedClient})}(),function(e){e[e.NotStarted=0]="NotStarted",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"}(n=e.TaskStatus||(e.TaskStatus={})),e.TaskStatus$=function(){var t=e.TaskStatus,o=y.create((function(){return[0,1,2]})),r=y.create((function(){return[t[0],t[1],t[2]]}));return Object.freeze({toJsonValue:function(e,t){return G(e,o.Value,r.Value,t)},DefaultValue:n.NotStarted})}(),function(e){e[e.Urgent=0]="Urgent",e[e.Important=1]="Important",e[e.Medium=2]="Medium",e[e.Low=3]="Low"}(o=e.TaskPriority||(e.TaskPriority={})),e.TaskPriority$=function(){var t=e.TaskPriority,n=y.create((function(){return[0,1,2,3]})),r=y.create((function(){return[t[0],t[1],t[2],t[3]]}));return Object.freeze({toJsonValue:function(e,t){return G(e,n.Value,r.Value,t)},DefaultValue:o.Urgent})}(),function(e){e[e.None=0]="None",e[e.Assignees=1]="Assignees",e[e.Title=2]="Title",e[e.DueDate=4]="DueDate",e[e.Status=8]="Status",e[e.Priority=16]="Priority"}(r=e.TaskProperties||(e.TaskProperties={})),e.TaskProperties$=function(){var t=e.TaskProperties,n=y.create((function(){return[1,2,4,8,16]})),o=y.create((function(){return[t[1],t[2],t[4],t[8],t[16]]}));return Object.freeze({toJsonValue:function(e,t){return _(e,n.Value,o.Value,t)},DefaultValue:r.None})}();var a=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.Revision",e}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"RevisionID",null,D.toJsonValue(this.RevisionID,t))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(re);e.Revision=a,e.Revision$=a;var u=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.PreviewFragment",e}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"Creator",null,pe.UserInfo$.toJsonValue(this.Creator,t|B.OmitTypeInfo)),te(e,"Created",null,$.toJsonValue(this.Created,t)),te(e,"Content",null,L.toJsonValue(this.Content,t)),te(e,"ContentId",null,D.toJsonValue(this.ContentId,t))}},{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToFacetJsonObject",this).call(this,e,t);var o=Q.fromFlags(t);if(o===be.Unified||o===be.UnifiedInSignal)return te(e,"Timestamp",null,$.toJsonValue(this.Created,t)),te(e,"Content",null,L.toJsonValue(this.Content,t)),te(e,"ContentId",null,D.toJsonValue(this.ContentId,t)),void te(e,"CreatorIndex",null,V.toJsonValue(ne.PersonIndex.convertToOptional(V,this),t))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(re);e.PreviewFragment=u,e.PreviewFragment$=u;var c=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.PreviewOptions",e}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"DisableActionableNotification",null,F.toJsonValue(this.DisableActionableNotification,t))}},{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToFacetJsonObject",this).call(this,e,t);var o=Q.fromFlags(t);o!==be.Unified&&o!==be.UnifiedInSignal||te(e,"DisableActionableNotification",null,F.toJsonValue(this.DisableActionableNotification,t))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(re);e.PreviewOptions=c,e.PreviewOptions$=c;var l=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){var e;return Object(i.a)(this,o),(e=n.apply(this,arguments)).TypeName="Common.CommentPreview",e}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"Location",null,D.toJsonValue(this.Location,n)),te(t,"Anchor",null,e.PreviewFragment$.toJsonValue(this.Anchor,n|B.OmitTypeInfo)),te(t,"Comment",null,e.PreviewFragment$.toJsonValue(this.Comment,n|B.OmitTypeInfo)),te(t,"ThreadId",null,D.toJsonValue(this.ThreadId,n)),te(t,"Options",null,e.PreviewOptions$.toPolymorphicJsonValue(this.Options,n&~B.OmitTypeInfo,"Common.PreviewOptions"))}},{key:"writeToFacetJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,t,n);var r=Q.fromFlags(n);if(r===be.Unified||r===be.UnifiedInSignal)return te(t,"LocationText",null,D.toJsonValue(this.Location,n)),te(t,"Anchor",null,e.PreviewFragment$.toJsonValue(this.Anchor,n|B.OmitTypeInfo)),te(t,"Comment",null,e.PreviewFragment$.toJsonValue(this.Comment,n|B.OmitTypeInfo)),te(t,"CommentThreadId",null,D.toJsonValue(this.ThreadId,n)),void te(t,"Options",null,e.PreviewOptions$.toPolymorphicJsonValue(this.Options,n&~B.OmitTypeInfo,"Common.PreviewOptions"))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),o}(re);e.CommentPreview=l,e.CommentPreview$=l;var f=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){var e;return Object(i.a)(this,o),(e=n.apply(this,arguments)).ThreadLength=V.DefaultValue,e.TypeName="Common.CommentReplyPreview",e}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"RootComment",null,e.PreviewFragment$.toJsonValue(this.RootComment,n|B.OmitTypeInfo)),te(t,"RecentComments",null,e.PreviewFragment$.toJsonValue(this.RecentComments,n|B.OmitTypeInfo)),te(t,"ThreadLength",null,V.toJsonValue(this.ThreadLength,n))}},{key:"writeToFacetJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,t,n);var r=Q.fromFlags(n);if(r===be.Unified||r===be.UnifiedInSignal)return te(t,"RootComment",null,e.PreviewFragment$.toJsonValue(this.RootComment,n|B.OmitTypeInfo)),te(t,"RecentComments",null,e.PreviewFragment$.toJsonValue(this.RecentComments,n|B.OmitTypeInfo)),void te(t,"ThreadCommentCount",null,V.toJsonValue(this.ThreadLength,n))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),o}(l);e.CommentReplyPreview=f,e.CommentReplyPreview$=f;var d=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){var e;return Object(i.a)(this,o),(e=n.apply(this,arguments)).TypeName="Common.RevisionSet",e.TypeClassification=q.EUII,e}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"Revisions",null,e.Revision$.toJsonValue(this.Revisions,n|B.OmitTypeInfo))}},{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,e,t);var n=Q.fromFlags(t);n!==be.Unified&&n!==be.UnifiedInSignal||te(e,"Revisions",["Data"],D.toJsonValue(ne.RevisionIDs.convertToArray(D,this.Revisions),t))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),o}(pe.ContentLevelActivity);e.RevisionSet=d,e.RevisionSet$=d;var p=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){var e;return Object(i.a)(this,o),(e=n.apply(this,arguments)).TypeName="Common.Mention",e}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"CommentContentId",null,D.toJsonValue(this.CommentContentId,n)),te(t,"CommentThreadId",null,D.toJsonValue(this.CommentThreadId,n)),te(t,"CommentThreadIsTask",null,F.toJsonValue(this.CommentThreadIsTask,n)),te(t,"TaskCreator",null,pe.UserInfo$.toJsonValue(this.TaskCreator,n|B.OmitTypeInfo)),te(t,"TaskAssignees",null,pe.UserInfo$.toJsonValue(this.TaskAssignees,n|B.OmitTypeInfo)),te(t,"CommentPreview",null,e.CommentPreview$.toPolymorphicJsonValue(this.CommentPreview,n&~B.OmitTypeInfo,"Common.CommentPreview")),te(t,"CommentPreviewAbsenceReason",null,e.PreviewAbsenceReason$.toJsonValue(this.CommentPreviewAbsenceReason,n))}},{key:"writeToFacetJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,t,n);var r=Q.fromFlags(n);if(r===be.Unified||r===be.UnifiedInSignal)return te(t,"ParentContentId",["Data"],D.toJsonValue(this.CommentContentId,n)),te(t,"CommentThreadId",["Data"],D.toJsonValue(this.CommentThreadId,n)),te(t,"CommentThreadIsTask",["Data"],F.toJsonValue(this.CommentThreadIsTask,n)),te(t,"Preview",null,e.CommentPreview$.toPolymorphicJsonValue(this.CommentPreview,n&~B.OmitTypeInfo,"Common.CommentPreview")),void te(t,"PreviewAbsenceReason",["Data"],e.PreviewAbsenceReason$.toJsonValue(this.CommentPreviewAbsenceReason,n))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),o}(pe.Mention);e.Mention=p,e.Mention$=p;var O=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){var e;return Object(i.a)(this,o),(e=n.apply(this,arguments)).TypeName="Common.Comment",e}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"ThreadId",null,D.toJsonValue(this.ThreadId,n)),te(t,"ThreadIsTask",null,F.toJsonValue(this.ThreadIsTask,n)),te(t,"TaskCreator",null,pe.UserInfo$.toJsonValue(this.TaskCreator,n|B.OmitTypeInfo)),te(t,"TaskAssignees",null,pe.UserInfo$.toJsonValue(this.TaskAssignees,n|B.OmitTypeInfo)),te(t,"Preview",null,e.CommentPreview$.toPolymorphicJsonValue(this.Preview,n&~B.OmitTypeInfo,"Common.CommentPreview")),te(t,"PreviewAbsenceReason",null,e.PreviewAbsenceReason$.toJsonValue(this.PreviewAbsenceReason,n))}},{key:"writeToFacetJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,t,n);var r=Q.fromFlags(n);if(r===be.Unified||r===be.UnifiedInSignal)return te(t,"CommentThreadId",["Data"],D.toJsonValue(this.ThreadId,n)),te(t,"CommentThreadIsTask",["Data"],F.toJsonValue(this.ThreadIsTask,n)),te(t,"Preview",null,e.CommentPreview$.toPolymorphicJsonValue(this.Preview,n&~B.OmitTypeInfo,"Common.CommentPreview")),void te(t,"PreviewAbsenceReason",["Data"],e.PreviewAbsenceReason$.toJsonValue(this.PreviewAbsenceReason,n))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),o}(pe.ContentActionActivity);e.Comment=O,e.Comment$=O;var b=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.CommentReply",e}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"ParentAuthor",null,pe.UserInfo$.toJsonValue(this.ParentAuthor,t|B.OmitTypeInfo)),te(e,"Participants",null,pe.UserInfo$.toJsonValue(this.Participants,t|B.OmitTypeInfo))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(O);e.CommentReply=b,e.CommentReply$=b;var m=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){return Object(i.a)(this,o),n.apply(this,arguments)}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"CommentThreadId",null,D.toJsonValue(this.CommentThreadId,n)),te(t,"NavigationId",null,D.toJsonValue(this.NavigationId,n)),te(t,"Assignees",null,pe.UserInfo$.toJsonValue(this.Assignees,n|B.OmitTypeInfo)),te(t,"CommentPreview",null,e.CommentPreview$.toPolymorphicJsonValue(this.CommentPreview,n&~B.OmitTypeInfo,"Common.CommentPreview")),te(t,"CommentPreviewAbsenceReason",null,e.PreviewAbsenceReason$.toJsonValue(this.CommentPreviewAbsenceReason,n))}},{key:"writeToFacetJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,t,n);var r=Q.fromFlags(n);if(r===be.Unified||r===be.UnifiedInSignal)return te(t,"CommentThreadId",["Data"],D.toJsonValue(this.CommentThreadId,n)),te(t,"NavigationId",["Data"],D.toJsonValue(this.NavigationId,n)),te(t,"Preview",null,e.CommentPreview$.toPolymorphicJsonValue(this.CommentPreview,n&~B.OmitTypeInfo,"Common.CommentPreview")),void te(t,"PreviewAbsenceReason",["Data"],e.PreviewAbsenceReason$.toJsonValue(this.CommentPreviewAbsenceReason,n))}}]),o}(pe.ContentLevelActivity);e.TaskActivity=m,e.TaskActivity$=m;var j=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.TaskCreation",e}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"CommentThreadCreator",null,pe.UserInfo$.toJsonValue(this.CommentThreadCreator,t|B.OmitTypeInfo))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(m);e.TaskCreation=j,e.TaskCreation$=j;var J=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"TaskCreator",null,pe.UserInfo$.toJsonValue(this.TaskCreator,t|B.OmitTypeInfo))}}]),n}(m);e.TaskUpdate=J,e.TaskUpdate$=J;var T=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.TaskReassignment",e}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"NewAssignees",null,pe.UserInfo$.toJsonValue(this.NewAssignees,t|B.OmitTypeInfo))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(J);e.TaskReassignment=T,e.TaskReassignment$=T;var I=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.TaskCompletion",e}return Object(s.a)(n,[{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(J);e.TaskCompletion=I,e.TaskCompletion$=I;var P=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.TaskReopen",e}return Object(s.a)(n,[{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(J);e.TaskReopen=P,e.TaskReopen$=P;var w=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){var t;return Object(i.a)(this,o),(t=n.apply(this,arguments)).DueDate=$.DefaultValue,t.Status=e.TaskStatus$.DefaultValue,t.Priority=e.TaskPriority$.DefaultValue,t.TypeName="Common.CanvasTask",t}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"TaskCreator",null,pe.UserInfo$.toJsonValue(this.TaskCreator,n|B.OmitTypeInfo)),te(t,"Assignees",null,pe.UserInfo$.toJsonValue(this.Assignees,n|B.OmitTypeInfo)),te(t,"PreviousAssignees",null,pe.UserInfo$.toJsonValue(this.PreviousAssignees,n|B.OmitTypeInfo)),te(t,"Title",null,D.toJsonValue(this.Title,n)),te(t,"DueDate",null,$.toJsonValue(this.DueDate,n)),te(t,"Status",null,e.TaskStatus$.toJsonValue(this.Status,n)),te(t,"Priority",null,e.TaskPriority$.toJsonValue(this.Priority,n)),te(t,"Updates",null,e.TaskProperties$.toJsonValue(this.Updates,n))}},{key:"writeToFacetJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,t,n);var r=Q.fromFlags(n);if(r===be.Unified||r===be.UnifiedInSignal)return te(t,"Title",["Data"],D.toJsonValue(this.Title,n)),te(t,"DueDate",["Data"],$.toJsonValue(this.DueDate,n)),te(t,"Status",["Data"],e.TaskStatus$.toJsonValue(this.Status,n)),te(t,"Priority",["Data"],e.TaskPriority$.toJsonValue(this.Priority,n)),void te(t,"Updates",["Data"],e.TaskProperties$.toJsonValue(this.Updates,n))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),o}(pe.ContentActionActivity);e.CanvasTask=w,e.CanvasTask$=w;var C=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"WorkspaceOwner",null,pe.UserInfo$.toJsonValue(this.WorkspaceOwner,t|B.OmitTypeInfo)),te(e,"WorkspaceId",null,D.toJsonValue(this.WorkspaceId,t))}},{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToFacetJsonObject",this).call(this,e,t);var o=Q.fromFlags(t);o!==be.Unified&&o!==be.UnifiedInSignal||te(e,"WorkspaceId",["Data"],D.toJsonValue(this.WorkspaceId,t))}}]),n}(pe.ContentLevelActivity);e.WorkspaceActivity=C,e.WorkspaceActivity$=C;var A=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.WorkspaceCreated",e}return Object(s.a)(n,[{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(C);e.WorkspaceCreated=A,e.WorkspaceCreated$=A;var k=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.WorkspaceOpened",e}return Object(s.a)(n,[{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(C);e.WorkspaceOpened=k,e.WorkspaceOpened$=k;var g=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.WorkspaceJoined",e}return Object(s.a)(n,[{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(C);e.WorkspaceJoined=g,e.WorkspaceJoined$=g;var S=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.WorkspacePageAdded",e}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"AddedPageId",null,D.toJsonValue(this.AddedPageId,t))}},{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToFacetJsonObject",this).call(this,e,t);var o=Q.fromFlags(t);o!==be.Unified&&o!==be.UnifiedInSignal||te(e,"AddedPageId",["Data"],D.toJsonValue(this.AddedPageId,t))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(C);e.WorkspacePageAdded=S,e.WorkspacePageAdded$=S;var U=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.WorkspacePageRemoved",e}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"RemovedPageId",null,D.toJsonValue(this.RemovedPageId,t))}},{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToFacetJsonObject",this).call(this,e,t);var o=Q.fromFlags(t);o!==be.Unified&&o!==be.UnifiedInSignal||te(e,"RemovedPageId",["Data"],D.toJsonValue(this.RemovedPageId,t))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(C);e.WorkspacePageRemoved=U,e.WorkspacePageRemoved$=U;var N=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"LinkedPageId",null,D.toJsonValue(this.LinkedPageId,t)),te(e,"LinkedPageLabel",null,D.toJsonValue(this.LinkedPageLabel,t))}},{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToFacetJsonObject",this).call(this,e,t);var o=Q.fromFlags(t);if(o===be.Unified||o===be.UnifiedInSignal)return te(e,"LinkedPageId",["Data"],D.toJsonValue(this.LinkedPageId,t)),void te(e,"LinkedPageLabel",["Data"],D.toJsonValue(this.LinkedPageLabel,t))}}]),n}(C);e.WorkspacePageLinkActivity=N,e.WorkspacePageLinkActivity$=N;var R=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.WorkspacePageLinkAdded",e}return Object(s.a)(n,[{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(N);e.WorkspacePageLinkAdded=R,e.WorkspacePageLinkAdded$=R;var x=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.WorkspacePageLinkRemoved",e}return Object(s.a)(n,[{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(N);e.WorkspacePageLinkRemoved=x,e.WorkspacePageLinkRemoved$=x;var E=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.ActivitySignalWithoutContent",e.TypeClassification=q.EUII,e}return Object(s.a)(n,[{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToFacetJsonObject",this).call(this,e,t),Q.fromFlags(t)!==be.SIGS||te(e,"ActivityCompliance",["CustomProperties"],D.toJsonValue("EUII",t))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(pe.ActivitySignal);e.ActivitySignalWithoutContent=E,e.ActivitySignalWithoutContent$=E;var M=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Common.ActivitySignalWithContent",e}return Object(s.a)(n,[{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToFacetJsonObject",this).call(this,e,t),Q.fromFlags(t)!==be.SIGS||te(e,"ActivityCompliance",["CustomProperties"],D.toJsonValue("CustomerContent",t))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(pe.ActivitySignal);e.ActivitySignalWithContent=M,e.ActivitySignalWithContent$=M}(ve||(ve={})),function(e){var t=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).Id=R.DefaultValue,e.TypeName="Vroom.WrappedActivity",e}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"Id",null,R.toJsonValue(this.Id,t)),te(e,"activity",null,pe.Activity$.toPolymorphicJsonValue(this.Activity,t&~B.OmitTypeInfo,"Base.Activity"))}},{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToFacetJsonObject",this).call(this,e,t);var o=Q.fromFlags(t);if(o===be.Unified||o===be.UnifiedInSignal)return te(e,"Id",null,R.toJsonValue(this.Id,t)),void te(e,"activity",null,pe.Activity$.toPolymorphicJsonValue(this.Activity,t&~B.OmitTypeInfo,"Base.Activity"))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(re);e.WrappedActivity=t,e.WrappedActivity$=t;var n=function(t){Object(v.a)(o,t);var n=Object(h.a)(o);function o(){var e;return Object(i.a)(this,o),(e=n.apply(this,arguments)).TypeName="Vroom.PatchStreamPayload",e}return Object(s.a)(o,[{key:"writeToJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToJsonObject",this).call(this,t,n),te(t,"value",null,e.WrappedActivity$.toJsonValue(this.Activities,n|B.OmitTypeInfo))}},{key:"writeToFacetJsonObject",value:function(t,n){Object(ue.a)(Object(ce.a)(o.prototype),"writeToFacetJsonObject",this).call(this,t,n);var r=Q.fromFlags(n);r!==be.Unified&&r!==be.UnifiedInSignal||te(t,"value",null,e.WrappedActivity$.toJsonValue(this.Activities,n|B.OmitTypeInfo))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),o}(re);e.PatchStreamPayload=n,e.PatchStreamPayload$=n}(he||(he={})),function(e){var t=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments)).TypeName="Transport.PreprocessorPayload",e}return Object(s.a)(n,[{key:"writeToJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToJsonObject",this).call(this,e,t),te(e,"Signals",null,pe.ActivitySignal$.toPolymorphicJsonValue(this.Signals,t&~B.OmitTypeInfo,"Base.ActivitySignal"))}},{key:"writeToFacetJsonObject",value:function(e,t){Object(ue.a)(Object(ce.a)(n.prototype),"writeToFacetJsonObject",this).call(this,e,t),Q.fromFlags(t)!==be.SIGS||te(e,"activities",null,pe.ActivitySignal$.toPolymorphicJsonValue(this.Signals,t&~B.OmitTypeInfo,"Base.ActivitySignal"))}},{key:"toJsonValue",value:function(e){var t=ee(this.TypeName,e);return this.processJsonObject(t,e,this.writeToJsonObject,this.writeToFacetJsonObject),t}}]),n}(re);e.PreprocessorPayload=t,e.PreprocessorPayload$=t}(Oe||(Oe={}));var me=n(31),ye=n(327),je=n(1287);function Je(e){return btoa(e).split("=")[0].replace("+","-").replace("/","_")}function Te(e,t){return Ie.apply(this,arguments)}function Ie(){return(Ie=Object(a.a)(c.a.mark((function e(t,n){var o,r,a,i,s,u,l,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.siteUrl,r=n.driveId,a=n.fileId,e.next=3,Object(f.a)(t,o,r,a);case 3:if(i=e.sent){e.next=6;break}throw new Error("Failed to fetch file sharepoint ids");case 6:return s=i.sharepointIds,u=s.siteId,l=s.webId,d=s.listId,e.abrupt("return","SPO_".concat(Je("".concat(u,",").concat(l,",").concat(d)),"_").concat(a));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Pe,we,Ve,Ce=n(212),Ae=n(893),ke=n(227),ge=n(907);function Se(e,t){return Ue.apply(this,arguments)}function Ue(){return(Ue=Object(a.a)(c.a.mark((function e(t,n){var o,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.forEach(He.bind(null,t)),e.next=3,Re(t,n);case 3:return o=e.sent,e.next=6,Promise.all([Ke(t,o.filter(Ze)),ze(t,o.filter(et))]);case 6:return r=e.sent,e.abrupt("return",r.every((function(e){return e})));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fe(e,t){return Ne(e,"Pipelines."+t.TypeName,1)}function De(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return $e(e,t,n)}function $e(e,t,n){return Ne(e,Pe[t],n)}function Ne(e,t,n){return Object(ye.a)("ActivityTransport."+t,n,e.settingsProvider)}function Re(e,t){return xe.apply(this,arguments)}function xe(){return(xe=Object(a.a)(c.a.mark((function e(t,n){var o,r,a,i,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],e.prev=1,i=Object(me.c)(Ee(t,n));case 3:return e.next=5,i.next();case 5:if((s=e.sent).done){e.next=11;break}u=s.value,a.push(u);case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),o={error:e.t0};case 16:if(e.prev=16,e.prev=17,!s||s.done||!(r=i.return)){e.next=21;break}return e.next=21,r.call(i);case 21:if(e.prev=21,!o){e.next=24;break}throw o.error;case 24:return e.finish(21);case 25:return e.finish(16);case 26:return e.abrupt("return",a);case 27:case"end":return e.stop()}}),e,null,[[1,13,16,26],[17,,21,25]])})))).apply(this,arguments)}function Ee(e,t){return Object(me.b)(this,arguments,c.a.mark((function n(){var o,r,a,i,s;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(me.d)(Me(e));case 2:o=n.sent,r=Object(O.a)(t),n.prev=4,r.s();case 6:if((a=r.n()).done){n.next=29;break}if(i=a.value,!o||!et(i)){n.next=15;break}return n.next=11,Object(me.d)(i);case 11:return n.next=13,n.sent;case 13:n.next=27;break;case 15:if(!Ze(i)){n.next=27;break}if(!(1&(s=Fe(e,i)))){n.next=22;break}return n.next=20,Object(me.d)(i);case 20:return n.next=22,n.sent;case 22:if(!(o&&2&s)){n.next=27;break}return n.next=25,Object(me.d)(Ye(o,i));case 25:return n.next=27,n.sent;case 27:n.next=6;break;case 29:n.next=34;break;case 31:n.prev=31,n.t0=n.catch(4),r.e(n.t0);case 34:return n.prev=34,r.f(),n.finish(34);case 37:case"end":return n.stop()}}),n,null,[[4,31,34,37]])})))}function Me(e){return We.apply(this,arguments)}function We(){return(We=Object(a.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Le(t)){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.prev=2,e.next=5,Te(t.tokenProvider,t);case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",void 0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}function Le(e){var t,n;return!(!(null===(t=e.senderIdentity)||void 0===t?void 0:t.oid)&&!(null===(n=e.senderIdentity)||void 0===n?void 0:n.puid))&&De(e,Pe.EnableSubstrate)}function Ke(e,t){return Be.apply(this,arguments)}function Be(){return(Be=Object(a.a)(c.a.mark((function e(t,n){var o,a,i,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.length<1)){e.next=2;break}return e.abrupt("return",!0);case 2:return(o=new r.Vroom.PatchStreamPayload).Activities=n.map(Qe),a=Object(Ce.a)(t.siteUrl),i="Consumer"===t.tokenProvider.identityType,s="".concat(a,"/").concat(i?"v2.1":"_api/v2.1")+"/drives/".concat(t.driveId,"/items/").concat(t.fileId,"/office_activityStream"),e.next=9,Object(je.a)({getToken:function(e){var n=Object.assign(Object.assign({},e),{siteUrl:t.siteUrl,driveId:t.driveId,itemId:t.fileId});return t.tokenProvider.getToken(Object(ge.a)(a,i),n)},url:s,tenantId:t.tenantId,requestInit:{method:"PATCH",headers:{"Content-Type":"application/json"},body:o.toFacetJson(r.Facet.Unified)},retryPolicy:Ae.b,tokenPolicy:Object(Ae.a)(t.tokenProvider)});case 9:return u=e.sent,e.abrupt("return",u.result.ok);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ze(e,t){return Ge.apply(this,arguments)}function Ge(){return(Ge=Object(a.a)(c.a.mark((function e(t,n){var o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.length<1)){e.next=2;break}return e.abrupt("return",!0);case 2:return e.prev=2,e.next=5,Promise.all(n.map(_e.bind(null,t)));case 5:return o=e.sent,e.abrupt("return",o.every((function(e){return e})));case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function _e(e,t){return Xe.apply(this,arguments)}function Xe(){return(Xe=Object(a.a)(c.a.mark((function e(t,n){var o,a,i,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(qe(n)){e.next=2;break}return e.abrupt("return",!1);case 2:return De(t,Pe.EnableSignalPreprocessor)&&tt(n)?(o="https://substrate.office.com/signalservice/documentactivities",(i=new r.Transport.PreprocessorPayload).Signals=[n],a=i):(o="https://substrate.office.com/api/v2.0/me/signals",a=n),e.next=5,Object(je.a)({getToken:function(e){return t.tokenProvider.getToken(["https://substrate.office.com/Signals-Internal.ReadWrite"],e)},url:o,tenantId:t.tenantId,requestInit:{method:"POST",headers:{"Content-Type":"application/json",Prefer:'exchange.behavior="SignalAccessV2,OpenComplexTypeExtensions"',"X-SignalInstanceId":n.Id.toString(),"X-AnchorMailbox":t.senderIdentity.upn},body:a.toFacetJson(r.Facet.SIGS)},retryPolicy:{maxRetries:2,backoffFn:Object(ke.a)(500),filter:Object(ke.e)([429,500])}});case 5:return s=e.sent,e.abrupt("return",s.result.ok);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qe(e){return o.isValid(e.Creator)&&o.isValid(e.Creator.RawIdKind)}function He(e,t){e.senderIdentity&&!t.Creator&&(t.Creator=new r.Base.UserInfo,t.Creator.Id=function(e){var t,n;if(null===(t=e.senderIdentity)||void 0===t?void 0:t.oid)return e.senderIdentity.oid;if(null===(n=e.senderIdentity)||void 0===n?void 0:n.puid)return e.senderIdentity.puid;return}(e),t.Creator.Name=e.senderIdentity.name,t.Creator.Email=e.senderIdentity.upn,t.Creator.TenantId=e.senderIdentity.tenantId,t.Creator.RawProvider=function(e){if("Consumer"===e.tokenProvider.identityType)return r.Base.RawIdentityProvider.LiveId;if("Enterprise"===e.tokenProvider.identityType)return r.Base.RawIdentityProvider.ADAL;return}(e),t.Creator.RawId=t.Creator.Id,t.Creator.RawIdKind=function(e){var t,n;if(null===(t=e.senderIdentity)||void 0===t?void 0:t.oid)return r.Base.RawUserIdKind.OID;if(null===(n=e.senderIdentity)||void 0===n?void 0:n.puid)return r.Base.RawUserIdKind.PUID;return}(e))}function Qe(e){var t=new r.Vroom.WrappedActivity;return t.Activity=e,t.Id=e.Id,t}function Ye(e,t){var n=function(e){if(e.TypeClassification===o.Classification.CustomerContent)return new r.Common.ActivitySignalWithContent;return new r.Common.ActivitySignalWithoutContent}(t);return t.SignalId||(t.SignalId=new o.Guid(Object(l.a)())),n.Id=t.SignalId,n.Creator=t.Creator,n.SourceApp=t.SourceApp,n.SourceAppVersion=t.SourceAppVersion,n.SourcePlatform=t.SourcePlatform,n.SourcePlatformVersion=t.SourcePlatformVersion,n.SourceDeviceId=t.SourceDeviceId,n.SourceUserAgent=t.SourceUserAgent,n.SourceIpAddress=t.SourceIpAddress,n.SourceAppContext=t.SourceAppContext,n.NotifiedInBand=t.NotifiedInBand,n.StartTime=t.Created,n.EndTime=t.Created,n.ItemId=e,n.Data=t,n}function Ze(e){return e instanceof r.Base.NormalActivity}function et(e){return e instanceof r.Base.Signal}function tt(e){return e instanceof r.Base.ActivitySignal}!function(e){e[e.EnableSubstrate=0]="EnableSubstrate",e[e.EnableSignalPreprocessor=1]="EnableSignalPreprocessor"}(Pe||(Pe={})),function(e){e.AppContextError="AppContextError",e.MissingAuthorInformation="MissingAuthorInformation",e.NotificationActivityStreamError="NotificationActivityStreamError"}(we||(we={})),function(e){e.NotifyAtMention="NotifyAtMention",e.QueueAtMentionNotification="QueueAtMentionNotification"}(Ve||(Ve={}));var nt=function(){function e(t){if(Object(i.a)(this,e),this.props=t,!this.props.fileId||!this.props.driveId||!this.props.siteUrl)throw new Error("Invalid file information: fileId, driveId or siteUrl might be missing")}return Object(s.a)(e,[{key:"NotificationServicePromise",get:function(){return Promise.resolve(this)}},{key:"notifyAtMention",value:function(){var e=Object(a.a)(c.a.mark((function e(t,n,o){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.sendNotification(t,n,o,Ve.NotifyAtMention));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,o){return e.apply(this,arguments)}}()},{key:"queueAtMentionNotification",value:function(){var e=Object(a.a)(c.a.mark((function e(t){var n,o,r,a,i,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.recipient,o=t.atMentionId,r=t.contentId,a=t.navigationPath,(i=t.resolvedUrl)&&Object(f.c)(i)&&(u=null===(s=i.codeHint)||void 0===s?void 0:s.containerPackageName),e.abrupt("return",this.sendNotification(n.userPrincipalName,r,a,Ve.QueueAtMentionNotification,o,u));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAppContext",value:function(e){var t=void 0,n=void 0;if(e)try{t={fluidComponents:JSON.parse(e)}}catch(o){n=o}return{appContext:t,appContextError:n}}},{key:"notifyOfficeActivityStream",value:function(){var e=Object(a.a)(c.a.mark((function e(t,n,a,i,s,u){var f,d,v,h,O,b,m;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=this.props,d=f.correlationId,v=f.siteUrl,h=f.driveId,O=f.fileId,b=p.a.createNavParam({siteUrl:v,driveId:h,itemId:O,dataStorePath:n,containerPackageName:u}),(m=new r.Common.Mention).Id=new o.Guid(Object(l.a)()),m.Created=m.Observed=new Date,m.SourceApp=r.Base.App.FluidApp,m.SourcePlatform=r.Base.Platform.Web,m.SourceSessionId=d?new o.Guid(d):o.Guid$.DefaultValue,m.SourceAppContext=i,m.ContentId=null!==s&&void 0!==s?s:n,m.NavigationId=b,m.Action=r.Base.ContentAction.Create,m.Mentionee=new r.Base.UserInfo,m.Mentionee.Email=t,m.CommentPreviewAbsenceReason=r.Common.PreviewAbsenceReason.UnsupportedClient,a.addAdditionalProps({activityId:m.Id.toString(),contentId:m.ContentId}),e.next=18,Se(this.props,[m]);case 18:return e.abrupt("return",e.sent);case 19:case"end":return e.stop()}}),e,this)})));return function(t,n,o,r,a,i){return e.apply(this,arguments)}}()},{key:"sendNotification",value:function(){var e=Object(a.a)(c.a.mark((function e(t,n,o,r,a,i){var s,u,l,f,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=d.a.start("NotifyOfficeActivityStream",this.props.logger),t){e.next=4;break}return s.setResult(!1,{navigationPath:o.length>0,entryPoint:r,errorType:we.MissingAuthorInformation}),e.abrupt("return",!1);case 4:return u=this.getAppContext(o),l=u.appContext,f=u.appContextError,e.prev=5,e.next=8,this.notifyOfficeActivityStream(t,n,s,l,a,i);case 8:return p=e.sent,s.setResult(p&&!f,Object.assign({appContextSent:!!l,notifyActivity:p,navigationPath:o.length>0,entryPoint:r},f&&{errorType:we.AppContextError}),f),e.abrupt("return",p);case 13:return e.prev=13,e.t0=e.catch(5),s.setResult(!1,{appContextSent:!!l,notifyActivity:!1,navigationPath:o.length>0,entryPoint:r,errorType:we.NotificationActivityStreamError},e.t0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t,n,o,r,a,i){return e.apply(this,arguments)}}()}]),e}()},907:function(e,t,n){"use strict";function o(e,t){return[t?"onedrive.readwrite":"".concat(e,"/files.readwrite.all")]}n.d(t,"a",(function(){return o}))}}]);
//# sourceMappingURL=276.381e3cc7.chunk.js.map