(this.webpackJsonpfluidhost=this.webpackJsonpfluidhost||[]).push([[267],{1268:function(e,t,r){"use strict";r.r(t),r.d(t,"ShareDialog",(function(){return h})),r.d(t,"ShareDialogRenderer",(function(){return m}));var a=r(6),n=r(731),i=r(1284),o=r(1273),s=r(819),c=r(1267),d=r(776),l=r(779),h=n.memo((function(e){var t=e.payloadPromise,r=e.onRenderPromise,h=e.onCompletePromise,m=e.onDismissDialog,g=e.stringTable,u=e.perfMarks,p=e.localization,f=e.shareMode,b=e.dialogProps,w=n.useState(!1),v=Object(a.a)(w,2),E=v[0],j=v[1],S=n.useState(0),y=Object(a.a)(S,2),k=y[0],D=y[1],O=function(){j(!0),m()},P=function(e){switch(e){case 0:return{header:{padding:0,height:50},title:{padding:0},inner:{padding:0}};case 1:return{header:{padding:0,height:0},title:{padding:0},inner:{padding:0,"@media (min-width: 320px) and (max-width: 479px)":{padding:0}}};case 2:return{header:{padding:0,height:50},title:{paddingTop:15,paddingBottom:15,paddingLeft:20},inner:{padding:20,width:330}}}}(k);return n.createElement(i.a,{settings:{theme:null===b||void 0===b?void 0:b.theme}},n.createElement(o.a,Object.assign({dialogContentProps:{type:s.a.normal,styles:P},hidden:E,modalProps:{isBlocking:!1,styles:{main:{maxWidth:l.a,minWidth:l.c}}},onDismiss:O,maxWidth:"none",title:2===k?f===c.a.copyLink?g.copyDialogErrorTitle:g.shareDialogErrorTitle:void 0},b),n.createElement(d.a,{payloadPromise:t,onRenderPromise:r,onCompletePromise:h,stringTable:g,perfMarks:u,localization:p,renderState:k,setRenderState:D,onIframeDismiss:O})))})),m=function(e){var t=n.useState(!0),r=Object(a.a)(t,2),i=r[0],o=r[1];return n.createElement(n.Fragment,null,i&&n.createElement(h,Object.assign({},e,{onDismissDialog:function(){o(!1),e.onDismissDialog()}})))}},776:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var a=r(6),n=r(731),i=r(1286),o=r(822),s=r(777),c=r(1259),d=r(743),l=r(775),h=r(779),m="shareIframe",g="www.odwebp.svc.ms",u="https://".concat(g,"/share"),p=n.memo((function(e){var t=e.payloadPromise,r=e.onRenderPromise,s=e.onCompletePromise,c=e.stringTable,d=e.perfMarks,l=e.localization,g=e.renderState,p=e.setRenderState,E=e.onIframeDismiss,j=n.useState(void 0),S=Object(a.a)(j,2),y=S[0],k=S[1],D=n.useState({width:Object(h.d)(h.c),height:h.b}),O=Object(a.a)(D,2),P=O[0],C=O[1],M=n.useCallback((function(e){var t=e.width,r=e.height;C({width:Object(h.d)(t),height:r})}),[]),x="".concat(u,"?smkt=").concat(l.locale),T=n.useCallback((function(e){null!==e&&(e.submit(),d.payloadSendStartTime=performance.now())}),[]),L=n.useCallback((function(e){e&&e.focus()}),[]);n.useEffect((function(){t.then((function(e){k(e)})).catch((function(e){r.reject(e),s.reject(e)}))}),[t]),n.useEffect((function(){s.catch((function(){p(2)}))}),[s]),n.useEffect((function(){var e=function(e){f(e,E,r,s,p,M,d)};return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}}),[]);var R=v(g,P.width,P.height),_=w(P.width,P.height);return n.createElement(n.Fragment,null,0===g&&n.createElement("div",{className:b,"aria-label":"Loading",ref:L},n.createElement(i.a,{size:o.a.large})),2===g&&n.createElement("div",{"aria-label":c.shareDialogErrorMessage},c.shareDialogErrorMessage),2!==g&&n.createElement("div",{className:R},y&&n.createElement("form",{id:"shareform",action:x,method:"post",target:m,ref:T},n.createElement("input",{type:"text",name:"context",defaultValue:y,style:{display:"none"}})),n.createElement("iframe",{className:_,name:m,sandbox:void 0})))})),f=function(e,t,r,a,n,i,o){var s=new URL(e.origin);if("https:"===s.protocol&&s.hostname===g){var h=JSON.parse(e.data);switch(h.name){case"share_started":o.sharePointLoadStartTime=performance.now();break;case"share_ready":n(1),r.resolve(!0);break;case"share_resize":h&&Object(c.a)(h.width)&&Object(c.a)(h.height)&&0!==h.width&&0!==h.height&&i({width:h.width,height:h.height});break;case"share_dismiss":t();break;case"share_grantAccessCompleted":a.resolve(h&&h.successful);break;case"share_completed":a.resolve(!0);break;case"share_error":var m=h&&h.error?h.error.toString():"error not provided",u=h&&h.errorCategory?h.errorCategory.toString():"error category not provided",p=h&&h.errorMessage?h.errorMessage:"error message not provided",f=h&&h.debugErrorMessage?h.debugErrorMessage:"debug error message not provided",b=new l.a(d.b.SpoShareError,p,f,m,u);r.reject(b),a.reject(b)}}},b=Object(s.A)({width:350,height:250,paddingBottom:50,display:"flex",justifyContent:"center",alignContent:"center",selectors:{":focus":{outline:"none"}}}),w=function(e,t){return Object(s.A)({width:e,height:t,border:"none"})},v=function(e,t,r){return Object(s.A)({width:1===e?t:0,height:1===e?r:0,overflow:"hidden"})}}}]);
//# sourceMappingURL=shareDialog.975f5973.chunk.js.map