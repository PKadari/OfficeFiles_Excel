(this.webpackJsonpfluidhost=this.webpackJsonpfluidhost||[]).push([[266],{1289:function(e,t,r){"use strict";r.r(t),r.d(t,"ShareCallout",(function(){return c})),r.d(t,"ShareCalloutRenderer",(function(){return l}));var a=r(6),n=r(731),o=r(1284),s=r(1281),i=r(776),c=n.memo((function(e){var t=e.payloadPromise,r=e.onRenderPromise,c=e.onCompletePromise,l=e.stringTable,d=e.perfMarks,m=e.localization,h=e.onDismissCallout,f=e.calloutProps,g=n.useState(0),b=Object(a.a)(g,2),p=b[0],v=b[1],w=n.useState(!1),E=Object(a.a)(w,2),S=E[0],j=E[1],k=function(){j(!0),h()};return function(e){var t=n.useRef(!1);n.useEffect((function(){var r=function(r){t.current&&!r.relatedTarget&&e()};return window.addEventListener("blur",r),t.current=!0,function(){t.current=!1,window.removeEventListener("blur",r)}}),[])}(k),n.createElement(o.a,{settings:{theme:null===f||void 0===f?void 0:f.theme}},n.createElement(s.a,Object.assign({hidden:S,onDismiss:k},u,f),n.createElement(i.a,{payloadPromise:t,onRenderPromise:r,onCompletePromise:c,stringTable:l,perfMarks:d,localization:m,renderState:p,setRenderState:v,onIframeDismiss:k})))})),l=function(e){var t=n.useState(!0),r=Object(a.a)(t,2),o=r[0],s=r[1];return n.createElement(n.Fragment,null,o&&n.createElement(c,Object.assign({},e,{onDismissCallout:function(){s(!1),e.onDismissCallout()}})))},u={setInitialFocus:!0,isBeakVisible:!1,gapSpace:0}},776:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var a=r(6),n=r(731),o=r(1286),s=r(822),i=r(777),c=r(1259),l=r(743),u=r(775),d=r(779),m="shareIframe",h="www.odwebp.svc.ms",f="https://".concat(h,"/share"),g=n.memo((function(e){var t=e.payloadPromise,r=e.onRenderPromise,i=e.onCompletePromise,c=e.stringTable,l=e.perfMarks,u=e.localization,h=e.renderState,g=e.setRenderState,E=e.onIframeDismiss,S=n.useState(void 0),j=Object(a.a)(S,2),k=j[0],C=j[1],O=n.useState({width:Object(d.d)(d.c),height:d.b}),y=Object(a.a)(O,2),P=y[0],M=y[1],D=n.useCallback((function(e){var t=e.width,r=e.height;M({width:Object(d.d)(t),height:r})}),[]),R="".concat(f,"?smkt=").concat(u.locale),L=n.useCallback((function(e){null!==e&&(e.submit(),l.payloadSendStartTime=performance.now())}),[]),_=n.useCallback((function(e){e&&e.focus()}),[]);n.useEffect((function(){t.then((function(e){C(e)})).catch((function(e){r.reject(e),i.reject(e)}))}),[t]),n.useEffect((function(){i.catch((function(){g(2)}))}),[i]),n.useEffect((function(){var e=function(e){b(e,E,r,i,g,D,l)};return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}}),[]);var T=w(h,P.width,P.height),z=v(P.width,P.height);return n.createElement(n.Fragment,null,0===h&&n.createElement("div",{className:p,"aria-label":"Loading",ref:_},n.createElement(o.a,{size:s.a.large})),2===h&&n.createElement("div",{"aria-label":c.shareDialogErrorMessage},c.shareDialogErrorMessage),2!==h&&n.createElement("div",{className:T},k&&n.createElement("form",{id:"shareform",action:R,method:"post",target:m,ref:L},n.createElement("input",{type:"text",name:"context",defaultValue:k,style:{display:"none"}})),n.createElement("iframe",{className:z,name:m,sandbox:void 0})))})),b=function(e,t,r,a,n,o,s){var i=new URL(e.origin);if("https:"===i.protocol&&i.hostname===h){var d=JSON.parse(e.data);switch(d.name){case"share_started":s.sharePointLoadStartTime=performance.now();break;case"share_ready":n(1),r.resolve(!0);break;case"share_resize":d&&Object(c.a)(d.width)&&Object(c.a)(d.height)&&0!==d.width&&0!==d.height&&o({width:d.width,height:d.height});break;case"share_dismiss":t();break;case"share_grantAccessCompleted":a.resolve(d&&d.successful);break;case"share_completed":a.resolve(!0);break;case"share_error":var m=d&&d.error?d.error.toString():"error not provided",f=d&&d.errorCategory?d.errorCategory.toString():"error category not provided",g=d&&d.errorMessage?d.errorMessage:"error message not provided",b=d&&d.debugErrorMessage?d.debugErrorMessage:"debug error message not provided",p=new u.a(l.b.SpoShareError,g,b,m,f);r.reject(p),a.reject(p)}}},p=Object(i.A)({width:350,height:250,paddingBottom:50,display:"flex",justifyContent:"center",alignContent:"center",selectors:{":focus":{outline:"none"}}}),v=function(e,t){return Object(i.A)({width:e,height:t,border:"none"})},w=function(e,t,r){return Object(i.A)({width:1===e?t:0,height:1===e?r:0,overflow:"hidden"})}}}]);
//# sourceMappingURL=shareCallout.21c058af.chunk.js.map