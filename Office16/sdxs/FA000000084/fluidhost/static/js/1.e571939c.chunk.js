(this.webpackJsonpfluidhost=this.webpackJsonpfluidhost||[]).push([[1],{1260:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return b}));var r=n(1),a=n(0),i=n.n(a),s=n(1287),u=n(818),c=function(e){return e?["files.readwrite","people.read","user.read"]:["files.readwrite.all","people.read","user.read","user.readbasic.all"]};function o(e,t,n,r,a,i,s){return d.apply(this,arguments)}function d(){return d=Object(r.a)(i.a.mark((function e(t,n,a,c,o,d,l){var f,p,b,v,g,m=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=m.length>7&&void 0!==m[7]?m[7]:0,p=m.length>8?m[8]:void 0,b=n.startsWith("http")?n:"https://graph.microsoft.com/v1.0/".concat(n),v={getToken:t,url:b,tenantId:o,requestInit:d,retryPolicy:l,timeoutMs:f},g=c&&a?Object(s.b)(Object.assign(Object.assign({},v),{logger:c,nameForLogging:a,doNotLogOnSuccess:p,getAdditionalProps:function(){var e=Object(r.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(u.a)(t));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()})):Object(s.a)(v),e.next=7,g;case 7:return e.abrupt("return",e.sent.result);case 8:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}var l,f={};function p(e,t,n,a){return"Consumer"===e.identityType?Promise.resolve(404):(f[t]||(f[t]=new Promise(function(){var s=Object(r.a)(i.a.mark((function r(s,u){var d,l;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return d=function(t){return e.getToken(c(!1),t)},r.prev=1,r.next=4,o(d,"users/".concat(t,"/photos/96x96/$value"),"GetUserPhoto",n,a);case 4:l=r.sent,r.next=11;break;case 7:r.prev=7,r.t0=r.catch(1),delete f[t],u(r.t0);case 11:if(!l){r.next=31;break}if(200===l.status||404===l.status){r.next=17;break}delete f[t],s(l.status),r.next=31;break;case 17:if(r.t1=s,!l.ok){r.next=28;break}return r.t3=t,r.t4=URL,r.next=23,l.blob();case 23:r.t5=r.sent,r.t6=r.t4.createObjectURL.call(r.t4,r.t5),r.t2={userPrincipalName:r.t3,pictureUrl:r.t6},r.next=29;break;case 28:r.t2=l.status;case 29:r.t7=r.t2,(0,r.t1)(r.t7);case 31:case"end":return r.stop()}}),r,null,[[1,7]])})));return function(e,t){return s.apply(this,arguments)}}())),f[t])}function b(e,t){return l||(l=new Promise(function(){var n=Object(r.a)(i.a.mark((function n(r,a){var s,u,d,f,p,b,v;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return d="Consumer"===e.identityType,f=function(t){return e.getToken(c(d),t)},n.prev=2,n.next=5,o(f,"organization?$select=displayName","GetMyCompanyName",t);case 5:p=n.sent,n.next=12;break;case 8:n.prev=8,n.t0=n.catch(2),l=void 0,a(n.t0);case 12:if(!p){n.next=23;break}if(200===p.status||404===p.status){n.next=18;break}l=void 0,r(p.status),n.next=23;break;case 18:return n.next=20,p.json();case 20:b=n.sent,v=null===(u=null===(s=null===b||void 0===b?void 0:b.value)||void 0===s?void 0:s[0])||void 0===u?void 0:u.displayName,r(v||p.status);case 23:case"end":return n.stop()}}),n,null,[[2,8]])})));return function(e,t){return n.apply(this,arguments)}}())),l}},1287:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f}));var r=n(1),a=n(0),i=n.n(a),s=n(209),u=n(227);function c(e){var t=e.get("www-authenticate");if(t){var n,r=!1;return t.split(",").map((function(e){var t=e.split("=");t.length>=2&&(r||"error"!==t[0].trim().toLowerCase()?n||"claims"!==t[0].trim().toLowerCase()||(n=atob(JSON.parse(e.substring(e.indexOf("=")+1).trim()))):r="insufficient_claims"===JSON.parse(t[1].trim().toLowerCase()))})),r?n:void 0}}var o=n(312),d={scheme:s.b};function l(e){var t;return e.tenantId&&(t={tenantId:e.tenantId}),p(e,t)}function f(e){var t;return e.tenantId&&(t={tenantId:e.tenantId}),p(e,t)}function p(e,t){return b.apply(this,arguments)}function b(){return b=Object(r.a)(i.a.mark((function e(t,n){var r,a,l,f,b,v,g,m,h,x,O,k,j,y,w,I,N,L=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=L.length>2&&void 0!==L[2]?L[2]:1,e.next=3,t.getToken(n);case 3:if(l=e.sent.token,f=t.url,b=t.requestInit,v=t.retryPolicy,g=t.timeoutMs,m=null!==(a=t.tokenPolicy)&&void 0!==a?a:d,h=Object(s.a)(f,b,l,m),x=h.url,O=h.request,k=function(e){return 401===e.status&&c(e.headers)||void 0},j=function(e){if(401===e.status){var t=Object(o.a)(e.headers);if(t&&t!==(null===n||void 0===n?void 0:n.tenantId))return t}},v&&(y=Object.assign(Object.assign({},v),{filter:function(e){return!k(e)&&!j(e)&&v.filter(e)}})),!("logger"in t)||!("nameForLogging"in t)){e.next=16;break}return e.next=13,Object(u.d)(x,O,t.nameForLogging,t.logger,"doNotLogOnSuccess"in t?t.doNotLogOnSuccess:void 0,y,g,"getAdditionalProps"in t?t.getAdditionalProps:void 0);case 13:e.t0=e.sent,e.next=19;break;case 16:return e.next=18,Object(u.c)(x,O,y,g);case 18:e.t0=e.sent;case 19:if(w=e.t0,!((I=k(w.result))&&r<3)){e.next=23;break}return e.abrupt("return",p(t,Object.assign(Object.assign({},n),{claims:I}),r+1));case 23:if(!(N=j(w.result))){e.next=26;break}return e.abrupt("return",p(t,Object.assign(Object.assign({},n),{tenantId:N}),r+1));case 26:return e.abrupt("return",w);case 27:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}},818:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=[{headerName:"sprequestguid",logName:"spRequestGuid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"}];function a(e){var t={};return e&&e.headers&&r.forEach((function(n){var r=e.headers.get(n.headerName);r&&(t[n.logName]=r)})),t}},892:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return p}));var r=n(1),a=n(0),i=n.n(a),s=n(212),u=n(1287),c=n(818),o=(n(333),n(893)),d={};function l(e,t,n,a,l,f){var p=Object(s.a)(t),b="".concat(p,"_").concat(n,"_").concat(a);return d[b]||(d[b]=new Promise(function(){var s=Object(r.a)(i.a.mark((function s(v){var g,m,h,x,O;return i.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return g="".concat(p,"/_api/v2.0/drives/").concat(n,"/items/").concat(a,"?select=webUrl,webDavUrl,name,sharepointIds"),m={getToken:function(r){var i=Object.assign(Object.assign({},r),{siteUrl:t,driveId:n,itemId:a});return e.getToken(["Consumer"===e.identityType?"onedrive.readwrite":"".concat(p,"/files.readwrite.all")],i)},url:g,tenantId:f,requestInit:{method:"GET"},retryPolicy:o.b,tokenPolicy:Object(o.a)(e)},h=l?Object(u.b)(Object.assign(Object.assign({},m),{logger:l,nameForLogging:"GetFileItemLite",doNotLogOnSuccess:!0,getAdditionalProps:function(){var e=Object(r.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(c.a)(t));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()})):Object(u.a)(m),s.prev=3,s.next=6,h;case 6:x=s.sent.result,s.next=11;break;case 9:s.prev=9,s.t0=s.catch(3);case 11:if(x&&(200===x.status||404===x.status)){s.next=16;break}delete d[b],v(void 0),s.next=27;break;case 16:return s.prev=16,s.next=19,x.json();case 19:O=s.sent,v(O),s.next=27;break;case 23:s.prev=23,s.t1=s.catch(16),delete d[b],v(void 0);case 27:case"end":return s.stop()}}),s,null,[[3,9],[16,23]])})));return function(e){return s.apply(this,arguments)}}())),d[b]}var f=function(){var e=Object(r.a)(i.a.mark((function e(t,n,r,a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p(t)){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.abrupt("return",l(n,t.siteUrl,t.driveId,t.itemId,r,a).then((function(e){var t=null===e||void 0===e?void 0:e.webDavUrl.lastIndexOf("/");if(void 0!==t&&t>0)return null===e||void 0===e?void 0:e.webDavUrl.substring(0,t)})));case 3:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),p=function(e){return function(e){return"fluid"===e.type}(e)&&"driveId"in e&&"siteUrl"in e&&"itemId"in e}},893:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(209),a=n(227),i={maxRetries:2,backoffFn:Object(a.a)(500),filter:Object(a.e)([408,409,429])},s={scheme:r.b,queryParam:"access_token",doNotExceedQueryParamsLength:2048,preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920},u={scheme:r.b,preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920};function c(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="Consumer"===e.identityType?u:s;return Object.assign(Object.assign({},n),{preferAuthorizationInMultipartFormBody:t})}}}]);
//# sourceMappingURL=1.e571939c.chunk.js.map